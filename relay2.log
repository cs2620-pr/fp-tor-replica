[Relay] ---- Relay process started ----
[Relay 2] [Relay] Loaded persistent RSA keypair from relay2_key.pem
[Relay 2] [Relay] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] [KEY] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] Relay 2 starting on 10.250.153.213:9102 (RELAY PORT 9102)
[Relay 2] Registering with CDS at 127.0.0.1:9000
[Relay 2] [Relay] Registered with CDS: {'ip': '10.250.153.213', 'port': 9102, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA58J3pSrOQd4hYnuzQQ7q\nWrjjo+3BJp+ik23brR2yl0kjtfH+wjD9LYWHS7dBxsDRzSozJ/7EWKKNCaTsgvaF\nN6vpyBPqDM/uQfOWfirteL50RgDZw95Vml4Fuay7bTBEb1J8ydvFqawo8rnLE2I3\nU4BjBT+CD38bY3je8wrrCX9fo1uYaLDlfteGshadZ2gnTxrAzkZZ/CTFdyb8JrmN\nIuxjBVjwSA/uIv+KHWQhXRA5jJPXcNV88LYXyEzpid1Cr9gnrqA88K0HSleiwZjU\nJF3LhBvS2Ga2HHfFsk5D/yz/pTHwDvRA98VMT/90wahwmSJsck4XWDFhmNhy3oDR\nBQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 2] [Relay] Listening for incoming messages on port 9102 (RELAY PORT 9102)
[Relay 2] [Relay] [handle_message ENTERED] addr=('10.250.153.213', 56620), thread=6124564480, relay_port=9102
[Relay 2] [Relay] [DEBUG] Raw data received: b'{"next_ip": "10.250.153.213", "next_port": 9102, "session_key": "iTPkiJVqJwxB6IYyjY6OjNoVOy65wranFToJLgEzBW2ZlxUeiF4hNB0IYpKnNKJtFB+yEtYxi+CsY6NaJBaBJNJkZDt6Iw7ZN4Z47CpRxT1HMGmL4L8RAv0z4vThAxFWYbXcklpAko3URmPo+tZ8AW8v2KEq9crsMjjZBJG3gbUQmeZ3GQOvmloy7QlBRzWz0hRbeeALdMbuFny+7Jh9u2pe3GvZC1EtLsUwhKDphOO354Rtek3hLDkQBw4Q91nqsUEJ+ATplnJJVDIRR9PAgKGxQ4Eoumf8lduyrn/oaUsEi8Zf+hMW6X5ZK5blx+mw6fp4E+RlXsacug5fJv6zTQ==", "payload": "aYppccvedr8J0qekgMqHgtD1C3ctHEFnkX7Nn91ZqjJy/lINjTBu/v6uZKtxhUkTqURTmGwsTUzR+ZeLFKmnvxx30UZ/JjlFBVUOW6hfDGr/gfXxgEhKzzJ6CLDNx+DmST5WVvv0h62Zze/6j7iTOwgf7+BfL4qaT/ZyeAXglVLqQZ2rlEFzfaGLpPZ5Z8S40G4qJR6+DjIKpr37cYIu8MU2ZY+k9Tpsp/XAW7n/lK324ICK1k52K+j7axj1wC4kwy2EdIS10ng+iJQbbcMmNjmrcYVUC0Aux94h68y+WskwR/Df/boWWKg3+QBh6xxPSgUD6/2VH+upTtxuIQz3L9DmmrOIjLFQumZ53b/9N1rhQyP4YrZe7pKW/PGbnry356wLpcgZyr6pEImllbJRNRYcwEeST5KAq1rmlzulxjPoZrvKtqH5fDWow5Ft2kGWTTvxsg8M8sdcB4+4fZXXHYNcjMsB4ICb6gIR9fIJ2vD63jhle5n7FyA5vXMcHfZv0qrJd+J78x5MsRCB85S1Mr4T6B/QjsRlk1tCCzdqoPe5X3q7FaYo20CZFoJNyWztbc8aH+Ijs6ZsozcgsxoH68FNlzYB2z6MuMYo/NDd759j5rKcnxCzpZpE6hIzphj6i6GbuLiMzt1AjfzXRRxM6FJ+Ss9NY1Lh9FrMYESf2RhHqAiBqDjVHUWlnNpbjpWea76QADH7WBNThgSSbqzCIrqHY/FMHwFqz7pZ/iCvMfxPPsGVKRctuugVW5aBLN9bM7ANU04Tq3XWA6uHp+TI0E6nip/TYi+JDCXcUwTjwb29KvRctcv8x/t5Xc6hZuqeqR2DGBTjpjXqU5TlI2VQxhAzCS6t5NZOnP49Fh9K1+jSMy1hXvAbTlO5cbweVAx9PVAgp8jxS0RUiL85YFOaHQrfHgyz3DAPU2xPywPbEL+XN2ACbT7ZO2OM7jqSqBe232Px32Pg50qN00iaLRMT+X4yo/Gx+tJFBOeawR5KQ5OOaApoJHDcbY9PWxxFMA8byqcxeNATcmimIibB4aCWNyDPXlG/xSItY8xDR7sn06dJnVEtmNAYgT1a30UOVZhLhMucYW3dqkqbzOppAWRl/E0eAP1yvueOUjj+ov0vlA7u9TWxHWJg0QzTCCS9kcVZtlISNBHrvN+W1Q+8R48EGLLnEbCNarQ9dI1OOH9JHDSfYytdES4R7iRCTR1yoX4YcuYplNhL7nZVQpEqI5Z4P/TWJtRZgG+7Z3egxOIw6USf44Vj7mEPCWnz6qrvguE8bou+h9uFcRrTlyg6QHz2N4xWunAve7ZhcldHGIn8ZMUHOn1Y5qotV7JNJshDhsCAYXYVuHztgg0t6oiAaGKEZVNTlMiv2SCqvmUj0t6RhnqwRCU9K3RW5MMFUXOSzeZURT7qR3AOznVnsesWDswYuR388FAmRKv/gYrQGkHKd7ihoCO+HSFBQg0UbTjHbpqPMBQ="}'
[Relay 2] [Relay] [DEBUG] Data after JSON parse: type=<class 'dict'>, keys=['next_ip', 'next_port', 'session_key', 'payload']
[Relay 2] [Relay] Received session_key (base64): iTPkiJVqJwxB6IYyjY6OjNoVOy65wranFToJLgEzBW2ZlxUeiF4hNB0IYpKnNKJtFB+yEtYxi+CsY6NaJBaBJNJkZDt6Iw7ZN4Z47CpRxT1HMGmL4L8RAv0z4vThAxFWYbXcklpAko3URmPo+tZ8AW8v2KEq9crsMjjZBJG3gbUQmeZ3GQOvmloy7QlBRzWz0hRbeeALdMbuFny+7Jh9u2pe3GvZC1EtLsUwhKDphOO354Rtek3hLDkQBw4Q91nqsUEJ+ATplnJJVDIRR9PAgKGxQ4Eoumf8lduyrn/oaUsEi8Zf+hMW6X5ZK5blx+mw6fp4E+RlXsacug5fJv6zTQ==
[Relay 2] [Relay] Decoded session_key_enc (hex): 8933e488956a270c41e886328d8e8e8cda153b2eb9c2b6a7153a092e0133056d9997151e885e21341d086292a734a26d141fb212d6318be0ac63a35a24168124d264643b7a230ed9378678ec2a51c53d4730698be0bf1102fd33e2f4e103115661b5dc925a40928dd44663e8fad67c016f2fd8a12af5caec3238d90491b781b51099e6771903af9a5a32ed09414735b3d2145b79e00b74c6ee167cbeec987dbb6a5edc6bd90b512d2ec53084a0e984e3b7e7846d7a4de12c3910070e10f759eab14109f804e996724954321147d3c080a1b1438128ba67fc95dbb2ae7fe8694b048bc65ffa1316e97e592b96e5c7e9b0e9fa7813e4655ec69cba0e5f26feb34d
[Relay 2] [Relay] Decrypting session key with fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] Decrypted session_key (hex): 4c4dee0eea273c82fb44d9607cd0d81388301b00f5d271a0ec3cb82fa100e398
[Relay 2] [Relay] [DEBUG] About to AES-decrypt payload (passing base64 string directly)
[Relay 2] [Relay] [DEBUG] Payload base64-decoded: type=<class 'bytes'>, len=1106, preview=b'i\x8aiq\xcb\xdev\xbf\t\xd2\xa7\xa4\x80\xca\x87\x82\xd0\xf5\x0bw-\x1cAg\x91~\xcd\x9f\xddY\xaa2r\xfeR\r\x8d0n\xfe\xfe\xaed\xabq\x85I\x13\xa9DS\x98l,ML\xd1\xf9\x97\x8b'
[Relay 2] [Relay] [DEBUG] AES-decrypted payload: type=<class 'bytes'>, len=1090, preview=b'{"next_ip": "10.250.153.213", "next_port": 9101, "session_ke'
[Relay 2] [Relay] [DEBUG] AES-decrypted payload (hex): 7b226e6578745f6970223a202231302e3235302e3135332e323133222c20226e6578745f706f7274223a20393130312c202273657373696f6e5f6b65
[Relay 2] [Relay] [DEBUG] Next hop JSON keys: ['next_ip', 'next_port', 'session_key', 'payload']
[Relay 2] [Relay] [DEBUG] Forwarding to next relay 10.250.153.213:9101
[Relay 2] [Relay] [DEBUG] Received response from next relay: type=<class 'bytes'>, len=44, preview=b'n2pYeHno+utNZGOIEQKqJDb0Ra0VGCno5yOsFtswb5Y='
[Relay 2] [Relay] [RETURN] Base64-decoded response: type=<class 'bytes'>, len=32, preview=b'\x9fjXxy\xe8\xfa\xebMdc\x88\x11\x02\xaa$6\xf4E\xad\x15\x18)\xe8\xe7#\xac\x16\xdb0o\x96'
[Relay 2] [Relay] [RETURN] AES-decrypted response: type=<class 'bytes'>, len=16, preview=b'\xf0\x00e\x82\xd7\x130\xdf\xfc\xe6\x01yH\x9aBt'
[Relay 2] [Relay] [RETURN] AES-decrypted response not UTF-8: 'utf-8' codec can't decode byte 0xf0 in position 0: invalid continuation byte
[Relay 2] [Relay] [RETURN] AES-encrypted response (hex): f68c26f8af674e57f297130a06d6defb075d6d66af03936a6ae72b13e82c9b7e82d0d221bbdc69d645cfb82fd543dd47
[Relay 2] [Relay] [RETURN] Base64-encoded AES-encrypted response: type=<class 'bytes'>, len=64, preview=b'9owm+K9nTlfylxMKBtbe+wddbWavA5NqaucrE+gsm36C0NIhu9xp1kXPuC/V'
[Relay 2] [Relay] [handle_message END] addr=('10.250.153.213', 56620), thread=6124564480
