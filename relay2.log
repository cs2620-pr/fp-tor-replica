[Relay] ---- Relay process started ----
[Relay 2] [Relay] Loaded persistent RSA keypair from relay2_key.pem
[Relay 2] [Relay] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] [KEY] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] Relay 2 starting on 10.250.120.196:9102 (RELAY PORT 9102)
[Relay 2] Registering with CDS at 127.0.0.1:9000
[Relay 2] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9102, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA58J3pSrOQd4hYnuzQQ7q\nWrjjo+3BJp+ik23brR2yl0kjtfH+wjD9LYWHS7dBxsDRzSozJ/7EWKKNCaTsgvaF\nN6vpyBPqDM/uQfOWfirteL50RgDZw95Vml4Fuay7bTBEb1J8ydvFqawo8rnLE2I3\nU4BjBT+CD38bY3je8wrrCX9fo1uYaLDlfteGshadZ2gnTxrAzkZZ/CTFdyb8JrmN\nIuxjBVjwSA/uIv+KHWQhXRA5jJPXcNV88LYXyEzpid1Cr9gnrqA88K0HSleiwZjU\nJF3LhBvS2Ga2HHfFsk5D/yz/pTHwDvRA98VMT/90wahwmSJsck4XWDFhmNhy3oDR\nBQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 2] [Relay] Listening for incoming messages on port 9102 (RELAY PORT 9102)
[Relay 2] [Relay] [handle_message ENTERED] addr=('10.250.120.196', 60526), thread=6132690944, relay_port=9102
[Relay 2] [Relay] [DEBUG] Raw data received: b'{"next_ip": "10.250.120.196", "next_port": 9102, "session_key": "cP+QCevhs41QBL+dbmZAxsDX1T4oIP/gZp4l+8qrrfECkVrhV4PGKhPAmh0b/CeIEYxYp0Y0rjhbDySJSCN4ZL/DOpzzU6HynPqsEmrkBixRVWHrKAScFXidZ+tLIGriYPrgs9H717w5btpqp+BKwBbXaSm/77bvns1yfoq8Fe7+D4abuqn/crcqYK0LUqhfr4bq25J4WSYUEPXEfjWE5QqhQTJIJwGqZ4MO8nCPc1MVBg5cinuY84n6bvqFfeMXduFYMFS0NqX6iDtZCZmUIeNrQWDFRv1DP0Ih5ra7wtUP9G6r4e1IWIPyZrpcBWINMzFkpfMAGtLUC6YsX5YWFQ==", "payload": "IYgViqbfcHTc2QLQkuNIhE/P7AH4WiswkjV/1B3/FzZKAV7zxtRWJmCCU0j8T5wgPVI6dKn4JHE0/yzKhef/9nrrUJJpO3MPCwcVfs2jSlaW5ilRo0IAJU7xsgMHUL81bddyEYUixsRwx/R2deWXSgBe77P2bYbM/utUx660ggI7qVO1KhH3kIzq+j4Iy/yP3A/x+h3pA0Cv85zWFQl/TMEkk25pkBGiCn0Y3lDvWG5EoCK4+HMj1Dgzr7IUo0WHEX14T6SiRKscxUDgRrgsk6Mln7tcG/5OpUo9R5C8h/Sd2DxWrnrJUJkEDE21U6BowYttKah5FYUi0Ri/5z9M3KNZkhmIFrpdgx1kmUGerlwkHUxxplbpMBoAlxQU9KjaELJHpRFnuIza8uahP50o9nf20SajRZwcAlHYlHe3bDxpKVrQ5zN9a2lC9zDOpXWjEb22n5wfsPmY75iEugC7nIaGLoYeaP1nbptc+ChR7eFB5xdgpVk4BwxZ5h47m9EKRmKhxhlvEdkm8wjqP1jkWdZ0lw/KEPS+U26SN5Vfk94k4d7CSM7vB9jDeJqnxOg+E43pTKP99VV3eQlUSQV39axJB/uInht2c+V7+nqp/PbfLaD01KY61WB8i4CoswFetsQsu3fEFuIq7ENjplHtY+kC"}'
[Relay 2] [Relay] [DEBUG] Data after JSON parse: type=<class 'dict'>, keys=['next_ip', 'next_port', 'session_key', 'payload']
[Relay 2] [Relay] Received session_key (base64): cP+QCevhs41QBL+dbmZAxsDX1T4oIP/gZp4l+8qrrfECkVrhV4PGKhPAmh0b/CeIEYxYp0Y0rjhbDySJSCN4ZL/DOpzzU6HynPqsEmrkBixRVWHrKAScFXidZ+tLIGriYPrgs9H717w5btpqp+BKwBbXaSm/77bvns1yfoq8Fe7+D4abuqn/crcqYK0LUqhfr4bq25J4WSYUEPXEfjWE5QqhQTJIJwGqZ4MO8nCPc1MVBg5cinuY84n6bvqFfeMXduFYMFS0NqX6iDtZCZmUIeNrQWDFRv1DP0Ih5ra7wtUP9G6r4e1IWIPyZrpcBWINMzFkpfMAGtLUC6YsX5YWFQ==
[Relay 2] [Relay] Decoded session_key_enc (hex): 70ff9009ebe1b38d5004bf9d6e6640c6c0d7d53e2820ffe0669e25fbcaabadf102915ae15783c62a13c09a1d1bfc2788118c58a74634ae385b0f248948237864bfc33a9cf353a1f29cfaac126ae4062c515561eb28049c15789d67eb4b206ae260fae0b3d1fbd7bc396eda6aa7e04ac016d76929bfefb6ef9ecd727e8abc15eefe0f869bbaa9ff72b72a60ad0b52a85faf86eadb927859261410f5c47e3584e50aa14132482701aa67830ef2708f735315060e5c8a7b98f389fa6efa857de31776e1583054b436a5fa883b5909999421e36b4160c546fd433f4221e6b6bbc2d50ff46eabe1ed485883f266ba5c05620d333164a5f3001ad2d40ba62c5f961615
[Relay 2] [Relay] Decrypting session key with fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] Decrypted session_key (hex): 33c929f4483ac6b52aed26b2b77efdbbb3046d7662ba6ba6d8426c656671f713
[Relay 2] [Relay] [DEBUG] About to AES-decrypt payload (passing base64 string directly)
[Relay 2] [Relay] [DEBUG] Payload base64-decoded: type=<class 'bytes'>, len=498, preview=b'!\x88\x15\x8a\xa6\xdfpt\xdc\xd9\x02\xd0\x92\xe3H\x84O\xcf\xec\x01\xf8Z+0\x925\x7f\xd4\x1d\xff\x176J\x01^\xf3\xc6\xd4V&`\x82SH\xfcO\x9c =R:t\xa9\xf8$q4\xff,\xca'
[Relay 2] [Relay] [DEBUG] AES-decrypted payload: type=<class 'bytes'>, len=482, preview=b'{"next_ip": "10.250.120.196", "next_port": 9103, "session_ke'
[Relay 2] [Relay] [DEBUG] AES-decrypted payload (hex): 7b226e6578745f6970223a202231302e3235302e3132302e313936222c20226e6578745f706f7274223a20393130332c202273657373696f6e5f6b65
[Relay 2] [Relay] [DEBUG] Next hop JSON keys: ['next_ip', 'next_port', 'session_key', 'payload']
[Relay 2] [Relay] [DEBUG] Forwarding to next relay 10.250.120.196:9103
[Relay 2] [Relay] [DEBUG] Received response from next relay: type=<class 'bytes'>, len=88, preview=b'l29OTBsX53AzZ++P35Ib686qAe0Qy0FIONV44sm+MM1d7eVEGjQr5JgwwrYN'
[Relay 2] [Relay] [RETURN] Base64-decoded response: type=<class 'bytes'>, len=66, preview=b'\x97oNL\x1b\x17\xe7p3g\xef\x8f\xdf\x92\x1b\xeb\xce\xaa\x01\xed\x10\xcbAH8\xd5x\xe2\xc9\xbe0\xcd]\xed\xe5D\x1a4+\xe4\x980\xc2\xb6\rK\xca\x0b\xaeQ\x8b\x83\xbb&\x84t\x0e6\xa0\x93'
[Relay 2] [Relay] [RETURN] AES-decrypted response: type=<class 'bytes'>, len=50, preview=b"\x94`U\xf7\xf5\xc6\x01\xd8\xb5\xff\xe9\x0e\x13$\xdby\x08s\x95'\x1a\xb2\x98H\xc9\x83-\xd3\xeaS\xd0\x16\xc6\xd6\xe6\xb8\xa9\xfd>67\xf0 \xec\t\x85\xf3:\xec\x1a"
[Relay 2] [Relay] [RETURN] AES-decrypted response not UTF-8: 'utf-8' codec can't decode byte 0x94 in position 0: invalid start byte
[Relay 2] [Relay] [RETURN] AES-encrypted response (hex): 263d9384811d0cc2448a775ed783a557a5da84fcf8db733c0ca9cc87288311ae02d1bc051770ac2dc6eaa5ced088f1f91ef29838f247c4aac465de7e
[Relay 2] [Relay] [RETURN] Base64-encoded AES-encrypted response: type=<class 'bytes'>, len=112, preview=b'Jj2ThIEdDMJEinde14OlV6XahPz423M8DKnMhyiDEa4C0bwFF3CsLcbqpc7Q'
[Relay 2] [Relay] [handle_message END] addr=('10.250.120.196', 60526), thread=6132690944
