[Relay] ---- Relay process started ----
[Relay 2] [Relay] Loaded persistent RSA keypair from relay2_key.pem
[Relay 2] [Relay] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] [KEY] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] Relay 2 starting on 10.250.120.196:9102 (RELAY PORT 9102)
[Relay 2] Registering with CDS at 127.0.0.1:9000
[Relay 2] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9102, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA58J3pSrOQd4hYnuzQQ7q\nWrjjo+3BJp+ik23brR2yl0kjtfH+wjD9LYWHS7dBxsDRzSozJ/7EWKKNCaTsgvaF\nN6vpyBPqDM/uQfOWfirteL50RgDZw95Vml4Fuay7bTBEb1J8ydvFqawo8rnLE2I3\nU4BjBT+CD38bY3je8wrrCX9fo1uYaLDlfteGshadZ2gnTxrAzkZZ/CTFdyb8JrmN\nIuxjBVjwSA/uIv+KHWQhXRA5jJPXcNV88LYXyEzpid1Cr9gnrqA88K0HSleiwZjU\nJF3LhBvS2Ga2HHfFsk5D/yz/pTHwDvRA98VMT/90wahwmSJsck4XWDFhmNhy3oDR\nBQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 2] [Relay] Listening for incoming messages on port 9102 (RELAY PORT 9102)
[Relay 2] [Relay] [handle_message ENTERED] addr=('10.250.120.196', 59681), thread=6164672512, relay_port=9102
[Relay 2] [Relay] [DEBUG] Raw data received: b'{"next_ip": "10.250.120.196", "next_port": 9102, "session_key": "PztxxF8uEcY/QcmnfJ0o+i19boVU4ktyBGvSsVkjNGC8TkRGPYdEtGXfCl/2GUC7RuGpjBym/qbs2YRQwp0aVpL8GIreHUoK77K5Gu+LBMNGJg9EyagpMZ5OkvQXAH8l3hrkjQLNH62NsQ9jOwqtqzFQkPEjjmjPYXtcdX7OvOey6etaoCurjPbGyjDfaq0lRgKxFvSe7jfHcrQqgROXV7woKlRDeMmtKtrAlr3SXOOPvQwj45k1sdgMoMCPWgUaR/JsZbzu3+Olvympyr77UPZK/WIVOT9dxiCvb2I1Ly3A29qr0DLR0HUOm9KEkAOJ4lDTMzMnvkTHsdOfGCuUjA==", "payload": "2M8Xp+c7O3k/GQM+nQqfXJjO4W7uls+gBjioPLJ1WTtg/JI4qwR7Q4tPAZbRJ/1IQ6m/R5q/x9Sz2gyPaUgaXOZMBagi9lqLinSWik7sqQ8ufHjzNOtAutI2kY3l37RAIVYS7+Y5TIb5LjPtEOkSgAX4v+QcCR2FLZbcRZp7hAw4hZaeFqUXw377rampM5X4IX7b7SiFDfHJlARmxy/KRTLnBYGBF2Qqyrq3H478JZ0p4F2bUyEIWckjY+OVGKmQUvlqK7AIjcxRCM4kfjpW1yplqT8IxcQGlkfDtL+n8kCKx8tTHMbYa/EihZm5iHfL1hBeCWDTpXg+G6XtP1mAPs+RgLoGYo81j5wvzL6/jdsAEu+zxwG3iwEVjbcMMxbSikeg6ZmdiTNdEJdqd+qLpe3Pe15hEfD4ANGCXsMX4P03MqWSdPdu5DHvxV6EejoHu1jxF2+aP1aP67bOG1Ph77ilHEAwXe37AXgzljX9grc+kceu7HklXUyKlCRv7V/x/8Vh16CP0pblWeVvyG6u3vnqJj/WU+f8O8VQGu0FFtMNEKV98Q1Bo1zG0rSSOQ2xFRJUPIql2P8ODHhD+XACp7L3R/fun0stTlhpIXbCRgcXxKxLaQCIYkVqiAmqYG+s9tuVvDHIec9SrzJQTZLIMXC2KwHv4fTjSsIukiWWw91pUTFF/Ymudiuth5pP2BDxnlPfDsX5qkBTEuc4iY2yGh1liaiRalr7duc4zY3XnNfkP5Q35DM7XZHH6mLH6IrMgc+PbrjmjfPJ82PuIPXqHwxMn4Ip11LQAkH/msVYQnSFAZOCe8FxM6FY0WcFV+CToZRzzmYDAxVlOkRRxOFUhVaWphKcZKcF+XyRtsIivuLQEaBmKZJ/OA2r0xNZ25dk8m83tyF9AMqBo+YQ3CkIBbtU/B1zzevsWHsmr9vt59WgJlWx+eB0L5I6T9QC5WkhztaXuxX//smdOZX0bAlO3sGZsN4WebrzI6+o6hOxjQ137QxXIM8dCkYKXGXEA3EAWDG8OmQgK7KplEq5S5pRoknc9zwNe4jiKWrO8eYfvZPKtAWpRGntiSzpJO+k0mIU1xUX5sVu4ikUl2pUBfXukf1S2VJRn+aeeARM9pzgTLDodKS/p6N4gmSgjyVFNeBf05qR9yjw++bSko3eD6BADHyLhS1RQPsrCEFdK3aoLeKRrl1dWQ/al7jALq5RjFx8XyswALNtKWWb3OBs1fs9aGTUIbU5NzVhJNNPND2PY515ssSn5JQUEnAB/U+CVA4CJO+49SMqLvWD3U1reKlZ3xZeV/lowxM7csbXEf2+EcrnFBZUl0rM8LeDHm0/6wxAVWMCdLPHRyMyS1mu2z82j7m9SPK14xdzuS6lqe74StVQQeap0DP0erIfBXt8vGploS9yOTGXyxBcxa7nu+zKUUZHoakbkKa3qhh1/ZhVhINT+USp12GdcgTRTU1kNQ=="}'
[Relay 2] [Relay] [DEBUG] Data after JSON parse: type=<class 'dict'>, keys=['next_ip', 'next_port', 'session_key', 'payload']
[Relay 2] [Relay] Received session_key (base64): PztxxF8uEcY/QcmnfJ0o+i19boVU4ktyBGvSsVkjNGC8TkRGPYdEtGXfCl/2GUC7RuGpjBym/qbs2YRQwp0aVpL8GIreHUoK77K5Gu+LBMNGJg9EyagpMZ5OkvQXAH8l3hrkjQLNH62NsQ9jOwqtqzFQkPEjjmjPYXtcdX7OvOey6etaoCurjPbGyjDfaq0lRgKxFvSe7jfHcrQqgROXV7woKlRDeMmtKtrAlr3SXOOPvQwj45k1sdgMoMCPWgUaR/JsZbzu3+Olvympyr77UPZK/WIVOT9dxiCvb2I1Ly3A29qr0DLR0HUOm9KEkAOJ4lDTMzMnvkTHsdOfGCuUjA==
[Relay 2] [Relay] Decoded session_key_enc (hex): 3f3b71c45f2e11c63f41c9a77c9d28fa2d7d6e8554e24b72046bd2b159233460bc4e44463d8744b465df0a5ff61940bb46e1a98c1ca6fea6ecd98450c29d1a5692fc188ade1d4a0aefb2b91aef8b04c346260f44c9a829319e4e92f417007f25de1ae48d02cd1fad8db10f633b0aadab315090f1238e68cf617b5c757ecebce7b2e9eb5aa02bab8cf6c6ca30df6aad254602b116f49eee37c772b42a81139757bc282a544378c9ad2adac096bdd25ce38fbd0c23e39935b1d80ca0c08f5a051a47f26c65bceedfe3a5bf29a9cabefb50f64afd6215393f5dc620af6f62352f2dc0dbdaabd032d1d0750e9bd284900389e250d3333327be44c7b1d39f182b948c
[Relay 2] [Relay] Decrypting session key with fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] Decrypted session_key (hex): d0093cf7318da51566ea2deba7a21a85ac698a02782ab9da19ddf3369772bc04
[Relay 2] [Relay] [DEBUG] About to AES-decrypt payload (passing base64 string directly)
[Relay 2] [Relay] [DEBUG] Payload base64-decoded: type=<class 'bytes'>, len=1102, preview=b"\xd8\xcf\x17\xa7\xe7;;y?\x19\x03>\x9d\n\x9f\\\x98\xce\xe1n\xee\x96\xcf\xa0\x068\xa8<\xb2uY;`\xfc\x928\xab\x04{C\x8bO\x01\x96\xd1'\xfdHC\xa9\xbfG\x9a\xbf\xc7\xd4\xb3\xda\x0c\x8f"
[Relay 2] [Relay] [DEBUG] AES-decrypted payload: type=<class 'bytes'>, len=1086, preview=b'{"next_ip": "10.250.120.196", "next_port": 9101, "session_ke'
[Relay 2] [Relay] [DEBUG] AES-decrypted payload (hex): 7b226e6578745f6970223a202231302e3235302e3132302e313936222c20226e6578745f706f7274223a20393130312c202273657373696f6e5f6b65
[Relay 2] [Relay] [DEBUG] AES-decrypted payload as UTF-8: '{"next_ip": "10.250.120.196", "next_port": 9101, "session_key": "F2h+dQT6g+s7X0stg70kPZZri6cdRl4emlrzJW0M77r3XAfyLaIKvWa'
[Relay 2] [Relay] [DEBUG] Inner payload is JSON, forwarding to next relay.
[Relay 2] [Relay] [DEBUG] Forwarding to next relay 10.250.120.196:9101
[Relay 2] [Relay] [DEBUG] Received response from next relay: type=<class 'bytes'>, len=636, preview=b'pLmebIyeWVKtM9qkrP43ldXfSn7wSFQNYv7vgBXposQOmTVANmN0smqyopjx'
[Relay 2] [Relay] [RETURN] AES-encrypted response (hex): 4fe2f6f69925130cd79464f6f2fc9b3ef0ad8d6215365469a96af863ca73806ebfeb67cf6f9237b15356d922e1142b8f4abe6a6e568b9ec168bc52fd
[Relay 2] [Relay] [RETURN] Base64-encoded AES-encrypted response: type=<class 'bytes'>, len=872, preview=b'T+L29pklEwzXlGT28vybPvCtjWIVNlRpqWr4Y8pzgG6/62fPb5I3sVNW2SLh'
[Relay 2] [Relay] [handle_message END] addr=('10.250.120.196', 59681), thread=6164672512
[Relay 2] [Relay] Deregistering from CDS and shutting down...
[Relay 2] [Relay] ERROR during deregistration: [Errno 54] Connection reset by peer
