[Relay] ---- Relay process started ----
[Relay 3] [Relay] Loaded persistent RSA keypair from relay3_key.pem
[Relay 3] [Relay] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] [Relay] [KEY] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] Relay 3 starting on 10.250.120.196:9103 (RELAY PORT 9103)
[Relay 3] Registering with CDS at 127.0.0.1:9000
[Relay 3] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9103, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5k9OJ8m3IdjmwR1skM1G\nwrKkwlYLK0Qs+I/BX5ww5wEakOsTy5NVFAwTYrCUnR012u2jCwI8wV1YpPaMa8RJ\ntnqNFy4pFfqBh5tmidHQ3QMRvINPrGtQM5+VgMXoA0y8izql52M1K/3Q6sHVlAXd\nmpQcBO+JSHY7uyVx1txZssyisia7Nn8Frh/XRpl0oUvGkSnbm/KgqDAP0xJ3lUZS\nEGiIWdf0bn7tHD3nYBMrWWi3jSQWf0Q80asIEYWipwkfMPf0ffzu4FX0elfvpyOX\nr50xk7sb8K5IhcilwxKxQpPOcq3f6ph0EERQR7pOdDqkzFdHoGiyssSX4MYM60kd\nmQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 3] [Relay] Listening for incoming messages on port 9103 (RELAY PORT 9103)
[Relay 3] [Relay] [handle_message ENTERED] addr=('10.250.120.196', 53164), thread=6195654656, relay_port=9103
[Relay 3] [Relay] [DEBUG] Raw data received: b'{"next_ip": "10.250.120.196", "next_port": 9103, "session_key": "BLk6Y5JxKM+SfPtvX2KNBlzvODErylksx2i/+8oI2MCGSTbr7RmlndQ5u9eO6nWfMXV7HmBnLb/aNLD5RsJRFZf45FZpqT1jtqWg0u8Rnb58gNPYm3I5AnBowtvV9mmQzy9T4ZFftvBJJSy4GnRXYKeGxK152XRmOhnMD2KLhCP9saHQht4IvzuxOZ4Y+QI/6SpyhReHiuGJywUT7jdblE58BubZXkSbvKT1OT5nB49wuAkJiBtZykao48OBS6yJ+z+1cqCSLmOg7kit+TLwm+DsoDsO6fkw13w1w7hZp5KgjWaXdwWivjG4Y7BS/aKz5ASE0qLTM+ndnr5zCWcgjw==", "payload": "9Na+Aba8rct2bY19LY3Pk4b39TYGUDNbm0fPwv4aK3DCjSbFfY3YkLhFLwrqssFl717eTwTWBf8AAsaFsQptd2PQXA3fSBm7S6oi3Uon2EGX0tQC0xtV+aDnxkcUNm7P+g/2xIYrFQECujp7LWDeu4UiTGLoHFioXM+yGCZZxNuMgAXaw3mShYe1nZCf7NLkdaQB/fseFcyjWXtEC0gEcmaWIE4Alt+vE4v4OSIMo44KrAUcI/8ZIHcuKIplznd1QUbeMu7/Y9ow672/u/FO70adUwWDWB9eSDa5ZURhf0BIqLpdp9k4O3HENSRgNpJMiLVSYgiYpl6eAprXy0LoksXE2QiOP5/XhPplYy/FmLwTInxe2pcmXq0WT9jyLpbBdbDW29O0mOUpkWGYhX1z+FTG2wggnOB4VJppwakBAwUiiUMxYvjMNj5UzYDDsVgB3RAynSKnqRkauGyfidDf38zY+PjAQrFuH1kPQBPYDAMo2FI6JiDAr9zBEec/0TdCqa7SMb21h5k9s/jWGW2rTzylFA487JpHsT/6gQMVgWrxQBARJDOczLPY2CLQcvZUcoaftjJZ8Z5bwQU/OrXSPWMfNLx1zphoSDm5SsvfIFIlkJ+xvJbnHaZdTyskYGWLAVWPFb0DNT1oB98giAxM8PQD"}'
[Relay 3] [Relay] [DEBUG] Data after JSON parse: type=<class 'dict'>, keys=['next_ip', 'next_port', 'session_key', 'payload']
[Relay 3] [Relay] Received session_key (base64): BLk6Y5JxKM+SfPtvX2KNBlzvODErylksx2i/+8oI2MCGSTbr7RmlndQ5u9eO6nWfMXV7HmBnLb/aNLD5RsJRFZf45FZpqT1jtqWg0u8Rnb58gNPYm3I5AnBowtvV9mmQzy9T4ZFftvBJJSy4GnRXYKeGxK152XRmOhnMD2KLhCP9saHQht4IvzuxOZ4Y+QI/6SpyhReHiuGJywUT7jdblE58BubZXkSbvKT1OT5nB49wuAkJiBtZykao48OBS6yJ+z+1cqCSLmOg7kit+TLwm+DsoDsO6fkw13w1w7hZp5KgjWaXdwWivjG4Y7BS/aKz5ASE0qLTM+ndnr5zCWcgjw==
[Relay 3] [Relay] Decoded session_key_enc (hex): 04b93a63927128cf927cfb6f5f628d065cef38312bca592cc768bffbca08d8c0864936ebed19a59dd439bbd78eea759f31757b1e60672dbfda34b0f946c2511597f8e45669a93d63b6a5a0d2ef119dbe7c80d3d89b7239027068c2dbd5f66990cf2f53e1915fb6f049252cb81a745760a786c4ad79d974663a19cc0f628b8423fdb1a1d086de08bf3bb1399e18f9023fe92a728517878ae189cb0513ee375b944e7c06e6d95e449bbca4f5393e67078f70b80909881b59ca46a8e3c3814bac89fb3fb572a0922e63a0ee48adf932f09be0eca03b0ee9f930d77c35c3b859a792a08d66977705a2be31b863b052fda2b3e40484d2a2d333e9dd9ebe730967208f
[Relay 3] [Relay] Decrypting session key with fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] [Relay] Decrypted session_key (hex): 8811f7aad5e46d9f68a2d4888525da39f35f4cb0e57807e0d6b807c4aa71ee37
[Relay 3] [Relay] [DEBUG] About to AES-decrypt payload (passing base64 string directly)
[Relay 3] [Relay] [DEBUG] Payload base64-decoded: type=<class 'bytes'>, len=498, preview=b'\xf4\xd6\xbe\x01\xb6\xbc\xad\xcbvm\x8d}-\x8d\xcf\x93\x86\xf7\xf56\x06P3[\x9bG\xcf\xc2\xfe\x1a+p\xc2\x8d&\xc5}\x8d\xd8\x90\xb8E/\n\xea\xb2\xc1e\xef^\xdeO\x04\xd6\x05\xff\x00\x02\xc6\x85'
[Relay 3] [Relay] [DEBUG] AES-decrypted payload: type=<class 'bytes'>, len=482, preview=b'{"next_ip": "10.250.120.196", "next_port": 9102, "session_ke'
[Relay 3] [Relay] [DEBUG] AES-decrypted payload (hex): 7b226e6578745f6970223a202231302e3235302e3132302e313936222c20226e6578745f706f7274223a20393130322c202273657373696f6e5f6b65
[Relay 3] [Relay] [DEBUG] Next hop JSON keys: ['next_ip', 'next_port', 'session_key', 'payload']
[Relay 3] [Relay] [DEBUG] Forwarding to next relay 10.250.120.196:9102
[Relay 3] [Relay] [DEBUG] Received response from next relay: type=<class 'bytes'>, len=88, preview=b'h+rFX+fgoF5Y1nBIT9fpC8JSEaXXqDYrNTdeCxTQxAfyoXiJ6MNVMBrzolLV'
[Relay 3] [Relay] [RETURN] Base64-decoded response: type=<class 'bytes'>, len=66, preview=b'\x87\xea\xc5_\xe7\xe0\xa0^X\xd6pHO\xd7\xe9\x0b\xc2R\x11\xa5\xd7\xa86+57^\x0b\x14\xd0\xc4\x07\xf2\xa1x\x89\xe8\xc3U0\x1a\xf3\xa2R\xd5\x87\xaf\xf0\xd9>\xe5_\xb0\x19\xa5\xcb\xff\xae5H'
[Relay 3] [Relay] [RETURN] AES-decrypted response: type=<class 'bytes'>, len=50, preview=b'GW\xc8T\x83GW\xf7N\xcaj\x80t\xee{-\t\x8e\xf2\x16\x959Z\xa4\xde[g\xd8\xd4T\xe7\xd4\xa5\xe6-\xc2\xf7\xd8\xa2XA{\xbeo\xd2\xdb\x8fah\x9f'
[Relay 3] [Relay] [RETURN] AES-decrypted response not UTF-8: 'utf-8' codec can't decode byte 0xc8 in position 2: invalid continuation byte
[Relay 3] [Relay] [RETURN] AES-encrypted response (hex): ecd4e275c7cce90005287daa25415bbf0a180f31ee8b04a0e5a259566ff52f27da48240fffd05aae897aaf0da403505c45a9be7323f4bd657f9e7648
[Relay 3] [Relay] [RETURN] Base64-encoded AES-encrypted response: type=<class 'bytes'>, len=112, preview=b'7NTidcfM6QAFKH2qJUFbvwoYDzHuiwSg5aJZVm/1LyfaSCQP/9Barol6rw2k'
[Relay 3] [Relay] [handle_message END] addr=('10.250.120.196', 53164), thread=6195654656
