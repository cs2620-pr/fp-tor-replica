[Relay] ---- Relay process started ----
[Relay 1] [Relay] Generated and saved new RSA keypair to relay1_key.pem
[Relay 1] [Relay] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] [KEY] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] Relay 1 starting on 10.250.120.196:9101 (RELAY PORT 9101)
[Relay 1] Registering with CDS at 127.0.0.1:9000
[Relay 1] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9101, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5MM7/HBECV26fZqjUJkt\nQ4+dx297cL0hf1+rf08Qir5tL/lArfQsiplTqcsIsZiN7vJ8K2XzvK5JAEv8tVE4\nEKU4W1hbEVBd1eLCX+Oc5XauTbWhW8xlc2wdNlNwDhin2Mw84doKJWPyfjtIwnIi\n3nWHqxLyAqkj6qDoByA8D7YVmJxvzwL0mrYE8G8b4Q4Wjnx2SXeTwc9LRzqwrsyb\nlM5B4BSVPBignOMhD2AfuIFw6uULQThbkL9L5AnQA08B4Gqzo731LLJN/Y6qo+VJ\nki2t6m1aJTG0LBjijpH7CtnN1MHIQ5UueS1sJVYZooYxkxEYYZTqIUXxuI5ICKPC\nCQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 1] [Relay] Listening for incoming messages on port 9101 (RELAY PORT 9101)
[Relay] ---- Relay process started ----
[Relay 2] [Relay] Generated and saved new RSA keypair to relay2_key.pem
[Relay 2] [Relay] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] [KEY] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] Relay 2 starting on 10.250.120.196:9102 (RELAY PORT 9102)
[Relay 2] Registering with CDS at 127.0.0.1:9000
[Relay 2] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9102, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA58J3pSrOQd4hYnuzQQ7q\nWrjjo+3BJp+ik23brR2yl0kjtfH+wjD9LYWHS7dBxsDRzSozJ/7EWKKNCaTsgvaF\nN6vpyBPqDM/uQfOWfirteL50RgDZw95Vml4Fuay7bTBEb1J8ydvFqawo8rnLE2I3\nU4BjBT+CD38bY3je8wrrCX9fo1uYaLDlfteGshadZ2gnTxrAzkZZ/CTFdyb8JrmN\nIuxjBVjwSA/uIv+KHWQhXRA5jJPXcNV88LYXyEzpid1Cr9gnrqA88K0HSleiwZjU\nJF3LhBvS2Ga2HHfFsk5D/yz/pTHwDvRA98VMT/90wahwmSJsck4XWDFhmNhy3oDR\nBQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 2] [Relay] Listening for incoming messages on port 9102 (RELAY PORT 9102)
[Relay] ---- Relay process started ----
[Relay 3] [Relay] Generated and saved new RSA keypair to relay3_key.pem
[Relay 3] [Relay] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] [Relay] [KEY] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] Relay 3 starting on 10.250.120.196:9103 (RELAY PORT 9103)
[Relay 3] Registering with CDS at 127.0.0.1:9000
[Relay 3] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9103, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5k9OJ8m3IdjmwR1skM1G\nwrKkwlYLK0Qs+I/BX5ww5wEakOsTy5NVFAwTYrCUnR012u2jCwI8wV1YpPaMa8RJ\ntnqNFy4pFfqBh5tmidHQ3QMRvINPrGtQM5+VgMXoA0y8izql52M1K/3Q6sHVlAXd\nmpQcBO+JSHY7uyVx1txZssyisia7Nn8Frh/XRpl0oUvGkSnbm/KgqDAP0xJ3lUZS\nEGiIWdf0bn7tHD3nYBMrWWi3jSQWf0Q80asIEYWipwkfMPf0ffzu4FX0elfvpyOX\nr50xk7sb8K5IhcilwxKxQpPOcq3f6ph0EERQR7pOdDqkzFdHoGiyssSX4MYM60kd\nmQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 3] [Relay] Listening for incoming messages on port 9103 (RELAY PORT 9103)
[Relay 1] [Relay] [handle_message ENTERED] addr=('10.250.120.196', 51063), thread=6125842432, relay_port=9101
[Relay 1] [Relay] [DEBUG] Raw data received: b'{"next_ip": "10.250.120.196", "next_port": 9101, "session_key": "dIJQZc9MYpat5f8TEs0pYu/b9WET6CiFEVct6P1Pu1QtUmXsq2kB0CWyutYTC4l/3nQ2apTygHf9n3lCjJ1+Gq7azrwra4rjQbn7+scUtK/Q80xeoDpVUJDI17dnmIAfbY59IKO6jCgZgDkTarSdYaKzM8WXgFMcCG8PlCbQNUPQQ9W8HbXQsu0JnhlEqC7mD44qDS5GZZ72XsN0lkH46mB+MYfFTF0YcCEBBdgVNwubeOXBbh2FtXDOLM0F3Bb8WtsAODN9B/UIDDUv+WzSVYTJfzbWxdFPDAs/oWMTX+dv2tzNSnalZtPtZna9v56x/1Us8u1EQz+YYMNfh5SbBQ==", "payload": "wPEFlPduBZupzCY9ZNGgWTHkYdX5CefdEV1fDBEb14caLPdG8o7NDc+oTZH2fZjIkqhnd+7YyI1XCxxIldE9KD/aETwV2xr/YED/41KcPkFbkNkfjwGF9AqXLPBFKzEJw9Ce7XB9/5XhfDf6EhlnK8Ar64AmRxD0mWomy18R1nS7e9WjwlGiZErPoE3Akig3+Wb5ETnesVMJ8ZLPAbVJpBGHawBgcClTzw29zvh+XHNKWQn/Ck1wPflRPsf6YnvuaE5wfwYDjIs78jgTasOy9WXBR4uxsAIREezyofgXx9BsEufWL9Fot83KbA17LsGtcSeXrG68gFIZosaYJwB7bLn51fgAFfDF9WaANkkq4S0UqUizNc79OYBtWys6jr0gkAE7d+f8U9laxmQPM3r4SxySObYuFuZwlFmwvjtuHsse9J+cPOunqyGaymKVNsONsD19QmhJh+Yi0UU++BPDyBggCFgODZixj1CHRaKuCRJa6K5GrvvseHx1W3oVY4Hn+37mEs+vsHOW304yYfemsVlRevOAiDBG3exqyjFMe0VL9ZvYa7dW/e39Saa9c+5QEWIMx+EmbVejEGf+Jx6buREjX8hOfFdYRdOXhlV2DAnAUR0GcRb9TsJweTWgf96CTQX/gem88tjmbQ1TwWhKV+UBM8sLlUXkklXG8xh6dxWS1L/Bj6Ni2NwSHpXGz25ndZEdru3M6hhZVs6az6y+RlaDHKELakQPbUHKW0yXDxDaM84FZtbD06rlMtE3CjZr3k2quIHRMpTUbS0XD7QyZECX3vgwidIQJIfpBBNvWZmDTxeDGFvjudWm0IM5q2bale+S0QRY/JQd4ulKC8G8e+5/rm9vzRksjGTMun/iAZfLQ1nx/pzWrF3T//fEtTEJG8rnRfvsPq63MiHzDtliu8I9LsEQNNXOPQ49yl9gg0UkNNeFShFDWwq15kBPxSJ03eX3uu5iP+GmFA36pkor9ENho/zalzNdwFxaV3NbTNtOsa5AMoeovIurT4YucKr+eh1Gc1l9Sfw4NCruvmM7vZsUSzHnFJ+S6HU1mS0JGNllRXJR/KZOdyMqd43aCxUk84Q8H7uvJLypbCzhJNLSOcspaKBCp7aEscge84CDRYyoyOjmjNXtHM7EQfIPruah1F/fKvv9Nda2A4hsO97nXIKH8+M+GJxdB6rt1Bga0dX/x3eDLbTcnQBpGGxz0QFZcf1ZLzwQYQAwWq54QP7A1w0U2HuO+egYNL0/cprMXUlTUG2f4UXY5t79wrGDDW+Wa2mmz9eA0Sj2S2YzqflKih90pDxxvM61vd+I6u7MR1jXW/yRwwNtan0AYQEVdqs3Fd47zyaC9YMOMirBOmlIba6hrD6kFJvgAE6P1quul5P0bASaX9jPo+pvzpEQ8BAZlm5//SdkJA+KsayxU2EnB9FDTqljhQD7gtA2pd6+g4AL9tza4zVndfYmr8ARZsLdM2s="}'
[Relay 1] [Relay] [DEBUG] Data before JSON parse: type=<class 'bytes'>, value=b'{"next_ip": "10.250.120.196", "next_port": 9101, "session_key": "dIJQZc9MYpat5f8TEs0pYu/b9WET6CiFEVct6P1Pu1QtUmXsq2kB0
[Relay 1] [Relay] [DEBUG] Data after JSON parse: type=<class 'dict'>, keys=['next_ip', 'next_port', 'session_key', 'payload']
[Relay 1] [Relay] Received session_key (base64): dIJQZc9MYpat5f8TEs0pYu/b9WET6CiFEVct6P1Pu1QtUmXsq2kB0CWyutYTC4l/3nQ2apTygHf9n3lCjJ1+Gq7azrwra4rjQbn7+scUtK/Q80xeoDpVUJDI17dnmIAfbY59IKO6jCgZgDkTarSdYaKzM8WXgFMcCG8PlCbQNUPQQ9W8HbXQsu0JnhlEqC7mD44qDS5GZZ72XsN0lkH46mB+MYfFTF0YcCEBBdgVNwubeOXBbh2FtXDOLM0F3Bb8WtsAODN9B/UIDDUv+WzSVYTJfzbWxdFPDAs/oWMTX+dv2tzNSnalZtPtZna9v56x/1Us8u1EQz+YYMNfh5SbBQ==
[Relay 1] [Relay] Decoded session_key_enc (hex): 74825065cf4c6296ade5ff1312cd2962efdbf56113e8288511572de8fd4fbb542d5265ecab6901d025b2bad6130b897fde74366a94f28077fd9f79428c9d7e1aaedacebc2b6b8ae341b9fbfac714b4afd0f34c5ea03a555090c8d7b76798801f6d8e7d20a3ba8c28198039136ab49d61a2b333c59780531c086f0f9426d03543d043d5bc1db5d0b2ed099e1944a82ee60f8e2a0d2e46659ef65ec3749641f8ea607e3187c54c5d1870210105d815370b9b78e5c16e1d85b570ce2ccd05dc16fc5adb0038337d07f5080c352ff96cd25584c97f36d6c5d14f0c0b3fa163135fe76fdadccd4a76a566d3ed6676bdbf9eb1ff552cf2ed44433f9860c35f87949b05
[Relay 1] [Relay] Decrypting session key with fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] Decrypted session_key (hex): 92beed5947e3fa2f5c40f0d9f415d98d5e4b928cc5f8759e6bad700c73fe94e9
[Relay 1] [Relay] Extracted session_key: <class 'str'>, len=344
[Relay 1] [Relay] [DEBUG] About to AES-decrypt payload (passing base64 string directly)
[Relay 1] [Relay] [DEBUG] Payload base64-decoded: type=<class 'bytes'>, len=1106, preview=b'\xc0\xf1\x05\x94\xf7n\x05\x9b\xa9\xcc&=d\xd1\xa0Y1\xe4a\xd
[Relay 1] [Relay] [DEBUG] AES-decrypted payload: type=<class 'bytes'>, len=1090, preview=b'{"next_ip": "10.250.120.196", "next_port": 9103, "session_
[Relay 1] [Relay] [Last Hop] Forwarding payload to dest 127.0.0.1:9100, len=1090, type=<class 'bytes'>
[Relay 1] [Relay] [Last Hop] Sending to dest: type=<class 'bytes'>, len=1090, preview=b'{"next_ip": "10.250.120.196", "next_port": 9103, "session_key": "AwwiVr8YdXY1+
[Relay 1] [Relay] [Last Hop] Received response from dest: type=<class 'bytes'>, len=1488, preview=b'eyJyZXN1bHQiOiAiT0siLCAiZWNobyI6IHsibmV4dF9pcCI6ICIxMC4yNTAu'
[Relay 1] [Relay] [Last Hop] Base64-encoded AES-encrypted response: type=<class 'bytes'>, len=2008, preview=b'U0jpxgtWxYjkkNyOolqihHXnv1J5yypD1cj4up/OwXUkljRaQIGbhgIXlVGt'
[Relay] ---- Relay process started ----
[Relay 1] [Relay] Loaded persistent RSA keypair from relay1_key.pem
[Relay 1] [Relay] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] [KEY] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] Relay 1 starting on 10.250.120.196:9101 (RELAY PORT 9101)
[Relay 1] Registering with CDS at 127.0.0.1:9000
[Relay 1] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9101, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5MM7/HBECV26fZqjUJkt\nQ4+dx297cL0hf1+rf08Qir5tL/lArfQsiplTqcsIsZiN7vJ8K2XzvK5JAEv8tVE4\nEKU4W1hbEVBd1eLCX+Oc5XauTbWhW8xlc2wdNlNwDhin2Mw84doKJWPyfjtIwnIi\n3nWHqxLyAqkj6qDoByA8D7YVmJxvzwL0mrYE8G8b4Q4Wjnx2SXeTwc9LRzqwrsyb\nlM5B4BSVPBignOMhD2AfuIFw6uULQThbkL9L5AnQA08B4Gqzo731LLJN/Y6qo+VJ\nki2t6m1aJTG0LBjijpH7CtnN1MHIQ5UueS1sJVYZooYxkxEYYZTqIUXxuI5ICKPC\nCQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 1] [Relay] Listening for incoming messages on port 9101 (RELAY PORT 9101)
[Relay] ---- Relay process started ----
[Relay 2] [Relay] Loaded persistent RSA keypair from relay2_key.pem
[Relay 2] [Relay] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] [KEY] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] Relay 2 starting on 10.250.120.196:9102 (RELAY PORT 9102)
[Relay 2] Registering with CDS at 127.0.0.1:9000
[Relay 2] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9102, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA58J3pSrOQd4hYnuzQQ7q\nWrjjo+3BJp+ik23brR2yl0kjtfH+wjD9LYWHS7dBxsDRzSozJ/7EWKKNCaTsgvaF\nN6vpyBPqDM/uQfOWfirteL50RgDZw95Vml4Fuay7bTBEb1J8ydvFqawo8rnLE2I3\nU4BjBT+CD38bY3je8wrrCX9fo1uYaLDlfteGshadZ2gnTxrAzkZZ/CTFdyb8JrmN\nIuxjBVjwSA/uIv+KHWQhXRA5jJPXcNV88LYXyEzpid1Cr9gnrqA88K0HSleiwZjU\nJF3LhBvS2Ga2HHfFsk5D/yz/pTHwDvRA98VMT/90wahwmSJsck4XWDFhmNhy3oDR\nBQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 2] [Relay] Listening for incoming messages on port 9102 (RELAY PORT 9102)
[Relay] ---- Relay process started ----
[Relay 3] [Relay] Loaded persistent RSA keypair from relay3_key.pem
[Relay 3] [Relay] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] [Relay] [KEY] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] Relay 3 starting on 10.250.120.196:9103 (RELAY PORT 9103)
[Relay 3] Registering with CDS at 127.0.0.1:9000
[Relay 3] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9103, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5k9OJ8m3IdjmwR1skM1G\nwrKkwlYLK0Qs+I/BX5ww5wEakOsTy5NVFAwTYrCUnR012u2jCwI8wV1YpPaMa8RJ\ntnqNFy4pFfqBh5tmidHQ3QMRvINPrGtQM5+VgMXoA0y8izql52M1K/3Q6sHVlAXd\nmpQcBO+JSHY7uyVx1txZssyisia7Nn8Frh/XRpl0oUvGkSnbm/KgqDAP0xJ3lUZS\nEGiIWdf0bn7tHD3nYBMrWWi3jSQWf0Q80asIEYWipwkfMPf0ffzu4FX0elfvpyOX\nr50xk7sb8K5IhcilwxKxQpPOcq3f6ph0EERQR7pOdDqkzFdHoGiyssSX4MYM60kd\nmQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 3] [Relay] Listening for incoming messages on port 9103 (RELAY PORT 9103)
[Relay 1] [Relay] [handle_message ENTERED] addr=('10.250.120.196', 52288), thread=6135623680, relay_port=9101
[Relay 1] [Relay] [DEBUG] Raw data received: b'{"next_ip": "10.250.120.196", "next_port": 9101, "session_key": "HN8/Ug3zfRW5zmDEC16Gx1wZ4TkBc4DwoYDn11hDu9I42nlAVEmm8cfyCLA5gO2xeIuDjQgmFCDT0jLcu1sJXJGQ8767s/jk5wJG94MZaJ7jGWX9Hb0elYh3NigJTxAuRLDpas4PYL6+1oTJW9RmYdb21c3xH7mkxWtjSc6lAkIIeZWU2eNd6J8R10cebsT0BTrpNe8xNQAhIAMlaZk2zv54sXGw1UyTE9JJU2ODSoBNlLT+33GB0IL7hbS2d6xNnfv98OGtgqs8dG3SlZhj2a2UuJjNu3vEMS1dZl2HS4+xZ1GRW5vEMuoNJc3jSEf7K3h35UZcwi3LRqB4kciyZA==", "payload": "hLc5w1AB/FiOOTkxXmw0O+xGb24upKZ9+LOlJPMTk1O513nMkuZugIsSWLxya8l6FFiI/E7sdgxUeYAUavmh4vdJBUP9al6ztF69dJKrAFYyHSWzh+V9uP/Ls4elqmQd8FFcMIyPwYm1SIFmakIpq6veEPr7++ULa4vVkax39p9nsXpTBkp6mdJ1qy7EhooGbNMQPv4vrYEYWjP/XLmm5c//BY+tpvFe3cPJPGwfMEGNCS0EdhpDzpOtDGGWd2E7ip300ooqoOC6Jyiqz4gNyAeM+cAQodynZ4hHXxezwZ/qM6JhpVDaLK5JHk58Cuh7942bqZ4v2gZ7LKxq8x+/kVR9CXU3PKX7Jb5BvGrdjQv+WK8ZhsH7xPYuUsITr7ml5ABxnQ94TD9w7KwCPlJpkvErL4OH7KEmLW/f4EvTfiGBDfEgl96WDjgB00OyeDetuFiQMuYA+XD0JSStvhSkzOuHTJdFjCRzPNNnmJ6aMKLFIibZbIjazyTUM8zKT4lfGGuKFguWuxwh6rFYixtUP+OJuFKg/WlA5VxVbAek1/pmyv1eep9E3PApX/gV8CWrMIn/j5D7Zh2Ngcu2WzFsS3xIW166UndYX2dJSRDLG3HeN05Kq+mRf7sKayU417Lfd6XBtI6jekVIGR8tv7+rw6YX55VQ8B826NwkqrvR+6WfzC3U4pIpitapkBlzgwPHcLYwAqJSiAEKDMcdEj8/3+j/zDJVbBSlQxxwPlIkFYT9wJv14jOVC3dceqCW2Rd0H3BtMxSfkodOZBKzWlv/GI6/CyknS0cCiz90+5SLKWSBbHT/+PMRLqJA08YfE3UjQcUg4dwykv0aa8/nvCP+UEYLNawYaoF/+1hvir6eZaIP6f/UeiSO+Cyx9XGGDlB9GMzm3imsP5MfdfbPIlbyC5iu+YfWg+Ved20j2sR+RXrEBSWylEJxgJO1Maq0DeMZntiUUGFbELPwK9Gd/YPMjCLGds726bTRjTKLyr6rb0ukMlJjB2WGkAJBqqLdx5l1o+VZX256IPMFjNLgoJJKzdMO1RUjk6i8A+zacijq1sMJh5BTVbskDdO9Ef1dh6JuT5W3ZTjv0amSJMSb1eACDzV9Xc3hpepjIYcP63pSmpZkcsrlrS/fiIc58eVPNCsW5r5xddIFY9065jhZzMvfk9h372uPzzvh1QNVG8QQWyDzhxjXNyItsaBRUIVL2U85wQfPUdckhebwHv6LfmSK5uweOQ1ZvvK/w//cj68+U9krO+MyDX/rJEHqKFJMHmFQIgCk74BRIAOMVPKbnFRAcqC4m3tgcvPdYZSS2NzHcxTMcF8dK1Po21ukPr1tsjOCSui2UlQKrXkcc/HmTI1vwN+TFqah4IoQkMh5BX2RS9fzHUmCdktq0uQ1q8ibm6QLZpksMQGM20Pp+gLAzMfMHvv3ePfres1egH+nRABIV3Wr9CC+N3QktvuHlXgC86UPyds="}'
[Relay 1] [Relay] [DEBUG] Data before JSON parse: type=<class 'bytes'>, value=b'{"next_ip": "10.250.120.196", "next_port": 9101, "session_key": "HN8/Ug3zfRW5zmDEC16Gx1wZ4TkBc4DwoYDn11hDu9I42nlAVEmm8
[Relay 1] [Relay] [DEBUG] Data after JSON parse: type=<class 'dict'>, keys=['next_ip', 'next_port', 'session_key', 'payload']
[Relay 1] [Relay] Received session_key (base64): HN8/Ug3zfRW5zmDEC16Gx1wZ4TkBc4DwoYDn11hDu9I42nlAVEmm8cfyCLA5gO2xeIuDjQgmFCDT0jLcu1sJXJGQ8767s/jk5wJG94MZaJ7jGWX9Hb0elYh3NigJTxAuRLDpas4PYL6+1oTJW9RmYdb21c3xH7mkxWtjSc6lAkIIeZWU2eNd6J8R10cebsT0BTrpNe8xNQAhIAMlaZk2zv54sXGw1UyTE9JJU2ODSoBNlLT+33GB0IL7hbS2d6xNnfv98OGtgqs8dG3SlZhj2a2UuJjNu3vEMS1dZl2HS4+xZ1GRW5vEMuoNJc3jSEf7K3h35UZcwi3LRqB4kciyZA==
[Relay 1] [Relay] Decoded session_key_enc (hex): 1cdf3f520df37d15b9ce60c40b5e86c75c19e139017380f0a180e7d75843bbd238da79405449a6f1c7f208b03980edb1788b838d08261420d3d232dcbb5b095c9190f3bebbb3f8e4e70246f78319689ee31965fd1dbd1e9588773628094f102e44b0e96ace0f60bebed684c95bd46661d6f6d5cdf11fb9a4c56b6349cea5024208799594d9e35de89f11d7471e6ec4f4053ae935ef31350021200325699936cefe78b171b0d54c9313d2495363834a804d94b4fedf7181d082fb85b4b677ac4d9dfbfdf0e1ad82ab3c746dd2959863d9ad94b898cdbb7bc4312d5d665d874b8fb16751915b9bc432ea0d25cde34847fb2b7877e5465cc22dcb46a07891c8b264
[Relay 1] [Relay] Decrypting session key with fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] Decrypted session_key (hex): d784ea74ec6d155408c29a94c667184b9037788d0cad987642cf9e12f353a78d
[Relay 1] [Relay] Extracted session_key: <class 'str'>, len=344
[Relay 1] [Relay] [DEBUG] About to AES-decrypt payload (passing base64 string directly)
[Relay 1] [Relay] [DEBUG] Payload base64-decoded: type=<class 'bytes'>, len=1106, preview=b'\x84\xb79\xc3P\x01\xfcX\x8e991^l4;\xecFon.\xa4\xa6}\xf8\xb
[Relay 1] [Relay] [DEBUG] AES-decrypted payload: type=<class 'bytes'>, len=1090, preview=b'{"next_ip": "10.250.120.196", "next_port": 9103, "session_
[Relay 1] [Relay] [Last Hop] Forwarding payload to dest 127.0.0.1:9100, len=1090, type=<class 'bytes'>
[Relay 1] [Relay] [Last Hop] Sending to dest: type=<class 'bytes'>, len=1090, preview=b'{"next_ip": "10.250.120.196", "next_port": 9103, "session_key": "dpkIeqhg6cKj9
[Relay 1] [Relay] [Last Hop] Received response from dest: type=<class 'bytes'>, len=1488, preview=b'eyJyZXN1bHQiOiAiT0siLCAiZWNobyI6IHsibmV4dF9pcCI6ICIxMC4yNTAu'
[Relay 1] [Relay] [Last Hop] Base64-encoded AES-encrypted response: type=<class 'bytes'>, len=2008, preview=b'K6txmVP//HUdST4w1brfc/g6ab2vjhRU4j5+ov9UiWnjhXqmBeicJxgLVVYc'
[Relay 1] [Relay] [Last Hop] Sent response to ('10.250.120.196', 52288): b'K6txmVP//HUdST4w1brfc/g6ab2vjhRU4j5+ov9UiWnjhXqmBeicJxgLVVYc'... (len=2008)
[Relay 1] [Relay] [handle_message END] addr=('10.250.120.196', 52288), thread=6135623680
[Relay] ---- Relay process started ----
[Relay 1] [Relay] Loaded persistent RSA keypair from relay1_key.pem
[Relay 1] [Relay] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] [KEY] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] Relay 1 starting on 10.250.120.196:9101 (RELAY PORT 9101)
[Relay 1] Registering with CDS at 127.0.0.1:9000
[Relay 1] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9101, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5MM7/HBECV26fZqjUJkt\nQ4+dx297cL0hf1+rf08Qir5tL/lArfQsiplTqcsIsZiN7vJ8K2XzvK5JAEv8tVE4\nEKU4W1hbEVBd1eLCX+Oc5XauTbWhW8xlc2wdNlNwDhin2Mw84doKJWPyfjtIwnIi\n3nWHqxLyAqkj6qDoByA8D7YVmJxvzwL0mrYE8G8b4Q4Wjnx2SXeTwc9LRzqwrsyb\nlM5B4BSVPBignOMhD2AfuIFw6uULQThbkL9L5AnQA08B4Gqzo731LLJN/Y6qo+VJ\nki2t6m1aJTG0LBjijpH7CtnN1MHIQ5UueS1sJVYZooYxkxEYYZTqIUXxuI5ICKPC\nCQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 1] [Relay] Listening for incoming messages on port 9101 (RELAY PORT 9101)
[Relay] ---- Relay process started ----
[Relay 2] [Relay] Loaded persistent RSA keypair from relay2_key.pem
[Relay 2] [Relay] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] [KEY] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] Relay 2 starting on 10.250.120.196:9102 (RELAY PORT 9102)
[Relay 2] Registering with CDS at 127.0.0.1:9000
[Relay 2] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9102, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA58J3pSrOQd4hYnuzQQ7q\nWrjjo+3BJp+ik23brR2yl0kjtfH+wjD9LYWHS7dBxsDRzSozJ/7EWKKNCaTsgvaF\nN6vpyBPqDM/uQfOWfirteL50RgDZw95Vml4Fuay7bTBEb1J8ydvFqawo8rnLE2I3\nU4BjBT+CD38bY3je8wrrCX9fo1uYaLDlfteGshadZ2gnTxrAzkZZ/CTFdyb8JrmN\nIuxjBVjwSA/uIv+KHWQhXRA5jJPXcNV88LYXyEzpid1Cr9gnrqA88K0HSleiwZjU\nJF3LhBvS2Ga2HHfFsk5D/yz/pTHwDvRA98VMT/90wahwmSJsck4XWDFhmNhy3oDR\nBQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 2] [Relay] Listening for incoming messages on port 9102 (RELAY PORT 9102)
[Relay] ---- Relay process started ----
[Relay 3] [Relay] Loaded persistent RSA keypair from relay3_key.pem
[Relay 3] [Relay] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] [Relay] [KEY] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] Relay 3 starting on 10.250.120.196:9103 (RELAY PORT 9103)
[Relay 3] Registering with CDS at 127.0.0.1:9000
[Relay 3] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9103, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5k9OJ8m3IdjmwR1skM1G\nwrKkwlYLK0Qs+I/BX5ww5wEakOsTy5NVFAwTYrCUnR012u2jCwI8wV1YpPaMa8RJ\ntnqNFy4pFfqBh5tmidHQ3QMRvINPrGtQM5+VgMXoA0y8izql52M1K/3Q6sHVlAXd\nmpQcBO+JSHY7uyVx1txZssyisia7Nn8Frh/XRpl0oUvGkSnbm/KgqDAP0xJ3lUZS\nEGiIWdf0bn7tHD3nYBMrWWi3jSQWf0Q80asIEYWipwkfMPf0ffzu4FX0elfvpyOX\nr50xk7sb8K5IhcilwxKxQpPOcq3f6ph0EERQR7pOdDqkzFdHoGiyssSX4MYM60kd\nmQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 3] [Relay] Listening for incoming messages on port 9103 (RELAY PORT 9103)
[Relay 1] [Relay] [handle_message ENTERED] addr=('10.250.120.196', 53089), thread=6156644352, relay_port=9101
[Relay 1] [Relay] [DEBUG] Raw data received: b'{"next_ip": "10.250.120.196", "next_port": 9101, "session_key": "fMgUBdeUO9c/GfKe8DSdyzpvHZWJEfQcAStX+0kqxHrKcj7D2NEPHh1KFDMIVcNoEtIbTfNrpThzodfZoWQ/vsZiDyirzducbklQxDhV5DO27pw/Q4urt7VftGuBx46OijWe8f7G3sAU80N/Zhw5OLZkhTp/TiRztyrsE2aDu5zoAIUgJpqPTJCZN7IRaSLplatspRviX8BuTjV0no3VbhXPCGa57KXMHt5oklJ59YP84hDZ1v1fCUt/l3vRzVeJa4vgjR88+xdvpEZj95p4riPRiYwTbrKU6knpJ5mO/vnSr9LIYGsSAMNE0TrwApBUpFsI9a5oJz3xhsu/E7we9g==", "payload": "bC5lYOSNcdRiMopSQ1/hlM0M8rdC0Usy83e3UzEZZjo/skT4y5RO8umrClPRXLy9O2pf8LrHXIgwTuOTdAygoQchCqWNjtAnJjj40fMaBRQ2tC7DYdsX9lomSy9s+cYVCf8CMigl7mod5iHXKPXSLriuJXZd+nOKSE4Y5J2aAIOUJAXescsWckv3iXRwP8sgl48KL0l48AnHoMRTCHQmjqj5U/2jv5xkwxii1QDeMWTKqKV5yrN/Z62Q94MezsEaCm3JXCPGMwJeOPuW+nRmD5Y1iPprKH/HG7puep+VBQx+o1Mc428IcKKmCB2CtNpWolY8zXXniCkRtiJzsfOOREUcPJPbd8fzoFWBBk39GPedzWDQA4ZVGzPnwHeeZD1KAEKDAFOpZex/BMmtLg7k1y10x1hLafNzQSsFRTH79Ajq7cAAXmi30SuY3ti++OfGZImpWCFVGekqxNgz6+0VaySFXN5l1OrKdVpbggvtB7Fs0xK/Nnf0yUK7VSYx+NGbqZNFrg1IE+yniSvd9pW2ySL1dEnqoBLGtJet5i5ZpUYjPcJ3Q109+pUloefvhyiTfCbvK/OSsgO0PH0kNTRdTh3JOd351BfvE8kE5+71wpbvvT6fbONeFeK9CASt/Hde1dgAKaydWV3eQhOSmgUXsezYhauZgtJ5uDsLni9Y3LmQVFAWoe20hwf4tYI8yXl2wwnTePAZLuv0RFyvU+Y8GYbAaQ/KtyUSW51PM1mMgJpuyeVjZ4pvd66ESFy1KgfTHAbVSTP2nVuZjNqvVtwrlLaObxcDa0+MTQCZdaHG+fk7l4JQTMvvc1DrvHvog6eotvAjpoESGBPeRXiRuS6IhlqCKFj10nzVu9/Q2SypA+AHRrVVucHBSJDw7Ng9Mbcr0cD9A45Hme6jKtMdF5CIs1a3OF1OmYU94CUtr/NwSVupWSyc9lzPzZ/uSdjkAIuQ8DfgHFjkPEeSRGGPFyYh+hjTOklwXfd7v9qEjlXwcm64AbRfbRcZl2cd57NCr5wpgnJP517vcbh2QkkKCrCulDToZfLi8tq9VYhs0OBhVg6GocXICP98n+J4Atb4f1srphi6jNts5EbGbUpm2HoHU+5jja9h3NSjxXszYk1Wb9uiPA7VynheNFHIYFjluCJPCNqKTn1edcK/plWYq7bFkcK5s9EzPb69EznlcSaXNwno5CXQJiotI85G8pq9z7Myrx2TrbLe1i17WJprYzgcxziaiac9801McGzlXM7EmYZe82FZnBLyD9sSA2ND0hCIFwzvroWryIA5AR8BoIEBhvv1NRaThgzgVKlQno1I7b3Q9n8x+j3AH/96vEBhbTC1eCbPqDnZ0kpobFGec1yxbsUfFvqUwOBSEN2AEzQUGC1rlD/fHzGkt+Z9snIO6T3Jk70Mu2/gbOSC8SJ2mxJ9Bvw7BUhuKQyjEzKz4lV6+fEJik/NRaC7moKQt6ZIRtauW3o="}'
[Relay 1] [Relay] [DEBUG] Data before JSON parse: type=<class 'bytes'>, value=b'{"next_ip": "10.250.120.196", "next_port": 9101, "session_key": "fMgUBdeUO9c/GfKe8DSdyzpvHZWJEfQcAStX+0kqxHrKcj7D2NEPH
[Relay 1] [Relay] [DEBUG] Data after JSON parse: type=<class 'dict'>, keys=['next_ip', 'next_port', 'session_key', 'payload']
[Relay 1] [Relay] Received session_key (base64): fMgUBdeUO9c/GfKe8DSdyzpvHZWJEfQcAStX+0kqxHrKcj7D2NEPHh1KFDMIVcNoEtIbTfNrpThzodfZoWQ/vsZiDyirzducbklQxDhV5DO27pw/Q4urt7VftGuBx46OijWe8f7G3sAU80N/Zhw5OLZkhTp/TiRztyrsE2aDu5zoAIUgJpqPTJCZN7IRaSLplatspRviX8BuTjV0no3VbhXPCGa57KXMHt5oklJ59YP84hDZ1v1fCUt/l3vRzVeJa4vgjR88+xdvpEZj95p4riPRiYwTbrKU6knpJ5mO/vnSr9LIYGsSAMNE0TrwApBUpFsI9a5oJz3xhsu/E7we9g==
[Relay 1] [Relay] Decoded session_key_enc (hex): 7cc81405d7943bd73f19f29ef0349dcb3a6f1d958911f41c012b57fb492ac47aca723ec3d8d10f1e1d4a14330855c36812d21b4df36ba53873a1d7d9a1643fbec6620f28abcddb9c6e4950c43855e433b6ee9c3f438babb7b55fb46b81c78e8e8a359ef1fec6dec014f3437f661c3938b664853a7f4e2473b72aec136683bb9ce8008520269a8f4c909937b2116922e995ab6ca51be25fc06e4e35749e8dd56e15cf0866b9eca5cc1ede68925279f583fce210d9d6fd5f094b7f977bd1cd57896b8be08d1f3cfb176fa44663f79a78ae23d1898c136eb294ea49e927998efef9d2afd2c8606b1200c344d13af0029054a45b08f5ae68273df186cbbf13bc1ef6
[Relay 1] [Relay] Decrypting session key with fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] Decrypted session_key (hex): 5d9d6e82204df340dfc7857b50dcc2dc0fe6b3e7ce5916c77ff828c6244395b8
[Relay 1] [Relay] Extracted session_key: <class 'str'>, len=344
[Relay 1] [Relay] [DEBUG] About to AES-decrypt payload (passing base64 string directly)
[Relay 1] [Relay] [DEBUG] Payload base64-decoded: type=<class 'bytes'>, len=1106, preview=b'l.e`\xe4\x8dq\xd4b2\x8aRC_\xe1\x94\xcd\x0c\xf2\xb7B\xd1K2\
[Relay 1] [Relay] [DEBUG] AES-decrypted payload: type=<class 'bytes'>, len=1090, preview=b'{"next_ip": "10.250.120.196", "next_port": 9102, "session_
[Relay 1] [Relay] [Last Hop] Forwarding payload to dest 127.0.0.1:9100, len=1090, type=<class 'bytes'>
[Relay 1] [Relay] [Last Hop] Sending to dest: type=<class 'bytes'>, len=1090, preview=b'{"next_ip": "10.250.120.196", "next_port": 9102, "session_key": "2s98yuK5d2pkY
[Relay 1] [Relay] [Last Hop] Received response from dest: type=<class 'bytes'>, len=1116, preview=b'{"result": "OK", "echo": {"next_ip": "10.250.120.196", "next'
[Relay 1] [Relay] [Last Hop] Base64-encoded AES-encrypted response: type=<class 'bytes'>, len=1512, preview=b'IUmwd94IVywjKpi8ucxRNB/usA2FDRyucYV+S6g6FNk6sJ5/XxykjtgbkLEe'
[Relay 1] [Relay] [Last Hop] Sent response to ('10.250.120.196', 53089): b'IUmwd94IVywjKpi8ucxRNB/usA2FDRyucYV+S6g6FNk6sJ5/XxykjtgbkLEe'... (len=1512)
[Relay 1] [Relay] [handle_message END] addr=('10.250.120.196', 53089), thread=6156644352
[Relay] ---- Relay process started ----
[Relay 1] [Relay] Loaded persistent RSA keypair from relay1_key.pem
[Relay 1] [Relay] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] [KEY] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] Relay 1 starting on 10.250.120.196:9101 (RELAY PORT 9101)
[Relay 1] Registering with CDS at 127.0.0.1:9000
[Relay 1] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9101, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5MM7/HBECV26fZqjUJkt\nQ4+dx297cL0hf1+rf08Qir5tL/lArfQsiplTqcsIsZiN7vJ8K2XzvK5JAEv8tVE4\nEKU4W1hbEVBd1eLCX+Oc5XauTbWhW8xlc2wdNlNwDhin2Mw84doKJWPyfjtIwnIi\n3nWHqxLyAqkj6qDoByA8D7YVmJxvzwL0mrYE8G8b4Q4Wjnx2SXeTwc9LRzqwrsyb\nlM5B4BSVPBignOMhD2AfuIFw6uULQThbkL9L5AnQA08B4Gqzo731LLJN/Y6qo+VJ\nki2t6m1aJTG0LBjijpH7CtnN1MHIQ5UueS1sJVYZooYxkxEYYZTqIUXxuI5ICKPC\nCQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 1] [Relay] Listening for incoming messages on port 9101 (RELAY PORT 9101)
[Relay] ---- Relay process started ----
[Relay 2] [Relay] Loaded persistent RSA keypair from relay2_key.pem
[Relay 2] [Relay] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] [KEY] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] Relay 2 starting on 10.250.120.196:9102 (RELAY PORT 9102)
[Relay 2] Registering with CDS at 127.0.0.1:9000
[Relay 2] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9102, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA58J3pSrOQd4hYnuzQQ7q\nWrjjo+3BJp+ik23brR2yl0kjtfH+wjD9LYWHS7dBxsDRzSozJ/7EWKKNCaTsgvaF\nN6vpyBPqDM/uQfOWfirteL50RgDZw95Vml4Fuay7bTBEb1J8ydvFqawo8rnLE2I3\nU4BjBT+CD38bY3je8wrrCX9fo1uYaLDlfteGshadZ2gnTxrAzkZZ/CTFdyb8JrmN\nIuxjBVjwSA/uIv+KHWQhXRA5jJPXcNV88LYXyEzpid1Cr9gnrqA88K0HSleiwZjU\nJF3LhBvS2Ga2HHfFsk5D/yz/pTHwDvRA98VMT/90wahwmSJsck4XWDFhmNhy3oDR\nBQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 2] [Relay] Listening for incoming messages on port 9102 (RELAY PORT 9102)
[Relay] ---- Relay process started ----
[Relay 3] [Relay] Loaded persistent RSA keypair from relay3_key.pem
[Relay 3] [Relay] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] [Relay] [KEY] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] Relay 3 starting on 10.250.120.196:9103 (RELAY PORT 9103)
[Relay 3] Registering with CDS at 127.0.0.1:9000
[Relay 3] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9103, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5k9OJ8m3IdjmwR1skM1G\nwrKkwlYLK0Qs+I/BX5ww5wEakOsTy5NVFAwTYrCUnR012u2jCwI8wV1YpPaMa8RJ\ntnqNFy4pFfqBh5tmidHQ3QMRvINPrGtQM5+VgMXoA0y8izql52M1K/3Q6sHVlAXd\nmpQcBO+JSHY7uyVx1txZssyisia7Nn8Frh/XRpl0oUvGkSnbm/KgqDAP0xJ3lUZS\nEGiIWdf0bn7tHD3nYBMrWWi3jSQWf0Q80asIEYWipwkfMPf0ffzu4FX0elfvpyOX\nr50xk7sb8K5IhcilwxKxQpPOcq3f6ph0EERQR7pOdDqkzFdHoGiyssSX4MYM60kd\nmQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 3] [Relay] Listening for incoming messages on port 9103 (RELAY PORT 9103)
[Relay 2] [Relay] [handle_message ENTERED] addr=('10.250.120.196', 53843), thread=6138097664, relay_port=9102
[Relay 2] [Relay] [DEBUG] Raw data received: b'{"next_ip": "10.250.120.196", "next_port": 9102, "session_key": "bwtobWFKHQglmeIqQ/rfbo02qV/Au7jdUnYS9hn+j7jFfVixubG3M+kcb2uKSetfOwo8WibewasueYlugs0JPRgYxzEbwLpTFw74GeI8wxMzXp938NazNcZGwJCzHdjwYYfk11kOIIdJHUSdYlPqw0OldZEvxagSNOfeAEntNPuZywCUR7G4SR838RUCh4eTEGVRgVAWcnoiIa1M2nyfiAiaou4YD5Ydl6C807eqGigYY+qVg9S4W06UG1jRDIB06fWsqvlp1kD1d3vyc2fkM5mkTzIVa1G3543t1o9DYvNF4CMDqpf+e/kjznjKGlFj6Zf3NVSG7ucSQm/KyLwhdg==", "payload": "l9AQtVY1wEHvU2129z14/eLlmHb5DG8nT7xqTK4RRKzDfzallyrrjSlzScEMq302ivCENGeCDJ9AAsOQ6GZGeYVzh4IC/g9eYYXnQqEukjIrI95BFfv4WsDK0tG3ZhESeItygVRP/s++azQSFEnQx/QGww/i8d/LWwhjRedQCvio+Uzpo3/B+aH9wN8As8hls46zKct26tn6JoyekhvI0FU2LKYmoo8VhA9AeZElRFVmvZcI+OVYV+XKG5SmigFCD3mvwzSn5UMs3E/3cLgeTMcLdVNbkPILcz9nCDwQAo5F3TodpqJrKgKFZAZhtySw/iS1d9Q2/vbFY8cVOfncmxLT3OIAUbrVeLc+avUQol9bcHFYyq+a9QSGQwAfzBYsvlgfymUn5iT9LU0mu8eO5Dhxgp32xlGOOANlrBgH1luAoFR1lC2lgD5shvzuThgcsDMFm/56czak+1vLUku/K1cdF/wvaeBhGdN0LHkkv8/a2MoQIHOH/E41QBhYJ5GQKrRmK1C/3cCztgntuJAuKD0hRXhHBcCx6A+qfROu5X96eFW2yldQMX0npOPl1EIBczNvr/Zda3bJ7uu+VFoFHNfn9Sem+2nMGu8UGbA8W5wDqJ7Dmqvdup8Tr/unqDsMDEJYHhM6XwDMEo1XAJof2bn1n5RlV1nhBWthg90RmW8eg0QqDZNAjwMWBAHIxd3Vf03Trw4O+pLCx+AeoYCkB4Ncw2c7a9Lyq3P7kMmFcVPrzeP0eytmz/HBspPIo6oXcBb5Jc9sdtK93qcAcz+x+DISAzF9cHRLfr8+3d7xZxMB9e2/hYlfFpnm2EPI3z4lLrq6o273s2nS5ZksVYf7JSMFhBV+4FRA0us4DUPFY3QanaOrnMT8GSyoOrWMlKKuVtlM8QgLB2ef6b+UPboLqlbDPJPo4w0fwwyL2EoL2WyCqHCWxuF73j7lMFLckRgkD8YGJx85IBtt/3BOJefjrZpU3+vEuQ95PrK+ihLOBIp7xpICudm4vrZixnm/TTn1cOJSwYIufzw0AwgHvhIJ4uvFt2GiIkASzkyNGf5yt4DuQwUIdlxzMtCODs+Q8ijuwSs54u8N0B5T+oo1oKs5Y1bYA9+V1N7whF0sqzL0yMae0qhI96RppADq8MAQvDHRnf4ETfVg/4WPUtDagvhz8AVPTEiMq0udMYAmj1pVn0JU7GOXImM08eabI/pouSHrnYdr78OuT7k/GyoQjvAJFSkKw6tN41MwNAx8G0imGO2OAcikEql6oMnH6nIi7beuC9ZQHv5uqQN4ych+doIN2ah3v2fcamHkpdcQ54ODUKrCoRL6Sq1UdgNeJcrbq4sGXBqFzarSbvgWeAbadc5ITkKeIn1Tm/24aXC3FbwKNwxhADgI/Jk+RtqIMbkbQ5fiuQalqW89PPMSr6xSqXXUqnvYDTKjwiWDDO0k0YdksIH2WvAuOmJZUbMhSuSpXTm+lHY="}'
[Relay 2] [Relay] [DEBUG] Data before JSON parse: type=<class 'bytes'>, value=b'{"next_ip": "10.250.120.196", "next_port": 9102, "session_key": "bwtobWFKHQglmeIqQ/rfbo02qV/Au7jdUnYS9hn+j7jFfVixubG3M
[Relay 2] [Relay] [DEBUG] Data after JSON parse: type=<class 'dict'>, keys=['next_ip', 'next_port', 'session_key', 'payload']
[Relay 2] [Relay] Received session_key (base64): bwtobWFKHQglmeIqQ/rfbo02qV/Au7jdUnYS9hn+j7jFfVixubG3M+kcb2uKSetfOwo8WibewasueYlugs0JPRgYxzEbwLpTFw74GeI8wxMzXp938NazNcZGwJCzHdjwYYfk11kOIIdJHUSdYlPqw0OldZEvxagSNOfeAEntNPuZywCUR7G4SR838RUCh4eTEGVRgVAWcnoiIa1M2nyfiAiaou4YD5Ydl6C807eqGigYY+qVg9S4W06UG1jRDIB06fWsqvlp1kD1d3vyc2fkM5mkTzIVa1G3543t1o9DYvNF4CMDqpf+e/kjznjKGlFj6Zf3NVSG7ucSQm/KyLwhdg==
[Relay 2] [Relay] Decoded session_key_enc (hex): 6f0b686d614a1d082599e22a43fadf6e8d36a95fc0bbb8dd527612f619fe8fb8c57d58b1b9b1b733e91c6f6b8a49eb5f3b0a3c5a26dec1ab2e79896e82cd093d1818c7311bc0ba53170ef819e23cc313335e9f77f0d6b335c646c090b31dd8f06187e4d7590e2087491d449d6253eac343a575912fc5a81234e7de0049ed34fb99cb009447b1b8491f37f11502878793106551815016727a2221ad4cda7c9f88089aa2ee180f961d97a0bcd3b7aa1a281863ea9583d4b85b4e941b58d10c8074e9f5acaaf969d640f5777bf27367e43399a44f32156b51b7e78dedd68f4362f345e02303aa97fe7bf923ce78ca1a5163e997f7355486eee712426fcac8bc2176
[Relay 2] [Relay] Decrypting session key with fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] Decrypted session_key (hex): 91f6f32438fd5998c17a4df431be37ea4e7ee304f6e9fa68ba1b7faa5ba05a86
[Relay 2] [Relay] Extracted session_key: <class 'str'>, len=344
[Relay 2] [Relay] [DEBUG] About to AES-decrypt payload (passing base64 string directly)
[Relay 2] [Relay] [DEBUG] Payload base64-decoded: type=<class 'bytes'>, len=1106, preview=b'\x97\xd0\x10\xb5V5\xc0A\xefSmv\xf7=x\xfd\xe2\xe5\x98v\xf9\
[Relay 2] [Relay] [DEBUG] AES-decrypted payload: type=<class 'bytes'>, len=1090, preview=b'{"next_ip": "10.250.120.196", "next_port": 9101, "session_
[Relay 2] [Relay] [Last Hop] Forwarding payload to dest 127.0.0.1:9100, len=1090, type=<class 'bytes'>
[Relay 2] [Relay] [Last Hop] Sending to dest: type=<class 'bytes'>, len=1090, preview=b'{"next_ip": "10.250.120.196", "next_port": 9101, "session_key": "sgUuEgLWQUZ1U
[Relay 2] [Relay] [Last Hop] Received response from dest: type=<class 'bytes'>, len=1116, preview=b'{"result": "OK", "echo": {"next_ip": "10.250.120.196", "next'
[Relay 2] [Relay] [Last Hop] Base64-encoded AES-encrypted response: type=<class 'bytes'>, len=1512, preview=b'fcuO3SX4HMEHIZsHuOq1vBlg+EyXbeE850OSMOlxxAx3ELMaGQNfKEvM1PAC'
[Relay 2] [Relay] [Last Hop] Sent response to ('10.250.120.196', 53843): b'fcuO3SX4HMEHIZsHuOq1vBlg+EyXbeE850OSMOlxxAx3ELMaGQNfKEvM1PAC'... (len=1512)
[Relay 2] [Relay] [handle_message END] addr=('10.250.120.196', 53843), thread=6138097664
[Relay] ---- Relay process started ----
[Relay 1] [Relay] Loaded persistent RSA keypair from relay1_key.pem
[Relay 1] [Relay] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] [KEY] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] Relay 1 starting on 10.250.120.196:9101 (RELAY PORT 9101)
[Relay 1] Registering with CDS at 127.0.0.1:9000
[Relay 1] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9101, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5MM7/HBECV26fZqjUJkt\nQ4+dx297cL0hf1+rf08Qir5tL/lArfQsiplTqcsIsZiN7vJ8K2XzvK5JAEv8tVE4\nEKU4W1hbEVBd1eLCX+Oc5XauTbWhW8xlc2wdNlNwDhin2Mw84doKJWPyfjtIwnIi\n3nWHqxLyAqkj6qDoByA8D7YVmJxvzwL0mrYE8G8b4Q4Wjnx2SXeTwc9LRzqwrsyb\nlM5B4BSVPBignOMhD2AfuIFw6uULQThbkL9L5AnQA08B4Gqzo731LLJN/Y6qo+VJ\nki2t6m1aJTG0LBjijpH7CtnN1MHIQ5UueS1sJVYZooYxkxEYYZTqIUXxuI5ICKPC\nCQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 1] [Relay] Listening for incoming messages on port 9101 (RELAY PORT 9101)
[Relay] ---- Relay process started ----
[Relay 2] [Relay] Loaded persistent RSA keypair from relay2_key.pem
[Relay 2] [Relay] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] [KEY] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] Relay 2 starting on 10.250.120.196:9102 (RELAY PORT 9102)
[Relay 2] Registering with CDS at 127.0.0.1:9000
[Relay 2] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9102, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA58J3pSrOQd4hYnuzQQ7q\nWrjjo+3BJp+ik23brR2yl0kjtfH+wjD9LYWHS7dBxsDRzSozJ/7EWKKNCaTsgvaF\nN6vpyBPqDM/uQfOWfirteL50RgDZw95Vml4Fuay7bTBEb1J8ydvFqawo8rnLE2I3\nU4BjBT+CD38bY3je8wrrCX9fo1uYaLDlfteGshadZ2gnTxrAzkZZ/CTFdyb8JrmN\nIuxjBVjwSA/uIv+KHWQhXRA5jJPXcNV88LYXyEzpid1Cr9gnrqA88K0HSleiwZjU\nJF3LhBvS2Ga2HHfFsk5D/yz/pTHwDvRA98VMT/90wahwmSJsck4XWDFhmNhy3oDR\nBQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 2] [Relay] Listening for incoming messages on port 9102 (RELAY PORT 9102)
[Relay] ---- Relay process started ----
[Relay 3] [Relay] Loaded persistent RSA keypair from relay3_key.pem
[Relay 3] [Relay] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] [Relay] [KEY] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] Relay 3 starting on 10.250.120.196:9103 (RELAY PORT 9103)
[Relay 3] Registering with CDS at 127.0.0.1:9000
[Relay 3] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9103, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5k9OJ8m3IdjmwR1skM1G\nwrKkwlYLK0Qs+I/BX5ww5wEakOsTy5NVFAwTYrCUnR012u2jCwI8wV1YpPaMa8RJ\ntnqNFy4pFfqBh5tmidHQ3QMRvINPrGtQM5+VgMXoA0y8izql52M1K/3Q6sHVlAXd\nmpQcBO+JSHY7uyVx1txZssyisia7Nn8Frh/XRpl0oUvGkSnbm/KgqDAP0xJ3lUZS\nEGiIWdf0bn7tHD3nYBMrWWi3jSQWf0Q80asIEYWipwkfMPf0ffzu4FX0elfvpyOX\nr50xk7sb8K5IhcilwxKxQpPOcq3f6ph0EERQR7pOdDqkzFdHoGiyssSX4MYM60kd\nmQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 3] [Relay] Listening for incoming messages on port 9103 (RELAY PORT 9103)
[Relay 2] [Relay] [handle_message ENTERED] addr=('10.250.120.196', 55698), thread=6195392512, relay_port=9102
[Relay 2] [Relay] [DEBUG] Raw data received: b'{"next_ip": "10.250.120.196", "next_port": 9102, "session_key": "28cUIhIaKp9iAPoyI7yW00yGiXAszGSq+LOatlp0ut+VQtOcnS7Fb8X3EZ72j+2A/NQEygyfVSxY7aKkFZlYisu843P6LnGZ7acz0vF6/SSDzpXidEQW9or3NccWm2ZmLQS4I09DB3eNMLXETPXDFri4HYhixhOHDChWDLTpeu4gEPGN51O6Z3uMJLUlqTf/lvoZMTF4ZjXiBdP8w7cBZks5UV53cFrUahcM4oa+GxUE1CWBkYYicGEVsQN0FMMiCYzY8LBBVjgtCr/2qzTQuLFZU5PFzKzJCH1kkjbI9a6cc/2bNi2s4cuK0shPCC8PIF4KAjaCl1lI2KD/YLD4Uw==", "payload": "MKCzmSEemGuxJ7oVYBvzZwvKci3K+kA7n/6C3Yq9G20GhqQib5wa8VZOAHIglxjGVvgTv9TxNsSEE9QZhwWA7vY1vA56tJW1FS4UWrIZ7W0WV8Ck25pKmDmWDRgxxs7mgJ0CMB6C0O/WmodNIhCCbz4ZLPNSjh6tfpHuKdh3z5Ga8ieqwlU0V303lqhwMX7gy12yKjnGBd/t4AOJz/3cCO2NFeR/DSLVIqK0bS2NNK5fLxC30uW3eS4OxAxOcdGYVoU0OARkDp517E+ZRnAkyv+5vHtrk1boWWWHKQ664rAlbYEXoihQKGwFFi11ZorOCo3JQEj8cp67i19SgqFqkYtdIaNxKvF9NXWJYml8MpHKXS8gD54xDHaI8+jSsijG5zk1iQPv0DWdm/u34TTWDDt/ukYq4MItJlkcTeWdhgXyBZtrTeb/PXmkdeg/Llv9+IKUWh9n6CFKrqCFS9l7/xmq/PkVEYOfgqLjfeUEINhMQg4VRcfi8JDp+elXdhWAXg8XB4zC6sYNYsvQzQk7kLtWuOlEkhH80/37n8smqkn8lxGVxHk/UZyWwuPKealbN1XzQJtswyzMbwfn4+JhOLUWlD6V6b9vPGLHBpvutUeaA7VgxqGeIzY9wCZ2qVCSMJZ9S4Kni2GRhWW27bz+dG5MAe7tuhYc98ehFEFGEjmsfGzEzs8o17EZl1wa00lr9YAty4iVdvUQy+aYzUj6E2ejWMuNdXcYCh5cGfwyW6xmKWZ6Mvxyx7p/T2XBxQsllVYHqgd8E/zd7umqUzHms0wZDCwWai8WaRBFlnXs/Vhymef7Fo1Jk0yixK3KSPc1e5swSz8y126q2+mBw7QkjpHUM78FOVB+LQr1LPiKqsVGLa65qxmgjhiKnJnfo7PHQOqX5BdIOXLWkemTzxN65xHM8m3LWV3oxziL6OXNdLasTYGZ+oUhbAsDbF6FJxX1QPkR+VS9HVPePrB+gAUXYwz47eyHckIllsfEAzMvU7nqi5C1ko/oN4kzY8yreWUpLgjC170f4v4h0DEQVVo51umT4h1y7W7DgCFYs6S9ITBjDM+yHO31/zM54X+6J1Q7TPmRJdeiEk3ptr+BhIDbjfgXIVAycDllP6BRFzsfaDQ+szet8Fw4ui1IsxljW5YbqcpmTA+EDPttB7ejqjZ7Sf2WRP4UZO8kxh+pRH1GHLHMSfBBoh1yjhqU/r+sS4CR4U5v5gJcLnKHnPGffBun3OwyNMrLAbu+I2liiXe/Li/zZoOdPA0Yynl6MxxdSYJ1jn1A+vQZMWQIboEyge0CM4Nu0UJb/+ZuVegVA69qJ4biDifZhpFGWQGkiNyiPGVDKpKtfODaKudXF3uyCd6ISqJh446Q6yOh/GA4mCtn3l/CRRPoD6I/ANA1sl8sVTUu1faj0uwW7qGs/No3Y9bc5UGAxTkqOkzKGtRZwh4OcPpMXqUyoLHzsdEGEa54vBGRyig="}'
[Relay 2] [Relay] [DEBUG] Data before JSON parse: type=<class 'bytes'>, value=b'{"next_ip": "10.250.120.196", "next_port": 9102, "session_key": "28cUIhIaKp9iAPoyI7yW00yGiXAszGSq+LOatlp0ut+VQtOcnS7Fb
[Relay 2] [Relay] [DEBUG] Data after JSON parse: type=<class 'dict'>, keys=['next_ip', 'next_port', 'session_key', 'payload']
[Relay 2] [Relay] Received session_key (base64): 28cUIhIaKp9iAPoyI7yW00yGiXAszGSq+LOatlp0ut+VQtOcnS7Fb8X3EZ72j+2A/NQEygyfVSxY7aKkFZlYisu843P6LnGZ7acz0vF6/SSDzpXidEQW9or3NccWm2ZmLQS4I09DB3eNMLXETPXDFri4HYhixhOHDChWDLTpeu4gEPGN51O6Z3uMJLUlqTf/lvoZMTF4ZjXiBdP8w7cBZks5UV53cFrUahcM4oa+GxUE1CWBkYYicGEVsQN0FMMiCYzY8LBBVjgtCr/2qzTQuLFZU5PFzKzJCH1kkjbI9a6cc/2bNi2s4cuK0shPCC8PIF4KAjaCl1lI2KD/YLD4Uw==
[Relay 2] [Relay] Decoded session_key_enc (hex): dbc71422121a2a9f6200fa3223bc96d34c8689702ccc64aaf8b39ab65a74badf9542d39c9d2ec56fc5f7119ef68fed80fcd404ca0c9f552c58eda2a41599588acbbce373fa2e7199eda733d2f17afd2483ce95e2744416f68af735c7169b66662d04b8234f4307778d30b5c44cf5c316b8b81d8862c613870c28560cb4e97aee2010f18de753ba677b8c24b525a937ff96fa193131786635e205d3fcc3b701664b39515e77705ad46a170ce286be1b1504d42581918622706115b1037414c322098cd8f0b04156382d0abff6ab34d0b8b1595393c5ccacc9087d649236c8f5ae9c73fd9b362dace1cb8ad2c84f082f0f205e0a023682975948d8a0ff60b0f853
[Relay 2] [Relay] Decrypting session key with fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] Decrypted session_key (hex): 03bf2b9802e4939d703101980c690bc44868403603f3a2c19028e823c7172807
[Relay 2] [Relay] Extracted session_key: <class 'str'>, len=344
[Relay 2] [Relay] [DEBUG] About to AES-decrypt payload (passing base64 string directly)
[Relay 2] [Relay] [DEBUG] Payload base64-decoded: type=<class 'bytes'>, len=1106, preview=b'0\xa0\xb3\x99!\x1e\x98k\xb1\'\xba\x15`\x1b\xf3g\x0b\xcar-\
[Relay 2] [Relay] [DEBUG] AES-decrypted payload: type=<class 'bytes'>, len=1090, preview=b'{"next_ip": "10.250.120.196", "next_port": 9103, "session_
[Relay 2] [Relay] [Last Hop] Forwarding payload to dest 127.0.0.1:9100, len=1090, type=<class 'bytes'>
[Relay 2] [Relay] [Last Hop] Sending to dest: type=<class 'bytes'>, len=1090, preview=b'{"next_ip": "10.250.120.196", "next_port": 9103, "session_key": "TlUQ6cU5Zd/Yx
[Relay 2] [Relay] [Last Hop] Received response from dest: type=<class 'bytes'>, len=1116, preview=b'{"result": "OK", "echo": {"next_ip": "10.250.120.196", "next'
[Relay 2] [Relay] [Last Hop] Response from dest decoded as UTF-8: '{"result": "OK", "echo": {"next_ip": "10.250.120.196", "next_port": 9103, "session_key": "TlUQ6cU5Zd/YxxZ453OwVrVxMM4+V0'
[Relay 2] [Relay] [Last Hop] Response from dest (hex): 7b22726573756c74223a20224f4b222c20226563686f223a207b226e6578745f6970223a202231302e3235302e3132302e313936222c20226e657874
[Relay 2] [Relay] [Last Hop] About to AES-encrypt response: type=<class 'bytes'>, len=1116, preview=b'{"result": "OK", "echo": {"next_ip": "10.250.120.196", "next'
[Relay 2] [Relay] [Last Hop] Base64-encoded AES-encrypted response: type=<class 'bytes'>, len=1512, preview=b'm0IbctLMzzKQTV0wIs4HGIluFdveM8HaHrDk0uBxb4wpdhUlI9jeAUqkdqES'
[Relay] ---- Relay process started ----
[Relay 1] [Relay] Loaded persistent RSA keypair from relay1_key.pem
[Relay 1] [Relay] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] [KEY] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] Relay 1 starting on 10.250.120.196:9101 (RELAY PORT 9101)
[Relay 1] Registering with CDS at 127.0.0.1:9000
[Relay 1] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9101, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5MM7/HBECV26fZqjUJkt\nQ4+dx297cL0hf1+rf08Qir5tL/lArfQsiplTqcsIsZiN7vJ8K2XzvK5JAEv8tVE4\nEKU4W1hbEVBd1eLCX+Oc5XauTbWhW8xlc2wdNlNwDhin2Mw84doKJWPyfjtIwnIi\n3nWHqxLyAqkj6qDoByA8D7YVmJxvzwL0mrYE8G8b4Q4Wjnx2SXeTwc9LRzqwrsyb\nlM5B4BSVPBignOMhD2AfuIFw6uULQThbkL9L5AnQA08B4Gqzo731LLJN/Y6qo+VJ\nki2t6m1aJTG0LBjijpH7CtnN1MHIQ5UueS1sJVYZooYxkxEYYZTqIUXxuI5ICKPC\nCQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 1] [Relay] Listening for incoming messages on port 9101 (RELAY PORT 9101)
[Relay] ---- Relay process started ----
[Relay 2] [Relay] Loaded persistent RSA keypair from relay2_key.pem
[Relay 2] [Relay] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] [KEY] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] Relay 2 starting on 10.250.120.196:9102 (RELAY PORT 9102)
[Relay 2] Registering with CDS at 127.0.0.1:9000
[Relay 2] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9102, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA58J3pSrOQd4hYnuzQQ7q\nWrjjo+3BJp+ik23brR2yl0kjtfH+wjD9LYWHS7dBxsDRzSozJ/7EWKKNCaTsgvaF\nN6vpyBPqDM/uQfOWfirteL50RgDZw95Vml4Fuay7bTBEb1J8ydvFqawo8rnLE2I3\nU4BjBT+CD38bY3je8wrrCX9fo1uYaLDlfteGshadZ2gnTxrAzkZZ/CTFdyb8JrmN\nIuxjBVjwSA/uIv+KHWQhXRA5jJPXcNV88LYXyEzpid1Cr9gnrqA88K0HSleiwZjU\nJF3LhBvS2Ga2HHfFsk5D/yz/pTHwDvRA98VMT/90wahwmSJsck4XWDFhmNhy3oDR\nBQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 2] [Relay] Listening for incoming messages on port 9102 (RELAY PORT 9102)
[Relay] ---- Relay process started ----
[Relay 3] [Relay] Loaded persistent RSA keypair from relay3_key.pem
[Relay 3] [Relay] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] [Relay] [KEY] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] Relay 3 starting on 10.250.120.196:9103 (RELAY PORT 9103)
[Relay 3] Registering with CDS at 127.0.0.1:9000
[Relay 3] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9103, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5k9OJ8m3IdjmwR1skM1G\nwrKkwlYLK0Qs+I/BX5ww5wEakOsTy5NVFAwTYrCUnR012u2jCwI8wV1YpPaMa8RJ\ntnqNFy4pFfqBh5tmidHQ3QMRvINPrGtQM5+VgMXoA0y8izql52M1K/3Q6sHVlAXd\nmpQcBO+JSHY7uyVx1txZssyisia7Nn8Frh/XRpl0oUvGkSnbm/KgqDAP0xJ3lUZS\nEGiIWdf0bn7tHD3nYBMrWWi3jSQWf0Q80asIEYWipwkfMPf0ffzu4FX0elfvpyOX\nr50xk7sb8K5IhcilwxKxQpPOcq3f6ph0EERQR7pOdDqkzFdHoGiyssSX4MYM60kd\nmQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 3] [Relay] Listening for incoming messages on port 9103 (RELAY PORT 9103)
[Relay 1] [Relay] [handle_message ENTERED] addr=('10.250.120.196', 59318), thread=6133886976, relay_port=9101
[Relay 1] [Relay] [DEBUG] Raw data received: b'{"next_ip": "10.250.120.196", "next_port": 9101, "session_key": "asY3kcK+P68f3unA7mWWT6DQK6OFdc/kUg3MRDShbx82Fndw1L71zhxD1KH/PTiU9WAEeRrdJEIbtkoig4dyTtKJd+Y3/OOlKZ6rGSh2RJ10m87Tby+FsHXSbNFBzMtv0jO7U7l4KS4N58LiIcQsJtFjEy9e8gY/cMAIvXoALGqiadAu8g6HFCPquGAmyqVrYUnvyr55GDTCfYI003u9au5nJhpdyaKi4R7TCe+edZxLhvjGfaCRnTzTtFWfhGd/130A73HSOIOoasJbACudpNRGco4RKfwbiuJ+xnacZnY2FFFEcBcHtMUMfaWO10Krj6VlkREVu0xnsxuXSzuKdg==", "payload": "FHdYCPCV9Ey6LoEPLILolWauDFEyh6tFeQJAkaLk8/12cyExP8MCTWi85ymtas/2JWX8nVhr6uKObHtufg07pX5mem6dOTkUPkAqV9GIh1NuK6RqGLF7f75yd4rA0dMuBHf7XMrM4bAoBqXqfoBJFvYOhL+wgShEP3a6QwRxG29nU7K8g+n2WKOFo+r8nq+cJFmplWeVJuEzwENbEoXX4tHDoUtOpCO79yCxZududunWdDq8LGwHaQ8GvUdOZzyvCIx4pdgiEoQqV3mR7sSBV36rlT4X7ED9ecFQrfyooId29+GlJR34zdmlf2PFSwWAeGZ59Rn2FbpcWuGUZ6lqwIgAVOH31/WDQOQZ59yo/b2lfN6z909uF9vfMIMITUawn0MLr3Fr/hZfPBb96QiI/M+WkzEIShxRnHAgTVzE1xJ0zHtbWvlSLK/QnqSRdurtGxCsYq88LGilSZyklKrlHTSzXU6zGNbTksPIwcRIqagbGGNQJdAsj3+LAHyonxG5PvkwI++blcjxG7vI3CjU/lcX48JxBjBX4rQcbI0xqUs6UmvGNjt/vkKG0dYhNS/zheEpdXxNyU5BxUwVvi1wSAsVKQHkKDVtHLsjc9GaRAzJ4Psg1PEpmXhW9toTbjEFmXe42GCHhIxOYF+hf3+gCqYAC8NpiDsTimpSLeXbhHASBqjyfKtizRASt4dfkaRzhgXk6rOLnSaPr5tRlErZWfOygUlG2cglMpVHNaaXManSKis80ryP/8k0gi1hDtKIRjK+1pwDbLER0yZ06XeWcB0pUA5Afa8TA1XET/ctg8RrP9/z2mY9ZZsCEHH+J2Muzo0FZ4JdIP4k5j2MZQ9Gb5RCeapY1smpBwAtRongoJlB+Cv+7fb5AYnFc2tTZhjihmdillWwVvummIu/GpzIX7TqNoGeqKbbt37xL3duVElx7YI+1UBxnM5Dd3r7jnCfkZ7ZtnSEOc+B8typppVhn6PcaEBSHHTF0WSe4ghByqu3HWlThtMElmMPsTrsiF9gbR7Db/Y9JAUBe/szuqqyifBFJ30c/Nl3SEpYQtpe6xZOekPWdiiCGc5KX9IRFUz0/JCz4ckKUkfQsJO4VCsiAuhVevpyX7ibwORadx/kmclDQIf3UN2FiXeEVnANzcQ81qu12lL6qfDH8/N356eqAagHLBHL9PgAr5BGOvmpQWI8ykhGvFMhTWBo4zGnvIN2ghmlt4ABNGm2OWL02/re63zBmMteXDdhyEJscWERoLux/9Y5Jhs3TUC1Dls2Njy6/V7ItYvXpIbKryGYlKSyM22EPPsz7retFlxXtHPeJn9LP7/DUBzxWGK2FtcUwbjs0Z20kWUAoHAWWJXExlBWcSyGLT9F0eDNUPm/3F0vrZhXcHi76trIofsHJEyojA5gFbiLuK+WOK4bZ6x24kDn3pJDA5cYI3RuVwjp4TTEcH06vjL7u+ycZoUfgHWaOCHiqpo="}'
[Relay 1] [Relay] [DEBUG] Data before JSON parse: type=<class 'bytes'>, value=b'{"next_ip": "10.250.120.196", "next_port": 9101, "session_key": "asY3kcK+P68f3unA7mWWT6DQK6OFdc/kUg3MRDShbx82Fndw1L71z
[Relay 1] [Relay] [DEBUG] Data after JSON parse: type=<class 'dict'>, keys=['next_ip', 'next_port', 'session_key', 'payload']
[Relay 1] [Relay] Received session_key (base64): asY3kcK+P68f3unA7mWWT6DQK6OFdc/kUg3MRDShbx82Fndw1L71zhxD1KH/PTiU9WAEeRrdJEIbtkoig4dyTtKJd+Y3/OOlKZ6rGSh2RJ10m87Tby+FsHXSbNFBzMtv0jO7U7l4KS4N58LiIcQsJtFjEy9e8gY/cMAIvXoALGqiadAu8g6HFCPquGAmyqVrYUnvyr55GDTCfYI003u9au5nJhpdyaKi4R7TCe+edZxLhvjGfaCRnTzTtFWfhGd/130A73HSOIOoasJbACudpNRGco4RKfwbiuJ+xnacZnY2FFFEcBcHtMUMfaWO10Krj6VlkREVu0xnsxuXSzuKdg==
[Relay 1] [Relay] Decoded session_key_enc (hex): 6ac63791c2be3faf1fdee9c0ee65964fa0d02ba38575cfe4520dcc4434a16f1f36167770d4bef5ce1c43d4a1ff3d3894f56004791add24421bb64a228387724ed28977e637fce3a5299eab192876449d749bced36f2f85b075d26cd141cccb6fd233bb53b978292e0de7c2e221c42c26d163132f5ef2063f70c008bd7a002c6aa269d02ef20e871423eab86026caa56b6149efcabe791834c27d8234d37bbd6aee67261a5dc9a2a2e11ed309ef9e759c4b86f8c67da0919d3cd3b4559f84677fd77d00ef71d23883a86ac25b002b9da4d446728e1129fc1b8ae27ec6769c667636145144701707b4c50c7da58ed742ab8fa565911115bb4c67b31b974b3b8a76
[Relay 1] [Relay] Decrypting session key with fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] Decrypted session_key (hex): 42cbcd5118bf21905a64088f251cd440b98cadc23b921e580ca55bb68ccd2e82
[Relay 1] [Relay] Extracted session_key: <class 'str'>, len=344
[Relay 1] [Relay] [DEBUG] About to AES-decrypt payload (passing base64 string directly)
[Relay 1] [Relay] [DEBUG] Payload base64-decoded: type=<class 'bytes'>, len=1106, preview=b'\x14wX\x08\xf0\x95\xf4L\xba.\x81\x0f,\x82\xe8\x95f\xae\x0c
[Relay 1] [Relay] [DEBUG] AES-decrypted payload: type=<class 'bytes'>, len=1090, preview=b'{"next_ip": "10.250.120.196", "next_port": 9102, "session_
[Relay 1] [Relay] [DEBUG] AES-decrypted payload as UTF-8: '{"next_ip": "10.250.120.196", "next_port": 9102, "session_key": "eKD4kKqF2QWv7nn95ioKGLsVYZB3xTQRjmZleRQMu8KbW1h/I7diPyI'
[Relay 1] [Relay] [DEBUG] AES-decrypted payload (hex): 7b226e6578745f6970223a202231302e3235302e3132302e313936222c20226e6578745f706f7274223a20393130322c202273657373696f6e5f6b65
[Relay 1] [Relay] [Last Hop] Forwarding payload to dest 127.0.0.1:9100, len=1090, type=<class 'bytes'>
[Relay 1] [Relay] [Last Hop] Sending to dest: type=<class 'bytes'>, len=1090, preview=b'{"next_ip": "10.250.120.196", "next_port": 9102, "session_key": "eKD4kKqF2QWv7
[Relay 1] [Relay] [Last Hop] Received response from dest: type=<class 'bytes'>, len=1116, preview=b'{"result": "OK", "echo": {"next_ip": "10.250.120.196", "next'
[Relay 1] [Relay] [Last Hop] Response from dest decoded as UTF-8: '{"result": "OK", "echo": {"next_ip": "10.250.120.196", "next_port": 9102, "session_key": "eKD4kKqF2QWv7nn95ioKGLsVYZB3xT'
[Relay 1] [Relay] [Last Hop] Response from dest (hex): 7b22726573756c74223a20224f4b222c20226563686f223a207b226e6578745f6970223a202231302e3235302e3132302e313936222c20226e657874
[Relay 1] [Relay] [Last Hop] About to AES-encrypt response: type=<class 'bytes'>, len=1116, preview=b'{"result": "OK", "echo": {"next_ip": "10.250.120.196", "next'
[Relay 1] [Relay] [Last Hop] AES-encrypted response (hex): afe1fc5f5bef0c91966d21dee2e263b632a73649defe02c0edcf7264b7ea4605d50cb5b4b8b954fde33d755332519cca96be168a85e984344f48ccf5
[Relay 1] [Relay] [Last Hop] Base64-encoded AES-encrypted response: type=<class 'bytes'>, len=1512, preview=b'r+H8X1vvDJGWbSHe4uJjtjKnNkne/gLA7c9yZLfqRgXVDLW0uLlU/eM9dVMy'
[Relay] ---- Relay process started ----
[Relay 1] [Relay] Loaded persistent RSA keypair from relay1_key.pem
[Relay 1] [Relay] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] [KEY] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] Relay 1 starting on 10.250.120.196:9101 (RELAY PORT 9101)
[Relay 1] Registering with CDS at 127.0.0.1:9000
[Relay 1] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9101, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5MM7/HBECV26fZqjUJkt\nQ4+dx297cL0hf1+rf08Qir5tL/lArfQsiplTqcsIsZiN7vJ8K2XzvK5JAEv8tVE4\nEKU4W1hbEVBd1eLCX+Oc5XauTbWhW8xlc2wdNlNwDhin2Mw84doKJWPyfjtIwnIi\n3nWHqxLyAqkj6qDoByA8D7YVmJxvzwL0mrYE8G8b4Q4Wjnx2SXeTwc9LRzqwrsyb\nlM5B4BSVPBignOMhD2AfuIFw6uULQThbkL9L5AnQA08B4Gqzo731LLJN/Y6qo+VJ\nki2t6m1aJTG0LBjijpH7CtnN1MHIQ5UueS1sJVYZooYxkxEYYZTqIUXxuI5ICKPC\nCQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 1] [Relay] Listening for incoming messages on port 9101 (RELAY PORT 9101)
[Relay] ---- Relay process started ----
[Relay 2] [Relay] Loaded persistent RSA keypair from relay2_key.pem
[Relay 2] [Relay] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] [KEY] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] Relay 2 starting on 10.250.120.196:9102 (RELAY PORT 9102)
[Relay 2] Registering with CDS at 127.0.0.1:9000
[Relay 2] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9102, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA58J3pSrOQd4hYnuzQQ7q\nWrjjo+3BJp+ik23brR2yl0kjtfH+wjD9LYWHS7dBxsDRzSozJ/7EWKKNCaTsgvaF\nN6vpyBPqDM/uQfOWfirteL50RgDZw95Vml4Fuay7bTBEb1J8ydvFqawo8rnLE2I3\nU4BjBT+CD38bY3je8wrrCX9fo1uYaLDlfteGshadZ2gnTxrAzkZZ/CTFdyb8JrmN\nIuxjBVjwSA/uIv+KHWQhXRA5jJPXcNV88LYXyEzpid1Cr9gnrqA88K0HSleiwZjU\nJF3LhBvS2Ga2HHfFsk5D/yz/pTHwDvRA98VMT/90wahwmSJsck4XWDFhmNhy3oDR\nBQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 2] [Relay] Listening for incoming messages on port 9102 (RELAY PORT 9102)
[Relay] ---- Relay process started ----
[Relay 3] [Relay] Loaded persistent RSA keypair from relay3_key.pem
[Relay 3] [Relay] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] [Relay] [KEY] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] Relay 3 starting on 10.250.120.196:9103 (RELAY PORT 9103)
[Relay 3] Registering with CDS at 127.0.0.1:9000
[Relay 3] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9103, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5k9OJ8m3IdjmwR1skM1G\nwrKkwlYLK0Qs+I/BX5ww5wEakOsTy5NVFAwTYrCUnR012u2jCwI8wV1YpPaMa8RJ\ntnqNFy4pFfqBh5tmidHQ3QMRvINPrGtQM5+VgMXoA0y8izql52M1K/3Q6sHVlAXd\nmpQcBO+JSHY7uyVx1txZssyisia7Nn8Frh/XRpl0oUvGkSnbm/KgqDAP0xJ3lUZS\nEGiIWdf0bn7tHD3nYBMrWWi3jSQWf0Q80asIEYWipwkfMPf0ffzu4FX0elfvpyOX\nr50xk7sb8K5IhcilwxKxQpPOcq3f6ph0EERQR7pOdDqkzFdHoGiyssSX4MYM60kd\nmQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 3] [Relay] Listening for incoming messages on port 9103 (RELAY PORT 9103)
[Relay 1] [Relay] [handle_message ENTERED] addr=('10.250.120.196', 64363), thread=6137901056, relay_port=9101
[Relay 1] [Relay] [DEBUG] Raw data received: b'{"next_ip": "10.250.120.196", "next_port": 9101, "session_key": "EjB5O1dtBHLNMFjfygmujHQDW1zXpfLtWNvZGKSuof6XCbt6zPlzOoMyN86Fvd8UBjAufTOHu6Q/RRh5AGS2U52dRxJYV/0omK3xHi0rXo2v19+PFhwG5zFLkcN/gWmt2x/CyWVAez8fJFsiUFe54eUQU/5OVtgIcIOsowm1Ey10ZAoDRkIHwtaPHafRm/LVsuEci/irJ5LvsPgfnhaDotyT+F5pB2FnG5EW7LemhJoOBEOq6l0tTGtGY2ALA3LVf82uPzRzxOXHkTYGzoVl292tjdmJoD8QGfKFzvg5Dj+gw8qOapM1T6FxnpAiMYVyT2cG9Bs3kcY2nCBOen8Ikw==", "payload": "TrN/CpwTKt013zcfCsz+SHBHFvt7wduFHkDh5uZY9P+Y0Tvy0ydT50l1OeEy++eMvFRi/v+sI1lcO7Oearqb/0fNt9ihM2AffxegwyYUdBBdGg9SEnZG0rbAZaWdoELWNaRkHxO9Az1p4BmLU8nE7c5uDcypx+DZt/1JkYWLWKjZISMg/rj2s2WtN3unxOWkBRC9ebXghIOuGW2CrHoyegfh+XHRbUo4sPmA+nHH4kz1VyPiYLEmek0UvMo5s1YiqeuuwEM7s9lV0NGo9iw64k0PomoEW0ZKrRWzrwHfaIl4O/vyaYU8bYKWG/XuUUuaQXc0cyJI+sks3UAckAIi/s3SuGQSkzl7faYMVGzlyGNkutwKhxz8LM/Sgy96JguvV1OqHfCSb7/+QzuRPZ/UXNxGUg73gpqwXVTsjwJjP1v/aIFp6MWYDZikgtEVCkGfwel7oNyqY/9r6mVELK1qG4Z0V7EGFg81KTuEKJh6ZsAhmlfG7UcbL81/8/4LJ+LrItvrYcjO3LQkC56laYhiu967+3z+l3+JVrWicCtzrmDYdbQw4Dw/jFav4lhwb5XITpKzM+VbRPxzi2WDjP6bg4NBDbXhrLfufdXM50nvfM1vLAZR0CqGyvO98I11GNRaivwEgmV+XGIl1D4QG8ltI9WZf1UNNIuI1n1cA0tq4PnefuP8ipSRn6ZRP096aT6WzmGHtH5NwmMiL3+awIpjFpTTB4qncjXPiEsXxZvLw3DAvZwphZVsc9nHaQpP+jr+zkSBcJBYefAJn+9CB3tp3x8eE92AkeKvUM/2nk3p079LmxAzYkAZgLzE0goGNDlegiFPCRD22jVqKjVRGLGkmnOOcd+rQRWbFLUeF0n67aGn45hoRwyYhHxFzVxw9Z+Bc1CYF/EmvXQovURjWGbnf5VNgOyPMPm0HYFDVv70YINhXMGXQ55AXfSFN6cTQXo1snIwHSRO3/XMrkPhbGwkVGisj4EbsCLZ3dAAKuKhHFIbNoBzOWvwxfn0iwHlSqI8WrUpfzQPX0Euk0mZEklP2V9bUlLQJfcDwSUedDIG9/R7BbzIZvX/lbF4CGzeoLHM4ZNd+iGgsDhCyZsRmXjycpa0qlOn7JXIm+tWSVd4xxmKsBBN+L21jzxsZRTVpMdfjb7onXeFO1Xac83hZHZpu2KJnGK2TbwfleoLVOHkANBgyN8noMjL0FErhQlzdqrAQMBNzGmL1VT4IUCFPAmMYol0fi1EC/UltdnIIqFlc0WytV22YZRNLMznA/j+pR3TjFpGuEW7jdoVY922x7o7ze/tm8W+FkIyHUtDbHBv9sf/3ZkTr4A4Le7Iub7KL+ePnuffEu2lDp9WB6iDOYpz3+3QgPJMDT4ZMOrTRrUrMwoawnfbFMxMidq2lNOuqnTmA5xFXQx/Z2BBWbkW7prenYYJyNCoy5hsCVQfc9e6K67665fl9JLBfNFkxWiUinxu6fo="}'
[Relay 1] [Relay] [DEBUG] Data after JSON parse: type=<class 'dict'>, keys=['next_ip', 'next_port', 'session_key', 'payload']
[Relay 1] [Relay] Received session_key (base64): EjB5O1dtBHLNMFjfygmujHQDW1zXpfLtWNvZGKSuof6XCbt6zPlzOoMyN86Fvd8UBjAufTOHu6Q/RRh5AGS2U52dRxJYV/0omK3xHi0rXo2v19+PFhwG5zFLkcN/gWmt2x/CyWVAez8fJFsiUFe54eUQU/5OVtgIcIOsowm1Ey10ZAoDRkIHwtaPHafRm/LVsuEci/irJ5LvsPgfnhaDotyT+F5pB2FnG5EW7LemhJoOBEOq6l0tTGtGY2ALA3LVf82uPzRzxOXHkTYGzoVl292tjdmJoD8QGfKFzvg5Dj+gw8qOapM1T6FxnpAiMYVyT2cG9Bs3kcY2nCBOen8Ikw==
[Relay 1] [Relay] Decoded session_key_enc (hex): 1230793b576d0472cd3058dfca09ae8c74035b5cd7a5f2ed58dbd918a4aea1fe9709bb7accf9733a833237ce85bddf1406302e7d3387bba43f4518790064b6539d9d47125857fd2898adf11e2d2b5e8dafd7df8f161c06e7314b91c37f8169addb1fc2c965407b3f1f245b225057b9e1e51053fe4e56d8087083aca309b5132d74640a03464207c2d68f1da7d19bf2d5b2e11c8bf8ab2792efb0f81f9e1683a2dc93f85e690761671b9116ecb7a6849a0e0443aaea5d2d4c6b4663600b0372d57fcdae3f3473c4e5c7913606ce8565dbddad8dd989a03f1019f285cef8390e3fa0c3ca8e6a93354fa1719e90223185724f6706f41b3791c6369c204e7a7f0893
[Relay 1] [Relay] Decrypting session key with fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] Decrypted session_key (hex): c26d055c22c7df0cf451a83567fc9cde6bdbb99d2a8c99dcc03fd3f1bfdd943e
[Relay 1] [Relay] [DEBUG] About to AES-decrypt payload (passing base64 string directly)
[Relay 1] [Relay] [DEBUG] Payload base64-decoded: type=<class 'bytes'>, len=1106, preview=b"N\xb3\x7f\n\x9c\x13*\xdd5\xdf7\x1f\n\xcc\xfeHpG\x16\xfb{\xc1\xdb\x85\x1e@\xe1\xe6\xe6X\xf4\xff\x98\xd1;\xf2\xd3'S\xe7Iu9\xe12\xfb\xe7\x8c\xbcTb\xfe\xff\xac#Y\\;\xb3\x9e"
[Relay 1] [Relay] [DEBUG] AES-decrypted payload: type=<class 'bytes'>, len=1090, preview=b'{"next_ip": "10.250.120.196", "next_port": 9102, "session_ke'
[Relay 1] [Relay] [DEBUG] AES-decrypted payload (hex): 7b226e6578745f6970223a202231302e3235302e3132302e313936222c20226e6578745f706f7274223a20393130322c202273657373696f6e5f6b65
[Relay 1] [Relay] [DEBUG] Next hop JSON keys: ['next_ip', 'next_port', 'session_key', 'payload']
[Relay 1] [Relay] [DEBUG] Forwarding to next relay 10.250.120.196:9102
[Relay 2] [Relay] [handle_message ENTERED] addr=('10.250.120.196', 64372), thread=6158561280, relay_port=9102
[Relay 2] [Relay] [DEBUG] Raw data received: b'{"next_ip": "10.250.120.196", "next_port": 9102, "session_key": "NWhSxSm5YzHlGcr+vGIdjdMJsxAhP9cHeU3hxOAr9sm0FTn559Cq4UcYz47lfoqooixtODH/Z+wwFgI0czuBiwHdjDT8Hyz0yBH2CiGNB9syHvx/fmE2SvJKSG3O+1OG49LMRb0U4RI67TygZWzzJ0HiIsShqWqf9IM0cN1QZDXbbkJL2U1+uSX4yaqLZvVv8e8uzhUrRdkbpXcuqk0//kpOFLL4I8Cl/Nh/xVtGTGDkESoVPtoFMx96GRek0og0DfAd1u8Wf5uJYea5Kv3hx7k/lEYbMW/4I4Pt0CGu4kqFbe5TI5nHQA4a3CTv6ULkzWaA/1JskPH4dlvzpBQ+aQ==", "payload": "xXKtAfyhJNN7amosLGvIiH4HV3A3PgpRM77DPTHNbpXGgCNPA84HOnOhCpGflqnR+/FEJf82G2K2wSEQEO2uYwuyOQMpD9GGPU3Gfs94866sJSJ15g7Q1vBCTsydSahWpf2ghBVfn2GOKs0vF5Uj/fDzGnYYGZaGB+h88FQi43UhItzPv5VI+db5ifZ3AlTQC58+kV4F11c5kcwBbSkaYAGLGunBX/Fle74mur/htqXGPpnVQ0hKbi0Ay00juA4DFWK4AxlETAZxaxHnh75XpAtrqyXnco3IoCMMjWBDRzLa6LDHsP6cqviRQzKwZENbBLiRA+A2oiNRa+iwBoX3N0BOuQRKyaFFb0OK10qmRdBOLfDPXGJgfDp9akRsdR4f3y42aM6Rcw5AaUdUKdlsBwzlJTQuBFk5iHhy8YDD+82FVJ3t51Z70L15S27iBL5XclGLY7c+cEP3jt6IXM4lfrkXIcSlpHarkgaormZFwRmUiGWAwa69875kYEKwUdIcupwFkPBs/LOsIhocFxVuKGD6KcaUEZzQDgqilIOQ3MyulFpqZcNbEmN7JlLzzwZiQT3y0tEa141lc0yPYPg0b7pv6ygakFHMm1wtbnKj5oHwvHGNx/bAOPwouRSWjHFdcxqZ4FsaQT6TVDkjcphM8wdF"}'
[Relay 2] [Relay] [DEBUG] Data after JSON parse: type=<class 'dict'>, keys=['next_ip', 'next_port', 'session_key', 'payload']
[Relay 2] [Relay] Received session_key (base64): NWhSxSm5YzHlGcr+vGIdjdMJsxAhP9cHeU3hxOAr9sm0FTn559Cq4UcYz47lfoqooixtODH/Z+wwFgI0czuBiwHdjDT8Hyz0yBH2CiGNB9syHvx/fmE2SvJKSG3O+1OG49LMRb0U4RI67TygZWzzJ0HiIsShqWqf9IM0cN1QZDXbbkJL2U1+uSX4yaqLZvVv8e8uzhUrRdkbpXcuqk0//kpOFLL4I8Cl/Nh/xVtGTGDkESoVPtoFMx96GRek0og0DfAd1u8Wf5uJYea5Kv3hx7k/lEYbMW/4I4Pt0CGu4kqFbe5TI5nHQA4a3CTv6ULkzWaA/1JskPH4dlvzpBQ+aQ==
[Relay 2] [Relay] Decoded session_key_enc (hex): 356852c529b96331e519cafebc621d8dd309b310213fd707794de1c4e02bf6c9b41539f9e7d0aae14718cf8ee57e8aa8a22c6d3831ff67ec30160234733b818b01dd8c34fc1f2cf4c811f60a218d07db321efc7f7e61364af24a486dcefb5386e3d2cc45bd14e1123aed3ca0656cf32741e222c4a1a96a9ff4833470dd506435db6e424bd94d7eb925f8c9aa8b66f56ff1ef2ece152b45d91ba5772eaa4d3ffe4a4e14b2f823c0a5fcd87fc55b464c60e4112a153eda05331f7a1917a4d288340df01dd6ef167f9b8961e6b92afde1c7b93f94461b316ff82383edd021aee24a856dee532399c7400e1adc24efe942e4cd6680ff526c90f1f8765bf3a4143e69
[Relay 2] [Relay] Decrypting session key with fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] Decrypted session_key (hex): 386794a4888dbb99e4f5ac3fdf7fbf5a869c4b3ed4f35c5d3a045acfa5d1d500
[Relay 2] [Relay] [DEBUG] About to AES-decrypt payload (passing base64 string directly)
[Relay 2] [Relay] [DEBUG] Payload base64-decoded: type=<class 'bytes'>, len=498, preview=b'\xc5r\xad\x01\xfc\xa1$\xd3{jj,,k\xc8\x88~\x07Wp7>\nQ3\xbe\xc3=1\xcdn\x95\xc6\x80#O\x03\xce\x07:s\xa1\n\x91\x9f\x96\xa9\xd1\xfb\xf1D%\xff6\x1bb\xb6\xc1!\x10'
[Relay 2] [Relay] [DEBUG] AES-decrypted payload: type=<class 'bytes'>, len=482, preview=b'{"next_ip": "10.250.120.196", "next_port": 9103, "session_ke'
[Relay 2] [Relay] [DEBUG] AES-decrypted payload (hex): 7b226e6578745f6970223a202231302e3235302e3132302e313936222c20226e6578745f706f7274223a20393130332c202273657373696f6e5f6b65
[Relay 2] [Relay] [DEBUG] Next hop JSON keys: ['next_ip', 'next_port', 'session_key', 'payload']
[Relay 2] [Relay] [DEBUG] Forwarding to next relay 10.250.120.196:9103
[Relay 3] [Relay] [handle_message ENTERED] addr=('10.250.120.196', 64379), thread=6196867072, relay_port=9103
[Relay 3] [Relay] [DEBUG] Raw data received: b'{"next_ip": "10.250.120.196", "next_port": 9103, "session_key": "UiZpQ33n+DF+RKEt5Yuwv2odx7jU92c/SzrqwMucThejNz30dHiLilMB1msIx2IXOQ+HVjkwYflZ5lfJ15m3j+RGveXcPk0BfjQ1PuZElXCv2LN8euin2397ECOjSfE3kMjdRUSisDGrqCqNvx/ShEqDkJZ49uXG12vjg34XyzT1f8n53d14dK5UCqVzolbDMZVWfiBUcGerYnWiGC4Qah3fGWWc8xZemrQUShMZym0fsjZ4Dm44F49e9KGxcf/Fal6mD3+fQ+2AiTebO72DN4okYcyOCg/n8GvESJq9JeW0dAa6irQ8bVZfaqtU3jiPvUWyWWVcASMuo/pIlFPkZQ==", "payload": "DvncF4VkHHTjrTL5YUA5UgRJboFOG8HxJC1TPQXIz954OrCqPY/5rA=="}'
[Relay 3] [Relay] [DEBUG] Data after JSON parse: type=<class 'dict'>, keys=['next_ip', 'next_port', 'session_key', 'payload']
[Relay 3] [Relay] Received session_key (base64): UiZpQ33n+DF+RKEt5Yuwv2odx7jU92c/SzrqwMucThejNz30dHiLilMB1msIx2IXOQ+HVjkwYflZ5lfJ15m3j+RGveXcPk0BfjQ1PuZElXCv2LN8euin2397ECOjSfE3kMjdRUSisDGrqCqNvx/ShEqDkJZ49uXG12vjg34XyzT1f8n53d14dK5UCqVzolbDMZVWfiBUcGerYnWiGC4Qah3fGWWc8xZemrQUShMZym0fsjZ4Dm44F49e9KGxcf/Fal6mD3+fQ+2AiTebO72DN4okYcyOCg/n8GvESJq9JeW0dAa6irQ8bVZfaqtU3jiPvUWyWWVcASMuo/pIlFPkZQ==
[Relay 3] [Relay] Decoded session_key_enc (hex): 522669437de7f8317e44a12de58bb0bf6a1dc7b8d4f7673f4b3aeac0cb9c4e17a3373df474788b8a5301d66b08c76217390f8756393061f959e657c9d799b78fe446bde5dc3e4d017e34353ee6449570afd8b37c7ae8a7db7f7b1023a349f13790c8dd4544a2b031aba82a8dbf1fd2844a83909678f6e5c6d76be3837e17cb34f57fc9f9dddd7874ae540aa573a256c33195567e20547067ab6275a2182e106a1ddf19659cf3165e9ab4144a1319ca6d1fb236780e6e38178f5ef4a1b171ffc56a5ea60f7f9f43ed8089379b3bbd83378a2461cc8e0a0fe7f06bc4489abd25e5b47406ba8ab43c6d565f6aab54de388fbd45b259655c01232ea3fa489453e465
[Relay 3] [Relay] Decrypting session key with fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] [Relay] Decrypted session_key (hex): b738b63385a8a7815be155295e302a014b24df5370ecac43bcc162d7feb01428
[Relay 3] [Relay] [DEBUG] About to AES-decrypt payload (passing base64 string directly)
[Relay 3] [Relay] [DEBUG] Payload base64-decoded: type=<class 'bytes'>, len=40, preview=b'\x0e\xf9\xdc\x17\x85d\x1ct\xe3\xad2\xf9a@9R\x04In\x81N\x1b\xc1\xf1$-S=\x05\xc8\xcf\xdex:\xb0\xaa=\x8f\xf9\xac'
[Relay 3] [Relay] [DEBUG] AES-decrypted payload: type=<class 'bytes'>, len=24, preview=b'{"msg": "Hello, world!"}'
[Relay 3] [Relay] [DEBUG] AES-decrypted payload (hex): 7b226d7367223a202248656c6c6f2c20776f726c6421227d
[Relay 3] [Relay] [DEBUG] Next hop JSON keys: ['msg']
[Relay 3] [Relay] [DEBUG] Payload is not JSON, assuming last hop. Error: 'next_ip'
[Relay 3] [Relay] [Last Hop] Forwarding payload to dest 127.0.0.1:9100, len=24, type=<class 'bytes'>
[Relay 3] [Relay] [Last Hop] Sending to dest: type=<class 'bytes'>, len=24, preview=b'{"msg": "Hello, world!"}'
[Relay 3] [Relay] [Last Hop] Received response from dest: type=<class 'bytes'>, len=50, preview=b'{"result": "OK", "echo": {"msg": "Hello, world!"}}'
[Relay 3] [Relay] [Last Hop] Response from dest decoded as UTF-8: '{"result": "OK", "echo": {"msg": "Hello, world!"}}'
[Relay 3] [Relay] [Last Hop] Response from dest (hex): 7b22726573756c74223a20224f4b222c20226563686f223a207b226d7367223a202248656c6c6f2c20776f726c6421227d7d
[Relay 3] [Relay] [Last Hop] About to AES-encrypt response: type=<class 'bytes'>, len=50, preview=b'{"result": "OK", "echo": {"msg": "Hello, world!"}}'
[Relay 3] [Relay] [Last Hop] AES-encrypted response (hex): 138360d32e74922af70fbf8cb643b1d61a19abeb6752351332ae35bac425d6083e3ca7f0bfdbb86fc71103372f7fb815d059f79145c0fc879fe37d4f
[Relay 3] [Relay] [Last Hop] Base64-encoded AES-encrypted response: type=<class 'bytes'>, len=88, preview=b'E4Ng0y50kir3D7+MtkOx1hoZq+tnUjUTMq41usQl1gg+PKfwv9u4b8cRAzcv'
[Relay 3] [Relay] [Last Hop] Sent response to ('10.250.120.196', 64379): b'E4Ng0y50kir3D7+MtkOx1hoZq+tnUjUTMq41usQl1gg+PKfwv9u4b8cRAzcv'... (len=88)
[Relay 3] [Relay] [handle_message END] addr=('10.250.120.196', 64379), thread=6196867072
[Relay 2] [Relay] [DEBUG] Received response from next relay: type=<class 'bytes'>, len=88, preview=b'E4Ng0y50kir3D7+MtkOx1hoZq+tnUjUTMq41usQl1gg+PKfwv9u4b8cRAzcv'
[Relay 2] [Relay] [DEBUG] Encrypted response for previous hop: type=<class 'bytes'>, len=140, preview=b'elZDr2J1hCmaF0L/rduvsWaNjA2X6CY1kp4pUstP7xK5LX0qZYLuyp0t8M6X'
[Relay 1] [Relay] [DEBUG] Received response from next relay: type=<class 'bytes'>, len=140, preview=b'elZDr2J1hCmaF0L/rduvsWaNjA2X6CY1kp4pUstP7xK5LX0qZYLuyp0t8M6X'
[Relay 2] [Relay] [handle_message END] addr=('10.250.120.196', 64372), thread=6158561280
[Relay 1] [Relay] [DEBUG] Encrypted response for previous hop: type=<class 'bytes'>, len=208, preview=b'BesQozTR1LXPprHaBNcWvg6KybaAiq2kKXGnSkZgRlD5wmQ6U6UanVYVkOu3'
[Relay] ---- Relay process started ----
[Relay 1] [Relay] Loaded persistent RSA keypair from relay1_key.pem
[Relay 1] [Relay] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] [KEY] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] Relay 1 starting on 10.250.120.196:9101 (RELAY PORT 9101)
[Relay 1] Registering with CDS at 127.0.0.1:9000
[Relay 1] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9101, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5MM7/HBECV26fZqjUJkt\nQ4+dx297cL0hf1+rf08Qir5tL/lArfQsiplTqcsIsZiN7vJ8K2XzvK5JAEv8tVE4\nEKU4W1hbEVBd1eLCX+Oc5XauTbWhW8xlc2wdNlNwDhin2Mw84doKJWPyfjtIwnIi\n3nWHqxLyAqkj6qDoByA8D7YVmJxvzwL0mrYE8G8b4Q4Wjnx2SXeTwc9LRzqwrsyb\nlM5B4BSVPBignOMhD2AfuIFw6uULQThbkL9L5AnQA08B4Gqzo731LLJN/Y6qo+VJ\nki2t6m1aJTG0LBjijpH7CtnN1MHIQ5UueS1sJVYZooYxkxEYYZTqIUXxuI5ICKPC\nCQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 1] [Relay] Listening for incoming messages on port 9101 (RELAY PORT 9101)
[Relay] ---- Relay process started ----
[Relay 2] [Relay] Loaded persistent RSA keypair from relay2_key.pem
[Relay 2] [Relay] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] [KEY] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] Relay 2 starting on 10.250.120.196:9102 (RELAY PORT 9102)
[Relay 2] Registering with CDS at 127.0.0.1:9000
[Relay 2] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9102, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA58J3pSrOQd4hYnuzQQ7q\nWrjjo+3BJp+ik23brR2yl0kjtfH+wjD9LYWHS7dBxsDRzSozJ/7EWKKNCaTsgvaF\nN6vpyBPqDM/uQfOWfirteL50RgDZw95Vml4Fuay7bTBEb1J8ydvFqawo8rnLE2I3\nU4BjBT+CD38bY3je8wrrCX9fo1uYaLDlfteGshadZ2gnTxrAzkZZ/CTFdyb8JrmN\nIuxjBVjwSA/uIv+KHWQhXRA5jJPXcNV88LYXyEzpid1Cr9gnrqA88K0HSleiwZjU\nJF3LhBvS2Ga2HHfFsk5D/yz/pTHwDvRA98VMT/90wahwmSJsck4XWDFhmNhy3oDR\nBQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 2] [Relay] Listening for incoming messages on port 9102 (RELAY PORT 9102)
[Relay] ---- Relay process started ----
[Relay 3] [Relay] Loaded persistent RSA keypair from relay3_key.pem
[Relay 3] [Relay] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] [Relay] [KEY] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] Relay 3 starting on 10.250.120.196:9103 (RELAY PORT 9103)
[Relay 3] Registering with CDS at 127.0.0.1:9000
[Relay 3] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9103, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5k9OJ8m3IdjmwR1skM1G\nwrKkwlYLK0Qs+I/BX5ww5wEakOsTy5NVFAwTYrCUnR012u2jCwI8wV1YpPaMa8RJ\ntnqNFy4pFfqBh5tmidHQ3QMRvINPrGtQM5+VgMXoA0y8izql52M1K/3Q6sHVlAXd\nmpQcBO+JSHY7uyVx1txZssyisia7Nn8Frh/XRpl0oUvGkSnbm/KgqDAP0xJ3lUZS\nEGiIWdf0bn7tHD3nYBMrWWi3jSQWf0Q80asIEYWipwkfMPf0ffzu4FX0elfvpyOX\nr50xk7sb8K5IhcilwxKxQpPOcq3f6ph0EERQR7pOdDqkzFdHoGiyssSX4MYM60kd\nmQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 3] [Relay] Listening for incoming messages on port 9103 (RELAY PORT 9103)
[Relay 1] [Relay] [handle_message ENTERED] addr=('10.250.120.196', 49755), thread=6201880576, relay_port=9101
[Relay 1] [Relay] [DEBUG] Raw data received: b'{"next_ip": "10.250.120.196", "next_port": 9101, "session_key": "Qf0ct9BfJLx7PT8WQFXyAVjBI5xZ7r2zIZQE/7LQdYliPbXeXAKIfsBvII6NsY20ZMSDzSmn4/2IuXInhsdx38l91d3ol2J45mSPCohN2Jcu7ZKJrEm4VrHvul7jVBJIXPI54ZNnL8LurWZBEsRpS1lDfOEcHRoYBf0VtJx2mCrsBpBM0IYLi3YttjHrfbSxwjmFjwsCPhViATeEmj/PerbOr42EqDvY0bBj8k9XmyIWkGMlSO7EEDrJbcbeLMEkcBzxsTAaC2dj++FxwFO7UO2juZ7jtBqXumk20PcnHfO6wD38LlrDpo5V4yO1ZJmJL0jLtibqBlbqXud+b2JXWg==", "payload": "wWqHW5HAnlV3EdfMPIC260psj9vjoRtKjlpPuH3Vh/QB+CtIuIw7d+enpqFSZx2KGy1WyMhrs3ecjsxokhb+e82vxaVZs40TlU17UrSd7KatpFcyeE1ic7XUMTn/F8s+zekX5BRaGY4VNcPUa7gB/vKmt6u/bs9RwTMK2589tsN03UF8DLaafde01mOXdFOzaGhDtSTJ+msWSA8j+DacBTBt8uENQBvENzu94n51z28/DYVcPhQsYUCEZhBpHMEJhMBrcFripdxOUhNiPjqp6B+GcKrP7h6bq8w6hPrd/9zhEBYUbNtvm7PC6LBNH37w2MQLoytbj4BGOxduLX2SAy+MzBC3fdocBpWQHcMzrodTAoY4QTWlV8ZziomiyFjfk4rnFQM21brZareTGr9v4SPekHOHBp58hB66/QZ1MovLNEJRKUCB6okl1gnNJB+bmxGl9tDoYuzchDjQ81rSbAmefaiEhfkFztiUN+htp5uJ+UdihmbQ+pKS63hdde8hkDCXbwTRGOlJ4J94Q8opp/ewEdoWzLKmDD3JjowS2aUTFlF127RaY/z1d9IlgcGWQDF78w474jKIckfaLZ330aQ+g+LkGpszTW0SOqz4v/jn8aH8vTf/KKOYTyOlyh1q4NEG1WEw5VNwzrY0yodeusaL4ZxRP6VhlFvfDc9nV3cW1zXoU97ktCCAuTgc+pfpnuuQ5Vq/agW0N4CxnUMx29H5zMYY//mxrXJ1ZzYmy2DimXunV5lAEBJCSzqcicUOcMJt3DOD2w4QpHoGVcgugymFYxlJkH9Cn2t5FDlfDIvQQf0mnLOumUrIIaVSMl7WgTlY8mdOLx+H7xSPVrEFJ8EPnj/LTgPXIFhXIgRA23R3CSAos2fMWY+Vn0mvzaq4++xcMMogzQlGERGtamfErhyfXNPu3ZP2gnecfxPziQFlktLfsopzvR8EbDrcshf/XfvSmpUcFGL0wkN0nodxFbezfZ1P/YsXOqInaufOqpUjTfzazLXXc+iWqdpC7awmbBNX80ZKtEqpvzcUjcmDnKZbbNGcOhYDWnt8FU+TqNYne3ygyrtZdkZbySRgsZnI9leYb12WajSJsFH5HVPNcoab6fsFFJxWP3qWTcFpC77PQKDUIxC4CgtAWP5k+giOTGOjbMGalrGmkn5S1wyGmcD9EMHOUVhzQzQvsl7cCejhJ0YQd1UP5ol+1bU6NGPfe3kmZBAkAjThN4HYDLXhQ5eTDNUv3n/JcmqASaH/B7eCJpC1uClWZeXW5iNirAz43uLgWgwzmpNDnBNDK21+ZyF1xATwvv/JNBYO+ErUUT2azcAe+uFyLb2hWSVVAWPsN7L6IA6WJYDysTp1eQZDDGgTN/qIYWvDH35EUDCVn08BADP4hFzyVQ3uAorH9YLYTUhcbnFn7EOb/h3AhlAmdejkbvx3obj8Opl8ANPxPWMzAmLmtROVCtt/T7FS342ysUI="}'
[Relay 1] [Relay] [DEBUG] Data after JSON parse: type=<class 'dict'>, keys=['next_ip', 'next_port', 'session_key', 'payload']
[Relay 1] [Relay] Received session_key (base64): Qf0ct9BfJLx7PT8WQFXyAVjBI5xZ7r2zIZQE/7LQdYliPbXeXAKIfsBvII6NsY20ZMSDzSmn4/2IuXInhsdx38l91d3ol2J45mSPCohN2Jcu7ZKJrEm4VrHvul7jVBJIXPI54ZNnL8LurWZBEsRpS1lDfOEcHRoYBf0VtJx2mCrsBpBM0IYLi3YttjHrfbSxwjmFjwsCPhViATeEmj/PerbOr42EqDvY0bBj8k9XmyIWkGMlSO7EEDrJbcbeLMEkcBzxsTAaC2dj++FxwFO7UO2juZ7jtBqXumk20PcnHfO6wD38LlrDpo5V4yO1ZJmJL0jLtibqBlbqXud+b2JXWg==
[Relay 1] [Relay] Decoded session_key_enc (hex): 41fd1cb7d05f24bc7b3d3f164055f20158c1239c59eebdb3219404ffb2d07589623db5de5c02887ec06f208e8db18db464c483cd29a7e3fd88b9722786c771dfc97dd5dde8976278e6648f0a884dd8972eed9289ac49b856b1efba5ee35412485cf239e193672fc2eead664112c4694b59437ce11c1d1a1805fd15b49c76982aec06904cd0860b8b762db631eb7db4b1c239858f0b023e15620137849a3fcf7ab6ceaf8d84a83bd8d1b063f24f579b221690632548eec4103ac96dc6de2cc124701cf1b1301a0b6763fbe171c053bb50eda3b99ee3b41a97ba6936d0f7271df3bac03dfc2e5ac3a68e55e323b56499892f48cbb626ea0656ea5ee77e6f62575a
[Relay 1] [Relay] Decrypting session key with fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] Decrypted session_key (hex): d11337852da20b65833a48020207e806fe22f9ed5ba271c772e472846f0d942d
[Relay 1] [Relay] [DEBUG] About to AES-decrypt payload (passing base64 string directly)
[Relay 1] [Relay] [DEBUG] Payload base64-decoded: type=<class 'bytes'>, len=1106, preview=b'\xc1j\x87[\x91\xc0\x9eUw\x11\xd7\xcc<\x80\xb6\xebJl\x8f\xdb\xe3\xa1\x1bJ\x8eZO\xb8}\xd5\x87\xf4\x01\xf8+H\xb8\x8c;w\xe7\xa7\xa6\xa1Rg\x1d\x8a\x1b-V\xc8\xc8k\xb3w\x9c\x8e\xcch'
[Relay 1] [Relay] [DEBUG] AES-decrypted payload: type=<class 'bytes'>, len=1090, preview=b'{"next_ip": "10.250.120.196", "next_port": 9102, "session_ke'
[Relay 1] [Relay] [DEBUG] AES-decrypted payload (hex): 7b226e6578745f6970223a202231302e3235302e3132302e313936222c20226e6578745f706f7274223a20393130322c202273657373696f6e5f6b65
[Relay 1] [Relay] [DEBUG] Next hop JSON keys: ['next_ip', 'next_port', 'session_key', 'payload']
[Relay 1] [Relay] [DEBUG] Forwarding to next relay 10.250.120.196:9102
[Relay 2] [Relay] [handle_message ENTERED] addr=('10.250.120.196', 49764), thread=6168817664, relay_port=9102
[Relay 2] [Relay] [DEBUG] Raw data received: b'{"next_ip": "10.250.120.196", "next_port": 9102, "session_key": "o8/ncHOeMKsyTwJw0o0PA3E1PrzCF2rXivA71RRqRqEv6U6581qofkwIQgiHBh40U1xU+gzbYIPZciks04rD0eq0uB5UIULbduK+FWj89HU+I9ndF8jqLPjvL2a0riX3d+3ckbfSwqjldFxbYKYA5ax8tNwdpxzwN21JAf4NTTHlPaN0Zy4QKF7wgU0bSEL2RCiuks9Lr5lJfhKXrMN+VuY/gwnJqoFMwezXrlHsj8pEkTpfyW9lZuIABJIdOVwI/HcmyES3bwJGvFdErRbc3t+euRpx6sH0lXcfXqZ/BM3vCapPNPJ5gnSyLVFrLxx0Ds+EQ2hZyCC5iYhcmEL95g==", "payload": "LffCEFxU4a+Ev6wdlrrOWL/jNFiht/UZDSWZmDKo1CNX26F+E/yCggI6k32mPB9IuQnBs+0Q/rxgSMdXo3qLy9lm9p1/D2p6Fx230bxi9Y+A4KSHkjfHeS7rsEIDkMZSkCi7duzFqzC0eK4G8+7d74VllRLelWeFlVzyNHb6D32dLl6WMeNzKKe4FwiB9bLrWx41oywYeku4PBZbfCLCjtxNXs+smVHRv1HjSuuoiIIb7/jiA82llVTlhaYrINyQ+LR4Q3Nm/9Uv54WvONpugAeaSKRoT12mK/uUqk01sNX/0tugYZbi7LBFBMW22AclIzm4dSlJSzvSD5X+62VP4ayUr59ujC81BPt8DAhQEjDgOxEztAuPEagwBtjujg4pYUJZ5sfngE4xgMEx7BW5uVb/8YVrMuDWFqXLgnseFyPTz4UoOcTFk3aypQgfk191bvgo2ZFpQt6lahKySx4MAT3IitqolHJLEQ0//jFc4q8erAampSZGQ3jQrEJUhq20T3dkERivEE6qvJd2UXkyaaDs7ZeqkD5QadcsZm+N/P8bH1ow5KUdeFWwsuiJA4L9rk8bdFgRVMkr6/9VZhLilSsnuEcc2M3XcgEQXcuvE2mkxh3MYQXoBPyxt1g/n26BCdlkkMwdxni3IOJsHHmVpQ1z"}'
[Relay 2] [Relay] [DEBUG] Data after JSON parse: type=<class 'dict'>, keys=['next_ip', 'next_port', 'session_key', 'payload']
[Relay 2] [Relay] Received session_key (base64): o8/ncHOeMKsyTwJw0o0PA3E1PrzCF2rXivA71RRqRqEv6U6581qofkwIQgiHBh40U1xU+gzbYIPZciks04rD0eq0uB5UIULbduK+FWj89HU+I9ndF8jqLPjvL2a0riX3d+3ckbfSwqjldFxbYKYA5ax8tNwdpxzwN21JAf4NTTHlPaN0Zy4QKF7wgU0bSEL2RCiuks9Lr5lJfhKXrMN+VuY/gwnJqoFMwezXrlHsj8pEkTpfyW9lZuIABJIdOVwI/HcmyES3bwJGvFdErRbc3t+euRpx6sH0lXcfXqZ/BM3vCapPNPJ5gnSyLVFrLxx0Ds+EQ2hZyCC5iYhcmEL95g==
[Relay 2] [Relay] Decoded session_key_enc (hex): a3cfe770739e30ab324f0270d28d0f0371353ebcc2176ad78af03bd5146a46a12fe94eb9f35aa87e4c08420887061e34535c54fa0cdb6083d972292cd38ac3d1eab4b81e542142db76e2be1568fcf4753e23d9dd17c8ea2cf8ef2f66b4ae25f777eddc91b7d2c2a8e5745c5b60a600e5ac7cb4dc1da71cf0376d4901fe0d4d31e53da374672e10285ef0814d1b4842f64428ae92cf4baf99497e1297acc37e56e63f8309c9aa814cc1ecd7ae51ec8fca44913a5fc96f6566e20004921d395c08fc7726c844b76f0246bc5744ad16dcdedf9eb91a71eac1f495771f5ea67f04cdef09aa4f34f2798274b22d516b2f1c740ecf84436859c820b989885c9842fde6
[Relay 2] [Relay] Decrypting session key with fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] Decrypted session_key (hex): b0030658cb5d9d73eacca9b4e24bce18dd05343c185639824322d711bd2f491b
[Relay 2] [Relay] [DEBUG] About to AES-decrypt payload (passing base64 string directly)
[Relay 2] [Relay] [DEBUG] Payload base64-decoded: type=<class 'bytes'>, len=498, preview=b'-\xf7\xc2\x10\\T\xe1\xaf\x84\xbf\xac\x1d\x96\xba\xceX\xbf\xe34X\xa1\xb7\xf5\x19\r%\x99\x982\xa8\xd4#W\xdb\xa1~\x13\xfc\x82\x82\x02:\x93}\xa6<\x1fH\xb9\t\xc1\xb3\xed\x10\xfe\xbc`H\xc7W'
[Relay 2] [Relay] [DEBUG] AES-decrypted payload: type=<class 'bytes'>, len=482, preview=b'{"next_ip": "10.250.120.196", "next_port": 9103, "session_ke'
[Relay 2] [Relay] [DEBUG] AES-decrypted payload (hex): 7b226e6578745f6970223a202231302e3235302e3132302e313936222c20226e6578745f706f7274223a20393130332c202273657373696f6e5f6b65
[Relay 2] [Relay] [DEBUG] Next hop JSON keys: ['next_ip', 'next_port', 'session_key', 'payload']
[Relay 2] [Relay] [DEBUG] Forwarding to next relay 10.250.120.196:9103
[Relay 3] [Relay] [handle_message ENTERED] addr=('10.250.120.196', 49766), thread=6191673344, relay_port=9103
[Relay 3] [Relay] [DEBUG] Raw data received: b'{"next_ip": "10.250.120.196", "next_port": 9103, "session_key": "P0IdAhg3fU8mOLd1THglJlHn5a3nsNWCV14tZirvwsczVzeLZZGTGBKY0Ixh5YR9ji4/Os7ZsiseN5Kvpdbn/cFXYamjd4zMdXulwFGyNWjt4w4DlDzk4wqJVNEF/3xoujimSRcCnwnpflWCvirnDXJk/7MpbCTBuHRYJridiS3ENDOphMdggDKpWbkauRpG5yTXnJPUUpXzM3LFnlAJL+uJPqJEgImJnzOJIK6uKTV+5LN7B9S25+C3jwLiV09D/j/uy18FxO3UEFq/01vQHQqweH/wAVbL5NnQAOaV3u5qCWKJFRu1BnWtp9sZcDJpTLJNxfa434kfAhCGP1z+Ag==", "payload": "HtiU96EGY4btVY3cWQf2bRHgjNkO3fcaNGThnqOmlxOD0gt23Tk3uA=="}'
[Relay 3] [Relay] [DEBUG] Data after JSON parse: type=<class 'dict'>, keys=['next_ip', 'next_port', 'session_key', 'payload']
[Relay 3] [Relay] Received session_key (base64): P0IdAhg3fU8mOLd1THglJlHn5a3nsNWCV14tZirvwsczVzeLZZGTGBKY0Ixh5YR9ji4/Os7ZsiseN5Kvpdbn/cFXYamjd4zMdXulwFGyNWjt4w4DlDzk4wqJVNEF/3xoujimSRcCnwnpflWCvirnDXJk/7MpbCTBuHRYJridiS3ENDOphMdggDKpWbkauRpG5yTXnJPUUpXzM3LFnlAJL+uJPqJEgImJnzOJIK6uKTV+5LN7B9S25+C3jwLiV09D/j/uy18FxO3UEFq/01vQHQqweH/wAVbL5NnQAOaV3u5qCWKJFRu1BnWtp9sZcDJpTLJNxfa434kfAhCGP1z+Ag==
[Relay 3] [Relay] Decoded session_key_enc (hex): 3f421d0218377d4f2638b7754c78252651e7e5ade7b0d582575e2d662aefc2c73357378b659193181298d08c61e5847d8e2e3f3aced9b22b1e3792afa5d6e7fdc15761a9a3778ccc757ba5c051b23568ede30e03943ce4e30a8954d105ff7c68ba38a64917029f09e97e5582be2ae70d7264ffb3296c24c1b8745826b89d892dc43433a984c7608032a959b91ab91a46e724d79c93d45295f33372c59e50092feb893ea2448089899f338920aeae29357ee4b37b07d4b6e7e0b78f02e2574f43fe3feecb5f05c4edd4105abfd35bd01d0ab0787ff00156cbe4d9d000e695deee6a096289151bb50675ada7db197032694cb24dc5f6b8df891f0210863f5cfe02
[Relay 3] [Relay] Decrypting session key with fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] [Relay] Decrypted session_key (hex): b26aaa22e9af972537a48f1663ac174a345aaebb32e06675bb5ea35b23580100
[Relay 3] [Relay] [DEBUG] About to AES-decrypt payload (passing base64 string directly)
[Relay 3] [Relay] [DEBUG] Payload base64-decoded: type=<class 'bytes'>, len=40, preview=b'\x1e\xd8\x94\xf7\xa1\x06c\x86\xedU\x8d\xdcY\x07\xf6m\x11\xe0\x8c\xd9\x0e\xdd\xf7\x1a4d\xe1\x9e\xa3\xa6\x97\x13\x83\xd2\x0bv\xdd97\xb8'
[Relay 3] [Relay] [DEBUG] AES-decrypted payload: type=<class 'bytes'>, len=24, preview=b'{"msg": "Hello, world!"}'
[Relay 3] [Relay] [DEBUG] AES-decrypted payload (hex): 7b226d7367223a202248656c6c6f2c20776f726c6421227d
[Relay 3] [Relay] [DEBUG] Next hop JSON keys: ['msg']
[Relay 3] [Relay] [DEBUG] Payload is not JSON, assuming last hop. Error: 'next_ip'
[Relay 3] [Relay] [Last Hop] Forwarding payload to dest 127.0.0.1:9100, len=24, type=<class 'bytes'>
[Relay 3] [Relay] [Last Hop] Sending to dest: type=<class 'bytes'>, len=24, preview=b'{"msg": "Hello, world!"}'
[Relay 3] [Relay] [Last Hop] Received response from dest: type=<class 'bytes'>, len=50, preview=b'{"result": "OK", "echo": {"msg": "Hello, world!"}}'
[Relay 3] [Relay] [Last Hop] Response from dest decoded as UTF-8: '{"result": "OK", "echo": {"msg": "Hello, world!"}}'
[Relay 3] [Relay] [Last Hop] Response from dest (hex): 7b22726573756c74223a20224f4b222c20226563686f223a207b226d7367223a202248656c6c6f2c20776f726c6421227d7d
[Relay 3] [Relay] [Last Hop] About to AES-encrypt response: type=<class 'bytes'>, len=50, preview=b'{"result": "OK", "echo": {"msg": "Hello, world!"}}'
[Relay 3] [Relay] [Last Hop] AES-encrypted response (hex): f9fa6357136e46181fc3c47822167730b554ec8bebb746570ab6fd97df83bef8e5d9e35f19efc6ee000d6ad9d1145a8119f0b65423dfd7bdaa5064de
[Relay 3] [Relay] [Last Hop] Base64-encoded AES-encrypted response: type=<class 'bytes'>, len=88, preview=b'+fpjVxNuRhgfw8R4IhZ3MLVU7Ivrt0ZXCrb9l9+Dvvjl2eNfGe/G7gANatnR'
[Relay 3] [Relay] [Last Hop] Sent response to ('10.250.120.196', 49766): b'+fpjVxNuRhgfw8R4IhZ3MLVU7Ivrt0ZXCrb9l9+Dvvjl2eNfGe/G7gANatnR'... (len=88)
[Relay 2] [Relay] [DEBUG] Received response from next relay: type=<class 'bytes'>, len=88, preview=b'+fpjVxNuRhgfw8R4IhZ3MLVU7Ivrt0ZXCrb9l9+Dvvjl2eNfGe/G7gANatnR'
[Relay 2] [Relay] [DEBUG] Response base64-decoded from next relay: type=<class 'bytes'>, len=66, preview=b'\xf9\xfacW\x13nF\x18\x1f\xc3\xc4x"\x16w0\xb5T\xec\x8b\xeb\xb7FW\n\xb6\xfd\x97\xdf\x83\xbe\xf8\xe5\xd9\xe3_\x19\xef\xc6\xee\x00\rj\xd9\xd1\x14Z\x81\x19\xf0\xb6T#\xdf\xd7\xbd\xaaPd\xde'
[Relay 3] [Relay] [handle_message END] addr=('10.250.120.196', 49766), thread=6191673344
[Relay 2] [Relay] [DEBUG] Encrypted response for previous hop: type=<class 'bytes'>, len=112, preview=b'BicCt+jwdSKsPDvftGc1xMZw0bBMlnl2Ly4jsUepDzEMMlzqeIw6j21ki1o6'
[Relay 2] [Relay] [handle_message END] addr=('10.250.120.196', 49764), thread=6168817664
[Relay 1] [Relay] [DEBUG] Received response from next relay: type=<class 'bytes'>, len=112, preview=b'BicCt+jwdSKsPDvftGc1xMZw0bBMlnl2Ly4jsUepDzEMMlzqeIw6j21ki1o6'
[Relay 1] [Relay] [DEBUG] Response base64-decoded from next relay: type=<class 'bytes'>, len=82, preview=b'\x06\'\x02\xb7\xe8\xf0u"\xac<;\xdf\xb4g5\xc4\xc6p\xd1\xb0L\x96yv/.#\xb1G\xa9\x0f1\x0c2\\\xeax\x8c:\x8fmd\x8bZ:\x1f?\xe2\x8cd{\x9a\xd1\x03\xa3B\t\xec3\xbf'
[Relay 1] [Relay] [DEBUG] Encrypted response for previous hop: type=<class 'bytes'>, len=132, preview=b'91kdUQd4cPoc3tJSu/giEFbeoaoMyr2rCol/0tS64qxC8vGLdmAnSxyGJHZs'
[Relay] ---- Relay process started ----
[Relay 1] [Relay] Loaded persistent RSA keypair from relay1_key.pem
[Relay 1] [Relay] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] [KEY] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] Relay 1 starting on 10.250.120.196:9101 (RELAY PORT 9101)
[Relay 1] Registering with CDS at 127.0.0.1:9000
[Relay 1] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9101, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5MM7/HBECV26fZqjUJkt\nQ4+dx297cL0hf1+rf08Qir5tL/lArfQsiplTqcsIsZiN7vJ8K2XzvK5JAEv8tVE4\nEKU4W1hbEVBd1eLCX+Oc5XauTbWhW8xlc2wdNlNwDhin2Mw84doKJWPyfjtIwnIi\n3nWHqxLyAqkj6qDoByA8D7YVmJxvzwL0mrYE8G8b4Q4Wjnx2SXeTwc9LRzqwrsyb\nlM5B4BSVPBignOMhD2AfuIFw6uULQThbkL9L5AnQA08B4Gqzo731LLJN/Y6qo+VJ\nki2t6m1aJTG0LBjijpH7CtnN1MHIQ5UueS1sJVYZooYxkxEYYZTqIUXxuI5ICKPC\nCQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 1] [Relay] Listening for incoming messages on port 9101 (RELAY PORT 9101)
[Relay] ---- Relay process started ----
[Relay 2] [Relay] Loaded persistent RSA keypair from relay2_key.pem
[Relay 2] [Relay] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] [KEY] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] Relay 2 starting on 10.250.120.196:9102 (RELAY PORT 9102)
[Relay 2] Registering with CDS at 127.0.0.1:9000
[Relay 2] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9102, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA58J3pSrOQd4hYnuzQQ7q\nWrjjo+3BJp+ik23brR2yl0kjtfH+wjD9LYWHS7dBxsDRzSozJ/7EWKKNCaTsgvaF\nN6vpyBPqDM/uQfOWfirteL50RgDZw95Vml4Fuay7bTBEb1J8ydvFqawo8rnLE2I3\nU4BjBT+CD38bY3je8wrrCX9fo1uYaLDlfteGshadZ2gnTxrAzkZZ/CTFdyb8JrmN\nIuxjBVjwSA/uIv+KHWQhXRA5jJPXcNV88LYXyEzpid1Cr9gnrqA88K0HSleiwZjU\nJF3LhBvS2Ga2HHfFsk5D/yz/pTHwDvRA98VMT/90wahwmSJsck4XWDFhmNhy3oDR\nBQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 2] [Relay] Listening for incoming messages on port 9102 (RELAY PORT 9102)
[Relay] ---- Relay process started ----
[Relay 3] [Relay] Loaded persistent RSA keypair from relay3_key.pem
[Relay 3] [Relay] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] [Relay] [KEY] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] Relay 3 starting on 10.250.120.196:9103 (RELAY PORT 9103)
[Relay 3] Registering with CDS at 127.0.0.1:9000
[Relay 3] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9103, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5k9OJ8m3IdjmwR1skM1G\nwrKkwlYLK0Qs+I/BX5ww5wEakOsTy5NVFAwTYrCUnR012u2jCwI8wV1YpPaMa8RJ\ntnqNFy4pFfqBh5tmidHQ3QMRvINPrGtQM5+VgMXoA0y8izql52M1K/3Q6sHVlAXd\nmpQcBO+JSHY7uyVx1txZssyisia7Nn8Frh/XRpl0oUvGkSnbm/KgqDAP0xJ3lUZS\nEGiIWdf0bn7tHD3nYBMrWWi3jSQWf0Q80asIEYWipwkfMPf0ffzu4FX0elfvpyOX\nr50xk7sb8K5IhcilwxKxQpPOcq3f6ph0EERQR7pOdDqkzFdHoGiyssSX4MYM60kd\nmQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 3] [Relay] Listening for incoming messages on port 9103 (RELAY PORT 9103)
[Relay 3] [Relay] [handle_message ENTERED] addr=('10.250.120.196', 51302), thread=6158299136, relay_port=9103
[Relay 3] [Relay] [DEBUG] Raw data received: b'{"next_ip": "10.250.120.196", "next_port": 9103, "session_key": "5LI2UyJGpR+Ic2orFL/n9DtY/8Zqps7lXeGhTqvzU1N6DhSx3Dbkoeb8jvKbCmDAOfnBSTlRBuRwukmH7aeQzRmFXE2Rgu4w7p1mp3WNqtXXE4FO8sEaRFaWED/BV4+WZAufRK1YkeVf7oRwW2IdClARifRreA4RDoDD7jG9NxpRsvCTtHoGKMQgVn+W/HRbmccYRtuKDDDkbDGjUhnYE7TcSNPtDx+YCF8iRe1iKTviHQbB1WPib5mXDgWZ7whSvNxJ6R8dQBi86/1DhFJFdBdyn5kAAYv+RJWNFA+BUdCHh+WPz58m3kYednc4nDDxXT7xxzacezN9eSOGpdr1vw==", "payload": "3DXmzIBUg5G/DzVKZFZs/lZgWFxLWescuoPymZj6R2oIG4HdqyHbPZ1M60RS8mE0csu90iBeWTUDDB25+iKFNAZmsNZ13vz/3vO6DBBemgqii98nF7WCxZyuKDSYQIo4WvsIKvI+xGEtrOtL8u6sGvDVqPoWR5crUMYhI4JpayYbIEN019909MDbmE9n4S5b+8UyoTVYhHCPuCUVMzPGJblbhTR9z42cIvneaM/+/g1I8ySlYkP4YHOuqrVeWml45tnup1ehLIVWYhfFN2iP8RWUGU5dzA+I5QjBVWH1pGw9uQJwxJeLpVbbTpyHQ54P7p1uU7Ylo47x0O3lTgnHr0ZOFDMaT+3O6ng6w4u45/zzcomiZS9DAZSlzGiro+kPgW3cTLujHP2mhoyB2q3ecND/m4xYrRmerxPczaPc7WeaH7QQKh7hb38zn7rEeoW+4E6jbc9i1R5aZj3yxrjg9bhTw59k/NgbKoZ6yI/On+PCR5QJ9Upi5V8wPG5AnC/bOPK8Aap6u/TemKeM+IlSWpH/byq2zGzoFhy93JhDFTje8iWZfSErnHKhf1rGT9BnFKJZzPH2vYm3MezIXvH6Fpx50dbk+cpbJrcBqpy2L5D02ETwFDtkG0dyytrXWc1vgM14InOPFKHUB6WpcYJwb9651gQGH1y80uwedLJYaZP3n7fnDnXvAdL52ivjqXQTE5SfiTh8cIegvrSZ6IS3Ve4qGH6E6F6j71WKPrbw0GzwWaUlPQfSIN93ml7pqZof6lwhbTn8wSrs0Pu4OIcQQOkbEN97is8AFDofQWEswdNVObR6CZCa7fT1UartRCjXnKVBQmOkxah8q9Opig6w2qWaTE950I9m0RagPTzEaPIE0SNxAJCi6UqaQcIgBd8qDQfecbfb5BoLylOqqqKwxvCrMNX2zMIqgRJcCHV4+H178RrGchJDgRz1gTVodks3W/dCdmFHUVrIeAJ7JehTqTyFteRGOwdnJgt0a7u14b5B0g5syrrhtt7jfW+oH2YfR3dkqBip41zPFdxqzf8HD3Ili/dqGd3OjF1aUBw6oQXCirw0m1Gno/p9T7xaD5MU8dFfPN34AoWjYQa3FHAnIfHDdhKRYvmoOLdn+d86bGCJEeSJLwYUrve3U+7ZEiuJhUzlubCGCfYINSo+CsO4wqhOuMdq4RkVd6EE3BzJmdNwx/Ymb2UWGQ6jY37kTYK987Czq0Q4c9DgiK+NeRBZ0q+Lwg0Wj0GoW+gJKV4m7X+9TJs/oeQkZ14cxcx/lVEpcAEzdbPasT6ZcuIrN7EM//Aziw5ZiV+APoJc5kN5IQrYbPbvhbszyihTCW8iQEwDZrFY/cb9yZ6pDTqEOlnrYR8juJ3IARTpSD6at94IzNqyIoY7jNYmeZLqND5cYqowJ5R9LOM81i+JyncJjUEeM/u5hBoOt8nD7bBXwoFkGG7RErJkdqvO/787+6zYV7eD2HY="}'
[Relay 3] [Relay] [DEBUG] Data after JSON parse: type=<class 'dict'>, keys=['next_ip', 'next_port', 'session_key', 'payload']
[Relay 3] [Relay] Received session_key (base64): 5LI2UyJGpR+Ic2orFL/n9DtY/8Zqps7lXeGhTqvzU1N6DhSx3Dbkoeb8jvKbCmDAOfnBSTlRBuRwukmH7aeQzRmFXE2Rgu4w7p1mp3WNqtXXE4FO8sEaRFaWED/BV4+WZAufRK1YkeVf7oRwW2IdClARifRreA4RDoDD7jG9NxpRsvCTtHoGKMQgVn+W/HRbmccYRtuKDDDkbDGjUhnYE7TcSNPtDx+YCF8iRe1iKTviHQbB1WPib5mXDgWZ7whSvNxJ6R8dQBi86/1DhFJFdBdyn5kAAYv+RJWNFA+BUdCHh+WPz58m3kYednc4nDDxXT7xxzacezN9eSOGpdr1vw==
[Relay 3] [Relay] Decoded session_key_enc (hex): e4b236532246a51f88736a2b14bfe7f43b58ffc66aa6cee55de1a14eabf353537a0e14b1dc36e4a1e6fc8ef29b0a60c039f9c149395106e470ba4987eda790cd19855c4d9182ee30ee9d66a7758daad5d713814ef2c11a445696103fc1578f96640b9f44ad5891e55fee84705b621d0a501189f46b780e110e80c3ee31bd371a51b2f093b47a0628c420567f96fc745b99c71846db8a0c30e46c31a35219d813b4dc48d3ed0f1f98085f2245ed62293be21d06c1d563e26f99970e0599ef0852bcdc49e91f1d4018bcebfd438452457417729f9900018bfe44958d140f8151d08787e58fcf9f26de461e7677389c30f15d3ef1c7369c7b337d792386a5daf5bf
[Relay 3] [Relay] Decrypting session key with fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] [Relay] Decrypted session_key (hex): 0bb2a9b9d52f0f15d9302e710666e10d873246b57ea38f1d9b0da17d9466b1b1
[Relay 3] [Relay] [DEBUG] About to AES-decrypt payload (passing base64 string directly)
[Relay 3] [Relay] [DEBUG] Payload base64-decoded: type=<class 'bytes'>, len=1106, preview=b'\xdc5\xe6\xcc\x80T\x83\x91\xbf\x0f5JdVl\xfeV`X\\KY\xeb\x1c\xba\x83\xf2\x99\x98\xfaGj\x08\x1b\x81\xdd\xab!\xdb=\x9dL\xebDR\xf2a4r\xcb\xbd\xd2 ^Y5\x03\x0c\x1d\xb9'
[Relay 3] [Relay] [DEBUG] AES-decrypted payload: type=<class 'bytes'>, len=1090, preview=b'{"next_ip": "10.250.120.196", "next_port": 9101, "session_ke'
[Relay 3] [Relay] [DEBUG] AES-decrypted payload (hex): 7b226e6578745f6970223a202231302e3235302e3132302e313936222c20226e6578745f706f7274223a20393130312c202273657373696f6e5f6b65
[Relay 3] [Relay] [DEBUG] Next hop JSON keys: ['next_ip', 'next_port', 'session_key', 'payload']
[Relay 3] [Relay] [DEBUG] Forwarding to next relay 10.250.120.196:9101
[Relay 1] [Relay] [handle_message ENTERED] addr=('10.250.120.196', 51314), thread=6188888064, relay_port=9101
[Relay 1] [Relay] [DEBUG] Raw data received: b'{"next_ip": "10.250.120.196", "next_port": 9101, "session_key": "H7at0pqN9f9Mo3mM+NXMyWCW3LdyKkw+MBDRoQgwXssyb+UajmVIaX/nkzZ8WWkdNv+5P+8T0sZloydcwT0NEJxxw1yuBb8AKxUh8rknLSXGGBbos5nGdFPjdBd/yTjAkz7cI6g9OGP/yPH9MnL8MjxxqzTLGmcoOGodLxMaJa+Nj/2qtwsroT7jyaVsCnlDNj1X4RbhQi4TCCO9Sm9LRK83BSioxCsBxYhHG7ixQY688CZrztD2i3cdSI4Ht08lsuizn9GpNb8r6ObyxXvyX17VKukVVm4GyrG3UlSQqOTMwlX3J01uhMmOyGoj7pUo8qzXaliMjXAPQYNcE7eXmw==", "payload": "Ol3ujohjwyFQ4ElFoWpYraSP+W0wgic6aGt3/afwMjl1BaKCMquj+XbQAKCiX5jRHC9SneTAJcG2kCyzM7GVfTcu07Lu3bwc+tEbl7oY8MzFFJWnFKqlEpLVuLL2Pd64jt/H199K4J76w2qS7jmIyoCngP7Mwc9r12MhMniyMVwrNgwX0+XeKXPmmijgxsmMz/jSiD0Hv3G7t/abB/zVvJCtVNl3OQOdopFF8CCzzaXlVsut3B/vbZ+0EavrU3lpk/9UGCszFxx6j+JwVbxeUU7VpRuOtO6dX3CBEcay0hc7Ms+2dALmnTl8fJOPnBp50GVHdYlrhcPfoAlcuReclVSSnMyCRNIzvAJiChOw1SlfaIE6xIQfFrFMH0y+jqpF+j/Z7CMixHqlPjJH7ngXbgKRbOHeh6kve34itzjJU4hvOqiHx16VXl9GJmeS+7xVB1805QN3+RcmHNePZbiF2JMZPUsq/BUrhyVYkd7ClKREHJzo6kro0l//HBBwCGROvVOuD7SF+uYSHT6FJyJ+GMlTaYeKJDdRvpTkOs6PSOGR2uPMBCCwHSSy2Vh16zOoWAiZUj7hHiz5OSRjfQk+cYr/5C8A1u/DwHxf3jaLZyBKn75+Wmx646hTdP1l880vmR+6RB/Az0j+Ltn/zRmXHZwA"}'
[Relay 1] [Relay] [DEBUG] Data after JSON parse: type=<class 'dict'>, keys=['next_ip', 'next_port', 'session_key', 'payload']
[Relay 1] [Relay] Received session_key (base64): H7at0pqN9f9Mo3mM+NXMyWCW3LdyKkw+MBDRoQgwXssyb+UajmVIaX/nkzZ8WWkdNv+5P+8T0sZloydcwT0NEJxxw1yuBb8AKxUh8rknLSXGGBbos5nGdFPjdBd/yTjAkz7cI6g9OGP/yPH9MnL8MjxxqzTLGmcoOGodLxMaJa+Nj/2qtwsroT7jyaVsCnlDNj1X4RbhQi4TCCO9Sm9LRK83BSioxCsBxYhHG7ixQY688CZrztD2i3cdSI4Ht08lsuizn9GpNb8r6ObyxXvyX17VKukVVm4GyrG3UlSQqOTMwlX3J01uhMmOyGoj7pUo8qzXaliMjXAPQYNcE7eXmw==
[Relay 1] [Relay] Decoded session_key_enc (hex): 1fb6add29a8df5ff4ca3798cf8d5ccc96096dcb7722a4c3e3010d1a108305ecb326fe51a8e6548697fe793367c59691d36ffb93fef13d2c665a3275cc13d0d109c71c35cae05bf002b1521f2b9272d25c61816e8b399c67453e374177fc938c0933edc23a83d3863ffc8f1fd3272fc323c71ab34cb1a6728386a1d2f131a25af8d8ffdaab70b2ba13ee3c9a56c0a7943363d57e116e1422e130823bd4a6f4b44af370528a8c42b01c588471bb8b1418ebcf0266bced0f68b771d488e07b74f25b2e8b39fd1a935bf2be8e6f2c57bf25f5ed52ae915566e06cab1b7525490a8e4ccc255f7274d6e84c98ec86a23ee9528f2acd76a588c8d700f41835c13b7979b
[Relay 1] [Relay] Decrypting session key with fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] Decrypted session_key (hex): 4611f5962664967d4de3def64489a35f6c1c9e794dc90ba172d2a70886d85679
[Relay 1] [Relay] [DEBUG] About to AES-decrypt payload (passing base64 string directly)
[Relay 1] [Relay] [DEBUG] Payload base64-decoded: type=<class 'bytes'>, len=498, preview=b":]\xee\x8e\x88c\xc3!P\xe0IE\xa1jX\xad\xa4\x8f\xf9m0\x82':hkw\xfd\xa7\xf029u\x05\xa2\x822\xab\xa3\xf9v\xd0\x00\xa0\xa2_\x98\xd1\x1c/R\x9d\xe4\xc0%\xc1\xb6\x90,\xb3"
[Relay 1] [Relay] [DEBUG] AES-decrypted payload: type=<class 'bytes'>, len=482, preview=b'{"next_ip": "10.250.120.196", "next_port": 9102, "session_ke'
[Relay 1] [Relay] [DEBUG] AES-decrypted payload (hex): 7b226e6578745f6970223a202231302e3235302e3132302e313936222c20226e6578745f706f7274223a20393130322c202273657373696f6e5f6b65
[Relay 1] [Relay] [DEBUG] Next hop JSON keys: ['next_ip', 'next_port', 'session_key', 'payload']
[Relay 1] [Relay] [DEBUG] Forwarding to next relay 10.250.120.196:9102
[Relay 2] [Relay] [handle_message ENTERED] addr=('10.250.120.196', 51318), thread=6196948992, relay_port=9102
[Relay 2] [Relay] [DEBUG] Raw data received: b'{"next_ip": "10.250.120.196", "next_port": 9102, "session_key": "U1eAz6MEfilL0dVcQ9HWFmrBXCoQDq1nhdUUq2DbWmIbn5RvlkkGFJ9bBCAyVVB3QC02Rk2VpCLuuIIDDQtrQk6cIa8cISAbFUVWTAwwYlcgIV6WDkd+1h04p8XEhGo1BuMLfT8ZJhBorrkdW4+2wldMKpZQvWA2+VXV55wsmp8DLHZX8bWJsapKmDD5JuPx9ROROjwSJOWikU6i0L6FCOxz2JT+zMqixPO2npU4KfQaS4TsVUM+TTtk8H1Mdg9GfcsxA78gJY53/8QXtZtJuEuXCOrBIBMnsfrCh0zSxSk+9mJ7Y4JuFFGlYdN/zWS02IrQIClFEg03mCW0h3k+bg==", "payload": "acgy61qMn9RBGZQOq8VvZKPAfoTp3Vvz2WXUflgi+VivzZXSUWo8qw=="}'
[Relay 2] [Relay] [DEBUG] Data after JSON parse: type=<class 'dict'>, keys=['next_ip', 'next_port', 'session_key', 'payload']
[Relay 2] [Relay] Received session_key (base64): U1eAz6MEfilL0dVcQ9HWFmrBXCoQDq1nhdUUq2DbWmIbn5RvlkkGFJ9bBCAyVVB3QC02Rk2VpCLuuIIDDQtrQk6cIa8cISAbFUVWTAwwYlcgIV6WDkd+1h04p8XEhGo1BuMLfT8ZJhBorrkdW4+2wldMKpZQvWA2+VXV55wsmp8DLHZX8bWJsapKmDD5JuPx9ROROjwSJOWikU6i0L6FCOxz2JT+zMqixPO2npU4KfQaS4TsVUM+TTtk8H1Mdg9GfcsxA78gJY53/8QXtZtJuEuXCOrBIBMnsfrCh0zSxSk+9mJ7Y4JuFFGlYdN/zWS02IrQIClFEg03mCW0h3k+bg==
[Relay 2] [Relay] Decoded session_key_enc (hex): 535780cfa3047e294bd1d55c43d1d6166ac15c2a100ead6785d514ab60db5a621b9f946f964906149f5b042032555077402d36464d95a422eeb882030d0b6b424e9c21af1c21201b1545564c0c30625720215e960e477ed61d38a7c5c4846a3506e30b7d3f19261068aeb91d5b8fb6c2574c2a9650bd6036f955d5e79c2c9a9f032c7657f1b589b1aa4a9830f926e3f1f513913a3c1224e5a2914ea2d0be8508ec73d894fecccaa2c4f3b69e953829f41a4b84ec55433e4d3b64f07d4c760f467dcb3103bf20258e77ffc417b59b49b84b9708eac1201327b1fac2874cd2c5293ef6627b63826e1451a561d37fcd64b4d88ad0202945120d379825b487793e6e
[Relay 2] [Relay] Decrypting session key with fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] Decrypted session_key (hex): 9acaf55d4d59bf57492c57da7ea6a50f70cb2115f9b2fb59d8fc2be63a265b74
[Relay 2] [Relay] [DEBUG] About to AES-decrypt payload (passing base64 string directly)
[Relay 2] [Relay] [DEBUG] Payload base64-decoded: type=<class 'bytes'>, len=40, preview=b'i\xc82\xebZ\x8c\x9f\xd4A\x19\x94\x0e\xab\xc5od\xa3\xc0~\x84\xe9\xdd[\xf3\xd9e\xd4~X"\xf9X\xaf\xcd\x95\xd2Qj<\xab'
[Relay 2] [Relay] [DEBUG] AES-decrypted payload: type=<class 'bytes'>, len=24, preview=b'{"msg": "Hello, world!"}'
[Relay 2] [Relay] [DEBUG] AES-decrypted payload (hex): 7b226d7367223a202248656c6c6f2c20776f726c6421227d
[Relay 2] [Relay] [DEBUG] Next hop JSON keys: ['msg']
[Relay 2] [Relay] [DEBUG] Payload is not JSON, assuming last hop. Error: 'next_ip'
[Relay 2] [Relay] [Last Hop] Forwarding payload to dest 127.0.0.1:9100, len=24, type=<class 'bytes'>
[Relay 2] [Relay] [Last Hop] Sending to dest: type=<class 'bytes'>, len=24, preview=b'{"msg": "Hello, world!"}'
[Relay 2] [Relay] [Last Hop] Received response from dest: type=<class 'bytes'>, len=50, preview=b'{"result": "OK", "echo": {"msg": "Hello, world!"}}'
[Relay 2] [Relay] [Last Hop] Response from dest decoded as UTF-8: '{"result": "OK", "echo": {"msg": "Hello, world!"}}'
[Relay 2] [Relay] [Last Hop] Response from dest (hex): 7b22726573756c74223a20224f4b222c20226563686f223a207b226d7367223a202248656c6c6f2c20776f726c6421227d7d
[Relay 2] [Relay] [Last Hop] About to AES-encrypt response: type=<class 'bytes'>, len=50, preview=b'{"result": "OK", "echo": {"msg": "Hello, world!"}}'
[Relay 2] [Relay] [Last Hop] AES-encrypted response (hex): 11858b4266d41273d483d319b02e0e49e93d29cf7a62d7b0c0d6d70f50747ef84006cfe4977107fafef56bed9b2cb2ed238848a644a1689217fdce7b
[Relay 2] [Relay] [Last Hop] Base64-encoded AES-encrypted response: type=<class 'bytes'>, len=88, preview=b'EYWLQmbUEnPUg9MZsC4OSek9Kc96YtewwNbXD1B0fvhABs/kl3EH+v71a+2b'
[Relay 2] [Relay] [Last Hop] Sent response to ('10.250.120.196', 51318): b'EYWLQmbUEnPUg9MZsC4OSek9Kc96YtewwNbXD1B0fvhABs/kl3EH+v71a+2b'... (len=88)
[Relay 1] [Relay] [DEBUG] Received response from next relay: type=<class 'bytes'>, len=88, preview=b'EYWLQmbUEnPUg9MZsC4OSek9Kc96YtewwNbXD1B0fvhABs/kl3EH+v71a+2b'
[Relay 2] [Relay] [handle_message END] addr=('10.250.120.196', 51318), thread=6196948992
[Relay 1] [Relay] [RETURN] Base64-decoded response: type=<class 'bytes'>, len=66, preview=b'\x11\x85\x8bBf\xd4\x12s\xd4\x83\xd3\x19\xb0.\x0eI\xe9=)\xcfzb\xd7\xb0\xc0\xd6\xd7\x0fPt~\xf8@\x06\xcf\xe4\x97q\x07\xfa\xfe\xf5k\xed\x9b,\xb2\xed#\x88H\xa6D\xa1h\x92\x17\xfd\xce{'
[Relay 1] [Relay] [RETURN] AES-decrypted response: type=<class 'bytes'>, len=50, preview=b'\x16\xafm\xb1)\xfe*\xfc\\\xa9\x0e\x12\xa3\xe7\xa0\xe7>\x92\x00\xdc\xfb\xd8\xf38|\x1d\xe3\xbc\x05\x88N\xbeJ\xa3\xa9\xc9\x97L#\x89\xbah\xf3X\xf9\xc3\xba@\xc0@'
[Relay 1] [Relay] [RETURN] AES-decrypted response not UTF-8: 'utf-8' codec can't decode byte 0xaf in position 1: invalid start byte
[Relay 1] [Relay] [RETURN] AES-encrypted response (hex): bbc45b30ece4b977dd0dbdc55a17181c4fd4638dd4e2b4abeff69107d75652e35011c5e080dd9260a67151ba32c673fd714c50b458d8a730550140a4
[Relay 1] [Relay] [RETURN] Base64-encoded AES-encrypted response: type=<class 'bytes'>, len=112, preview=b'u8RbMOzkuXfdDb3FWhcYHE/UY43U4rSr7/aRB9dWUuNQEcXggN2SYKZxUboy'
[Relay 1] [Relay] [handle_message END] addr=('10.250.120.196', 51314), thread=6188888064
[Relay 3] [Relay] [DEBUG] Received response from next relay: type=<class 'bytes'>, len=112, preview=b'u8RbMOzkuXfdDb3FWhcYHE/UY43U4rSr7/aRB9dWUuNQEcXggN2SYKZxUboy'
[Relay 3] [Relay] [RETURN] Base64-decoded response: type=<class 'bytes'>, len=82, preview=b'\xbb\xc4[0\xec\xe4\xb9w\xdd\r\xbd\xc5Z\x17\x18\x1cO\xd4c\x8d\xd4\xe2\xb4\xab\xef\xf6\x91\x07\xd7VR\xe3P\x11\xc5\xe0\x80\xdd\x92`\xa6qQ\xba2\xc6s\xfdqLP\xb4X\xd8\xa70U\x01@\xa4'
[Relay 3] [Relay] [RETURN] AES-decrypted response: type=<class 'bytes'>, len=66, preview=b'!\x0c\x9cd?\xb4g\xebYc\x02\xd0\xe8\x99\xd7\x08\n\x86Uz\xcf\'~\xb0\\.\x89\xfa\xf8mY\x81Y\x0f?p\xae\xe3&gK\xf3\x90\xf8x\x18"\x9b\x10\xd1\xae\x91\xb6\xc0F\x83\xd6@ ;'
[Relay 3] [Relay] [RETURN] AES-decrypted response not UTF-8: 'utf-8' codec can't decode byte 0x9c in position 2: invalid start byte
[Relay 3] [Relay] [RETURN] AES-encrypted response (hex): c0bf58fe5cd304ae786d74fc9db03273cddc272b930d83502574e559077078fcfdbf6bb492c8fe986124db5af7f3d94a502132cbc22912d6a7f5815f
[Relay 3] [Relay] [RETURN] Base64-encoded AES-encrypted response: type=<class 'bytes'>, len=132, preview=b'wL9Y/lzTBK54bXT8nbAyc83cJyuTDYNQJXTlWQdwePz9v2u0ksj+mGEk21r3'
[Relay] ---- Relay process started ----
[Relay 1] [Relay] Loaded persistent RSA keypair from relay1_key.pem
[Relay 1] [Relay] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] [KEY] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] Relay 1 starting on 10.250.120.196:9101 (RELAY PORT 9101)
[Relay 1] Registering with CDS at 127.0.0.1:9000
[Relay 1] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9101, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5MM7/HBECV26fZqjUJkt\nQ4+dx297cL0hf1+rf08Qir5tL/lArfQsiplTqcsIsZiN7vJ8K2XzvK5JAEv8tVE4\nEKU4W1hbEVBd1eLCX+Oc5XauTbWhW8xlc2wdNlNwDhin2Mw84doKJWPyfjtIwnIi\n3nWHqxLyAqkj6qDoByA8D7YVmJxvzwL0mrYE8G8b4Q4Wjnx2SXeTwc9LRzqwrsyb\nlM5B4BSVPBignOMhD2AfuIFw6uULQThbkL9L5AnQA08B4Gqzo731LLJN/Y6qo+VJ\nki2t6m1aJTG0LBjijpH7CtnN1MHIQ5UueS1sJVYZooYxkxEYYZTqIUXxuI5ICKPC\nCQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 1] [Relay] Listening for incoming messages on port 9101 (RELAY PORT 9101)
[Relay] ---- Relay process started ----
[Relay 2] [Relay] Loaded persistent RSA keypair from relay2_key.pem
[Relay 2] [Relay] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] [KEY] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] Relay 2 starting on 10.250.120.196:9102 (RELAY PORT 9102)
[Relay 2] Registering with CDS at 127.0.0.1:9000
[Relay 2] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9102, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA58J3pSrOQd4hYnuzQQ7q\nWrjjo+3BJp+ik23brR2yl0kjtfH+wjD9LYWHS7dBxsDRzSozJ/7EWKKNCaTsgvaF\nN6vpyBPqDM/uQfOWfirteL50RgDZw95Vml4Fuay7bTBEb1J8ydvFqawo8rnLE2I3\nU4BjBT+CD38bY3je8wrrCX9fo1uYaLDlfteGshadZ2gnTxrAzkZZ/CTFdyb8JrmN\nIuxjBVjwSA/uIv+KHWQhXRA5jJPXcNV88LYXyEzpid1Cr9gnrqA88K0HSleiwZjU\nJF3LhBvS2Ga2HHfFsk5D/yz/pTHwDvRA98VMT/90wahwmSJsck4XWDFhmNhy3oDR\nBQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 2] [Relay] Listening for incoming messages on port 9102 (RELAY PORT 9102)
[Relay] ---- Relay process started ----
[Relay 3] [Relay] Loaded persistent RSA keypair from relay3_key.pem
[Relay 3] [Relay] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] [Relay] [KEY] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] Relay 3 starting on 10.250.120.196:9103 (RELAY PORT 9103)
[Relay 3] Registering with CDS at 127.0.0.1:9000
[Relay 3] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9103, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5k9OJ8m3IdjmwR1skM1G\nwrKkwlYLK0Qs+I/BX5ww5wEakOsTy5NVFAwTYrCUnR012u2jCwI8wV1YpPaMa8RJ\ntnqNFy4pFfqBh5tmidHQ3QMRvINPrGtQM5+VgMXoA0y8izql52M1K/3Q6sHVlAXd\nmpQcBO+JSHY7uyVx1txZssyisia7Nn8Frh/XRpl0oUvGkSnbm/KgqDAP0xJ3lUZS\nEGiIWdf0bn7tHD3nYBMrWWi3jSQWf0Q80asIEYWipwkfMPf0ffzu4FX0elfvpyOX\nr50xk7sb8K5IhcilwxKxQpPOcq3f6ph0EERQR7pOdDqkzFdHoGiyssSX4MYM60kd\nmQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 3] [Relay] Listening for incoming messages on port 9103 (RELAY PORT 9103)
[Relay 2] [Relay] [handle_message ENTERED] addr=('10.250.120.196', 51697), thread=6196899840, relay_port=9102
[Relay 2] [Relay] [DEBUG] Raw data received: b'{"next_ip": "10.250.120.196", "next_port": 9102, "session_key": "h37w6bxCUxrrs/vYHp5GvGPq2jjj1ZeHOI0r8YXitgc80zLZEsig7bVEBPvlRQcMag/6p/GC6YNK21jjGARAJw0eS+B9rrlW2hxdhDeODCbjZ/vt3Ztp3ByKNdmhQMP1Fkx7ArT1Pmqmsn86qYXRvwBZjzwswEk50tf1NTK4tsYhLOMENYLhoqJyO40VBZVdKqk/zihF5rU9Mm5LY0Kd8TZ+1+rACoBNcx/azaE9q5sB61GXz+kELar8XIo3YJYRbNpZ6pKi5lMmFHcEvH0SMmTkddg5WaQXpj/cUPR+6j2dKZIeQFUzt+6no8iuh7bl0i7Mx2cAXbkakqSuhX2AgQ==", "payload": "zulAI8Y9z47Nbixt9l0QrRF9jx9EIWQQZnaqAMxJyClIkCO+7XDxHfjcquZNx+1d7KKE6BrKqjVP/LQbgRsGAAQGU/28PGF2h4bnU+Pqr2/QKbF1IgZ6Jcf7lxOZDurlWe00CF9hvb4XYeoXJH4XKPcLPg6tIARVwmZmXDGyuzUBezAH30E1lNhk2ViY+K3WvFCBvaN8he1Vhhg1DkkWqw+vBqzToDIe6L+mi0q/cP5zskQZjrU4cBPDAJ0a1c6P8nNi2KoGPN4g+uexIV81XaEMSlmwUGGk/rvV3PHXvntZ3KT1+oZrMxFkKw/klKk6Q4BIopJiymOzgoSKdI+FltD8j0l85pNiUDLiPoXqVHZeWFMFNujYLbTiZtdJmJ+iSMcWsfzOeTU49XOgwq5cYqXRNQOs5xzeubyZa/rDmqmnn54ODSnhPH2VgcYI37MR0+Zc2K8a9Qp7zqaUIiOwYZY9pEqGmTCbHOJNl86Wx5HkFIjA8nF0NxYYzRqF1G2VzkS1VtG8inmN+3pg3pfg1Q4X8uEGvaIJi/DbR1M1hX179GdCATCTsk1t3eSR4Q7j4Tgi1SaAH3eylJA67M2WQMdcpuFOn6LhYylE0Y9e2pSHrogJW3wSYKgCllNDT5rGJ0aEGKPuvl6000UCFmRMsCaYprOkCN14qhc7eaz1+FqShiK2V/Hhcuv+WnUVASvHoBzLFaT9wM4ibgFSBD7eSJofS/OpbUT37BfJiCDpiK5vyvxDvcfYqkUW8kBasrET+j4tsUXCurwKWBWu9oEq3NwuDkCEJ++nC8m0IbYNauRZ8StCfjOR/o9BpB1xKcmsxewHgkBcHmOtgTbJ08irvlnuFbIdgpXj7NuWblB+XRZrivuM17mHfgTY/r3zI38dnQuLsyPka1mqAbDcS3jmDq0lhmUGF4xTpeiKWYGfolfy8YcokOYBpFYBCebwBcAmqYEuQGyo9W0I5ro0aO9JvjAakuLi+ShCKFDbq3HIjY3rSPXWbW7qEEAwzCkqBGnPw9AwMPx0LACqu6mZElJUJGEMyz6rQoqxkSByQWodCKnpybJguGvw+zjZLgx6RqEcZxD2RFKt0f7K23zi/8qSTIiJckUVb36jr9DcXGQBfs2j4xm9jVsqUAlQ65+ZHV5fw6xS5DJg3VBmqayF8B7VuaCXpWJQ7Uk4enDPYPbiR5KJyyEXPng6RO1A481b6xHLEP+6P/oVVeq/gz6KubAwUXnZKg6KKCVEnwVbVSoYZBifSbMtRAzmdmaIc23+BUEuBxY/NmetdfV6Wv7tXTEZ2Yx23/yuKRHkdWz9BzHwhrsMiXpNcoTplSWWVf5UNBPoyG6lSE3To134mxYdQbi3BpOl2u2n6fvpo2zs9qVHi5Cl3qGgyJYVUY3k8DcPPYGliXuYUbCzlyRHFbrYngBbb7yGM3/NnCwLkAVsc1aOMOcuV9bzciGGzdyVAbcjbRPHdwQ="}'
[Relay 2] [Relay] [DEBUG] Data after JSON parse: type=<class 'dict'>, keys=['next_ip', 'next_port', 'session_key', 'payload']
[Relay 2] [Relay] Received session_key (base64): h37w6bxCUxrrs/vYHp5GvGPq2jjj1ZeHOI0r8YXitgc80zLZEsig7bVEBPvlRQcMag/6p/GC6YNK21jjGARAJw0eS+B9rrlW2hxdhDeODCbjZ/vt3Ztp3ByKNdmhQMP1Fkx7ArT1Pmqmsn86qYXRvwBZjzwswEk50tf1NTK4tsYhLOMENYLhoqJyO40VBZVdKqk/zihF5rU9Mm5LY0Kd8TZ+1+rACoBNcx/azaE9q5sB61GXz+kELar8XIo3YJYRbNpZ6pKi5lMmFHcEvH0SMmTkddg5WaQXpj/cUPR+6j2dKZIeQFUzt+6no8iuh7bl0i7Mx2cAXbkakqSuhX2AgQ==
[Relay 2] [Relay] Decoded session_key_enc (hex): 877ef0e9bc42531aebb3fbd81e9e46bc63eada38e3d59787388d2bf185e2b6073cd332d912c8a0edb54404fbe545070c6a0ffaa7f182e9834adb58e3180440270d1e4be07daeb956da1c5d84378e0c26e367fbeddd9b69dc1c8a35d9a140c3f5164c7b02b4f53e6aa6b27f3aa985d1bf00598f3c2cc04939d2d7f53532b8b6c6212ce3043582e1a2a2723b8d1505955d2aa93fce2845e6b53d326e4b63429df1367ed7eac00a804d731fdacda13dab9b01eb5197cfe9042daafc5c8a376096116cda59ea92a2e65326147704bc7d123264e475d83959a417a63fdc50f47eea3d9d29921e405533b7eea7a3c8ae87b6e5d22eccc767005db91a92a4ae857d8081
[Relay 2] [Relay] Decrypting session key with fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] Decrypted session_key (hex): 553f1930ed384413c79f5a699c0dfff2a4ca914b29acc9b5a3882771b1bb0893
[Relay 2] [Relay] [DEBUG] About to AES-decrypt payload (passing base64 string directly)
[Relay 2] [Relay] [DEBUG] Payload base64-decoded: type=<class 'bytes'>, len=1106, preview=b'\xce\xe9@#\xc6=\xcf\x8e\xcdn,m\xf6]\x10\xad\x11}\x8f\x1fD!d\x10fv\xaa\x00\xccI\xc8)H\x90#\xbe\xedp\xf1\x1d\xf8\xdc\xaa\xe6M\xc7\xed]\xec\xa2\x84\xe8\x1a\xca\xaa5O\xfc\xb4\x1b'
[Relay 2] [Relay] [DEBUG] AES-decrypted payload: type=<class 'bytes'>, len=1090, preview=b'{"next_ip": "10.250.120.196", "next_port": 9101, "session_ke'
[Relay 2] [Relay] [DEBUG] AES-decrypted payload (hex): 7b226e6578745f6970223a202231302e3235302e3132302e313936222c20226e6578745f706f7274223a20393130312c202273657373696f6e5f6b65
[Relay 2] [Relay] [DEBUG] Next hop JSON keys: ['next_ip', 'next_port', 'session_key', 'payload']
[Relay 2] [Relay] [DEBUG] Forwarding to next relay 10.250.120.196:9101
[Relay 1] [Relay] [handle_message ENTERED] addr=('10.250.120.196', 51698), thread=6158069760, relay_port=9101
[Relay 1] [Relay] [DEBUG] Raw data received: b'{"next_ip": "10.250.120.196", "next_port": 9101, "session_key": "tf6UWP0rBnQ6qGRUnTwCU7Y+UEyF4aCZBMzXr2mU3CpMnRtJSyd8cQnJX1L75QrnLeOVF43FqGewpIj4OKFN3YTxtee9tTBMiszSgKaAXw7hWV7tKbntg1Z2FcUByNh+GskXtEeH5PsTRtLYQIgGcj1RT9czTiMHk+ncS8W7G4Fhv7iWMqxzub0zqw7eb0KkJZ+6vxaaAB+lBEEMWOh2HdPTnMkIYhLHMoLoZdwjli2bS5wQrCdoRGxllnEkRgEOsd8yxS1/wlLJ8H6necu27mCVl3j9HPOMpv//KLndY//mDOP3bNQQ0y+jTcMlWKa8tkmI4r8HLx6CwS8kJBvcIQ==", "payload": "LHK3BMpRkukO5hcYqSrPESVlJ+dvxwCEkkzSj2mY9J1PL762Usrfu6ECLuNPkWtKDThBJw1PIqiIeYOcPbxCB400K053xzZIOI9cIoac7jKAWrE5B3JTQSTMVJJPEt4w/eyp+d4G+4dx5IUyr28RGXG7fLnyi9Q/OlcQeJhY8TVSpPVV/JipEKpk5FX45hFRcbhIUAgkoRx/5NFzYmcDYfqp/CedSyUex/oo3OAgHOGRGp0ViqlDANQBmtGpfG8hQVTbIGqc87d3ckNiMB3kvR8+AeiBkOu0Vy6jJlyPFpnr8FPhJuz6NOGRiVCqxHnK4qmPVbznmT7FGsOh3MxuSRgNvjxCMz1LllinbsMVa+wB4n3et4FmwgBJSz9ubyhY4a+5JZU5p4o5YAEwvW4dpdr98pzch8YUojc55s9BZtDc8eyzrvYI5cTyR/4WjPlGhZ9ni7aBhijlRHadIFb4vek0vTVwkgfhJXdxp7QUQNCBJJr/LOtDK31DsnAC3r50qbqW3aboJYYho59k089Z5r9UzH3k3NiiEWixbmxGpHWOjt+VGJfU85xUb2ReWxqr91hsd7VhWyWUrLANfnFpsX4+5lfBC+d00oxPgRYTz4VqLMjj8xWNEVETpHBy3Dq41wv1zv4gHa4H5sqUwj4WrAfT"}'
[Relay 1] [Relay] [DEBUG] Data after JSON parse: type=<class 'dict'>, keys=['next_ip', 'next_port', 'session_key', 'payload']
[Relay 1] [Relay] Received session_key (base64): tf6UWP0rBnQ6qGRUnTwCU7Y+UEyF4aCZBMzXr2mU3CpMnRtJSyd8cQnJX1L75QrnLeOVF43FqGewpIj4OKFN3YTxtee9tTBMiszSgKaAXw7hWV7tKbntg1Z2FcUByNh+GskXtEeH5PsTRtLYQIgGcj1RT9czTiMHk+ncS8W7G4Fhv7iWMqxzub0zqw7eb0KkJZ+6vxaaAB+lBEEMWOh2HdPTnMkIYhLHMoLoZdwjli2bS5wQrCdoRGxllnEkRgEOsd8yxS1/wlLJ8H6necu27mCVl3j9HPOMpv//KLndY//mDOP3bNQQ0y+jTcMlWKa8tkmI4r8HLx6CwS8kJBvcIQ==
[Relay 1] [Relay] Decoded session_key_enc (hex): b5fe9458fd2b06743aa864549d3c0253b63e504c85e1a09904ccd7af6994dc2a4c9d1b494b277c7109c95f52fbe50ae72de395178dc5a867b0a488f838a14ddd84f1b5e7bdb5304c8accd280a6805f0ee1595eed29b9ed83567615c501c8d87e1ac917b44787e4fb1346d2d8408806723d514fd7334e230793e9dc4bc5bb1b8161bfb89632ac73b9bd33ab0ede6f42a4259fbabf169a001fa504410c58e8761dd3d39cc9086212c73282e865dc23962d9b4b9c10ac2768446c6596712446010eb1df32c52d7fc252c9f07ea779cbb6ee60959778fd1cf38ca6ffff28b9dd63ffe60ce3f76cd410d32fa34dc32558a6bcb64988e2bf072f1e82c12f24241bdc21
[Relay 1] [Relay] Decrypting session key with fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] Decrypted session_key (hex): c684ef4e19d90b74f2114159db23f1746f220975902729322e877fd258a27a0c
[Relay 1] [Relay] [DEBUG] About to AES-decrypt payload (passing base64 string directly)
[Relay 1] [Relay] [DEBUG] Payload base64-decoded: type=<class 'bytes'>, len=498, preview=b',r\xb7\x04\xcaQ\x92\xe9\x0e\xe6\x17\x18\xa9*\xcf\x11%e\'\xe7o\xc7\x00\x84\x92L\xd2\x8fi\x98\xf4\x9dO/\xbe\xb6R\xca\xdf\xbb\xa1\x02.\xe3O\x91kJ\r8A\'\rO"\xa8\x88y\x83\x9c'
[Relay 1] [Relay] [DEBUG] AES-decrypted payload: type=<class 'bytes'>, len=482, preview=b'{"next_ip": "10.250.120.196", "next_port": 9103, "session_ke'
[Relay 1] [Relay] [DEBUG] AES-decrypted payload (hex): 7b226e6578745f6970223a202231302e3235302e3132302e313936222c20226e6578745f706f7274223a20393130332c202273657373696f6e5f6b65
[Relay 1] [Relay] [DEBUG] Next hop JSON keys: ['next_ip', 'next_port', 'session_key', 'payload']
[Relay 1] [Relay] [DEBUG] Forwarding to next relay 10.250.120.196:9103
[Relay 3] [Relay] [handle_message ENTERED] addr=('10.250.120.196', 51708), thread=6158118912, relay_port=9103
[Relay 3] [Relay] [DEBUG] Raw data received: b'{"next_ip": "10.250.120.196", "next_port": 9103, "session_key": "rWW7CGzP5HiuXblhiCFiIVoERh+hitr2QINRHCI+a9w4SsITjRsVxEfi/uy8uepOtdgJlHkThfQv1vtLpUnFPzLekwJKSun56zQg1413b3KolmfIqaE36rHSQl/QQPcfcXR99IRJpmPwYb5mkcqIQ2a+AebYG9+zQ9gTvBGBRdjcwfLbKSuy+Bfk1y+fk3WFZKowk02UuAd7pmzRGyadPyl5/2ObJ2WjLxqIuDgb7d3z2DNzHqaVR1noxMcOQ7GF9cjnTaGEehQic5C177VggsCfWyqkiinUJSbeShGdcFVVHt27tE1RXlIjf/UlKz+DUfWCWjAfU+Q62rUOzWWMlA==", "payload": "n58ArxEqrE+67XjUEbR/e4Vi9Fr01KS9lBzYWFVS4VNv33vfrturPA=="}'
[Relay 3] [Relay] [DEBUG] Data after JSON parse: type=<class 'dict'>, keys=['next_ip', 'next_port', 'session_key', 'payload']
[Relay 3] [Relay] Received session_key (base64): rWW7CGzP5HiuXblhiCFiIVoERh+hitr2QINRHCI+a9w4SsITjRsVxEfi/uy8uepOtdgJlHkThfQv1vtLpUnFPzLekwJKSun56zQg1413b3KolmfIqaE36rHSQl/QQPcfcXR99IRJpmPwYb5mkcqIQ2a+AebYG9+zQ9gTvBGBRdjcwfLbKSuy+Bfk1y+fk3WFZKowk02UuAd7pmzRGyadPyl5/2ObJ2WjLxqIuDgb7d3z2DNzHqaVR1noxMcOQ7GF9cjnTaGEehQic5C177VggsCfWyqkiinUJSbeShGdcFVVHt27tE1RXlIjf/UlKz+DUfWCWjAfU+Q62rUOzWWMlA==
[Relay 3] [Relay] Decoded session_key_enc (hex): ad65bb086ccfe478ae5db961882162215a04461fa18adaf64083511c223e6bdc384ac2138d1b15c447e2feecbcb9ea4eb5d80994791385f42fd6fb4ba549c53f32de93024a4ae9f9eb3420d78d776f72a89667c8a9a137eab1d2425fd040f71f71747df48449a663f061be6691ca884366be01e6d81bdfb343d813bc118145d8dcc1f2db292bb2f817e4d72f9f93758564aa30934d94b8077ba66cd11b269d3f2979ff639b2765a32f1a88b8381bedddf3d833731ea6954759e8c4c70e43b185f5c8e74da1847a14227390b5efb56082c09f5b2aa48a29d42526de4a119d7055551eddbbb44d515e52237ff5252b3f8351f5825a301f53e43adab50ecd658c94
[Relay 3] [Relay] Decrypting session key with fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] [Relay] Decrypted session_key (hex): ceec50d97452a4dcdd254732e187efb3b33c7d6b6a562d7d28065af02ddcae2f
[Relay 3] [Relay] [DEBUG] About to AES-decrypt payload (passing base64 string directly)
[Relay 3] [Relay] [DEBUG] Payload base64-decoded: type=<class 'bytes'>, len=40, preview=b'\x9f\x9f\x00\xaf\x11*\xacO\xba\xedx\xd4\x11\xb4\x7f{\x85b\xf4Z\xf4\xd4\xa4\xbd\x94\x1c\xd8XUR\xe1So\xdf{\xdf\xae\xdb\xab<'
[Relay 3] [Relay] [DEBUG] AES-decrypted payload: type=<class 'bytes'>, len=24, preview=b'{"msg": "Hello, world!"}'
[Relay 3] [Relay] [DEBUG] AES-decrypted payload (hex): 7b226d7367223a202248656c6c6f2c20776f726c6421227d
[Relay 3] [Relay] [DEBUG] Next hop JSON keys: ['msg']
[Relay 3] [Relay] [DEBUG] Payload is not JSON, assuming last hop. Error: 'next_ip'
[Relay 3] [Relay] [Last Hop] Forwarding payload to dest 127.0.0.1:9100, len=24, type=<class 'bytes'>
[Relay 3] [Relay] [Last Hop] Sending to dest: type=<class 'bytes'>, len=24, preview=b'{"msg": "Hello, world!"}'
[Relay 3] [Relay] [Last Hop] Received response from dest: type=<class 'bytes'>, len=50, preview=b'{"result": "OK", "echo": {"msg": "Hello, world!"}}'
[Relay 3] [Relay] [Last Hop] Response from dest decoded as UTF-8: '{"result": "OK", "echo": {"msg": "Hello, world!"}}'
[Relay 3] [Relay] [Last Hop] Response from dest (hex): 7b22726573756c74223a20224f4b222c20226563686f223a207b226d7367223a202248656c6c6f2c20776f726c6421227d7d
[Relay 3] [Relay] [Last Hop] About to AES-encrypt response: type=<class 'bytes'>, len=50, preview=b'{"result": "OK", "echo": {"msg": "Hello, world!"}}'
[Relay 3] [Relay] [Last Hop] AES-encrypted response (hex): 4eacfcf36399ba3af2813dcdf791b836c9559b204c6a672795819f608b57fc1a9aefafc3c2b6a1466b359ae5ba8493ec0058b376fdd43d00fe36beea
[Relay 3] [Relay] [Last Hop] Base64-encoded AES-encrypted response: type=<class 'bytes'>, len=88, preview=b'Tqz882OZujrygT3N95G4NslVmyBMamcnlYGfYItX/Bqa76/DwrahRms1muW6'
[Relay 1] [Relay] [DEBUG] Received response from next relay: type=<class 'bytes'>, len=88, preview=b'Tqz882OZujrygT3N95G4NslVmyBMamcnlYGfYItX/Bqa76/DwrahRms1muW6'
[Relay 3] [Relay] [Last Hop] Sent response to ('10.250.120.196', 51708): b'Tqz882OZujrygT3N95G4NslVmyBMamcnlYGfYItX/Bqa76/DwrahRms1muW6'... (len=88)
[Relay 1] [Relay] [RETURN] Base64-decoded response: type=<class 'bytes'>, len=66, preview=b"N\xac\xfc\xf3c\x99\xba:\xf2\x81=\xcd\xf7\x91\xb86\xc9U\x9b Ljg'\x95\x81\x9f`\x8bW\xfc\x1a\x9a\xef\xaf\xc3\xc2\xb6\xa1Fk5\x9a\xe5\xba\x84\x93\xec\x00X\xb3v\xfd\xd4=\x00\xfe6\xbe\xea"
[Relay 3] [Relay] [handle_message END] addr=('10.250.120.196', 51708), thread=6158118912
[Relay 1] [Relay] [RETURN] AES-decrypted response: type=<class 'bytes'>, len=50, preview=b'0\xf1\xe91Y\x1a\xad\x9d\x82kh\x0cX\xc8\x02,\x87EC\xc7\x89\xa2\xd1\xf4)i\x01\xa2h\xb4&\xb0Q<B\xd2\xdfl\x08\xa5\x9e\xd0\x1a\x8a[\x88}\x92sv'
[Relay 1] [Relay] [RETURN] AES-decrypted response not UTF-8: 'utf-8' codec can't decode byte 0xf1 in position 1: invalid continuation byte
[Relay 1] [Relay] [RETURN] AES-encrypted response (hex): d8f867f3b69866ab408e33e842f49e3c6ff6c9d9d55ab3f938b690aed53c6529b01cbeb120aeddf356d665b8dad5ec5acf336a44cbcd841444952127
[Relay 1] [Relay] [RETURN] Base64-encoded AES-encrypted response: type=<class 'bytes'>, len=112, preview=b'2Phn87aYZqtAjjPoQvSePG/2ydnVWrP5OLaQrtU8ZSmwHL6xIK7d81bWZbja'
[Relay 1] [Relay] [handle_message END] addr=('10.250.120.196', 51698), thread=6158069760
[Relay 2] [Relay] [DEBUG] Received response from next relay: type=<class 'bytes'>, len=112, preview=b'2Phn87aYZqtAjjPoQvSePG/2ydnVWrP5OLaQrtU8ZSmwHL6xIK7d81bWZbja'
[Relay 2] [Relay] [RETURN] Base64-decoded response: type=<class 'bytes'>, len=82, preview=b"\xd8\xf8g\xf3\xb6\x98f\xab@\x8e3\xe8B\xf4\x9e<o\xf6\xc9\xd9\xd5Z\xb3\xf98\xb6\x90\xae\xd5<e)\xb0\x1c\xbe\xb1 \xae\xdd\xf3V\xd6e\xb8\xda\xd5\xecZ\xcf3jD\xcb\xcd\x84\x14D\x95!'"
[Relay 2] [Relay] [RETURN] AES-decrypted response: type=<class 'bytes'>, len=66, preview=b'\xc9H(\xb7)6\x0f\xcf\xcb\x1br\x8c2\x98\xfc\x86\xae\xb9\x80\x06?p\x82\x11\xfbA\x05w\xc6\x9d\xa5\xee3\xdf\x92\xb6\xbd\xc0\xb3-x\xdd\xfc\xfb\xf0\x8f\xb4\xf8A\x0c\x81\xd9\xf5\n\xce\xd7j\xa9\xc7y'
[Relay 2] [Relay] [RETURN] AES-decrypted response not UTF-8: 'utf-8' codec can't decode byte 0xc9 in position 0: invalid continuation byte
[Relay 2] [Relay] [RETURN] AES-encrypted response (hex): 6ae386fe0620574da63488f3206d1d96e582d47f7efa7b9378baef0261925556c10501f8e06d90167e2246ca70c5d2257816c3a634bb8f15657eeae8
[Relay 2] [Relay] [RETURN] Base64-encoded AES-encrypted response: type=<class 'bytes'>, len=132, preview=b'auOG/gYgV02mNIjzIG0dluWC1H9++nuTeLrvAmGSVVbBBQH44G2QFn4iRspw'
[Relay] ---- Relay process started ----
[Relay 1] [Relay] Loaded persistent RSA keypair from relay1_key.pem
[Relay 1] [Relay] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] [KEY] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] Relay 1 starting on 10.250.120.196:9101 (RELAY PORT 9101)
[Relay 1] Registering with CDS at 127.0.0.1:9000
[Relay 1] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9101, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5MM7/HBECV26fZqjUJkt\nQ4+dx297cL0hf1+rf08Qir5tL/lArfQsiplTqcsIsZiN7vJ8K2XzvK5JAEv8tVE4\nEKU4W1hbEVBd1eLCX+Oc5XauTbWhW8xlc2wdNlNwDhin2Mw84doKJWPyfjtIwnIi\n3nWHqxLyAqkj6qDoByA8D7YVmJxvzwL0mrYE8G8b4Q4Wjnx2SXeTwc9LRzqwrsyb\nlM5B4BSVPBignOMhD2AfuIFw6uULQThbkL9L5AnQA08B4Gqzo731LLJN/Y6qo+VJ\nki2t6m1aJTG0LBjijpH7CtnN1MHIQ5UueS1sJVYZooYxkxEYYZTqIUXxuI5ICKPC\nCQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 1] [Relay] Listening for incoming messages on port 9101 (RELAY PORT 9101)
[Relay] ---- Relay process started ----
[Relay 2] [Relay] Loaded persistent RSA keypair from relay2_key.pem
[Relay 2] [Relay] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] [KEY] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] Relay 2 starting on 10.250.120.196:9102 (RELAY PORT 9102)
[Relay 2] Registering with CDS at 127.0.0.1:9000
[Relay 2] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9102, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA58J3pSrOQd4hYnuzQQ7q\nWrjjo+3BJp+ik23brR2yl0kjtfH+wjD9LYWHS7dBxsDRzSozJ/7EWKKNCaTsgvaF\nN6vpyBPqDM/uQfOWfirteL50RgDZw95Vml4Fuay7bTBEb1J8ydvFqawo8rnLE2I3\nU4BjBT+CD38bY3je8wrrCX9fo1uYaLDlfteGshadZ2gnTxrAzkZZ/CTFdyb8JrmN\nIuxjBVjwSA/uIv+KHWQhXRA5jJPXcNV88LYXyEzpid1Cr9gnrqA88K0HSleiwZjU\nJF3LhBvS2Ga2HHfFsk5D/yz/pTHwDvRA98VMT/90wahwmSJsck4XWDFhmNhy3oDR\nBQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 2] [Relay] Listening for incoming messages on port 9102 (RELAY PORT 9102)
[Relay] ---- Relay process started ----
[Relay 3] [Relay] Loaded persistent RSA keypair from relay3_key.pem
[Relay 3] [Relay] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] [Relay] [KEY] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] Relay 3 starting on 10.250.120.196:9103 (RELAY PORT 9103)
[Relay 3] Registering with CDS at 127.0.0.1:9000
[Relay 3] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9103, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5k9OJ8m3IdjmwR1skM1G\nwrKkwlYLK0Qs+I/BX5ww5wEakOsTy5NVFAwTYrCUnR012u2jCwI8wV1YpPaMa8RJ\ntnqNFy4pFfqBh5tmidHQ3QMRvINPrGtQM5+VgMXoA0y8izql52M1K/3Q6sHVlAXd\nmpQcBO+JSHY7uyVx1txZssyisia7Nn8Frh/XRpl0oUvGkSnbm/KgqDAP0xJ3lUZS\nEGiIWdf0bn7tHD3nYBMrWWi3jSQWf0Q80asIEYWipwkfMPf0ffzu4FX0elfvpyOX\nr50xk7sb8K5IhcilwxKxQpPOcq3f6ph0EERQR7pOdDqkzFdHoGiyssSX4MYM60kd\nmQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 3] [Relay] Listening for incoming messages on port 9103 (RELAY PORT 9103)
[Relay 2] [Relay] [handle_message ENTERED] addr=('10.250.120.196', 52639), thread=6194884608, relay_port=9102
[Relay 2] [Relay] [DEBUG] Raw data received: b'{"next_ip": "10.250.120.196", "next_port": 9102, "session_key": "5y0UcwWpl0eokbl8gwQyP1oB9jgbFA+4BPNP/rfdWyhg6q7ZEp/z4EhMPDUjuvjhJEEzv+cEYqWKUQwHcbvhXH1OS5SCknocPT9MHyofZefa33oovWGJar9ef51A5pVYmds84JmL93OUlr3JdBI/REZZ2jf3sQB1JEi+2eJ09du4cYsbfWkFpclUKv3FBetz1/Rf/jheKgldYj4JKBx6oud+Eo+itmyBBBm3ZLtQxiLTg+8tVTBuOGYtgiA7gJX7mKx7iNegudcy/4NszXStjBp/ygVOjDKGzvcSb/HZ706fBEoEMVKAvjpZuNRCvSrTfsc8Drr2e+kh8XI4dn1TNQ==", "payload": "VofF7Hn89KnTJ8hqaTe8ZYVgITsrQumn16zsWKvAkxoDrodDtGmAr9ZX7UgI3Z/rXpwLanQSD7vAoviRTogx/R8CyCNzef1JYKANwmYm1NLd3mkvkpQmWbZleIWF4NSdcA9QaM78OYL5ExQYUCq9+VDDtFM52bR54HMnNuMANMqyfOGtJxCxvyDwxu+yoXsmzyPcpD/Th44rQu1EhcT+3P8bMOqGlkvScg/gBdVOspQUWd9nE+4iVwBhOlEFg9Lt9/pkHFaozQiyJJhbzgcjRkiEgcOBiGvdgRfiG+gM6B1OhBZYqwRrVkwdC1iwRLTLg6qkcBqDp4exqWZBZaNSsQMtbBaEAQRngu1C5C0vx8zf5Yz960X1JHA+dPdgIZH8FoLDvEdyhvPdP6uGIiDAZGzyxKa5K2Fv99z9nnyco8YbobIs/v8YfSSV/tWRSVlke96aXaSlHQ0zcbUQdW4hkpqPhf18KRMqjbK9+P1BV0vaPuBP1JibnLyzSxmGGkjCD1zSbTpVZjmWFpwM8HJ7DH5N6YgvmS91+zqjC8rVwDbuBwy4vjR/z2E75Y+h1TrLMcfMY4GBAA3ZjvRW3LAyY7LKPAMOcpOSFHBFv/RbsHZjc5W9T7KHxxRCQIaHDd3ssE8YDm1NjFclXPaOqh3bvaP67TVG0ga7GOKOg7D/E8en0rRkM8XLwqgz6UZWNUyiwYVnttMX3J0+XD0B/jKCLneArojrZ2kpc3EGNpc5YLoSX29fnoQaVRA99Lla82g/JBID+50N/Vt0xkcLluUM5GpYX+qKypXpJ94j/Dw0iSQ0b2rGGwVvw3VHBbI+ZNPGQMvs8Q08wcdU7tl2dby95p9kImWTtd8EaTLnU7PZWRKPNvvbPnoDq+K1kXjkpNX+47SR4b/HbbxMjJRyh1lnRunvgsSO20mZDxgrksuGD5t+7qiru8sgjI97midbenRBgmtoAbor/ely095rAc1hU0XIXFPEMsou9pe6zo5zPx54MgKrLIbc9kab6TwwVm+ENREy4n/Kt3pICBdH+gKIxVWy8g0tQulyPfHMKKgpf5jMdkxBfiOZux3V8LOB5ZibOndv07LQwDk9ICjrAq2zo8M7H1xmMlJnrlIT4KCogL0swcQyknEwm4D4aEEOVXRS2jGFcQXpoim3alz6kLQwnT/ja+c8IasS57fZAylHd4L2AiJ0KqtgJS7uniMCjdzpn1oDp6FqlijWiNMUaW5qLDjC/uNB1Cj5YFNHdhuokENl4VuyKw4VaaRQyCLw9bkVQK1fQaRB1puQr+iQadBdkaXRItl7xvEAdoarXjz9WACrLH00r9nDRa8hen0XD54kIv6WvOTh8wFGZ7Ow9o6yF4f7c3lSWwA3AkkgTfX4/qaiyS9VMKgsD6Sdy3GD6nvZi7zLFdzwfAdxlj5RJ4Gz2lNqB+kasQL3THFnq4q+Fs9bsySgxE9UHbzZ4IUYPWdjdYY="}'
[Relay 2] [Relay] [DEBUG] Data after JSON parse: type=<class 'dict'>, keys=['next_ip', 'next_port', 'session_key', 'payload']
[Relay 2] [Relay] Received session_key (base64): 5y0UcwWpl0eokbl8gwQyP1oB9jgbFA+4BPNP/rfdWyhg6q7ZEp/z4EhMPDUjuvjhJEEzv+cEYqWKUQwHcbvhXH1OS5SCknocPT9MHyofZefa33oovWGJar9ef51A5pVYmds84JmL93OUlr3JdBI/REZZ2jf3sQB1JEi+2eJ09du4cYsbfWkFpclUKv3FBetz1/Rf/jheKgldYj4JKBx6oud+Eo+itmyBBBm3ZLtQxiLTg+8tVTBuOGYtgiA7gJX7mKx7iNegudcy/4NszXStjBp/ygVOjDKGzvcSb/HZ706fBEoEMVKAvjpZuNRCvSrTfsc8Drr2e+kh8XI4dn1TNQ==
[Relay 2] [Relay] Decoded session_key_enc (hex): e72d147305a99747a891b97c8304323f5a01f6381b140fb804f34ffeb7dd5b2860eaaed9129ff3e0484c3c3523baf8e1244133bfe70462a58a510c0771bbe15c7d4e4b9482927a1c3d3f4c1f2a1f65e7dadf7a28bd61896abf5e7f9d40e6955899db3ce0998bf7739496bdc974123f444659da37f7b100752448bed9e274f5dbb8718b1b7d6905a5c9542afdc505eb73d7f45ffe385e2a095d623e09281c7aa2e77e128fa2b66c810419b764bb50c622d383ef2d55306e38662d82203b8095fb98ac7b88d7a0b9d732ff836ccd74ad8c1a7fca054e8c3286cef7126ff1d9ef4e9f044a04315280be3a59b8d442bd2ad37ec73c0ebaf67be921f17238767d5335
[Relay 2] [Relay] Decrypting session key with fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] Decrypted session_key (hex): 0c902e73103cf906b24b2e83214c7363d077060f67954eda401bb497e9b7493b
[Relay 2] [Relay] [DEBUG] About to AES-decrypt payload (passing base64 string directly)
[Relay 2] [Relay] [DEBUG] Payload base64-decoded: type=<class 'bytes'>, len=1106, preview=b"V\x87\xc5\xecy\xfc\xf4\xa9\xd3'\xc8ji7\xbce\x85`!;+B\xe9\xa7\xd7\xac\xecX\xab\xc0\x93\x1a\x03\xae\x87C\xb4i\x80\xaf\xd6W\xedH\x08\xdd\x9f\xeb^\x9c\x0bjt\x12\x0f\xbb\xc0\xa2\xf8\x91"
[Relay 2] [Relay] [DEBUG] AES-decrypted payload: type=<class 'bytes'>, len=1090, preview=b'{"next_ip": "10.250.120.196", "next_port": 9101, "session_ke'
[Relay 2] [Relay] [DEBUG] AES-decrypted payload (hex): 7b226e6578745f6970223a202231302e3235302e3132302e313936222c20226e6578745f706f7274223a20393130312c202273657373696f6e5f6b65
[Relay 2] [Relay] [DEBUG] Next hop JSON keys: ['next_ip', 'next_port', 'session_key', 'payload']
[Relay 2] [Relay] [DEBUG] Forwarding to next relay 10.250.120.196:9101
[Relay 1] [Relay] [handle_message ENTERED] addr=('10.250.120.196', 52642), thread=6169620480, relay_port=9101
[Relay 1] [Relay] [DEBUG] Raw data received: b'{"next_ip": "10.250.120.196", "next_port": 9101, "session_key": "cQnIRZI1JIGB3McVYewtEzs3LCohGgAWmxKMlUN8HESMEz/xJlWdFWF31KMHULPdMimkLqYQfokpXMan3TP2AfAXGPD3jQE5U/ELsVeDgb9qs1FaN5mXMP3uL1b8IDtF7Tq5eEBB5jAZKo0yz1ubApDvJAT4Khy0hTpTVsFBKKyXwiJE7n9Xm9ZtFCC5qSuZ0dZSum5BZ0N/yHXfweH6u9MhmN8LsNZZwrnAx3IPw2lnfJGrT82Od+/yk4aZk+taB/sWrFjIzb80O1oYc3N+Ml+IyxBTishBHuymq21tVC8/EFjxqW8s48CQCjJjitBLOw1FLKcaGhfKd76+ex6UTg==", "payload": "0PrZ5G2O2yvuFPoRusSObsF73MWapgD6rhac/nne9fTcV9sVN+ieQBV8FEjRy9c1dGL3Kh5DBsk9LdJGf4zfMgzhyF+XkyuTT73WI2H3EGKi6eGkb++CCX2TSxv7zze2qX/td8MbyxqwjnsnaP2tZtsnWKEknBQCEJVRQvTx03dx8tjbpyGJ9guoh54rZ13VL6IWEOLGrUUUxaBEwssN4km8l0z/qWlCz1zWjc8FV9lnDgoD4hQyhz2kBzOviP3ZNGAD/Ry7fZDiCu9/n27+ShWxcmJwnfZHsoBpgGjJ0DvUMKnJ0a+MVoSxaOV/MheYkCEL0FTfKfTN/9B9WIw5LI6tjWG+yB9xb6bkT6ei6KshSm1uVzMFDBPyWDiY/G3yDahKFikQTi0DrXewB023vjpyq/MvBU+u/VheKF413225PqydWyh8NQg4vHcaD3xjG8FRhHO3k769Yk0W3lDr05lMMIWAiW3tbHCR7eYqfMO7qFfeBt1FdCuXUDf9Wjuy7B2QzA1kHlFiPRicSFOtSrJ35sk7BdxpJB47pwpQnlIu6z1WfuMXxyMgfsdzls6Zo/lv6mkd/3Tt+2xiuHHBCbi7XqT111vUx5jbtsYUuLkML4ShlmlrJTgA41AJbvz+VCjVikYZF5Tsa4TvTeYVf4ii"}'
[Relay 1] [Relay] [DEBUG] Data after JSON parse: type=<class 'dict'>, keys=['next_ip', 'next_port', 'session_key', 'payload']
[Relay 1] [Relay] Received session_key (base64): cQnIRZI1JIGB3McVYewtEzs3LCohGgAWmxKMlUN8HESMEz/xJlWdFWF31KMHULPdMimkLqYQfokpXMan3TP2AfAXGPD3jQE5U/ELsVeDgb9qs1FaN5mXMP3uL1b8IDtF7Tq5eEBB5jAZKo0yz1ubApDvJAT4Khy0hTpTVsFBKKyXwiJE7n9Xm9ZtFCC5qSuZ0dZSum5BZ0N/yHXfweH6u9MhmN8LsNZZwrnAx3IPw2lnfJGrT82Od+/yk4aZk+taB/sWrFjIzb80O1oYc3N+Ml+IyxBTishBHuymq21tVC8/EFjxqW8s48CQCjJjitBLOw1FLKcaGhfKd76+ex6UTg==
[Relay 1] [Relay] Decoded session_key_enc (hex): 7109c8459235248181dcc71561ec2d133b372c2a211a00169b128c95437c1c448c133ff126559d156177d4a30750b3dd3229a42ea6107e89295cc6a7dd33f601f01718f0f78d013953f10bb1578381bf6ab3515a37999730fdee2f56fc203b45ed3ab9784041e630192a8d32cf5b9b0290ef2404f82a1cb4853a5356c14128ac97c22244ee7f579bd66d1420b9a92b99d1d652ba6e4167437fc875dfc1e1fabbd32198df0bb0d659c2b9c0c7720fc369677c91ab4fcd8e77eff293869993eb5a07fb16ac58c8cdbf343b5a1873737e325f88cb10538ac8411eeca6ab6d6d542f3f1058f1a96f2ce3c0900a32638ad04b3b0d452ca71a1a17ca77bebe7b1e944e
[Relay 1] [Relay] Decrypting session key with fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] Decrypted session_key (hex): 39606f62130d092601cdc9471d27a22b0e170fbb35d1dbe019f3ec4d4f4fbc9b
[Relay 1] [Relay] [DEBUG] About to AES-decrypt payload (passing base64 string directly)
[Relay 1] [Relay] [DEBUG] Payload base64-decoded: type=<class 'bytes'>, len=498, preview=b'\xd0\xfa\xd9\xe4m\x8e\xdb+\xee\x14\xfa\x11\xba\xc4\x8en\xc1{\xdc\xc5\x9a\xa6\x00\xfa\xae\x16\x9c\xfey\xde\xf5\xf4\xdcW\xdb\x157\xe8\x9e@\x15|\x14H\xd1\xcb\xd75tb\xf7*\x1eC\x06\xc9=-\xd2F'
[Relay 1] [Relay] [DEBUG] AES-decrypted payload: type=<class 'bytes'>, len=482, preview=b'{"next_ip": "10.250.120.196", "next_port": 9103, "session_ke'
[Relay 1] [Relay] [DEBUG] AES-decrypted payload (hex): 7b226e6578745f6970223a202231302e3235302e3132302e313936222c20226e6578745f706f7274223a20393130332c202273657373696f6e5f6b65
[Relay 1] [Relay] [DEBUG] Next hop JSON keys: ['next_ip', 'next_port', 'session_key', 'payload']
[Relay 1] [Relay] [DEBUG] Forwarding to next relay 10.250.120.196:9103
[Relay 3] [Relay] [handle_message ENTERED] addr=('10.250.120.196', 52649), thread=6203551744, relay_port=9103
[Relay 3] [Relay] [DEBUG] Raw data received: b'{"next_ip": "10.250.120.196", "next_port": 9103, "session_key": "pns+UtUIHYQJbdpEtalnw80ckQbnHeY6Fh0UR9cAM78O9w089hmYcJ5muNE/l2tjejv3AVsNAWFdlKVAaWx6rZzh+hKgfrBhHG4fsv0gAwetds2ueS8gwk8Bc2IJsap80ahJFVfzTiS7mqlHebUW4cvcCRbrBeU8iahLn7FISfZLE+BdDxwjH0LwyDNJ3+LORKpP37G4Z0lBc9+HPtQhHL+S9A7PqCsGGywpdxlfcfktCOoXzJlOmP86fMNDC6Ba3RxBACGfgSwiFQEypQu+QEutPVBMnD74kwuf5EHFWO3zCoLUxI1qvhJvJ8iTO1bG/Mb7aWWq6ERdObfAtPHTaA==", "payload": "ooYmVs1cfr+XFf4CLE6zoPIesApXRDVLEAvI8pCdnkqeOn9cauKOqQ=="}'
[Relay 3] [Relay] [DEBUG] Data after JSON parse: type=<class 'dict'>, keys=['next_ip', 'next_port', 'session_key', 'payload']
[Relay 3] [Relay] Received session_key (base64): pns+UtUIHYQJbdpEtalnw80ckQbnHeY6Fh0UR9cAM78O9w089hmYcJ5muNE/l2tjejv3AVsNAWFdlKVAaWx6rZzh+hKgfrBhHG4fsv0gAwetds2ueS8gwk8Bc2IJsap80ahJFVfzTiS7mqlHebUW4cvcCRbrBeU8iahLn7FISfZLE+BdDxwjH0LwyDNJ3+LORKpP37G4Z0lBc9+HPtQhHL+S9A7PqCsGGywpdxlfcfktCOoXzJlOmP86fMNDC6Ba3RxBACGfgSwiFQEypQu+QEutPVBMnD74kwuf5EHFWO3zCoLUxI1qvhJvJ8iTO1bG/Mb7aWWq6ERdObfAtPHTaA==
[Relay 3] [Relay] Decoded session_key_enc (hex): a67b3e52d5081d84096dda44b5a967c3cd1c9106e71de63a161d1447d70033bf0ef70d3cf61998709e66b8d13f976b637a3bf7015b0d01615d94a540696c7aad9ce1fa12a07eb0611c6e1fb2fd200307ad76cdae792f20c24f01736209b1aa7cd1a8491557f34e24bb9aa94779b516e1cbdc0916eb05e53c89a84b9fb14849f64b13e05d0f1c231f42f0c83349dfe2ce44aa4fdfb1b867494173df873ed4211cbf92f40ecfa82b061b2c2977195f71f92d08ea17cc994e98ff3a7cc3430ba05add1c4100219f812c22150132a50bbe404bad3d504c9c3ef8930b9fe441c558edf30a82d4c48d6abe126f27c8933b56c6fcc6fb6965aae8445d39b7c0b4f1d368
[Relay 3] [Relay] Decrypting session key with fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] [Relay] Decrypted session_key (hex): 7c4c29cafbd406bf41f5b750f46be2245b0b40f75c297ef723e965312a6ecc0a
[Relay 3] [Relay] [DEBUG] About to AES-decrypt payload (passing base64 string directly)
[Relay 3] [Relay] [DEBUG] Payload base64-decoded: type=<class 'bytes'>, len=40, preview=b'\xa2\x86&V\xcd\\~\xbf\x97\x15\xfe\x02,N\xb3\xa0\xf2\x1e\xb0\nWD5K\x10\x0b\xc8\xf2\x90\x9d\x9eJ\x9e:\x7f\\j\xe2\x8e\xa9'
[Relay 3] [Relay] [DEBUG] AES-decrypted payload: type=<class 'bytes'>, len=24, preview=b'{"msg": "Hello, world!"}'
[Relay 3] [Relay] [DEBUG] AES-decrypted payload (hex): 7b226d7367223a202248656c6c6f2c20776f726c6421227d
[Relay 3] [Relay] [DEBUG] Next hop JSON keys: ['msg']
[Relay 3] [Relay] [DEBUG] Payload is not JSON, assuming last hop. Error: 'next_ip'
[Relay 3] [Relay] [Last Hop] Forwarding payload to dest 127.0.0.1:9100, len=24, type=<class 'bytes'>
[Relay 3] [Relay] [Last Hop] Sending to dest: type=<class 'bytes'>, len=24, preview=b'{"msg": "Hello, world!"}'
[Relay 3] [Relay] [Last Hop] Received response from dest: type=<class 'bytes'>, len=50, preview=b'{"result": "OK", "echo": {"msg": "Hello, world!"}}'
[Relay 3] [Relay] [Last Hop] Response from dest decoded as UTF-8: '{"result": "OK", "echo": {"msg": "Hello, world!"}}'
[Relay 3] [Relay] [Last Hop] Response from dest (hex): 7b22726573756c74223a20224f4b222c20226563686f223a207b226d7367223a202248656c6c6f2c20776f726c6421227d7d
[Relay 3] [Relay] [Last Hop] About to AES-encrypt response: type=<class 'bytes'>, len=50, preview=b'{"result": "OK", "echo": {"msg": "Hello, world!"}}'
[Relay 3] [Relay] [Last Hop] AES-encrypted response (hex): e386da7cbd2ef32865f9abe7c7469d50932dea9cddfa81d6ec8c45280d75b22e7e08cc19578557411dd5b743538f04464580ddb2902f4764971a1106
[Relay 3] [Relay] [Last Hop] Base64-encoded AES-encrypted response: type=<class 'bytes'>, len=88, preview=b'44bafL0u8yhl+avnx0adUJMt6pzd+oHW7IxFKA11si5+CMwZV4VXQR3Vt0NT'
[Relay 1] [Relay] [DEBUG] Received response from next relay: type=<class 'bytes'>, len=88, preview=b'44bafL0u8yhl+avnx0adUJMt6pzd+oHW7IxFKA11si5+CMwZV4VXQR3Vt0NT'
[Relay 3] [Relay] [Last Hop] Sent response to ('10.250.120.196', 52649): b'44bafL0u8yhl+avnx0adUJMt6pzd+oHW7IxFKA11si5+CMwZV4VXQR3Vt0NT'... (len=88)
[Relay 1] [Relay] [RETURN] Base64-decoded response: type=<class 'bytes'>, len=66, preview=b'\xe3\x86\xda|\xbd.\xf3(e\xf9\xab\xe7\xc7F\x9dP\x93-\xea\x9c\xdd\xfa\x81\xd6\xec\x8cE(\ru\xb2.~\x08\xcc\x19W\x85WA\x1d\xd5\xb7CS\x8f\x04FE\x80\xdd\xb2\x90/Gd\x97\x1a\x11\x06'
[Relay 1] [Relay] [RETURN] AES-decrypted response: type=<class 'bytes'>, len=50, preview=b'\xa2\xcb\xc3\x02\xb7\x07\x12:\xf7fBdK\x88?\xa0\x18\xea\xa6\xa4\xa8\x89\x1e(\xb7e\x07\xbd\x1d\x15\xea\xb8+\xd7\x17lY\xfe\xe9K\xef\xba\x89\x87\x00\x1d\x0c\xef\x8a\xf6'
[Relay 3] [Relay] [handle_message END] addr=('10.250.120.196', 52649), thread=6203551744
[Relay 1] [Relay] [RETURN] AES-decrypted response not UTF-8: 'utf-8' codec can't decode byte 0xa2 in position 0: invalid start byte
[Relay 1] [Relay] [RETURN] AES-encrypted response (hex): 1000ebf8b3c947ba8a564c879d8bf96b11da08724739868e1368e3623d7ec048e245289d3cb42f158291cd3f1895d4f6105e41376eaee4ba2d1eb189
[Relay 1] [Relay] [RETURN] Base64-encoded AES-encrypted response: type=<class 'bytes'>, len=112, preview=b'EADr+LPJR7qKVkyHnYv5axHaCHJHOYaOE2jjYj1+wEjiRSidPLQvFYKRzT8Y'
[Relay 2] [Relay] [DEBUG] Received response from next relay: type=<class 'bytes'>, len=112, preview=b'EADr+LPJR7qKVkyHnYv5axHaCHJHOYaOE2jjYj1+wEjiRSidPLQvFYKRzT8Y'
[Relay 1] [Relay] [handle_message END] addr=('10.250.120.196', 52642), thread=6169620480
[Relay 2] [Relay] [RETURN] Base64-decoded response: type=<class 'bytes'>, len=82, preview=b'\x10\x00\xeb\xf8\xb3\xc9G\xba\x8aVL\x87\x9d\x8b\xf9k\x11\xda\x08rG9\x86\x8e\x13h\xe3b=~\xc0H\xe2E(\x9d<\xb4/\x15\x82\x91\xcd?\x18\x95\xd4\xf6\x10^A7n\xae\xe4\xba-\x1e\xb1\x89'
[Relay 2] [Relay] [RETURN] AES-decrypted response: type=<class 'bytes'>, len=66, preview=b'6\xfaL\xdck$\xbd\x97\x85\xdb| \x08\xa2\x00\xa1\x15\x1b\xc4\xa2\x91\x83\xe6-\xbeW[\x16\xa4\xa5`\xa6\xbb\x92>/\xce\x93\xaa\x8c\x1a[\x90ab\xa1\xc9~\xa6N\x81\x88\xa2\x82K0\xfck\xe48'
[Relay 2] [Relay] [RETURN] AES-decrypted response not UTF-8: 'utf-8' codec can't decode byte 0xfa in position 1: invalid start byte
[Relay 2] [Relay] [RETURN] AES-encrypted response (hex): cc26a4687c73d5e43b686a4bcfec85cee8484f48f01a339348fa5a69f6fd2bd42ca3a709087d5a039ae5be4bfa7c0bc56701c903a8d37808be4b6fe3
[Relay 2] [Relay] [RETURN] Base64-encoded AES-encrypted response: type=<class 'bytes'>, len=132, preview=b'zCakaHxz1eQ7aGpLz+yFzuhIT0jwGjOTSPpaafb9K9Qso6cJCH1aA5rlvkv6'
[Relay 2] [Relay] [handle_message END] addr=('10.250.120.196', 52639), thread=6194884608
[Relay] ---- Relay process started ----
[Relay 1] [Relay] Loaded persistent RSA keypair from relay1_key.pem
[Relay 1] [Relay] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] [KEY] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] Relay 1 starting on 10.250.120.196:9101 (RELAY PORT 9101)
[Relay 1] Registering with CDS at 127.0.0.1:9000
[Relay 1] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9101, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5MM7/HBECV26fZqjUJkt\nQ4+dx297cL0hf1+rf08Qir5tL/lArfQsiplTqcsIsZiN7vJ8K2XzvK5JAEv8tVE4\nEKU4W1hbEVBd1eLCX+Oc5XauTbWhW8xlc2wdNlNwDhin2Mw84doKJWPyfjtIwnIi\n3nWHqxLyAqkj6qDoByA8D7YVmJxvzwL0mrYE8G8b4Q4Wjnx2SXeTwc9LRzqwrsyb\nlM5B4BSVPBignOMhD2AfuIFw6uULQThbkL9L5AnQA08B4Gqzo731LLJN/Y6qo+VJ\nki2t6m1aJTG0LBjijpH7CtnN1MHIQ5UueS1sJVYZooYxkxEYYZTqIUXxuI5ICKPC\nCQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 1] [Relay] Listening for incoming messages on port 9101 (RELAY PORT 9101)
[Relay] ---- Relay process started ----
[Relay 2] [Relay] Loaded persistent RSA keypair from relay2_key.pem
[Relay 2] [Relay] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] [KEY] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] Relay 2 starting on 10.250.120.196:9102 (RELAY PORT 9102)
[Relay 2] Registering with CDS at 127.0.0.1:9000
[Relay 2] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9102, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA58J3pSrOQd4hYnuzQQ7q\nWrjjo+3BJp+ik23brR2yl0kjtfH+wjD9LYWHS7dBxsDRzSozJ/7EWKKNCaTsgvaF\nN6vpyBPqDM/uQfOWfirteL50RgDZw95Vml4Fuay7bTBEb1J8ydvFqawo8rnLE2I3\nU4BjBT+CD38bY3je8wrrCX9fo1uYaLDlfteGshadZ2gnTxrAzkZZ/CTFdyb8JrmN\nIuxjBVjwSA/uIv+KHWQhXRA5jJPXcNV88LYXyEzpid1Cr9gnrqA88K0HSleiwZjU\nJF3LhBvS2Ga2HHfFsk5D/yz/pTHwDvRA98VMT/90wahwmSJsck4XWDFhmNhy3oDR\nBQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 2] [Relay] Listening for incoming messages on port 9102 (RELAY PORT 9102)
[Relay] ---- Relay process started ----
[Relay 3] [Relay] Loaded persistent RSA keypair from relay3_key.pem
[Relay 3] [Relay] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] [Relay] [KEY] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] Relay 3 starting on 10.250.120.196:9103 (RELAY PORT 9103)
[Relay 3] Registering with CDS at 127.0.0.1:9000
[Relay 3] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9103, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5k9OJ8m3IdjmwR1skM1G\nwrKkwlYLK0Qs+I/BX5ww5wEakOsTy5NVFAwTYrCUnR012u2jCwI8wV1YpPaMa8RJ\ntnqNFy4pFfqBh5tmidHQ3QMRvINPrGtQM5+VgMXoA0y8izql52M1K/3Q6sHVlAXd\nmpQcBO+JSHY7uyVx1txZssyisia7Nn8Frh/XRpl0oUvGkSnbm/KgqDAP0xJ3lUZS\nEGiIWdf0bn7tHD3nYBMrWWi3jSQWf0Q80asIEYWipwkfMPf0ffzu4FX0elfvpyOX\nr50xk7sb8K5IhcilwxKxQpPOcq3f6ph0EERQR7pOdDqkzFdHoGiyssSX4MYM60kd\nmQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 3] [Relay] Listening for incoming messages on port 9103 (RELAY PORT 9103)
[Relay 1] [Relay] [handle_message ENTERED] addr=('10.250.120.196', 53154), thread=6169440256, relay_port=9101
[Relay 1] [Relay] [DEBUG] Raw data received: b'{"next_ip": "10.250.120.196", "next_port": 9101, "session_key": "awAPF1UL75Xy43ojWS/GFJPLXwQPIvgktNgAFAkalnthOjB8Ly25ID/g/RhmviYLF/xJSL315l39sODYg8Npclm8E1GOFVgjNKNBQlOfJHvXpkahWlEAUAOXKqcYb4gVGbFOSTLvSL8W6qsoB+st07I+hyvHufn0BZFQ2ck5fGtxrZVmhpc50MjbxwaEFb3WmZtuXK4GFd1q6ifUxWn7i1xo59jnUcwQlWAYwMlsAji2uflz5smMa8P1wPrbDCp53UXg6CEVO0mRiqmA07rKmVpfVXmztsEV5bA4gEOH2sY1PWMbaLo2nHK0JYx6JEV0n53/VUe7rs87a4qRoyCeeg==", "payload": "LDfwBHwdopR9l4RsX2owL9pbNi3Jyf7KYMHNkzT0b9Lqk8HDuPMmr0Bj2eA/kFDs21xaVa4WeRMh1eg+TNDRb+PnAXTvBnGrWAid4MVlveISR810jH+Cdk6Nf7qzsLS42IyZYavv3u7L+A90v2zoMfSeUCkTYVE49ofeTU3X6MnkfXFjTiEKuFLmXY8+dAn7uM6Fi8+5n7SD/j102nPYvnkHxALJ5EN7djx+zluWzszd7I+goUsN9Icv/waPNlLs8ssvJmeV9/QSrL/MS5aAkqpDiD5Gvw011sUz1eVyaFUYQZZXdSW8BpPxOWnHG08g7sQZ8x4OL/JaUQjrlGjjsfVamKLVoCBzXT3K5kn7PiIQJYCi7dVRhy7F+jdIK7TiLD7PLJueInR8sOTJ9w8oZ6TvxJ0YpqTTRaBIBB0QO8lMUmLvdgSAAN9zHkk8H+9D1WK76eTImUIO07ZgNLAS/Xsk6foh8vD0/PJqoj0AhqCmc2IxxGaitfYOhRaztfsKfo5hjjXciAb7GteiCLjUnR/vqa7/stwsxF6Rbu3TCZ79kvw/XQ49Ce4rnlGwlixV79wBicQkMWxU/I4/LJlPYPJLDu6y+MY4UEkGZwDOEpejmFW5bsrOMQO3uuUBMmWdIGz2nIf2S6O17kIo3R6N0tIoGZxePcQmHTJ8xhQ+F1f5KCSu4k8oADHkPXJhvBgmZqxdUrNFbDvyjZZ/JHU+AlSb6jaAm55ksFmN0MmRxAZzKWimGcKSqRzxZ7DeaKBB4wq7Yd7wY7tPOhhr8RO1YtVKmCWD4jeQRxZjk0aHLwIBZ7rGW7r3tLa+J30hJfOT6LHj0flW6LbaeJaJMZ7HiJ81jNWYZdLwLf8Joh8lKKhz2GqAewcGNW8PrqBVmpLoWmQMcQDqerrUz6gGBeTnfYdK3ehZoHByfniF3FK7c+YYipcG3tofimf1xHhwMeQrPc9kGmS+++D48RSnXrkmCho2LF1xKvStRBLnQw+4MO5eIa/mbuvp/FHVa2XYSK+a+2tQpBKLa8etlYGYAHDBtaR+x2PM1JpBN33lmKrKKWb3fxXz92eCnm27Cd1vEVF0hCphGQEgARMD8By45kwBSqfVPalGnSNMJIgzy3N+CCXNKthw/bNdKm8Jvs5pS4syG0cCcRGz/vLYBs3mWTILYhGANXAq62UrIPRyuQUGoqbOCR5xOMRk4YArrWuirw7lWQ4lI/JLLZZom8DPIz2HjhjevCHQJYZWaJyEqRjZQS7gOpLe9kFgD9AEbClLxPNFyOqEu0NJtAbfEOM/yNaacl7l3/j37esy2iE5QVpO7818iRpFobk6OQsJYlBTi7JDsQ8q6ftJ5uHqgclHux1APf3FK2r9X3+TJiRiD1A5A5WRktmMttEjHJBdjoDsjTf/EAC/VF656CzAtdKJDjrQDs5ClJFFQsirhUv2qadzZy6tXNUQE86Ouht6GwrtllZ52sg="}'
[Relay 1] [Relay] [DEBUG] Data after JSON parse: type=<class 'dict'>, keys=['next_ip', 'next_port', 'session_key', 'payload']
[Relay 1] [Relay] Received session_key (base64): awAPF1UL75Xy43ojWS/GFJPLXwQPIvgktNgAFAkalnthOjB8Ly25ID/g/RhmviYLF/xJSL315l39sODYg8Npclm8E1GOFVgjNKNBQlOfJHvXpkahWlEAUAOXKqcYb4gVGbFOSTLvSL8W6qsoB+st07I+hyvHufn0BZFQ2ck5fGtxrZVmhpc50MjbxwaEFb3WmZtuXK4GFd1q6ifUxWn7i1xo59jnUcwQlWAYwMlsAji2uflz5smMa8P1wPrbDCp53UXg6CEVO0mRiqmA07rKmVpfVXmztsEV5bA4gEOH2sY1PWMbaLo2nHK0JYx6JEV0n53/VUe7rs87a4qRoyCeeg==
[Relay 1] [Relay] Decoded session_key_enc (hex): 6b000f17550bef95f2e37a23592fc61493cb5f040f22f824b4d80014091a967b613a307c2f2db9203fe0fd1866be260b17fc4948bdf5e65dfdb0e0d883c3697259bc13518e15582334a34142539f247bd7a646a15a51005003972aa7186f881519b14e4932ef48bf16eaab2807eb2dd3b23e872bc7b9f9f4059150d9c9397c6b71ad9566869739d0c8dbc7068415bdd6999b6e5cae0615dd6aea27d4c569fb8b5c68e7d8e751cc10956018c0c96c0238b6b9f973e6c98c6bc3f5c0fadb0c2a79dd45e0e821153b49918aa980d3baca995a5f5579b3b6c115e5b038804387dac6353d631b68ba369c72b4258c7a2445749f9dff5547bbaecf3b6b8a91a3209e7a
[Relay 1] [Relay] Decrypting session key with fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] Decrypted session_key (hex): 02269b2f46e08d643fc1f18524a848cd368f20fd6cb827256c5c2c0a7da1a4a3
[Relay 1] [Relay] [DEBUG] About to AES-decrypt payload (passing base64 string directly)
[Relay 1] [Relay] [DEBUG] Payload base64-decoded: type=<class 'bytes'>, len=1106, preview=b',7\xf0\x04|\x1d\xa2\x94}\x97\x84l_j0/\xda[6-\xc9\xc9\xfe\xca`\xc1\xcd\x934\xf4o\xd2\xea\x93\xc1\xc3\xb8\xf3&\xaf@c\xd9\xe0?\x90P\xec\xdb\\ZU\xae\x16y\x13!\xd5\xe8>'
[Relay 1] [Relay] [DEBUG] AES-decrypted payload: type=<class 'bytes'>, len=1090, preview=b'{"next_ip": "10.250.120.196", "next_port": 9103, "session_ke'
[Relay 1] [Relay] [DEBUG] AES-decrypted payload (hex): 7b226e6578745f6970223a202231302e3235302e3132302e313936222c20226e6578745f706f7274223a20393130332c202273657373696f6e5f6b65
[Relay 1] [Relay] [DEBUG] Next hop JSON keys: ['next_ip', 'next_port', 'session_key', 'payload']
[Relay 1] [Relay] [DEBUG] Forwarding to next relay 10.250.120.196:9103
[Relay 3] [Relay] [handle_message ENTERED] addr=('10.250.120.196', 53164), thread=6195654656, relay_port=9103
[Relay 3] [Relay] [DEBUG] Raw data received: b'{"next_ip": "10.250.120.196", "next_port": 9103, "session_key": "BLk6Y5JxKM+SfPtvX2KNBlzvODErylksx2i/+8oI2MCGSTbr7RmlndQ5u9eO6nWfMXV7HmBnLb/aNLD5RsJRFZf45FZpqT1jtqWg0u8Rnb58gNPYm3I5AnBowtvV9mmQzy9T4ZFftvBJJSy4GnRXYKeGxK152XRmOhnMD2KLhCP9saHQht4IvzuxOZ4Y+QI/6SpyhReHiuGJywUT7jdblE58BubZXkSbvKT1OT5nB49wuAkJiBtZykao48OBS6yJ+z+1cqCSLmOg7kit+TLwm+DsoDsO6fkw13w1w7hZp5KgjWaXdwWivjG4Y7BS/aKz5ASE0qLTM+ndnr5zCWcgjw==", "payload": "9Na+Aba8rct2bY19LY3Pk4b39TYGUDNbm0fPwv4aK3DCjSbFfY3YkLhFLwrqssFl717eTwTWBf8AAsaFsQptd2PQXA3fSBm7S6oi3Uon2EGX0tQC0xtV+aDnxkcUNm7P+g/2xIYrFQECujp7LWDeu4UiTGLoHFioXM+yGCZZxNuMgAXaw3mShYe1nZCf7NLkdaQB/fseFcyjWXtEC0gEcmaWIE4Alt+vE4v4OSIMo44KrAUcI/8ZIHcuKIplznd1QUbeMu7/Y9ow672/u/FO70adUwWDWB9eSDa5ZURhf0BIqLpdp9k4O3HENSRgNpJMiLVSYgiYpl6eAprXy0LoksXE2QiOP5/XhPplYy/FmLwTInxe2pcmXq0WT9jyLpbBdbDW29O0mOUpkWGYhX1z+FTG2wggnOB4VJppwakBAwUiiUMxYvjMNj5UzYDDsVgB3RAynSKnqRkauGyfidDf38zY+PjAQrFuH1kPQBPYDAMo2FI6JiDAr9zBEec/0TdCqa7SMb21h5k9s/jWGW2rTzylFA487JpHsT/6gQMVgWrxQBARJDOczLPY2CLQcvZUcoaftjJZ8Z5bwQU/OrXSPWMfNLx1zphoSDm5SsvfIFIlkJ+xvJbnHaZdTyskYGWLAVWPFb0DNT1oB98giAxM8PQD"}'
[Relay 3] [Relay] [DEBUG] Data after JSON parse: type=<class 'dict'>, keys=['next_ip', 'next_port', 'session_key', 'payload']
[Relay 3] [Relay] Received session_key (base64): BLk6Y5JxKM+SfPtvX2KNBlzvODErylksx2i/+8oI2MCGSTbr7RmlndQ5u9eO6nWfMXV7HmBnLb/aNLD5RsJRFZf45FZpqT1jtqWg0u8Rnb58gNPYm3I5AnBowtvV9mmQzy9T4ZFftvBJJSy4GnRXYKeGxK152XRmOhnMD2KLhCP9saHQht4IvzuxOZ4Y+QI/6SpyhReHiuGJywUT7jdblE58BubZXkSbvKT1OT5nB49wuAkJiBtZykao48OBS6yJ+z+1cqCSLmOg7kit+TLwm+DsoDsO6fkw13w1w7hZp5KgjWaXdwWivjG4Y7BS/aKz5ASE0qLTM+ndnr5zCWcgjw==
[Relay 3] [Relay] Decoded session_key_enc (hex): 04b93a63927128cf927cfb6f5f628d065cef38312bca592cc768bffbca08d8c0864936ebed19a59dd439bbd78eea759f31757b1e60672dbfda34b0f946c2511597f8e45669a93d63b6a5a0d2ef119dbe7c80d3d89b7239027068c2dbd5f66990cf2f53e1915fb6f049252cb81a745760a786c4ad79d974663a19cc0f628b8423fdb1a1d086de08bf3bb1399e18f9023fe92a728517878ae189cb0513ee375b944e7c06e6d95e449bbca4f5393e67078f70b80909881b59ca46a8e3c3814bac89fb3fb572a0922e63a0ee48adf932f09be0eca03b0ee9f930d77c35c3b859a792a08d66977705a2be31b863b052fda2b3e40484d2a2d333e9dd9ebe730967208f
[Relay 3] [Relay] Decrypting session key with fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] [Relay] Decrypted session_key (hex): 8811f7aad5e46d9f68a2d4888525da39f35f4cb0e57807e0d6b807c4aa71ee37
[Relay 3] [Relay] [DEBUG] About to AES-decrypt payload (passing base64 string directly)
[Relay 3] [Relay] [DEBUG] Payload base64-decoded: type=<class 'bytes'>, len=498, preview=b'\xf4\xd6\xbe\x01\xb6\xbc\xad\xcbvm\x8d}-\x8d\xcf\x93\x86\xf7\xf56\x06P3[\x9bG\xcf\xc2\xfe\x1a+p\xc2\x8d&\xc5}\x8d\xd8\x90\xb8E/\n\xea\xb2\xc1e\xef^\xdeO\x04\xd6\x05\xff\x00\x02\xc6\x85'
[Relay 3] [Relay] [DEBUG] AES-decrypted payload: type=<class 'bytes'>, len=482, preview=b'{"next_ip": "10.250.120.196", "next_port": 9102, "session_ke'
[Relay 3] [Relay] [DEBUG] AES-decrypted payload (hex): 7b226e6578745f6970223a202231302e3235302e3132302e313936222c20226e6578745f706f7274223a20393130322c202273657373696f6e5f6b65
[Relay 3] [Relay] [DEBUG] Next hop JSON keys: ['next_ip', 'next_port', 'session_key', 'payload']
[Relay 3] [Relay] [DEBUG] Forwarding to next relay 10.250.120.196:9102
[Relay 2] [Relay] [handle_message ENTERED] addr=('10.250.120.196', 53165), thread=6194491392, relay_port=9102
[Relay 2] [Relay] [DEBUG] Raw data received: b'{"next_ip": "10.250.120.196", "next_port": 9102, "session_key": "xA+aTb8TFwAL/RX8vU8SzYJJA4yF0ZaiS1sAIQK3t5n9fPXBlWsnNV/3RpHT/KH4b4qXmgYhUqYu768qhtr2vcIVI714HmYJLEgc9DSpjZhQfXoFY3bbHlCmrlfocnTengrY3duDKs2mXKexYfxua8kehZlpw+hVs6hFGHLx7tg9CYcVNZ2XYryW/M9EXacW0Rvee95EWmcari7qDAgc6Y2d8NcFD2y4m+/qDI6T6RV2AxSvousitubf2JDOi/6qvKR7O0Lrlv80te3j7d8TRXCVEG+eN1HnIWjNc5IOUvP/kDADMFVPdlD1w/tK8sj/SPmcUceZrCV7ewKnDmv5EQ==", "payload": "/Pxtdh8E50Mo9Jmdb4lx+7N8YNM1U0wBWrqh9N549ERGYadz5vX4rw=="}'
[Relay 2] [Relay] [DEBUG] Data after JSON parse: type=<class 'dict'>, keys=['next_ip', 'next_port', 'session_key', 'payload']
[Relay 2] [Relay] Received session_key (base64): xA+aTb8TFwAL/RX8vU8SzYJJA4yF0ZaiS1sAIQK3t5n9fPXBlWsnNV/3RpHT/KH4b4qXmgYhUqYu768qhtr2vcIVI714HmYJLEgc9DSpjZhQfXoFY3bbHlCmrlfocnTengrY3duDKs2mXKexYfxua8kehZlpw+hVs6hFGHLx7tg9CYcVNZ2XYryW/M9EXacW0Rvee95EWmcari7qDAgc6Y2d8NcFD2y4m+/qDI6T6RV2AxSvousitubf2JDOi/6qvKR7O0Lrlv80te3j7d8TRXCVEG+eN1HnIWjNc5IOUvP/kDADMFVPdlD1w/tK8sj/SPmcUceZrCV7ewKnDmv5EQ==
[Relay 2] [Relay] Decoded session_key_enc (hex): c40f9a4dbf1317000bfd15fcbd4f12cd8249038c85d196a24b5b002102b7b799fd7cf5c1956b27355ff74691d3fca1f86f8a979a062152a62eefaf2a86daf6bdc21523bd781e66092c481cf434a98d98507d7a056376db1e50a6ae57e87274de9e0ad8dddb832acda65ca7b161fc6e6bc91e859969c3e855b3a8451872f1eed83d098715359d9762bc96fccf445da716d11bde7bde445a671aae2eea0c081ce98d9df0d7050f6cb89befea0c8e93e915760314afa2eb22b6e6dfd890ce8bfeaabca47b3b42eb96ff34b5ede3eddf13457095106f9e3751e72168cd73920e52f3ff90300330554f7650f5c3fb4af2c8ff48f99c51c799ac257b7b02a70e6bf911
[Relay 2] [Relay] Decrypting session key with fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] Decrypted session_key (hex): 9d38da5da4519e5205256cd5fbeb1a8ec499944fb88ca23ee3a196ad38d878dd
[Relay 2] [Relay] [DEBUG] About to AES-decrypt payload (passing base64 string directly)
[Relay 2] [Relay] [DEBUG] Payload base64-decoded: type=<class 'bytes'>, len=40, preview=b'\xfc\xfcmv\x1f\x04\xe7C(\xf4\x99\x9do\x89q\xfb\xb3|`\xd35SL\x01Z\xba\xa1\xf4\xdex\xf4DFa\xa7s\xe6\xf5\xf8\xaf'
[Relay 2] [Relay] [DEBUG] AES-decrypted payload: type=<class 'bytes'>, len=24, preview=b'{"msg": "Hello, world!"}'
[Relay 2] [Relay] [DEBUG] AES-decrypted payload (hex): 7b226d7367223a202248656c6c6f2c20776f726c6421227d
[Relay 2] [Relay] [DEBUG] Next hop JSON keys: ['msg']
[Relay 2] [Relay] [DEBUG] Payload is not JSON, assuming last hop. Error: 'next_ip'
[Relay 2] [Relay] [Last Hop] Forwarding payload to dest 127.0.0.1:9100, len=24, type=<class 'bytes'>
[Relay 2] [Relay] [Last Hop] Sending to dest: type=<class 'bytes'>, len=24, preview=b'{"msg": "Hello, world!"}'
[Relay 2] [Relay] [Last Hop] Received response from dest: type=<class 'bytes'>, len=50, preview=b'{"result": "OK", "echo": {"msg": "Hello, world!"}}'
[Relay 2] [Relay] [Last Hop] Response from dest decoded as UTF-8: '{"result": "OK", "echo": {"msg": "Hello, world!"}}'
[Relay 2] [Relay] [Last Hop] Response from dest (hex): 7b22726573756c74223a20224f4b222c20226563686f223a207b226d7367223a202248656c6c6f2c20776f726c6421227d7d
[Relay 2] [Relay] [Last Hop] About to AES-encrypt response: type=<class 'bytes'>, len=50, preview=b'{"result": "OK", "echo": {"msg": "Hello, world!"}}'
[Relay 2] [Relay] [Last Hop] AES-encrypted response (hex): 87eac55fe7e0a05e58d670484fd7e90bc25211a5d7a8362b35375e0b14d0c407f2a17889e8c355301af3a252d587aff0d93ee55fb019a5cbffae3548
[Relay 2] [Relay] [Last Hop] Base64-encoded AES-encrypted response: type=<class 'bytes'>, len=88, preview=b'h+rFX+fgoF5Y1nBIT9fpC8JSEaXXqDYrNTdeCxTQxAfyoXiJ6MNVMBrzolLV'
[Relay 2] [Relay] [Last Hop] Sent response to ('10.250.120.196', 53165): b'h+rFX+fgoF5Y1nBIT9fpC8JSEaXXqDYrNTdeCxTQxAfyoXiJ6MNVMBrzolLV'... (len=88)
[Relay 3] [Relay] [DEBUG] Received response from next relay: type=<class 'bytes'>, len=88, preview=b'h+rFX+fgoF5Y1nBIT9fpC8JSEaXXqDYrNTdeCxTQxAfyoXiJ6MNVMBrzolLV'
[Relay 2] [Relay] [handle_message END] addr=('10.250.120.196', 53165), thread=6194491392
[Relay 3] [Relay] [RETURN] Base64-decoded response: type=<class 'bytes'>, len=66, preview=b'\x87\xea\xc5_\xe7\xe0\xa0^X\xd6pHO\xd7\xe9\x0b\xc2R\x11\xa5\xd7\xa86+57^\x0b\x14\xd0\xc4\x07\xf2\xa1x\x89\xe8\xc3U0\x1a\xf3\xa2R\xd5\x87\xaf\xf0\xd9>\xe5_\xb0\x19\xa5\xcb\xff\xae5H'
[Relay 3] [Relay] [RETURN] AES-decrypted response: type=<class 'bytes'>, len=50, preview=b'GW\xc8T\x83GW\xf7N\xcaj\x80t\xee{-\t\x8e\xf2\x16\x959Z\xa4\xde[g\xd8\xd4T\xe7\xd4\xa5\xe6-\xc2\xf7\xd8\xa2XA{\xbeo\xd2\xdb\x8fah\x9f'
[Relay 3] [Relay] [RETURN] AES-decrypted response not UTF-8: 'utf-8' codec can't decode byte 0xc8 in position 2: invalid continuation byte
[Relay 3] [Relay] [RETURN] AES-encrypted response (hex): ecd4e275c7cce90005287daa25415bbf0a180f31ee8b04a0e5a259566ff52f27da48240fffd05aae897aaf0da403505c45a9be7323f4bd657f9e7648
[Relay 3] [Relay] [RETURN] Base64-encoded AES-encrypted response: type=<class 'bytes'>, len=112, preview=b'7NTidcfM6QAFKH2qJUFbvwoYDzHuiwSg5aJZVm/1LyfaSCQP/9Barol6rw2k'
[Relay 3] [Relay] [handle_message END] addr=('10.250.120.196', 53164), thread=6195654656
[Relay 1] [Relay] [DEBUG] Received response from next relay: type=<class 'bytes'>, len=112, preview=b'7NTidcfM6QAFKH2qJUFbvwoYDzHuiwSg5aJZVm/1LyfaSCQP/9Barol6rw2k'
[Relay 1] [Relay] [RETURN] Base64-decoded response: type=<class 'bytes'>, len=82, preview=b"\xec\xd4\xe2u\xc7\xcc\xe9\x00\x05(}\xaa%A[\xbf\n\x18\x0f1\xee\x8b\x04\xa0\xe5\xa2YVo\xf5/'\xdaH$\x0f\xff\xd0Z\xae\x89z\xaf\r\xa4\x03P\\E\xa9\xbes#\xf4\xbde\x7f\x9evH"
[Relay 1] [Relay] [RETURN] AES-decrypted response: type=<class 'bytes'>, len=66, preview=b'[\x17]\x1e\xbf\xd6\xfc\xf4\xbb^\xe4;2h#\x8d\xc3\xbe|5\xb0\r5\x82jj\x1a\xa8d\xb8x\x1a\x10\x82\x15\xd5\xb8P\xd4\xe7h\x9b\xf2\x0c#m\xee\xcf\x95&lg\x01wr\x98\xa3;$\xe8'
[Relay 1] [Relay] [RETURN] AES-decrypted response not UTF-8: 'utf-8' codec can't decode byte 0xbf in position 4: invalid start byte
[Relay 1] [Relay] [RETURN] AES-encrypted response (hex): 3505ae330b8c411cfe76efe26a44917982901f21746dc7ecc7c97c5a09885740879027ad5a867d8c2d88b06c1b0e498b8b1d1a1faa65e774cee12cae
[Relay 1] [Relay] [RETURN] Base64-encoded AES-encrypted response: type=<class 'bytes'>, len=132, preview=b'NQWuMwuMQRz+du/iakSReYKQHyF0bcfsx8l8WgmIV0CHkCetWoZ9jC2IsGwb'
[Relay] ---- Relay process started ----
[Relay 1] [Relay] Loaded persistent RSA keypair from relay1_key.pem
[Relay 1] [Relay] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] [KEY] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] Relay 1 starting on 10.250.120.196:9101 (RELAY PORT 9101)
[Relay 1] Registering with CDS at 127.0.0.1:9000
[Relay 1] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9101, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5MM7/HBECV26fZqjUJkt\nQ4+dx297cL0hf1+rf08Qir5tL/lArfQsiplTqcsIsZiN7vJ8K2XzvK5JAEv8tVE4\nEKU4W1hbEVBd1eLCX+Oc5XauTbWhW8xlc2wdNlNwDhin2Mw84doKJWPyfjtIwnIi\n3nWHqxLyAqkj6qDoByA8D7YVmJxvzwL0mrYE8G8b4Q4Wjnx2SXeTwc9LRzqwrsyb\nlM5B4BSVPBignOMhD2AfuIFw6uULQThbkL9L5AnQA08B4Gqzo731LLJN/Y6qo+VJ\nki2t6m1aJTG0LBjijpH7CtnN1MHIQ5UueS1sJVYZooYxkxEYYZTqIUXxuI5ICKPC\nCQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 1] [Relay] Listening for incoming messages on port 9101 (RELAY PORT 9101)
[Relay] ---- Relay process started ----
[Relay 2] [Relay] Loaded persistent RSA keypair from relay2_key.pem
[Relay 2] [Relay] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] [KEY] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] Relay 2 starting on 10.250.120.196:9102 (RELAY PORT 9102)
[Relay 2] Registering with CDS at 127.0.0.1:9000
[Relay 2] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9102, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA58J3pSrOQd4hYnuzQQ7q\nWrjjo+3BJp+ik23brR2yl0kjtfH+wjD9LYWHS7dBxsDRzSozJ/7EWKKNCaTsgvaF\nN6vpyBPqDM/uQfOWfirteL50RgDZw95Vml4Fuay7bTBEb1J8ydvFqawo8rnLE2I3\nU4BjBT+CD38bY3je8wrrCX9fo1uYaLDlfteGshadZ2gnTxrAzkZZ/CTFdyb8JrmN\nIuxjBVjwSA/uIv+KHWQhXRA5jJPXcNV88LYXyEzpid1Cr9gnrqA88K0HSleiwZjU\nJF3LhBvS2Ga2HHfFsk5D/yz/pTHwDvRA98VMT/90wahwmSJsck4XWDFhmNhy3oDR\nBQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 2] [Relay] Listening for incoming messages on port 9102 (RELAY PORT 9102)
[Relay] ---- Relay process started ----
[Relay 3] [Relay] Loaded persistent RSA keypair from relay3_key.pem
[Relay 3] [Relay] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] [Relay] [KEY] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] Relay 3 starting on 10.250.120.196:9103 (RELAY PORT 9103)
[Relay 3] Registering with CDS at 127.0.0.1:9000
[Relay 3] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9103, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5k9OJ8m3IdjmwR1skM1G\nwrKkwlYLK0Qs+I/BX5ww5wEakOsTy5NVFAwTYrCUnR012u2jCwI8wV1YpPaMa8RJ\ntnqNFy4pFfqBh5tmidHQ3QMRvINPrGtQM5+VgMXoA0y8izql52M1K/3Q6sHVlAXd\nmpQcBO+JSHY7uyVx1txZssyisia7Nn8Frh/XRpl0oUvGkSnbm/KgqDAP0xJ3lUZS\nEGiIWdf0bn7tHD3nYBMrWWi3jSQWf0Q80asIEYWipwkfMPf0ffzu4FX0elfvpyOX\nr50xk7sb8K5IhcilwxKxQpPOcq3f6ph0EERQR7pOdDqkzFdHoGiyssSX4MYM60kd\nmQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 3] [Relay] Listening for incoming messages on port 9103 (RELAY PORT 9103)
[Relay 2] [Relay] [handle_message ENTERED] addr=('10.250.120.196', 60603), thread=6200995840, relay_port=9102
[Relay 2] [Relay] [DEBUG] Raw data received: b'{"next_ip": "10.250.120.196", "next_port": 9102, "session_key": "4UEqbvu9wVcvTkMrnAi8LJ0dMwDdpeAvOh1ugcedyR1UkgtmaPiOind1q3BlR+Tzv8naCu27I3AnDQAa1MJPeBaCptSWU2W5RrObYenwO6uTHI/XnHBX0cIH+pquWnRMqMQVe/3TvoEBiC8zFzbv3NdAeLg1Vp++cvxzYJwJndLm1faSYEBvt3hQRcxzQVh8HqQGdUljKFTpILBCKb+1dXnS2AdgpxMlvUCSYk7QPVv02yiR46Bx8OMkz6hvLZFlneeLdSBNLiEe4szV+8+SWJDGHrsbk6+Xu6Z3Uhubpz+ZXg0cXgD8/D4bEJCUq75yElGg3tNacxODDxVec9t5FQ==", "payload": "Lj0MiN5ka6GmQAu/ZIARNBUa6RMcJBiXLT6ub/JmeOxxIU6kTHxnVQHaRn3MQwRiC/n63/n+FGid5czc1ZdnUmfUxf03sr6jsDku0afL7DOltulf51OGDzA8lieqetuXzj+GvmFumVwWcrfDuse4BmCa+pfjwjYrQXYpkEkEQuZStHEsvJUu9Z+515l+DM1TACIZdC2TwuRFq/FQ6nROV2f4QZ4wY7SuMvGivVqKMTfch2VqGEiXM0mSrQB5ag5z6Hp+qEZg71nu0pdt3TK5btJ24PKND/HLBOyOLwD4Xx9JGEES8UN8y3/2KpjqVjlv9k1sbpBPDLnaKq13JgIrUTlJ6pzvX+BtZxCRHV5VCfDbJiVFUpd4mXfDc0p2hch7PyTnHWbDoz3uJ6r7uvefwALvL73WI08RLaMgAngVHYE7tKl4yeaJl8EqVoNC1xKaWywl1+sNgtGc/btYXb8S9OcXun3pi2FnH7zbgRRvO6yqRjneaceD4Zi5gSYTVwznTNEyshOkCQozAs100pRCx4pfqQapfbS5hRUo/M2FoWCAUl2ID5rRHaAf0IfgNOsgA9OexpsKvFreZsHynWp3Gr6XnUraamv9dqJ5eleKIlf/TW0jZSinc3/upO2TTept9es9ChlXs2TAyPUuPWlnZ+5EE61Q87awXrQLosvrLLxgfiIlznNOsmcN3TZqgpdriQtWhk1/5qRFcKuE3eT1bTxv4AFLA6vE4EzFrLF4nZ1YIc2oHqBi7IDXpxHiW1HbV//K4THJKGbAzJhB4Pv+rEepPFGXy2gZntIqbHnlugoym9gIH57dkHNab3nnJ2ZuW/MplhA7oK/WORVC3d+MxynhGEy95q3Pf4Wri8pjfngFGA+s1ye6Xe98su2GSNbCw426cjS2rLTGuPfztvd1Jv+olgXCZ2XYL4w38IEcdkbRFk4ITCfZ41SCPW3auermV+hQlenq0GDn/Vt62quiXKi1u0wGjzhql4WT8N5oD2enshumwUdvE8MoqJtag1fIaJn1TgZAQWBFjeMlNZlK4yt+ekVg4GRxBXdAfRD4VMakRFtzeovXh9hO99ftW8ILJ+o7D66iEJb6tdg6yhhUtjmQWOLKz9gVz2WZBNyEePv+5dsQfJEyb9+kDzVPh7nyUcA9+qicuS1s6XAZvDdCz/LaIB7h3nnwiqUR8d86D30uYNvgCWeJM5/77Y1NOV1mwWylVHT1BDc2aR19an1+JuXRlv8fgSPN4+u3JgACUprqaNYT655NMKMPQkvKV4dvB+v54noZN01rVIHTdCN1wxmnd/HYiGUBs0nZ6+qe/UC+Pzc8nrj4bNbKHkndEizfC/6gAZKlD3oVr0ZT3ds4YWlNMLYUZM3ctHq3DAAFOm9She0SiyU4uxb6hETpA2RTpQzmfxPR9undyYCiP+sk1x8VOeH8WbDOC37Te1toBZOdrOpLcbPUPijeXUhAwEXiQAQ="}'
[Relay 2] [Relay] [DEBUG] Data after JSON parse: type=<class 'dict'>, keys=['next_ip', 'next_port', 'session_key', 'payload']
[Relay 2] [Relay] Received session_key (base64): 4UEqbvu9wVcvTkMrnAi8LJ0dMwDdpeAvOh1ugcedyR1UkgtmaPiOind1q3BlR+Tzv8naCu27I3AnDQAa1MJPeBaCptSWU2W5RrObYenwO6uTHI/XnHBX0cIH+pquWnRMqMQVe/3TvoEBiC8zFzbv3NdAeLg1Vp++cvxzYJwJndLm1faSYEBvt3hQRcxzQVh8HqQGdUljKFTpILBCKb+1dXnS2AdgpxMlvUCSYk7QPVv02yiR46Bx8OMkz6hvLZFlneeLdSBNLiEe4szV+8+SWJDGHrsbk6+Xu6Z3Uhubpz+ZXg0cXgD8/D4bEJCUq75yElGg3tNacxODDxVec9t5FQ==
[Relay 2] [Relay] Decoded session_key_enc (hex): e1412a6efbbdc1572f4e432b9c08bc2c9d1d3300dda5e02f3a1d6e81c79dc91d54920b6668f88e8a7775ab706547e4f3bfc9da0aedbb2370270d001ad4c24f781682a6d4965365b946b39b61e9f03bab931c8fd79c7057d1c207fa9aae5a744ca8c4157bfdd3be8101882f331736efdcd74078b835569fbe72fc73609c099dd2e6d5f69260406fb7785045cc7341587c1ea4067549632854e920b04229bfb57579d2d80760a71325bd4092624ed03d5bf4db2891e3a071f0e324cfa86f2d91659de78b75204d2e211ee2ccd5fbcf925890c61ebb1b93af97bba677521b9ba73f995e0d1c5e00fcfc3e1b109094abbe721251a0ded35a7313830f155e73db7915
[Relay 2] [Relay] Decrypting session key with fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] Decrypted session_key (hex): 6bf844550617f1e4ef5730ed92c1b8b77d0f4d44289878bafa138f6b6431a83d
[Relay 2] [Relay] [DEBUG] About to AES-decrypt payload (passing base64 string directly)
[Relay 2] [Relay] [DEBUG] Payload base64-decoded: type=<class 'bytes'>, len=1106, preview=b'.=\x0c\x88\xdedk\xa1\xa6@\x0b\xbfd\x80\x114\x15\x1a\xe9\x13\x1c$\x18\x97->\xaeo\xf2fx\xecq!N\xa4L|gU\x01\xdaF}\xccC\x04b\x0b\xf9\xfa\xdf\xf9\xfe\x14h\x9d\xe5\xcc\xdc'
[Relay 2] [Relay] [DEBUG] AES-decrypted payload: type=<class 'bytes'>, len=1090, preview=b'{"next_ip": "10.250.120.196", "next_port": 9103, "session_ke'
[Relay 2] [Relay] [DEBUG] AES-decrypted payload (hex): 7b226e6578745f6970223a202231302e3235302e3132302e313936222c20226e6578745f706f7274223a20393130332c202273657373696f6e5f6b65
[Relay 2] [Relay] [DEBUG] Next hop JSON keys: ['next_ip', 'next_port', 'session_key', 'payload']
[Relay 2] [Relay] [DEBUG] Forwarding to next relay 10.250.120.196:9103
[Relay 3] [Relay] [handle_message ENTERED] addr=('10.250.120.196', 60609), thread=6200979456, relay_port=9103
[Relay 3] [Relay] [DEBUG] Raw data received: b'{"next_ip": "10.250.120.196", "next_port": 9103, "session_key": "nkrCg/Zdo4zOUWcSsSAxqhe5phqwBPELYJKuArCbGE8yqGnWHL5v1Zoe8FUT+7H5Nhobz5GFx4TUwqA6GQC2+fUhhM9RE1X2sw0OLNWUy3IEHsaFujpXdaccAQV9jXBeqe88VfEeU+O9JsYuKmDVn8kV5Ni1SMAOptP2gDc/cNzTk9k1m5nKE2VB6pUm+/e08luVJYx+iwkbXAYyk4SBeTwwfxhB8rY85AzJQ5P9Re7GYkqd8UO511skarQ224b/wiRHgk4NUtbvRNuGtJcAk+ePI9oDaAK3jgOtCI26XFtmDEKqWjODtBHV4sLH41kIr713V+cdLS2/REYCohfGVA==", "payload": "6AAoPs2GTQ7Yuc4XdLmWY2jKIOn6yhkH8EE/VnPNvJIrbB05M7X/6xAFarnBzvdlr5vDGEBMLBGR9TfhsRmmvsrg/Ogyt8LWMqhQe7xAw7+l4NQuN0ACpdsk3tSibB2m2ih37Ma+40mCcB5sgDXnVQszUbMO8sVZfE07IfPJm6SplEK1bem6dz5LCVaoAInjLg2/vVarYIyBZVSd45MUJk0nD8MxLLg29gk0l2i35atlB7eZEjUod14EuyB9CC/O0yLGzxCciqNeSuNRL+XTFQPotSJkC+KlSIhs9f0531Cn4QP2WnnWz1uV8UYZ1hj+P2LEJoLJV5n9fjkNoujaEB1nlexBopR97Va/EvzcmXzNQV3gH58dXHTOjpqfoxBKZ1AV4TsPFuI0YYNc2XmPVntly4vvKK9LQyjkrX9LZSunLSTVLZdq4IUjz9ys8bAsysnn1zhTi+qXG40O6BGFwK7xyWdNnBUAyd0+nZcTCsjgwNGSCMCTuLj6yR+HUdL9x7pV5S3B2v18V7XYmEqtvLpFgyekh2MSVLMuQ4Ra3iqhYv+SbBqZ30xJpzud95uzC6G1iM/Sf4yKKFVQJ26ZBKdv24fQsXcNZ7IMcHwhenQAXEQCgh2rlhaCYu+5ZCUVpS6ApoVpV/37fQ4Q4QcAQD9i"}'
[Relay 3] [Relay] [DEBUG] Data after JSON parse: type=<class 'dict'>, keys=['next_ip', 'next_port', 'session_key', 'payload']
[Relay 3] [Relay] Received session_key (base64): nkrCg/Zdo4zOUWcSsSAxqhe5phqwBPELYJKuArCbGE8yqGnWHL5v1Zoe8FUT+7H5Nhobz5GFx4TUwqA6GQC2+fUhhM9RE1X2sw0OLNWUy3IEHsaFujpXdaccAQV9jXBeqe88VfEeU+O9JsYuKmDVn8kV5Ni1SMAOptP2gDc/cNzTk9k1m5nKE2VB6pUm+/e08luVJYx+iwkbXAYyk4SBeTwwfxhB8rY85AzJQ5P9Re7GYkqd8UO511skarQ224b/wiRHgk4NUtbvRNuGtJcAk+ePI9oDaAK3jgOtCI26XFtmDEKqWjODtBHV4sLH41kIr713V+cdLS2/REYCohfGVA==
[Relay 3] [Relay] Decoded session_key_enc (hex): 9e4ac283f65da38cce516712b12031aa17b9a61ab004f10b6092ae02b09b184f32a869d61cbe6fd59a1ef05513fbb1f9361a1bcf9185c784d4c2a03a1900b6f9f52184cf511355f6b30d0e2cd594cb72041ec685ba3a5775a71c01057d8d705ea9ef3c55f11e53e3bd26c62e2a60d59fc915e4d8b548c00ea6d3f680373f70dcd393d9359b99ca136541ea9526fbf7b4f25b95258c7e8b091b5c0632938481793c307f1841f2b63ce40cc94393fd45eec6624a9df143b9d75b246ab436db86ffc22447824e0d52d6ef44db86b4970093e78f23da036802b78e03ad088dba5c5b660c42aa5a3383b411d5e2c2c7e35908afbd7757e71d2d2dbf444602a217c654
[Relay 3] [Relay] Decrypting session key with fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] [Relay] Decrypted session_key (hex): b7b3acba2a62175c3b3db8eed2f7b751e0d0fd47f2349cc0a5fbfa34c764118c
[Relay 3] [Relay] [DEBUG] About to AES-decrypt payload (passing base64 string directly)
[Relay 3] [Relay] [DEBUG] Payload base64-decoded: type=<class 'bytes'>, len=498, preview=b'\xe8\x00(>\xcd\x86M\x0e\xd8\xb9\xce\x17t\xb9\x96ch\xca \xe9\xfa\xca\x19\x07\xf0A?Vs\xcd\xbc\x92+l\x1d93\xb5\xff\xeb\x10\x05j\xb9\xc1\xce\xf7e\xaf\x9b\xc3\x18@L,\x11\x91\xf57\xe1'
[Relay 3] [Relay] [DEBUG] AES-decrypted payload: type=<class 'bytes'>, len=482, preview=b'{"next_ip": "10.250.120.196", "next_port": 9101, "session_ke'
[Relay 3] [Relay] [DEBUG] AES-decrypted payload (hex): 7b226e6578745f6970223a202231302e3235302e3132302e313936222c20226e6578745f706f7274223a20393130312c202273657373696f6e5f6b65
[Relay 3] [Relay] [DEBUG] Next hop JSON keys: ['next_ip', 'next_port', 'session_key', 'payload']
[Relay 3] [Relay] [DEBUG] Forwarding to next relay 10.250.120.196:9101
[Relay 1] [Relay] [handle_message ENTERED] addr=('10.250.120.196', 60613), thread=6163378176, relay_port=9101
[Relay 1] [Relay] [DEBUG] Raw data received: b'{"next_ip": "10.250.120.196", "next_port": 9101, "session_key": "sMlGfp4I/f8PqqOExlK4I30OGEo5/F0kj/cX9rKOSX5UbFtkEPEIbcRw9hFrZp0fA48Q1NHeQp4hOzMKXpM9lJ0bnlAywUN2L7HZBrh0FfYRKCM/XJkaVPhWEXngAj4kpcVFanLIcXPHSqZ5cZfD2xM1VwoL258mfPgJds9JOZFg1aSKcoA87MEl9O1eranE9c2wz6I2DoCVfBVb9htSmAuPwoRDLztsYJwckgAN5KFfOZOghAbD7UmsIO3F8buHbX6SLL/28RO9KKkxXp8F1nt40QH/zdg9ftl27PMAyMSnlNdfjptq0LrZMBToeQovhVAf/XfhjESj7Z9fpucwkg==", "payload": "rCKzql4+2P2EreylI91y5da9tZFqBXWW616sFjDCdSabHO/SWysXXA=="}'
[Relay 1] [Relay] [DEBUG] Data after JSON parse: type=<class 'dict'>, keys=['next_ip', 'next_port', 'session_key', 'payload']
[Relay 1] [Relay] Received session_key (base64): sMlGfp4I/f8PqqOExlK4I30OGEo5/F0kj/cX9rKOSX5UbFtkEPEIbcRw9hFrZp0fA48Q1NHeQp4hOzMKXpM9lJ0bnlAywUN2L7HZBrh0FfYRKCM/XJkaVPhWEXngAj4kpcVFanLIcXPHSqZ5cZfD2xM1VwoL258mfPgJds9JOZFg1aSKcoA87MEl9O1eranE9c2wz6I2DoCVfBVb9htSmAuPwoRDLztsYJwckgAN5KFfOZOghAbD7UmsIO3F8buHbX6SLL/28RO9KKkxXp8F1nt40QH/zdg9ftl27PMAyMSnlNdfjptq0LrZMBToeQovhVAf/XfhjESj7Z9fpucwkg==
[Relay 1] [Relay] Decoded session_key_enc (hex): b0c9467e9e08fdff0faaa384c652b8237d0e184a39fc5d248ff717f6b28e497e546c5b6410f1086dc470f6116b669d1f038f10d4d1de429e213b330a5e933d949d1b9e5032c143762fb1d906b87415f61128233f5c991a54f8561179e0023e24a5c5456a72c87173c74aa6797197c3db1335570a0bdb9f267cf80976cf49399160d5a48a72803cecc125f4ed5eada9c4f5cdb0cfa2360e80957c155bf61b52980b8fc284432f3b6c609c1c92000de4a15f3993a08406c3ed49ac20edc5f1bb876d7e922cbff6f113bd28a9315e9f05d67b78d101ffcdd83d7ed976ecf300c8c4a794d75f8e9b6ad0bad93014e8790a2f85501ffd77e18c44a3ed9f5fa6e73092
[Relay 1] [Relay] Decrypting session key with fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] Decrypted session_key (hex): e7228f0832ffa89a67536c83d8868fe714571069996331c3b54e088be7d1dcc1
[Relay 1] [Relay] [DEBUG] About to AES-decrypt payload (passing base64 string directly)
[Relay 1] [Relay] [DEBUG] Payload base64-decoded: type=<class 'bytes'>, len=40, preview=b'\xac"\xb3\xaa^>\xd8\xfd\x84\xad\xec\xa5#\xddr\xe5\xd6\xbd\xb5\x91j\x05u\x96\xeb^\xac\x160\xc2u&\x9b\x1c\xef\xd2[+\x17\\'
[Relay 1] [Relay] [DEBUG] AES-decrypted payload: type=<class 'bytes'>, len=24, preview=b'{"msg": "Hello, world!"}'
[Relay 1] [Relay] [DEBUG] AES-decrypted payload (hex): 7b226d7367223a202248656c6c6f2c20776f726c6421227d
[Relay 1] [Relay] [DEBUG] Next hop JSON keys: ['msg']
[Relay 1] [Relay] [DEBUG] Payload is not JSON, assuming last hop. Error: 'next_ip'
[Relay 1] [Relay] [Last Hop] Forwarding payload to dest 127.0.0.1:9100, len=24, type=<class 'bytes'>
[Relay 1] [Relay] [Last Hop] Sending to dest: type=<class 'bytes'>, len=24, preview=b'{"msg": "Hello, world!"}'
[Relay 1] [Relay] [Last Hop] Received response from dest: type=<class 'bytes'>, len=50, preview=b'{"result": "OK", "echo": {"msg": "Hello, world!"}}'
[Relay 1] [Relay] [Last Hop] Response from dest decoded as UTF-8: '{"result": "OK", "echo": {"msg": "Hello, world!"}}'
[Relay 1] [Relay] [Last Hop] Response from dest (hex): 7b22726573756c74223a20224f4b222c20226563686f223a207b226d7367223a202248656c6c6f2c20776f726c6421227d7d
[Relay 1] [Relay] [Last Hop] About to AES-encrypt response: type=<class 'bytes'>, len=50, preview=b'{"result": "OK", "echo": {"msg": "Hello, world!"}}'
[Relay 1] [Relay] [Last Hop] AES-encrypted response (hex): 2f047de7f122f1689b5be0bf89164a9deb34d0ea9894b3215d0067edbe0cea7ac864c7b19e247b767340cf81ba238ebc6650c62d2b4344628dc47569
[Relay 1] [Relay] [Last Hop] Base64-encoded AES-encrypted response: type=<class 'bytes'>, len=88, preview=b'LwR95/Ei8WibW+C/iRZKnes00OqYlLMhXQBn7b4M6nrIZMexniR7dnNAz4G6'
[Relay 3] [Relay] [DEBUG] Received response from next relay: type=<class 'bytes'>, len=88, preview=b'LwR95/Ei8WibW+C/iRZKnes00OqYlLMhXQBn7b4M6nrIZMexniR7dnNAz4G6'
[Relay 1] [Relay] [Last Hop] Sent response to ('10.250.120.196', 60613): b'LwR95/Ei8WibW+C/iRZKnes00OqYlLMhXQBn7b4M6nrIZMexniR7dnNAz4G6'... (len=88)
[Relay 3] [Relay] [RETURN] Base64-decoded response: type=<class 'bytes'>, len=66, preview=b'/\x04}\xe7\xf1"\xf1h\x9b[\xe0\xbf\x89\x16J\x9d\xeb4\xd0\xea\x98\x94\xb3!]\x00g\xed\xbe\x0c\xeaz\xc8d\xc7\xb1\x9e${vs@\xcf\x81\xba#\x8e\xbcfP\xc6-+CDb\x8d\xc4ui'
[Relay 1] [Relay] [handle_message END] addr=('10.250.120.196', 60613), thread=6163378176
[Relay 3] [Relay] [RETURN] AES-decrypted response: type=<class 'bytes'>, len=50, preview=b"\t\xa7t\xe3\xdd\xda\xe5Q\xf3B\xbb([\x88\xfc\xdc/\t\xc2a\xf7\xca*\xd46\x0b>\x86\xaf\xfa\xdd\x8bT\x0c{\xf0\xb0\n\x02\x18\xe6\x83\xeb+}\x92'\x9c4Q"
[Relay 3] [Relay] [RETURN] AES-decrypted response not UTF-8: 'utf-8' codec can't decode byte 0xa7 in position 1: invalid start byte
[Relay 3] [Relay] [RETURN] AES-encrypted response (hex): 61a00a897f8057ef755fb7acbf0205412ecdcb3c18f3ebb9148d7ddc59f167e6aa59f69ead9a23fd91fa0df3e1fd4b496e78c1a5b6c4facc9c32016f
[Relay 3] [Relay] [RETURN] Base64-encoded AES-encrypted response: type=<class 'bytes'>, len=112, preview=b'YaAKiX+AV+91X7esvwIFQS7NyzwY8+u5FI193FnxZ+aqWfaerZoj/ZH6DfPh'
[Relay 3] [Relay] [handle_message END] addr=('10.250.120.196', 60609), thread=6200979456
[Relay 2] [Relay] [DEBUG] Received response from next relay: type=<class 'bytes'>, len=112, preview=b'YaAKiX+AV+91X7esvwIFQS7NyzwY8+u5FI193FnxZ+aqWfaerZoj/ZH6DfPh'
[Relay 2] [Relay] [RETURN] Base64-decoded response: type=<class 'bytes'>, len=82, preview=b'a\xa0\n\x89\x7f\x80W\xefu_\xb7\xac\xbf\x02\x05A.\xcd\xcb<\x18\xf3\xeb\xb9\x14\x8d}\xdcY\xf1g\xe6\xaaY\xf6\x9e\xad\x9a#\xfd\x91\xfa\r\xf3\xe1\xfdKInx\xc1\xa5\xb6\xc4\xfa\xcc\x9c2\x01o'
[Relay 2] [Relay] [RETURN] AES-decrypted response: type=<class 'bytes'>, len=66, preview=b'-SX\x85\x921?\x11\x1f\xbb\xed)\xc7\xc9(q\xcd>\xd2(_9O?\xe6\x0b\xf5\x99F\xa0\x80\x08\x01\xa9\xc7c=}A\xc6\x84\xbb\xbb\xa1\x8f\x90\xf8B\x13.u(\x1eS\xe7\xc0:\x7fJP'
[Relay 2] [Relay] [RETURN] AES-decrypted response not UTF-8: 'utf-8' codec can't decode byte 0x85 in position 3: invalid start byte
[Relay 2] [Relay] [RETURN] AES-encrypted response (hex): defa669586bbbd68a42e4bee5de04d390216f19015005bdf81dab46ffdda8352589703bdcdd8e32b32c27e759b44f4ebee3800e24c340029ff6e07e4
[Relay 2] [Relay] [RETURN] Base64-encoded AES-encrypted response: type=<class 'bytes'>, len=132, preview=b'3vpmlYa7vWikLkvuXeBNOQIW8ZAVAFvfgdq0b/3ag1JYlwO9zdjjKzLCfnWb'
[Relay 2] [Relay] [handle_message END] addr=('10.250.120.196', 60603), thread=6200995840
[Relay] ---- Relay process started ----
[Relay 1] [Relay] Loaded persistent RSA keypair from relay1_key.pem
[Relay 1] [Relay] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] [KEY] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] Relay 1 starting on 172.20.10.11:9101 (RELAY PORT 9101)
[Relay 1] Registering with CDS at 127.0.0.1:9000
[Relay 1] [Relay] Registered with CDS: {'ip': '172.20.10.11', 'port': 9101, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5MM7/HBECV26fZqjUJkt\nQ4+dx297cL0hf1+rf08Qir5tL/lArfQsiplTqcsIsZiN7vJ8K2XzvK5JAEv8tVE4\nEKU4W1hbEVBd1eLCX+Oc5XauTbWhW8xlc2wdNlNwDhin2Mw84doKJWPyfjtIwnIi\n3nWHqxLyAqkj6qDoByA8D7YVmJxvzwL0mrYE8G8b4Q4Wjnx2SXeTwc9LRzqwrsyb\nlM5B4BSVPBignOMhD2AfuIFw6uULQThbkL9L5AnQA08B4Gqzo731LLJN/Y6qo+VJ\nki2t6m1aJTG0LBjijpH7CtnN1MHIQ5UueS1sJVYZooYxkxEYYZTqIUXxuI5ICKPC\nCQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 1] [Relay] Listening for incoming messages on port 9101 (RELAY PORT 9101)
[Relay] ---- Relay process started ----
[Relay 2] [Relay] Loaded persistent RSA keypair from relay2_key.pem
[Relay 2] [Relay] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] [KEY] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] Relay 2 starting on 172.20.10.11:9102 (RELAY PORT 9102)
[Relay 2] Registering with CDS at 127.0.0.1:9000
[Relay 2] [Relay] Registered with CDS: {'ip': '172.20.10.11', 'port': 9102, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA58J3pSrOQd4hYnuzQQ7q\nWrjjo+3BJp+ik23brR2yl0kjtfH+wjD9LYWHS7dBxsDRzSozJ/7EWKKNCaTsgvaF\nN6vpyBPqDM/uQfOWfirteL50RgDZw95Vml4Fuay7bTBEb1J8ydvFqawo8rnLE2I3\nU4BjBT+CD38bY3je8wrrCX9fo1uYaLDlfteGshadZ2gnTxrAzkZZ/CTFdyb8JrmN\nIuxjBVjwSA/uIv+KHWQhXRA5jJPXcNV88LYXyEzpid1Cr9gnrqA88K0HSleiwZjU\nJF3LhBvS2Ga2HHfFsk5D/yz/pTHwDvRA98VMT/90wahwmSJsck4XWDFhmNhy3oDR\nBQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 2] [Relay] Listening for incoming messages on port 9102 (RELAY PORT 9102)
[Relay] ---- Relay process started ----
[Relay 3] [Relay] Loaded persistent RSA keypair from relay3_key.pem
[Relay 3] [Relay] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] [Relay] [KEY] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] Relay 3 starting on 172.20.10.11:9103 (RELAY PORT 9103)
[Relay 3] Registering with CDS at 127.0.0.1:9000
[Relay 3] [Relay] Registered with CDS: {'ip': '172.20.10.11', 'port': 9103, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5k9OJ8m3IdjmwR1skM1G\nwrKkwlYLK0Qs+I/BX5ww5wEakOsTy5NVFAwTYrCUnR012u2jCwI8wV1YpPaMa8RJ\ntnqNFy4pFfqBh5tmidHQ3QMRvINPrGtQM5+VgMXoA0y8izql52M1K/3Q6sHVlAXd\nmpQcBO+JSHY7uyVx1txZssyisia7Nn8Frh/XRpl0oUvGkSnbm/KgqDAP0xJ3lUZS\nEGiIWdf0bn7tHD3nYBMrWWi3jSQWf0Q80asIEYWipwkfMPf0ffzu4FX0elfvpyOX\nr50xk7sb8K5IhcilwxKxQpPOcq3f6ph0EERQR7pOdDqkzFdHoGiyssSX4MYM60kd\nmQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 3] [Relay] Listening for incoming messages on port 9103 (RELAY PORT 9103)
[Relay 1] [Relay] [handle_message ENTERED] addr=('172.20.10.11', 56370), thread=6122319872, relay_port=9101
[Relay 1] [Relay] [DEBUG] Raw data received: b'{"next_ip": "172.20.10.11", "next_port": 9101, "session_key": "NTbeiizO9m4RHRYFiVkdiqC7GekH7vNDlzVkQnZxfZHAW5RfT9YwZpBoUcCXG+QKula3xYvf2ubKoOToz6w+RcPaP0dCfTr3JtraX7yQIIY1y+76JLjVM72hl9BiyoV5/c6U2165435R26LZzIVg7TP/krBy46+57vAF4sbioiZQ7uMut2q0xPon6IZBsnk6xKNlXPjWrCdMzZAcwCpFwitcJ5UxcMemUMMw57OoDenQj/53J46xtwFxJcNeeRu14dJ5YQqc6E2RNjqbckEIimpbG7G2n+DSbIOKVUpsERztlEfKAVD/nSrrVPvsr9Cy5/V/2fdRm/yOw8v/lZN2eQ==", "payload": "Q5Kca9ARNWJIOv2HUaHnU46h4+WZR57o0rGSAuUyA4zo+F+Ewsy3J3vLD9k0jq0ozbo/EMmcdvIs2iTZy0tdS6QsopFmDfZvYOeeg36ViFHvWiv/ngmpUORwCIfvicHTrG8vH1m/ha8NFN9YUeKx/LUKu+LpqKOfl755t/jLY4O/2Jj35sFprbhqmNNTDBOm1w5G1g1N9RVXn/DUbLfh+MJbotyuHMDOuMbj4ANAk9f2qffqXXzU5G7ZjanZxlbJp9i2WZt/N/UlpjgAkjee0QVgAYqgDi15pnAuuhQsY8hRzYQnhd7wDd+NYPo0p0+zmc1eCsXnf4VxEz4Xx7p3ass25kOX/GevQdO7tCKTezF//QBHipEEortFpZeb1IZU7uGD723ihB/PyPRBNt/35zHedoYUYsP25zZEOXau44WGJ6LKiAo5OedHBvKFcVsTJ37A39emQdbvwWF0sqoWWYgH+OKRHSOXR3T2YxMI+m1Bbxy9psLbHGROeFFzDpal5KhLd1q4pvq4Sb3xsiruYQFGKkMu1a5UPbw3m75phxci+SNGYLL9330B6yF4dK+Yp64uVeI+O3xIYXMNNz3o044wkXOQ3h4lfQ5UU2YRFzOGmblPT7Yxh74ohM+buSjPAjpgi98nhJcYgtVfGCMOcY6oJKz8m0DgS8YGfCdMk7DdXNyPYI1AWJd3r/bPFHkCa/78ojk5BZfYAaMzTGxXy5qLaC5c75VO9sRB7N+96js+holfeqmBW8pGu1xEYoDMtsJuE/7REqQLBcrmPbiN059qNgtT+eN934+fqDsqaV8LLCyfLXxzKYngA+fkj1ByJ8l0TwzxyifzH0Szxo4hpInO/Kux7UBMj5xQogTHBhWqSyp9tnjZ90lxMH/a0HX2ibndaLm1YY2FIon+u7pYYnivy72HLGxKoBioCRrBHX7nGpawAzNstT/Y8ZvreFA6IcLDBhl+FXw9m3fUHtUOzccU9Stu8nLIwdVR1Unt0CAETmeEKQ+GOi065uoCH6UOV4TiufDhqngIRZpkKpU+wd11qDuDD0W6PmJxKXl+QzutmvlRSePkfedIH6QQrUeJ4zIyT4v+cjDmQjfcYz9Uc91WVj6vEycsL90jR8yaPgVFePRJzLctYiTkLtW/dAw/tWWLoW6dZC9mkxZxgb4OxPNxGhDUNKVB/9TE/hZOKWCqC71OUvD/X+LOA6VbQ5gmdTIUZslgDMdV9fADeMB/FjXkZJ+rVcZbV6cxAHCar/cfAqoUq7fPY4pVN6hGfNaZ/y7HjWHSnMZZHkLJZt05ny9xNz6RLG88lk4gNKKk1Q+MfSXwlwINqX3eDP1SdIue/wrbWxmERjkJkC5n0I70Gy0OLsrbiXSeuhg6jkQaPCut6tIVlATlGqXwZMoL65wrRfCWFMmiCcTsOSe4wW8nFHNl3F/9NLcgOPD0WZVs7PBmZ581oxHu/uGdyBJUXm4x"}'
[Relay 1] [Relay] [DEBUG] Data after JSON parse: type=<class 'dict'>, keys=['next_ip', 'next_port', 'session_key', 'payload']
[Relay 1] [Relay] Received session_key (base64): NTbeiizO9m4RHRYFiVkdiqC7GekH7vNDlzVkQnZxfZHAW5RfT9YwZpBoUcCXG+QKula3xYvf2ubKoOToz6w+RcPaP0dCfTr3JtraX7yQIIY1y+76JLjVM72hl9BiyoV5/c6U2165435R26LZzIVg7TP/krBy46+57vAF4sbioiZQ7uMut2q0xPon6IZBsnk6xKNlXPjWrCdMzZAcwCpFwitcJ5UxcMemUMMw57OoDenQj/53J46xtwFxJcNeeRu14dJ5YQqc6E2RNjqbckEIimpbG7G2n+DSbIOKVUpsERztlEfKAVD/nSrrVPvsr9Cy5/V/2fdRm/yOw8v/lZN2eQ==
[Relay 1] [Relay] Decoded session_key_enc (hex): 3536de8a2ccef66e111d160589591d8aa0bb19e907eef3439735644276717d91c05b945f4fd63066906851c0971be40aba56b7c58bdfdae6caa0e4e8cfac3e45c3da3f47427d3af726dada5fbc90208635cbeefa24b8d533bda197d062ca8579fdce94db5eb9e37e51dba2d9cc8560ed33ff92b072e3afb9eef005e2c6e2a22650eee32eb76ab4c4fa27e88641b2793ac4a3655cf8d6ac274ccd901cc02a45c22b5c27953170c7a650c330e7b3a80de9d08ffe77278eb1b7017125c35e791bb5e1d279610a9ce84d91363a9b7241088a6a5b1bb1b69fe0d26c838a554a6c111ced9447ca0150ff9d2aeb54fbecafd0b2e7f57fd9f7519bfc8ec3cbff95937679
[Relay 1] [Relay] Decrypting session key with fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] Decrypted session_key (hex): 185ef613734ff5762c389746b1d6c783b1ad70400017621417857b6abc7be22a
[Relay 1] [Relay] [DEBUG] About to AES-decrypt payload (passing base64 string directly)
[Relay 1] [Relay] [DEBUG] Payload base64-decoded: type=<class 'bytes'>, len=1104, preview=b"C\x92\x9ck\xd0\x115bH:\xfd\x87Q\xa1\xe7S\x8e\xa1\xe3\xe5\x99G\x9e\xe8\xd2\xb1\x92\x02\xe52\x03\x8c\xe8\xf8_\x84\xc2\xcc\xb7'{\xcb\x0f\xd94\x8e\xad(\xcd\xba?\x10\xc9\x9cv\xf2,\xda$\xd9"
[Relay 1] [Relay] [DEBUG] AES-decrypted payload: type=<class 'bytes'>, len=1088, preview=b'{"next_ip": "172.20.10.11", "next_port": 9103, "session_key"'
[Relay 1] [Relay] [DEBUG] AES-decrypted payload (hex): 7b226e6578745f6970223a20223137322e32302e31302e3131222c20226e6578745f706f7274223a20393130332c202273657373696f6e5f6b657922
[Relay 1] [Relay] [DEBUG] Next hop JSON keys: ['next_ip', 'next_port', 'session_key', 'payload']
[Relay 1] [Relay] [DEBUG] Forwarding to next relay 172.20.10.11:9103
[Relay 3] [Relay] [handle_message ENTERED] addr=('172.20.10.11', 56371), thread=6168473600, relay_port=9103
[Relay 3] [Relay] [DEBUG] Raw data received: b'{"next_ip": "172.20.10.11", "next_port": 9103, "session_key": "NSWehS1OX23HLefWfTRssDpq1AFUeRfk6RbeML7I6zlif358FYC4/EMDdrl9QBnS3V667eAQ+gw1DwCn44Ilx78CNLvA4ogh2TuOetsEH09fknluSvOdCQRHg8nWP+TvjIPnk8UV4SKqQMRRDW+H3Ce1UB5UU2OtAUCxp4C0ZMMlnsHXuKz6Tdx46OewGOnKuubOXaTTdaVAb2sRI7YanRoey+KNnX+BzpZnsyIXpTcbFAUylmzzSgarB+x+EIf1dQJew4YYLIW49BcstWEgOKdCLSKBZF3lJuVDC0ZM4lZdM3B7T627ePzH/TLuTzZBFyw6qYlKZNy5uyyLOKCxvg==", "payload": "F9BRd1uXMqqRQWFczBmVaKlD9R+f70X5vKlJOfCPGhoDWwKcCxSqnMXnBUPujfBr9//7otA6b92CI9lH5Xu2EbHPIlCSjrB7y3tAfjx5XGRs+kIP/278wOZYBoNYR63eC/9i8RSEg5OSNSm++pc00hvxPcs6A2aCwKdPKIbYEIqidE/l05KVJjFLnReo+Ktr159yJrBNqgS/ASirOTm9wz4CO6W8OTbs1If3NPSs6xLO2e9mVk2qzd5XSBnq4zAO8gamBR0HZ4Fqf3X4/KwCz59WcNFX1nsLqK0kfru7Oj+4g1jjoaPdiLP/B/C92rSeG9nnVmI2lwX0ywEsBpc7QWZsxD61anl9uUs6z7Be3tWW/4WVEym9s5lfkNrCeaVVMhNtqi2aq4nnvbb/pDIFb8MESSW+fx49rb1z/ffk1SYQnGmlFFLzF3hgFN+LlCkLAyiMGqYh9XuBrTvrASRMnCve8KXXTr68Z2oZdDzVsrTkUbWvkZgul9qxR/d5ZL/P6hOTOWtGoKbypqYl6mlkOUXNYbblZuXVqypM0yx1jCpaFVQF0xBSGbX/L7uDrmdN+iT5bkhlXMSzVvxSTtcm7XMzvynZvRrhL6WmStjrSiaV/loe5BjU+pNMhxdH26RWb3hW0FrDpU2uY+UGTStz2A=="}'
[Relay 3] [Relay] [DEBUG] Data after JSON parse: type=<class 'dict'>, keys=['next_ip', 'next_port', 'session_key', 'payload']
[Relay 3] [Relay] Received session_key (base64): NSWehS1OX23HLefWfTRssDpq1AFUeRfk6RbeML7I6zlif358FYC4/EMDdrl9QBnS3V667eAQ+gw1DwCn44Ilx78CNLvA4ogh2TuOetsEH09fknluSvOdCQRHg8nWP+TvjIPnk8UV4SKqQMRRDW+H3Ce1UB5UU2OtAUCxp4C0ZMMlnsHXuKz6Tdx46OewGOnKuubOXaTTdaVAb2sRI7YanRoey+KNnX+BzpZnsyIXpTcbFAUylmzzSgarB+x+EIf1dQJew4YYLIW49BcstWEgOKdCLSKBZF3lJuVDC0ZM4lZdM3B7T627ePzH/TLuTzZBFyw6qYlKZNy5uyyLOKCxvg==
[Relay 3] [Relay] Decoded session_key_enc (hex): 35259e852d4e5f6dc72de7d67d346cb03a6ad401547917e4e916de30bec8eb39627f7e7c1580b8fc430376b97d4019d2dd5ebaede010fa0c350f00a7e38225c7bf0234bbc0e28821d93b8e7adb041f4f5f92796e4af39d09044783c9d63fe4ef8c83e793c515e122aa40c4510d6f87dc27b5501e545363ad0140b1a780b464c3259ec1d7b8acfa4ddc78e8e7b018e9cabae6ce5da4d375a5406f6b1123b61a9d1a1ecbe28d9d7f81ce9667b32217a5371b140532966cf34a06ab07ec7e1087f575025ec386182c85b8f4172cb5612038a7422d2281645de526e5430b464ce2565d33707b4fadbb78fcc7fd32ee4f3641172c3aa9894a64dcb9bb2c8b38a0b1be
[Relay 3] [Relay] Decrypting session key with fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] [Relay] Decrypted session_key (hex): 72a5431544972556417f601b922036aa4733421f86c867411b00445f2c469fb2
[Relay 3] [Relay] [DEBUG] About to AES-decrypt payload (passing base64 string directly)
[Relay 3] [Relay] [DEBUG] Payload base64-decoded: type=<class 'bytes'>, len=496, preview=b'\x17\xd0Qw[\x972\xaa\x91Aa\\\xcc\x19\x95h\xa9C\xf5\x1f\x9f\xefE\xf9\xbc\xa9I9\xf0\x8f\x1a\x1a\x03[\x02\x9c\x0b\x14\xaa\x9c\xc5\xe7\x05C\xee\x8d\xf0k\xf7\xff\xfb\xa2\xd0:o\xdd\x82#\xd9G'
[Relay 3] [Relay] [DEBUG] AES-decrypted payload: type=<class 'bytes'>, len=480, preview=b'{"next_ip": "172.20.10.11", "next_port": 9102, "session_key"'
[Relay 3] [Relay] [DEBUG] AES-decrypted payload (hex): 7b226e6578745f6970223a20223137322e32302e31302e3131222c20226e6578745f706f7274223a20393130322c202273657373696f6e5f6b657922
[Relay 3] [Relay] [DEBUG] Next hop JSON keys: ['next_ip', 'next_port', 'session_key', 'payload']
[Relay 3] [Relay] [DEBUG] Forwarding to next relay 172.20.10.11:9102
[Relay 2] [Relay] [handle_message ENTERED] addr=('172.20.10.11', 56380), thread=6155317248, relay_port=9102
[Relay 2] [Relay] [DEBUG] Raw data received: b'{"next_ip": "172.20.10.11", "next_port": 9102, "session_key": "TByQISoFc5WFXygMGTzEjqzclLYCMWuIAC2akexGMU+7SRBx+DOiJgysR7KTe+YrnpjDNeTk0mHCpr0EHyI7o6UNGXNj6odPGXSZ1sT6SfRPPnSMJOi34OemgDF8xY6AnbNWl9vu3JH5jHsdLbouJvubaWtybyWDHYJeJu365B3Z3nZ1p5C7wLSUfhsvsqTZZPloqVSZ2h2IP1FI9oupvHSybp0Te2JhHodCVVX8EDronYIeqn/4arUMeAMN5BfGPmjHixso3f9Xtj4ozRJ6LNtFmy+M09ZkaYTGlbe1pHQ5L3ofgDrXvV0z+avSZc0CpxmS3l6RHfJ1mQZJ/UegQg==", "payload": "iSZk9a1eO5YXCPYwTWjsrIPTwPp7n2vQ2r6K2psnt/tVumPI/UBX2Q=="}'
[Relay 2] [Relay] [DEBUG] Data after JSON parse: type=<class 'dict'>, keys=['next_ip', 'next_port', 'session_key', 'payload']
[Relay 2] [Relay] Received session_key (base64): TByQISoFc5WFXygMGTzEjqzclLYCMWuIAC2akexGMU+7SRBx+DOiJgysR7KTe+YrnpjDNeTk0mHCpr0EHyI7o6UNGXNj6odPGXSZ1sT6SfRPPnSMJOi34OemgDF8xY6AnbNWl9vu3JH5jHsdLbouJvubaWtybyWDHYJeJu365B3Z3nZ1p5C7wLSUfhsvsqTZZPloqVSZ2h2IP1FI9oupvHSybp0Te2JhHodCVVX8EDronYIeqn/4arUMeAMN5BfGPmjHixso3f9Xtj4ozRJ6LNtFmy+M09ZkaYTGlbe1pHQ5L3ofgDrXvV0z+avSZc0CpxmS3l6RHfJ1mQZJ/UegQg==
[Relay 2] [Relay] Decoded session_key_enc (hex): 4c1c90212a057395855f280c193cc48eacdc94b602316b88002d9a91ec46314fbb491071f833a2260cac47b2937be62b9e98c335e4e4d261c2a6bd041f223ba3a50d197363ea874f197499d6c4fa49f44f3e748c24e8b7e0e7a680317cc58e809db35697dbeedc91f98c7b1d2dba2e26fb9b696b726f25831d825e26edfae41dd9de7675a790bbc0b4947e1b2fb2a4d964f968a95499da1d883f5148f68ba9bc74b26e9d137b62611e87425555fc103ae89d821eaa7ff86ab50c78030de417c63e68c78b1b28ddff57b63e28cd127a2cdb459b2f8cd3d6646984c695b7b5a474392f7a1f803ad7bd5d33f9abd265cd02a71992de5e911df275990649fd47a042
[Relay 2] [Relay] Decrypting session key with fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] Decrypted session_key (hex): 298d9fd50a9377b12c59b2e9517271318013cf111b373a9322f763c59f1877fc
[Relay 2] [Relay] [DEBUG] About to AES-decrypt payload (passing base64 string directly)
[Relay 2] [Relay] [DEBUG] Payload base64-decoded: type=<class 'bytes'>, len=40, preview=b"\x89&d\xf5\xad^;\x96\x17\x08\xf60Mh\xec\xac\x83\xd3\xc0\xfa{\x9fk\xd0\xda\xbe\x8a\xda\x9b'\xb7\xfbU\xbac\xc8\xfd@W\xd9"
[Relay 2] [Relay] [DEBUG] AES-decrypted payload: type=<class 'bytes'>, len=24, preview=b'{"msg": "Hello, world!"}'
[Relay 2] [Relay] [DEBUG] AES-decrypted payload (hex): 7b226d7367223a202248656c6c6f2c20776f726c6421227d
[Relay 2] [Relay] [DEBUG] Next hop JSON keys: ['msg']
[Relay 2] [Relay] [DEBUG] Payload is not JSON, assuming last hop. Error: 'next_ip'
[Relay 2] [Relay] [Last Hop] Forwarding payload to dest 127.0.0.1:9100, len=24, type=<class 'bytes'>
[Relay 2] [Relay] [Last Hop] Sending to dest: type=<class 'bytes'>, len=24, preview=b'{"msg": "Hello, world!"}'
[Relay 2] [Relay] [Last Hop] Received response from dest: type=<class 'bytes'>, len=50, preview=b'{"result": "OK", "echo": {"msg": "Hello, world!"}}'
[Relay 2] [Relay] [Last Hop] Response from dest decoded as UTF-8: '{"result": "OK", "echo": {"msg": "Hello, world!"}}'
[Relay 2] [Relay] [Last Hop] Response from dest (hex): 7b22726573756c74223a20224f4b222c20226563686f223a207b226d7367223a202248656c6c6f2c20776f726c6421227d7d
[Relay 2] [Relay] [Last Hop] About to AES-encrypt response: type=<class 'bytes'>, len=50, preview=b'{"result": "OK", "echo": {"msg": "Hello, world!"}}'
[Relay 2] [Relay] [Last Hop] AES-encrypted response (hex): 8541318a728c4ab2e7448c1147af5a329721085f650b0c075b70fc24d9366b909b31573ca7bae16049e641a9974e3d1f86bfa2a24e0a7b50ae4e1bff
[Relay 2] [Relay] [Last Hop] Base64-encoded AES-encrypted response: type=<class 'bytes'>, len=88, preview=b'hUExinKMSrLnRIwRR69aMpchCF9lCwwHW3D8JNk2a5CbMVc8p7rhYEnmQamX'
[Relay 2] [Relay] [Last Hop] Sent response to ('172.20.10.11', 56380): b'hUExinKMSrLnRIwRR69aMpchCF9lCwwHW3D8JNk2a5CbMVc8p7rhYEnmQamX'... (len=88)
[Relay 2] [Relay] [handle_message END] addr=('172.20.10.11', 56380), thread=6155317248
[Relay 3] [Relay] [DEBUG] Received response from next relay: type=<class 'bytes'>, len=88, preview=b'hUExinKMSrLnRIwRR69aMpchCF9lCwwHW3D8JNk2a5CbMVc8p7rhYEnmQamX'
[Relay 3] [Relay] [RETURN] Base64-decoded response: type=<class 'bytes'>, len=66, preview=b'\x85A1\x8ar\x8cJ\xb2\xe7D\x8c\x11G\xafZ2\x97!\x08_e\x0b\x0c\x07[p\xfc$\xd96k\x90\x9b1W<\xa7\xba\xe1`I\xe6A\xa9\x97N=\x1f\x86\xbf\xa2\xa2N\n{P\xaeN\x1b\xff'
[Relay 3] [Relay] [RETURN] AES-decrypted response: type=<class 'bytes'>, len=50, preview=b'\x0fc\xe8mfHS\x0c\x8f\xe4\xca\x83\x87q\xc4Z\xb6\x84\xa5\x8cU\xcc\x95\xff~@\x88\xc9\xc0L\x89\xf4\x89\x97*N\xfb\xe5D\xa5{\xe41D3]\r\xc5\xfcL'
[Relay 3] [Relay] [RETURN] AES-decrypted response not UTF-8: 'utf-8' codec can't decode byte 0xe8 in position 2: invalid continuation byte
[Relay 3] [Relay] [RETURN] AES-encrypted response (hex): dcb03b68910324d428be35ee1d0a56eaf2900bae711820fb2f5c9f92fe923ccbb83e8fa37c39e4daba99055280950099906a5d48056a6bef2673cbdc
[Relay 3] [Relay] [RETURN] Base64-encoded AES-encrypted response: type=<class 'bytes'>, len=112, preview=b'3LA7aJEDJNQovjXuHQpW6vKQC65xGCD7L1yfkv6SPMu4Po+jfDnk2rqZBVKA'
[Relay 3] [Relay] [handle_message END] addr=('172.20.10.11', 56371), thread=6168473600
[Relay 1] [Relay] [DEBUG] Received response from next relay: type=<class 'bytes'>, len=112, preview=b'3LA7aJEDJNQovjXuHQpW6vKQC65xGCD7L1yfkv6SPMu4Po+jfDnk2rqZBVKA'
[Relay 1] [Relay] [RETURN] Base64-decoded response: type=<class 'bytes'>, len=82, preview=b'\xdc\xb0;h\x91\x03$\xd4(\xbe5\xee\x1d\nV\xea\xf2\x90\x0b\xaeq\x18 \xfb/\\\x9f\x92\xfe\x92<\xcb\xb8>\x8f\xa3|9\xe4\xda\xba\x99\x05R\x80\x95\x00\x99\x90j]H\x05jk\xef&s\xcb\xdc'
[Relay 1] [Relay] [RETURN] AES-decrypted response: type=<class 'bytes'>, len=66, preview=b'\x03-\xab\x9c\x17\xd5\xe4\xb9VP\x82\xe5\x19\x8c(b\xb6\xcd\x9a\xc8\x81I\x03\x137\x0c\xfc\x13\x00\x07\xd4`\xf3\x17i\xf1\xf6\xa4\xfc\x80/\xa6*\xf4\xc2\xe6j\xb3{\xb6\x10y5\x19\xbev\xc7_\x05\xfa'
[Relay 1] [Relay] [RETURN] AES-decrypted response not UTF-8: 'utf-8' codec can't decode byte 0xab in position 2: invalid start byte
[Relay 1] [Relay] [RETURN] AES-encrypted response (hex): d1ba5f678fe81086c55df4f10fc9e68f83373b1e32f936dd19991f1a5711938c442115a9cad75ceb009ca7a03d2975259a2859e6ad4aa60a0cafe5ac
[Relay 1] [Relay] [RETURN] Base64-encoded AES-encrypted response: type=<class 'bytes'>, len=132, preview=b'0bpfZ4/oEIbFXfTxD8nmj4M3Ox4y+TbdGZkfGlcRk4xEIRWpytdc6wCcp6A9'
[Relay 1] [Relay] [handle_message END] addr=('172.20.10.11', 56370), thread=6122319872
[Relay] ---- Relay process started ----
[Relay 1] [Relay] Loaded persistent RSA keypair from relay1_key.pem
[Relay 1] [Relay] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] [KEY] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] Relay 1 starting on 172.20.10.11:9101 (RELAY PORT 9101)
[Relay 1] Registering with CDS at 127.0.0.1:9000
[Relay 1] [Relay] Registered with CDS: {'ip': '172.20.10.11', 'port': 9101, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5MM7/HBECV26fZqjUJkt\nQ4+dx297cL0hf1+rf08Qir5tL/lArfQsiplTqcsIsZiN7vJ8K2XzvK5JAEv8tVE4\nEKU4W1hbEVBd1eLCX+Oc5XauTbWhW8xlc2wdNlNwDhin2Mw84doKJWPyfjtIwnIi\n3nWHqxLyAqkj6qDoByA8D7YVmJxvzwL0mrYE8G8b4Q4Wjnx2SXeTwc9LRzqwrsyb\nlM5B4BSVPBignOMhD2AfuIFw6uULQThbkL9L5AnQA08B4Gqzo731LLJN/Y6qo+VJ\nki2t6m1aJTG0LBjijpH7CtnN1MHIQ5UueS1sJVYZooYxkxEYYZTqIUXxuI5ICKPC\nCQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 1] [Relay] Listening for incoming messages on port 9101 (RELAY PORT 9101)
[Relay] ---- Relay process started ----
[Relay 2] [Relay] Loaded persistent RSA keypair from relay2_key.pem
[Relay 2] [Relay] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] [KEY] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] Relay 2 starting on 172.20.10.11:9102 (RELAY PORT 9102)
[Relay 2] Registering with CDS at 127.0.0.1:9000
[Relay 2] [Relay] Registered with CDS: {'ip': '172.20.10.11', 'port': 9102, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA58J3pSrOQd4hYnuzQQ7q\nWrjjo+3BJp+ik23brR2yl0kjtfH+wjD9LYWHS7dBxsDRzSozJ/7EWKKNCaTsgvaF\nN6vpyBPqDM/uQfOWfirteL50RgDZw95Vml4Fuay7bTBEb1J8ydvFqawo8rnLE2I3\nU4BjBT+CD38bY3je8wrrCX9fo1uYaLDlfteGshadZ2gnTxrAzkZZ/CTFdyb8JrmN\nIuxjBVjwSA/uIv+KHWQhXRA5jJPXcNV88LYXyEzpid1Cr9gnrqA88K0HSleiwZjU\nJF3LhBvS2Ga2HHfFsk5D/yz/pTHwDvRA98VMT/90wahwmSJsck4XWDFhmNhy3oDR\nBQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 2] [Relay] Listening for incoming messages on port 9102 (RELAY PORT 9102)
[Relay] ---- Relay process started ----
[Relay 3] [Relay] Loaded persistent RSA keypair from relay3_key.pem
[Relay 3] [Relay] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] [Relay] [KEY] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] Relay 3 starting on 172.20.10.11:9103 (RELAY PORT 9103)
[Relay 3] Registering with CDS at 127.0.0.1:9000
[Relay 3] [Relay] Registered with CDS: {'ip': '172.20.10.11', 'port': 9103, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5k9OJ8m3IdjmwR1skM1G\nwrKkwlYLK0Qs+I/BX5ww5wEakOsTy5NVFAwTYrCUnR012u2jCwI8wV1YpPaMa8RJ\ntnqNFy4pFfqBh5tmidHQ3QMRvINPrGtQM5+VgMXoA0y8izql52M1K/3Q6sHVlAXd\nmpQcBO+JSHY7uyVx1txZssyisia7Nn8Frh/XRpl0oUvGkSnbm/KgqDAP0xJ3lUZS\nEGiIWdf0bn7tHD3nYBMrWWi3jSQWf0Q80asIEYWipwkfMPf0ffzu4FX0elfvpyOX\nr50xk7sb8K5IhcilwxKxQpPOcq3f6ph0EERQR7pOdDqkzFdHoGiyssSX4MYM60kd\nmQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 3] [Relay] Listening for incoming messages on port 9103 (RELAY PORT 9103)
[Relay 2] [Relay] [handle_message ENTERED] addr=('172.20.10.11', 59008), thread=6126465024, relay_port=9102
[Relay 2] [Relay] [DEBUG] Raw data received: b'{"next_ip": "172.20.10.11", "next_port": 9102, "session_key": "XI+7PHzExr8/pluywxe4Z1+mGuSAooM5ufGxuDlIFzm3MY9q1t/ZIL7kZHqrGxQmc1ser8ig0g70Es7S4pnBA0fnxHGcTeMxXPboZu5vkdMPAVnXU3Rkmr0rfvuAeEFQyYdvxB9qnwMGbwut8rtMYeiTV4b63TyHTnMYcXCOyiUGYvkkF++mFHU15OMBedB/A+I6zx8kCBF3uZG6ahfMu99VHu2YhMd7KjuOrKlzwmog/7UDtGLH8jATJ0Mr0sx/OfQ4Gemv80rR2jkfbXFeQhA3qVgddZBncOcXnoQE5KIows+cRq1Ue+kV680kbgCJSoTD2ImG9tDKFSHWCjRETg==", "payload": "bgPB+FQvVWszLXiJd0vTBfPfKw6TpakTiSmsjbfY1oTKTrO0r7vkADs+zgADYd2kVUDdkD6+ANb+yw7l3S4XbqNEsI0JxzBKiDi3zCkCZx60jkQmnRBC8+L000WntXiwoVydPHIht4Cay1ty+XMcflcG7mtsTRkn3i2b7TAaEZokNbvgW+H8vPcZCP8CsgXh/vI2oiuAUxd7BH6RwIQnmmiUN88q85b+EROgyoexMJFwBr4yO68QRG7s6489n3uc+z4G1RelRfhMNL9oKecQHHHL2bka686TLZH7SaK6GHxYYXWqZE7X6UPebN4qwoCF5e7zCwgEaodwPSidoVKEyIC3a9J1dR0z+Cz8tC2bbvFus+g5AD0hZc/E0kTaPvF9h1FuvJXQ8IRmi1tQt1/CuhnrGdBKFY/8w5W2E4SqN+aeBQSd8n1Jb71oy/8iDCSsUrExxzs/tOMkOqZ9gyl64mC7Yi2jdfwcxDP+uMGaVOwZn73aKeTGLDlUjMCGPasfhjHqaH5s/cv9w7EBA8lm5M0To8+Ae6hh8D6s297dhSU4RHOjxyj2xLWQje+7oSENrr5stNfdvAsDEo14ex4xKpcTEyutJXpMWUxpivbbpfAg9b3dFIZTzDvvFjRUmVpEdOmfBKE2UHhwkkCFCKPlP11sYTwic4MoMppT5NZNwwzFrH9acFj4kBjX7qmKzvvXc2YtnBljmN9vZ03WgTV24BNlgcgKY7JuvskB2/PozsfxrjxwL6quzeshfzXRdrpZLuqInawPC/tJKQBGhtqFBHptZNNMHKx4WksE/2h4/DAEhWRb0Ip8gw6qIQXtJOw2Y8Oecj5BezW1uVKk4ATT3tt5/s/t7Y+BCbJzWfwKDCKs/LJUP2o1onrwMbnVXXsVrtcM3qI9lbHstUEkkaEKST4QROxGKNDo5N6XvUCsUOk2WObLLvcek1XtRL/vd/xe3gWLhc8vILFlg9+kAmQmZfXesAKyMUb79kT9Uf0txngNVIx8OKWSs40p6lujzQNGQsbY1EhS/rcrNJdT24xWFTlrwDRbXb7AaEPyVIWcGKC6ZvRCR1z2t5jrL0UPn45TNuKvrYRGVSrE8DH8fnpInaKWZX9Zx9cje8rcLXPCzbEgbsUrENA0cG+lzynYuVMkVGCTS3KBCRVwpxi7CxVhqFskwAjaRBfNC6EqlaT1HMrEAwx2V66otp4cNbpIPow0Ns7Y84aXXhmQZzVsZb2iuvDVsfhM0AVJ63YfKazavQpXdV2/3aUxlJgMzybfnlSurunS9qV2niesda/Sreq4ksG8EZSsNO4I0KBC7ykF1+UL/BXnQ3nnVPBtXPbWsgcfegUeclLkbfmlkcN1pChcGmz3M/B7YSeX0gnwn8hgqUqGQXnG7CpDgwWB5eUOVEaL4KM/YBZSulwOOpE4s3jU7lyjQXnXSH9Y6MA2Y9Al6bCnxonN01GsZHvc4eGL5MES"}'
[Relay 2] [Relay] [DEBUG] Data after JSON parse: type=<class 'dict'>, keys=['next_ip', 'next_port', 'session_key', 'payload']
[Relay 2] [Relay] Received session_key (base64): XI+7PHzExr8/pluywxe4Z1+mGuSAooM5ufGxuDlIFzm3MY9q1t/ZIL7kZHqrGxQmc1ser8ig0g70Es7S4pnBA0fnxHGcTeMxXPboZu5vkdMPAVnXU3Rkmr0rfvuAeEFQyYdvxB9qnwMGbwut8rtMYeiTV4b63TyHTnMYcXCOyiUGYvkkF++mFHU15OMBedB/A+I6zx8kCBF3uZG6ahfMu99VHu2YhMd7KjuOrKlzwmog/7UDtGLH8jATJ0Mr0sx/OfQ4Gemv80rR2jkfbXFeQhA3qVgddZBncOcXnoQE5KIows+cRq1Ue+kV680kbgCJSoTD2ImG9tDKFSHWCjRETg==
[Relay 2] [Relay] Decoded session_key_enc (hex): 5c8fbb3c7cc4c6bf3fa65bb2c317b8675fa61ae480a28339b9f1b1b839481739b7318f6ad6dfd920bee4647aab1b1426735b1eafc8a0d20ef412ced2e299c10347e7c4719c4de3315cf6e866ee6f91d30f0159d75374649abd2b7efb80784150c9876fc41f6a9f03066f0badf2bb4c61e8935786fadd3c874e731871708eca250662f92417efa6147535e4e30179d07f03e23acf1f24081177b991ba6a17ccbbdf551eed9884c77b2a3b8eaca973c26a20ffb503b462c7f2301327432bd2cc7f39f43819e9aff34ad1da391f6d715e421037a9581d75906770e7179e8404e4a228c2cf9c46ad547be915ebcd246e00894a84c3d88986f6d0ca1521d60a34444e
[Relay 2] [Relay] Decrypting session key with fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] Decrypted session_key (hex): 508b3cea99341a01cf4b31d1695445de6e196e20793d5c6ba7c10976bae0e6c1
[Relay 2] [Relay] [DEBUG] About to AES-decrypt payload (passing base64 string directly)
[Relay 2] [Relay] [DEBUG] Payload base64-decoded: type=<class 'bytes'>, len=1104, preview=b'n\x03\xc1\xf8T/Uk3-x\x89wK\xd3\x05\xf3\xdf+\x0e\x93\xa5\xa9\x13\x89)\xac\x8d\xb7\xd8\xd6\x84\xcaN\xb3\xb4\xaf\xbb\xe4\x00;>\xce\x00\x03a\xdd\xa4U@\xdd\x90>\xbe\x00\xd6\xfe\xcb\x0e\xe5'
[Relay 2] [Relay] [DEBUG] AES-decrypted payload: type=<class 'bytes'>, len=1088, preview=b'{"next_ip": "172.20.10.11", "next_port": 9103, "session_key"'
[Relay 2] [Relay] [DEBUG] AES-decrypted payload (hex): 7b226e6578745f6970223a20223137322e32302e31302e3131222c20226e6578745f706f7274223a20393130332c202273657373696f6e5f6b657922
[Relay 2] [Relay] [DEBUG] Next hop JSON keys: ['next_ip', 'next_port', 'session_key', 'payload']
[Relay 2] [Relay] [DEBUG] Forwarding to next relay 172.20.10.11:9103
[Relay 3] [Relay] [handle_message ENTERED] addr=('172.20.10.11', 59013), thread=6123139072, relay_port=9103
[Relay 3] [Relay] [DEBUG] Raw data received: b'{"next_ip": "172.20.10.11", "next_port": 9103, "session_key": "qMkV3by8TOqN38Fj0dNDZl+mbBkmeV2Xrqk/QOVhcfKZ7HfedU/I7Sti67Yq71Z47Glbpal8iKXgfl0M17/bzNRYkRPDILTsQBGrwPoJ8Vry7IhHDgZ99vaH7nRPNYEdhIXk3YNSoLQDHvHnLOJdofIMn6rYO85UqhwKfF0tz3S0ost/HZ7DrwrUMdScaqqgLfKR10oj4ZXQWOTYxQ38rQpcsJDniS1S+3hhEaWckl2miNrxQk7CZrImf4Cs7TLm8+o2qYzVntCbnYNzQk8r7yBqTpJbqaj3sLWhiI3Fnd107ijPyiGhLAlD5+BXnBRPjxPxD0woL1d5iqOwZa9d5Q==", "payload": "zYz4FOGTIIEfYvlqEc3jTapYsxbC0MgHEJFRtpqpGiQHrGVbC+Nu7PmhxzJaHpj50SyRkvoE5Ugd1pwT8phUViQuU8CtRr4bQP2xszEBBBl23tNG/AOWm53JzYDzxnDjnCQfcqfosLqUnlYIsohLGEw0p01xTHsZk6IK8IaVM53R3sYhWqlL3YYVkOT2CEi5VikIbeK2Rh8u68Mw+Dl+rIIFKBZlJdoof/MYZhvaCnyXJPAM15VpxsCFGLSJZHYlUqimakkPApUio/0y7x6kNPL7UQ0sFPpSS5ZOGWz+1m8+ZwCKY9H1gcy0G6xmM51jo5XGf5qfuPZRNMsZaMGegdqQqlmwudht0xJZV/dWmQ5r/wNliQE+YJnq4TlgTq8Ne//ZXGY0sLJ4Ww8PnSjkZk5ipB9bulaZofTWNR5eBTskiYxMWMTgDadDMP9TnWS+uASis8ClwbpdL2P1QBBHbR0JanBMRcFOqpOnZbtf6eb3+D2CeNjaRpTvzGFVY5EHptErisdIHZNiry7PIO2hzqv7gjULguM/kh6Fp+sIUlRX5Xs/7ldG19Q+ZO1bpc0S4FApwk4mFMT553sunpLghp/G+3PfzlRMiOaoKZs2hnE+81JGB9d7BHA6ACkulCBqzeg8iMQFV2RtO0XMO8yCbg=="}'
[Relay 3] [Relay] [DEBUG] Data after JSON parse: type=<class 'dict'>, keys=['next_ip', 'next_port', 'session_key', 'payload']
[Relay 3] [Relay] Received session_key (base64): qMkV3by8TOqN38Fj0dNDZl+mbBkmeV2Xrqk/QOVhcfKZ7HfedU/I7Sti67Yq71Z47Glbpal8iKXgfl0M17/bzNRYkRPDILTsQBGrwPoJ8Vry7IhHDgZ99vaH7nRPNYEdhIXk3YNSoLQDHvHnLOJdofIMn6rYO85UqhwKfF0tz3S0ost/HZ7DrwrUMdScaqqgLfKR10oj4ZXQWOTYxQ38rQpcsJDniS1S+3hhEaWckl2miNrxQk7CZrImf4Cs7TLm8+o2qYzVntCbnYNzQk8r7yBqTpJbqaj3sLWhiI3Fnd107ijPyiGhLAlD5+BXnBRPjxPxD0woL1d5iqOwZa9d5Q==
[Relay 3] [Relay] Decoded session_key_enc (hex): a8c915ddbcbc4cea8ddfc163d1d343665fa66c1926795d97aea93f40e56171f299ec77de754fc8ed2b62ebb62aef5678ec695ba5a97c88a5e07e5d0cd7bfdbccd4589113c320b4ec4011abc0fa09f15af2ec88470e067df6f687ee744f35811d8485e4dd8352a0b4031ef1e72ce25da1f20c9faad83bce54aa1c0a7c5d2dcf74b4a2cb7f1d9ec3af0ad431d49c6aaaa02df291d74a23e195d058e4d8c50dfcad0a5cb090e7892d52fb786111a59c925da688daf1424ec266b2267f80aced32e6f3ea36a98cd59ed09b9d8373424f2bef206a4e925ba9a8f7b0b5a1888dc59ddd74ee28cfca21a12c0943e7e0579c144f8f13f10f4c282f57798aa3b065af5de5
[Relay 3] [Relay] Decrypting session key with fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] [Relay] Decrypted session_key (hex): f85b2a65202028c631aea8e33e55cbe653ce662e53215ecb4d8a92db61e214cd
[Relay 3] [Relay] [DEBUG] About to AES-decrypt payload (passing base64 string directly)
[Relay 3] [Relay] [DEBUG] Payload base64-decoded: type=<class 'bytes'>, len=496, preview=b'\xcd\x8c\xf8\x14\xe1\x93 \x81\x1fb\xf9j\x11\xcd\xe3M\xaaX\xb3\x16\xc2\xd0\xc8\x07\x10\x91Q\xb6\x9a\xa9\x1a$\x07\xace[\x0b\xe3n\xec\xf9\xa1\xc72Z\x1e\x98\xf9\xd1,\x91\x92\xfa\x04\xe5H\x1d\xd6\x9c\x13'
[Relay 3] [Relay] [DEBUG] AES-decrypted payload: type=<class 'bytes'>, len=480, preview=b'{"next_ip": "172.20.10.11", "next_port": 9101, "session_key"'
[Relay 3] [Relay] [DEBUG] AES-decrypted payload (hex): 7b226e6578745f6970223a20223137322e32302e31302e3131222c20226e6578745f706f7274223a20393130312c202273657373696f6e5f6b657922
[Relay 3] [Relay] [DEBUG] Next hop JSON keys: ['next_ip', 'next_port', 'session_key', 'payload']
[Relay 3] [Relay] [DEBUG] Forwarding to next relay 172.20.10.11:9101
[Relay 1] [Relay] [handle_message ENTERED] addr=('172.20.10.11', 59021), thread=6170701824, relay_port=9101
[Relay 1] [Relay] [DEBUG] Raw data received: b'{"next_ip": "172.20.10.11", "next_port": 9101, "session_key": "1WDLB4g4U0fmo58mI40OEomoEOEAyaNQ1iFPm1bVYtjQAOYNXiSVuxz/LDA0taG9T+0mS7DdYXLZ/JpH9ag9Ysdpnf6mbk2R0JnAzPHQvEvR2ULUBAm743WuwRVpTNfLKhAmPwpyIJP+z9SMTH4bqCEoyW+E5uam5wVnVF1ne8LcP2/zQISVLSvSn7zqYRADTYW4z4VaNJNXOH8BxhUA/LZav41wG+uDZwMzIkVeGny4As+8LVAdQLQB1z/ccCTP5OQvn3We/yP4ZJ2Oa09Qzpbq5ZatH5Khxt/P0T7Y45YPDdc0POMTlmkZz85KrdIXTHehyN4JwLTxOxthEEAZkw==", "payload": "6EA00DhNY6t6rKnJQ3s1cZHYktFqNuH8SS7N521jY8dx3vaYWIwtmw=="}'
[Relay 1] [Relay] [DEBUG] Data after JSON parse: type=<class 'dict'>, keys=['next_ip', 'next_port', 'session_key', 'payload']
[Relay 1] [Relay] Received session_key (base64): 1WDLB4g4U0fmo58mI40OEomoEOEAyaNQ1iFPm1bVYtjQAOYNXiSVuxz/LDA0taG9T+0mS7DdYXLZ/JpH9ag9Ysdpnf6mbk2R0JnAzPHQvEvR2ULUBAm743WuwRVpTNfLKhAmPwpyIJP+z9SMTH4bqCEoyW+E5uam5wVnVF1ne8LcP2/zQISVLSvSn7zqYRADTYW4z4VaNJNXOH8BxhUA/LZav41wG+uDZwMzIkVeGny4As+8LVAdQLQB1z/ccCTP5OQvn3We/yP4ZJ2Oa09Qzpbq5ZatH5Khxt/P0T7Y45YPDdc0POMTlmkZz85KrdIXTHehyN4JwLTxOxthEEAZkw==
[Relay 1] [Relay] Decoded session_key_enc (hex): d560cb0788385347e6a39f26238d0e1289a810e100c9a350d6214f9b56d562d8d000e60d5e2495bb1cff2c3034b5a1bd4fed264bb0dd6172d9fc9a47f5a83d62c7699dfea66e4d91d099c0ccf1d0bc4bd1d942d40409bbe375aec115694cd7cb2a10263f0a722093fecfd48c4c7e1ba82128c96f84e6e6a6e70567545d677bc2dc3f6ff34084952d2bd29fbcea6110034d85b8cf855a349357387f01c61500fcb65abf8d701beb8367033322455e1a7cb802cfbc2d501d40b401d73fdc7024cfe4e42f9f759eff23f8649d8e6b4f50ce96eae596ad1f92a1c6dfcfd13ed8e3960f0dd7343ce313966919cfce4aadd2174c77a1c8de09c0b4f13b1b6110401993
[Relay 1] [Relay] Decrypting session key with fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] Decrypted session_key (hex): 8828d13e79b93530c805528c216875a81c5dbd32498cb729c7d4cdda54d96c96
[Relay 1] [Relay] [DEBUG] About to AES-decrypt payload (passing base64 string directly)
[Relay 1] [Relay] [DEBUG] Payload base64-decoded: type=<class 'bytes'>, len=40, preview=b'\xe8@4\xd08Mc\xabz\xac\xa9\xc9C{5q\x91\xd8\x92\xd1j6\xe1\xfcI.\xcd\xe7mcc\xc7q\xde\xf6\x98X\x8c-\x9b'
[Relay 1] [Relay] [DEBUG] AES-decrypted payload: type=<class 'bytes'>, len=24, preview=b'{"msg": "Hello, world!"}'
[Relay 1] [Relay] [DEBUG] AES-decrypted payload (hex): 7b226d7367223a202248656c6c6f2c20776f726c6421227d
[Relay 1] [Relay] [DEBUG] Next hop JSON keys: ['msg']
[Relay 1] [Relay] [DEBUG] Payload is not JSON, assuming last hop. Error: 'next_ip'
[Relay 1] [Relay] [Last Hop] Forwarding payload to dest 127.0.0.1:9100, len=24, type=<class 'bytes'>
[Relay 1] [Relay] [Last Hop] Sending to dest: type=<class 'bytes'>, len=24, preview=b'{"msg": "Hello, world!"}'
[Relay 1] [Relay] [Last Hop] Received response from dest: type=<class 'bytes'>, len=50, preview=b'{"result": "OK", "echo": {"msg": "Hello, world!"}}'
[Relay 1] [Relay] [Last Hop] Response from dest decoded as UTF-8: '{"result": "OK", "echo": {"msg": "Hello, world!"}}'
[Relay 1] [Relay] [Last Hop] Response from dest (hex): 7b22726573756c74223a20224f4b222c20226563686f223a207b226d7367223a202248656c6c6f2c20776f726c6421227d7d
[Relay 1] [Relay] [Last Hop] About to AES-encrypt response: type=<class 'bytes'>, len=50, preview=b'{"result": "OK", "echo": {"msg": "Hello, world!"}}'
[Relay 1] [Relay] [Last Hop] AES-encrypted response (hex): 5dc3216571c8d6e1524f34e98f69c4037fa3eab0063f5900956edf5cf2cf826373a537c3aaa40ef80b1d9061d36dc77b7afe2fe44bf7655a172afbc6
[Relay 1] [Relay] [Last Hop] Base64-encoded AES-encrypted response: type=<class 'bytes'>, len=88, preview=b'XcMhZXHI1uFSTzTpj2nEA3+j6rAGP1kAlW7fXPLPgmNzpTfDqqQO+AsdkGHT'
[Relay 1] [Relay] [Last Hop] Sent response to ('172.20.10.11', 59021): b'XcMhZXHI1uFSTzTpj2nEA3+j6rAGP1kAlW7fXPLPgmNzpTfDqqQO+AsdkGHT'... (len=88)
[Relay 3] [Relay] [DEBUG] Received response from next relay: type=<class 'bytes'>, len=88, preview=b'XcMhZXHI1uFSTzTpj2nEA3+j6rAGP1kAlW7fXPLPgmNzpTfDqqQO+AsdkGHT'
[Relay 1] [Relay] [handle_message END] addr=('172.20.10.11', 59021), thread=6170701824
[Relay 3] [Relay] [RETURN] Base64-decoded response: type=<class 'bytes'>, len=66, preview=b']\xc3!eq\xc8\xd6\xe1RO4\xe9\x8fi\xc4\x03\x7f\xa3\xea\xb0\x06?Y\x00\x95n\xdf\\\xf2\xcf\x82cs\xa57\xc3\xaa\xa4\x0e\xf8\x0b\x1d\x90a\xd3m\xc7{z\xfe/\xe4K\xf7eZ\x17*\xfb\xc6'
[Relay 3] [Relay] [RETURN] AES-decrypted response: type=<class 'bytes'>, len=50, preview=b"b\xacK\x99'\x8d\xed\xf9\xd1\x18Pq!\xa9\x9cV\xfa\xd2\xb45L\x964\xa6\xa8\xe8\xd3?od\x90\x9b\x06\xbf\r|\xae!g\xcc\xa3\x9eck\x83\xc47iRO"
[Relay 3] [Relay] [RETURN] AES-decrypted response not UTF-8: 'utf-8' codec can't decode byte 0xac in position 1: invalid start byte
[Relay 3] [Relay] [RETURN] AES-encrypted response (hex): c2e793e6aa80ef6c79e77559020006d8986f6ff59936bd3b01b1ece8520ddd663c01c74fb8f4a63fc9e8fe413f2f855ca7d0aa873fea3ea378355ee3
[Relay 3] [Relay] [RETURN] Base64-encoded AES-encrypted response: type=<class 'bytes'>, len=112, preview=b'wueT5qqA72x553VZAgAG2Jhvb/WZNr07AbHs6FIN3WY8AcdPuPSmP8no/kE/'
[Relay 3] [Relay] [handle_message END] addr=('172.20.10.11', 59013), thread=6123139072
[Relay 2] [Relay] [DEBUG] Received response from next relay: type=<class 'bytes'>, len=112, preview=b'wueT5qqA72x553VZAgAG2Jhvb/WZNr07AbHs6FIN3WY8AcdPuPSmP8no/kE/'
[Relay 2] [Relay] [RETURN] Base64-decoded response: type=<class 'bytes'>, len=82, preview=b'\xc2\xe7\x93\xe6\xaa\x80\xefly\xe7uY\x02\x00\x06\xd8\x98oo\xf5\x996\xbd;\x01\xb1\xec\xe8R\r\xddf<\x01\xc7O\xb8\xf4\xa6?\xc9\xe8\xfeA?/\x85\\\xa7\xd0\xaa\x87?\xea>\xa3x5^\xe3'
[Relay 2] [Relay] [RETURN] AES-decrypted response: type=<class 'bytes'>, len=66, preview=b'\x8e\x15k\xf4h\xffs\xf0b\x0c\xa3\xc1\x9c\xf5"\xec\xfei\xde\xa6s\x10\xff\xf5\xc5\xae\x19va[\xda<\xfd\x0f\x8e\xd5\'\x80\xac\x08\xa7!\xb3\xfc\xc3VuJ\xea8q`Z\x1f\xb2\xa4\xc5Bd\x9e'
[Relay 2] [Relay] [RETURN] AES-decrypted response not UTF-8: 'utf-8' codec can't decode byte 0x8e in position 0: invalid start byte
[Relay 2] [Relay] [RETURN] AES-encrypted response (hex): 6f364d218fbbcf6b6fbaa2051bc5be0f2f31392d1713d0584f52ddb1487b93d12f97cd4fed186fd18010f3057a30663b2552e301e51b1ab275282abe
[Relay 2] [Relay] [RETURN] Base64-encoded AES-encrypted response: type=<class 'bytes'>, len=132, preview=b'bzZNIY+7z2tvuqIFG8W+Dy8xOS0XE9BYT1LdsUh7k9Evl81P7Rhv0YAQ8wV6'
[Relay] ---- Relay process started ----
[Relay 1] [Relay] Loaded persistent RSA keypair from relay1_key.pem
[Relay 1] [Relay] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] [KEY] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] Relay 1 starting on 10.250.120.196:9101 (RELAY PORT 9101)
[Relay 1] Registering with CDS at 127.0.0.1:9000
[Relay 1] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9101, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5MM7/HBECV26fZqjUJkt\nQ4+dx297cL0hf1+rf08Qir5tL/lArfQsiplTqcsIsZiN7vJ8K2XzvK5JAEv8tVE4\nEKU4W1hbEVBd1eLCX+Oc5XauTbWhW8xlc2wdNlNwDhin2Mw84doKJWPyfjtIwnIi\n3nWHqxLyAqkj6qDoByA8D7YVmJxvzwL0mrYE8G8b4Q4Wjnx2SXeTwc9LRzqwrsyb\nlM5B4BSVPBignOMhD2AfuIFw6uULQThbkL9L5AnQA08B4Gqzo731LLJN/Y6qo+VJ\nki2t6m1aJTG0LBjijpH7CtnN1MHIQ5UueS1sJVYZooYxkxEYYZTqIUXxuI5ICKPC\nCQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 1] [Relay] Listening for incoming messages on port 9101 (RELAY PORT 9101)
[Relay] ---- Relay process started ----
[Relay 2] [Relay] Loaded persistent RSA keypair from relay2_key.pem
[Relay 2] [Relay] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] [KEY] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] Relay 2 starting on 10.250.120.196:9102 (RELAY PORT 9102)
[Relay 2] Registering with CDS at 127.0.0.1:9000
[Relay 2] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9102, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA58J3pSrOQd4hYnuzQQ7q\nWrjjo+3BJp+ik23brR2yl0kjtfH+wjD9LYWHS7dBxsDRzSozJ/7EWKKNCaTsgvaF\nN6vpyBPqDM/uQfOWfirteL50RgDZw95Vml4Fuay7bTBEb1J8ydvFqawo8rnLE2I3\nU4BjBT+CD38bY3je8wrrCX9fo1uYaLDlfteGshadZ2gnTxrAzkZZ/CTFdyb8JrmN\nIuxjBVjwSA/uIv+KHWQhXRA5jJPXcNV88LYXyEzpid1Cr9gnrqA88K0HSleiwZjU\nJF3LhBvS2Ga2HHfFsk5D/yz/pTHwDvRA98VMT/90wahwmSJsck4XWDFhmNhy3oDR\nBQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 2] [Relay] Listening for incoming messages on port 9102 (RELAY PORT 9102)
[Relay] ---- Relay process started ----
[Relay 3] [Relay] Loaded persistent RSA keypair from relay3_key.pem
[Relay 3] [Relay] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] [Relay] [KEY] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] Relay 3 starting on 10.250.120.196:9103 (RELAY PORT 9103)
[Relay 3] Registering with CDS at 127.0.0.1:9000
[Relay 3] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9103, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5k9OJ8m3IdjmwR1skM1G\nwrKkwlYLK0Qs+I/BX5ww5wEakOsTy5NVFAwTYrCUnR012u2jCwI8wV1YpPaMa8RJ\ntnqNFy4pFfqBh5tmidHQ3QMRvINPrGtQM5+VgMXoA0y8izql52M1K/3Q6sHVlAXd\nmpQcBO+JSHY7uyVx1txZssyisia7Nn8Frh/XRpl0oUvGkSnbm/KgqDAP0xJ3lUZS\nEGiIWdf0bn7tHD3nYBMrWWi3jSQWf0Q80asIEYWipwkfMPf0ffzu4FX0elfvpyOX\nr50xk7sb8K5IhcilwxKxQpPOcq3f6ph0EERQR7pOdDqkzFdHoGiyssSX4MYM60kd\nmQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 3] [Relay] Listening for incoming messages on port 9103 (RELAY PORT 9103)
[Relay 3] [Relay] [handle_message ENTERED] addr=('10.250.120.196', 59913), thread=6168915968, relay_port=9103
[Relay 3] [Relay] [DEBUG] Raw data received: b'{"next_ip": "10.250.120.196", "next_port": 9103, "session_key": "Jqr4X2ly6DVpl92hkEkEI3N6gcd26KZCWiuEsP9ajgRiLChLeZXlyNufngovYTuQvSvut/hLHYwXhTD66KtvzERpkcwYhUvV8PoaZg8Q6BlK81mrL7Uq5Py1b/76QZbJ2ART1mXtvTuiWh12eF8xACenxV+tNd+jgOyp9fYXFoIsiiSJrPLEHZ7Os39fHQWkCm6aUe1Hz+1c/bP2OCya7yggLdtyma9KTUZUj/YcFa8VLr5N1juzeicka7SImCdAUfaSqMWab3RuBpGFJpb2X0OM2hyIfJNcLWDmEUY9o9HKqo/MWjTKChYji3XhquHShLm+U1PWpbsdK4gSEUaBpA==", "payload": "xR8Xd30drnCjES3/iyBGVViaKmj1UXeS1hzqZZNVLtPyUYiPwJ6QsbVQR4F4zOd3wcOMTYTVBXEOjnfDtWrfN0uxcnypbwp1G/2z2ayBhsbArJgj9uUU4YPMAfcsZpvWllx1kc7+1u6jmBg/ARL6Eah5a8HHams9/G9l6+5tr9y4mLNGjgLIIV6O+MzexvLVbXvJ8vv79n1ni9amSe44hiTU4/QMWFLfbgVADj1ncVRklFBFKsa1/yijhGo92cg6O4HqXH+/pa8U1Azg+to26eO9uZrmRoIX2ewTwreJSWq3n/SntrZhL8bd2cfLhjGbB7VkvmoOEO0vZtZvWcuZm82tIEruNdC1N9CK6aE2M6/vuRpDyjlEgzh4zgb06j0zcMJ2Za7H+CIR2axlNNRvJUuTDUky/5mKcfPpUxvtvbqNH92KMZ3VSe4nEeQariO0jBeL2YLyMvSXL52RlOSSk1zIV8AEu0BZ/NxG5iLjaHGcdZYJG8HPyKxnvJYHS+Fe4BiOc8HwK+Ksg/0xE9Q2DzDH7qm/8cp1+Q+v56hAk0GICocOTD7OJWcNSVrPEyXbwmFMRAVgZVjDc7qV8j0raMMwbx5w9j6b27CJSL46+K3+d2OTlM9Akv/A9vcCAQ2yOCuMoUpnrdLXlFtCRzBwvr0keYaro+967yiuECrfP47msqXJX4siKBfoB+07o2X0XLMX6mgev17ck3choFSR2Sc0MKy7fM9Hu+rypB7RMzr2iBJ3uPz5F/9LGqYiQq+myAcyHZxPoRvh6dMMoFvD3Mii3vrF4CV+sFnBsDIUlOK4dTvsRK3H+dqT01h4n1Ttv6WR520pjKJdt/U8Lst8E/saK7fyKjIpwkoeDzzdy90dUFlOBqymmKwAnQyiczZ0RaMVWc7kh6MyPEYtTSRFUfxtZa3aLvjO4IUTgcJAQT8ci1J3K9WLUR2oMCO12MxRAwkBH9ZB1a1jWFVL4kafuCnbWjBB6DhLiIJHfByaJqKQdz7HKhf7N57EYUzUKlkkCheR0RiI2eHSyIKrgjlBTcuCQgd8An9YNYGwhl3+/5ej1QPczk7yBM4PkEuSy9FLNVz47rSN3ihg8ndXQ7tkkGn5MiM3j8yqOSIqZ8A4yM8NWfqPhXPoGdNTYkk4MUdeNoLb88/GOlsSOXp24iEoTV2vY0A8JIe3+i8TaFm3ZFHXWMvjgMxv9n9oOJP7dMdlZkvFoNv50mCDlj+EkIK9jc0+l+FLMqfDGCsmj+E3NmPTw0sIBLrX/CMHBw62e9ucaFXbZ7Qhx20WCyyfHWEtLT3uL6DWvuEDarSM5zULT0yUriE+dZCCIXShya47juz/T5MEhC7dNMZ3r/Syd9Hs+/C4CFMoS6poGuPlJnNzkQDYB4W9gMC0YgHjAvXPFiuCQmRu790Sq4S3lfV/WLCAW8vCa2GYtYwGnFYz7W4qHtJYoBpXp5J38FaGqKnt5EjAg+w="}'
[Relay 3] [Relay] [DEBUG] Data after JSON parse: type=<class 'dict'>, keys=['next_ip', 'next_port', 'session_key', 'payload']
[Relay 3] [Relay] Received session_key (base64): Jqr4X2ly6DVpl92hkEkEI3N6gcd26KZCWiuEsP9ajgRiLChLeZXlyNufngovYTuQvSvut/hLHYwXhTD66KtvzERpkcwYhUvV8PoaZg8Q6BlK81mrL7Uq5Py1b/76QZbJ2ART1mXtvTuiWh12eF8xACenxV+tNd+jgOyp9fYXFoIsiiSJrPLEHZ7Os39fHQWkCm6aUe1Hz+1c/bP2OCya7yggLdtyma9KTUZUj/YcFa8VLr5N1juzeicka7SImCdAUfaSqMWab3RuBpGFJpb2X0OM2hyIfJNcLWDmEUY9o9HKqo/MWjTKChYji3XhquHShLm+U1PWpbsdK4gSEUaBpA==
[Relay 3] [Relay] Decoded session_key_enc (hex): 26aaf85f6972e8356997dda190490423737a81c776e8a6425a2b84b0ff5a8e04622c284b7995e5c8db9f9e0a2f613b90bd2beeb7f84b1d8c178530fae8ab6fcc446991cc18854bd5f0fa1a660f10e8194af359ab2fb52ae4fcb56ffefa4196c9d80453d665edbd3ba25a1d76785f310027a7c55fad35dfa380eca9f5f61716822c8a2489acf2c41d9eceb37f5f1d05a40a6e9a51ed47cfed5cfdb3f6382c9aef28202ddb7299af4a4d46548ff61c15af152ebe4dd63bb37a27246bb48898274051f692a8c59a6f746e0691852696f65f438cda1c887c935c2d60e611463da3d1caaa8fcc5a34ca0a16238b75e1aae1d284b9be5353d6a5bb1d2b8812114681a4
[Relay 3] [Relay] Decrypting session key with fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] [Relay] Decrypted session_key (hex): f207589f9425f6f35759ddeb0d4ceebcbeb5254fac96185b0327a1388776b40b
[Relay 3] [Relay] [DEBUG] About to AES-decrypt payload (passing base64 string directly)
[Relay 3] [Relay] [DEBUG] Payload base64-decoded: type=<class 'bytes'>, len=1106, preview=b'\xc5\x1f\x17w}\x1d\xaep\xa3\x11-\xff\x8b FUX\x9a*h\xf5Qw\x92\xd6\x1c\xeae\x93U.\xd3\xf2Q\x88\x8f\xc0\x9e\x90\xb1\xb5PG\x81x\xcc\xe7w\xc1\xc3\x8cM\x84\xd5\x05q\x0e\x8ew\xc3'
[Relay 3] [Relay] [DEBUG] AES-decrypted payload: type=<class 'bytes'>, len=1090, preview=b'{"next_ip": "10.250.120.196", "next_port": 9102, "session_ke'
[Relay 3] [Relay] [DEBUG] AES-decrypted payload (hex): 7b226e6578745f6970223a202231302e3235302e3132302e313936222c20226e6578745f706f7274223a20393130322c202273657373696f6e5f6b65
[Relay 3] [Relay] [DEBUG] Next hop JSON keys: ['next_ip', 'next_port', 'session_key', 'payload']
[Relay 3] [Relay] [DEBUG] Forwarding to next relay 10.250.120.196:9102
[Relay 2] [Relay] [handle_message ENTERED] addr=('10.250.120.196', 59920), thread=6157463552, relay_port=9102
[Relay 2] [Relay] [DEBUG] Raw data received: b'{"next_ip": "10.250.120.196", "next_port": 9102, "session_key": "LMMN8kUfiZEFR7eQUWs5qDHj/XL0PD7AAO/jlTnLIDdWfY/+FUqam0mcoCrSSgU8J7KS0kIBNOZr45hioPA9L6gizmN0XBlwnaTxunU+UtKlI5i+0TYAjxr+OvwYzQTnqX9doKeYyzpKyq8uCmKfrel2Ghur50s3cSfKSedbOV8J/0NJapZlqBBXPrh9/4zkKlTG8jTJSzXnjuYxFMyC0BWbHDFbAmny888SBcWTpxdjNCjFPc/NtOwm1Tji3QpTXQBvh+xgGYaN9V9WswdZuVOtJmoWQJb3WMafhUQgDV9ceN/lSlbtJofKhP2+lQvUQlm2+DHNFpojgRQ7kV77mA==", "payload": "+i6IqQw7xrILPgerjoeBDbyryMQMe91SqzpbhZF+WxyHCGPY6DB91UwmL/bpeJaZ6CNTyiFuQKFK52xqYJQWZR/6quZ7sx3kTiv342ww6sVEmq04BJITldnRoRVOT/kNmoUw0dh74MKgZYm9d0hYXasU5h8hyYz/GFuItHRLq81756MW45DR6sfDp1GMF3VQIl0ddNglOZc7pDXARCz7zdlRM6u1GZofjfVhomM++Bdw1dQWHA73s+O2/kjrQAr/ow3ya4OsOKi1vu6ctyYCCOx0cKnBV9s0qVmy4wW1bXNgZKbFctkgU/yMt8svBV0GSxHMaxwIoHfOXAVWw13ZTpK/cYcIWZmtlEttnDV1X7a6g3+k4dNYWrRoomCP6yEY9EEHgEqrKHWjuBGk8Oug9VRQ9u5mRLums4JDEx2LVaFzwhJEE+MpmhY4I6NdSz6Mk2fOhML61CmH8cmzqlqGV3KxOoHdweFFKeBN108hgR8a0f+jEP78WCrjLDOeE+FVH+SP0ukSFsQV5IbOwjC8IySxhcxyucovR8L8uXG39Gu8mW5vzI/dW37VmOrNWsKzpWkfjxj4sNUWIBNzUaD/f+S1T2NGeD/MHgHiZcGDUZFcXWbPxuBY7HUwdRdOla2ylkALeoYpLqH4w3W4FWR/2Bxh"}'
[Relay 2] [Relay] [DEBUG] Data after JSON parse: type=<class 'dict'>, keys=['next_ip', 'next_port', 'session_key', 'payload']
[Relay 2] [Relay] Received session_key (base64): LMMN8kUfiZEFR7eQUWs5qDHj/XL0PD7AAO/jlTnLIDdWfY/+FUqam0mcoCrSSgU8J7KS0kIBNOZr45hioPA9L6gizmN0XBlwnaTxunU+UtKlI5i+0TYAjxr+OvwYzQTnqX9doKeYyzpKyq8uCmKfrel2Ghur50s3cSfKSedbOV8J/0NJapZlqBBXPrh9/4zkKlTG8jTJSzXnjuYxFMyC0BWbHDFbAmny888SBcWTpxdjNCjFPc/NtOwm1Tji3QpTXQBvh+xgGYaN9V9WswdZuVOtJmoWQJb3WMafhUQgDV9ceN/lSlbtJofKhP2+lQvUQlm2+DHNFpojgRQ7kV77mA==
[Relay 2] [Relay] Decoded session_key_enc (hex): 2cc30df2451f89910547b790516b39a831e3fd72f43c3ec000efe39539cb2037567d8ffe154a9a9b499ca02ad24a053c27b292d2420134e66be39862a0f03d2fa822ce63745c19709da4f1ba753e52d2a52398bed136008f1afe3afc18cd04e7a97f5da0a798cb3a4acaaf2e0a629fade9761a1babe74b377127ca49e75b395f09ff43496a9665a810573eb87dff8ce42a54c6f234c94b35e78ee63114cc82d0159b1c315b0269f2f3cf1205c593a717633428c53dcfcdb4ec26d538e2dd0a535d006f87ec6019868df55f56b30759b953ad266a164096f758c69f8544200d5f5c78dfe54a56ed2687ca84fdbe950bd44259b6f831cd169a2381143b915efb98
[Relay 2] [Relay] Decrypting session key with fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] Decrypted session_key (hex): 797ea5b626fba336526f85655553045fca4ce9e54621523664ebc52eb55eb3e3
[Relay 2] [Relay] [DEBUG] About to AES-decrypt payload (passing base64 string directly)
[Relay 2] [Relay] [DEBUG] Payload base64-decoded: type=<class 'bytes'>, len=498, preview=b'\xfa.\x88\xa9\x0c;\xc6\xb2\x0b>\x07\xab\x8e\x87\x81\r\xbc\xab\xc8\xc4\x0c{\xddR\xab:[\x85\x91~[\x1c\x87\x08c\xd8\xe80}\xd5L&/\xf6\xe9x\x96\x99\xe8#S\xca!n@\xa1J\xe7lj'
[Relay 2] [Relay] [DEBUG] AES-decrypted payload: type=<class 'bytes'>, len=482, preview=b'{"next_ip": "10.250.120.196", "next_port": 9101, "session_ke'
[Relay 2] [Relay] [DEBUG] AES-decrypted payload (hex): 7b226e6578745f6970223a202231302e3235302e3132302e313936222c20226e6578745f706f7274223a20393130312c202273657373696f6e5f6b65
[Relay 2] [Relay] [DEBUG] Next hop JSON keys: ['next_ip', 'next_port', 'session_key', 'payload']
[Relay 2] [Relay] [DEBUG] Forwarding to next relay 10.250.120.196:9101
[Relay 1] [Relay] [handle_message ENTERED] addr=('10.250.120.196', 59923), thread=6162755584, relay_port=9101
[Relay 1] [Relay] [DEBUG] Raw data received: b'{"next_ip": "10.250.120.196", "next_port": 9101, "session_key": "gBFi+ALHqfRQQwIA0oHSX6/sUdIHBXZfLF6BD86HZkFV57u8j2psl3ii4GzoVcsL1uyTHTN+E926+jj8/4Kfd7Fk+bT+7DWWBowttL8668prULVUac3QFb74uHOgYBeH9Bkpg/tKSB0R/LTaa94QBukxKUSFZlLiLfRdXW9miEV1UHxanPL8DhSTBuoxAlu/Fg8gqA9EKOm2U8YhGjxeEJSXxuiPO8lxmzFj+a1nAyRF+gzdVz80IQI1OfVgNL7L6oJmjneyDWYUj2YOSJuLN6jtwOq48AxwE9gygm4jouxuFyavm+c+6j3iAAackuxDv+druAXfRbe1Yn3S409RIw==", "payload": "LwyJYdYOCoZnNPHva1/PvfrKYNh3BOqRvMVRJZrU4GfKaYvojOukvQ=="}'
[Relay 1] [Relay] [DEBUG] Data after JSON parse: type=<class 'dict'>, keys=['next_ip', 'next_port', 'session_key', 'payload']
[Relay 1] [Relay] Received session_key (base64): gBFi+ALHqfRQQwIA0oHSX6/sUdIHBXZfLF6BD86HZkFV57u8j2psl3ii4GzoVcsL1uyTHTN+E926+jj8/4Kfd7Fk+bT+7DWWBowttL8668prULVUac3QFb74uHOgYBeH9Bkpg/tKSB0R/LTaa94QBukxKUSFZlLiLfRdXW9miEV1UHxanPL8DhSTBuoxAlu/Fg8gqA9EKOm2U8YhGjxeEJSXxuiPO8lxmzFj+a1nAyRF+gzdVz80IQI1OfVgNL7L6oJmjneyDWYUj2YOSJuLN6jtwOq48AxwE9gygm4jouxuFyavm+c+6j3iAAackuxDv+druAXfRbe1Yn3S409RIw==
[Relay 1] [Relay] Decoded session_key_enc (hex): 801162f802c7a9f450430200d281d25fafec51d20705765f2c5e810fce87664155e7bbbc8f6a6c9778a2e06ce855cb0bd6ec931d337e13ddbafa38fcff829f77b164f9b4feec3596068c2db4bf3aebca6b50b55469cdd015bef8b873a0601787f4192983fb4a481d11fcb4da6bde1006e9312944856652e22df45d5d6f66884575507c5a9cf2fc0e149306ea31025bbf160f20a80f4428e9b653c6211a3c5e109497c6e88f3bc9719b3163f9ad67032445fa0cdd573f3421023539f56034becbea82668e77b20d66148f660e489b8b37a8edc0eab8f00c7013d832826e23a2ec6e1726af9be73eea3de200069c92ec43bfe76bb805df45b7b5627dd2e34f5123
[Relay 1] [Relay] Decrypting session key with fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] Decrypted session_key (hex): 195663957d1fefb449a0a5aeb83ee62d89196ae305ed6b0643f218f5ec9b716d
[Relay 1] [Relay] [DEBUG] About to AES-decrypt payload (passing base64 string directly)
[Relay 1] [Relay] [DEBUG] Payload base64-decoded: type=<class 'bytes'>, len=40, preview=b'/\x0c\x89a\xd6\x0e\n\x86g4\xf1\xefk_\xcf\xbd\xfa\xca`\xd8w\x04\xea\x91\xbc\xc5Q%\x9a\xd4\xe0g\xcai\x8b\xe8\x8c\xeb\xa4\xbd'
[Relay 1] [Relay] [DEBUG] AES-decrypted payload: type=<class 'bytes'>, len=24, preview=b'{"msg": "Hello, world!"}'
[Relay 1] [Relay] [DEBUG] AES-decrypted payload (hex): 7b226d7367223a202248656c6c6f2c20776f726c6421227d
[Relay 1] [Relay] [DEBUG] Next hop JSON keys: ['msg']
[Relay 1] [Relay] [DEBUG] Payload is not JSON, assuming last hop. Error: 'next_ip'
[Relay 1] [Relay] [Last Hop] Forwarding payload to dest 127.0.0.1:9100, len=24, type=<class 'bytes'>
[Relay 1] [Relay] [Last Hop] Sending to dest: type=<class 'bytes'>, len=24, preview=b'{"msg": "Hello, world!"}'
[Relay 1] [Relay] [Last Hop] Received response from dest: type=<class 'bytes'>, len=50, preview=b'{"result": "OK", "echo": {"msg": "Hello, world!"}}'
[Relay 1] [Relay] [Last Hop] Response from dest decoded as UTF-8: '{"result": "OK", "echo": {"msg": "Hello, world!"}}'
[Relay 1] [Relay] [Last Hop] Response from dest (hex): 7b22726573756c74223a20224f4b222c20226563686f223a207b226d7367223a202248656c6c6f2c20776f726c6421227d7d
[Relay 1] [Relay] [Last Hop] About to AES-encrypt response: type=<class 'bytes'>, len=50, preview=b'{"result": "OK", "echo": {"msg": "Hello, world!"}}'
[Relay 1] [Relay] [Last Hop] AES-encrypted response (hex): 6fb6c4ce66c04bf910b8bcd4761c00d074635a070c98f8cb9c0a0c78cb3faa0b1767de7486cf6cacbc4e77e177ccf28ca80db43c0583c9c341caede2
[Relay 1] [Relay] [Last Hop] Base64-encoded AES-encrypted response: type=<class 'bytes'>, len=88, preview=b'b7bEzmbAS/kQuLzUdhwA0HRjWgcMmPjLnAoMeMs/qgsXZ950hs9srLxOd+F3'
[Relay 1] [Relay] [Last Hop] Sent response to ('10.250.120.196', 59923): b'b7bEzmbAS/kQuLzUdhwA0HRjWgcMmPjLnAoMeMs/qgsXZ950hs9srLxOd+F3'... (len=88)
[Relay 2] [Relay] [DEBUG] Received response from next relay: type=<class 'bytes'>, len=88, preview=b'b7bEzmbAS/kQuLzUdhwA0HRjWgcMmPjLnAoMeMs/qgsXZ950hs9srLxOd+F3'
[Relay 1] [Relay] [handle_message END] addr=('10.250.120.196', 59923), thread=6162755584
[Relay 2] [Relay] [RETURN] Base64-decoded response: type=<class 'bytes'>, len=66, preview=b'o\xb6\xc4\xcef\xc0K\xf9\x10\xb8\xbc\xd4v\x1c\x00\xd0tcZ\x07\x0c\x98\xf8\xcb\x9c\n\x0cx\xcb?\xaa\x0b\x17g\xdet\x86\xcfl\xac\xbcNw\xe1w\xcc\xf2\x8c\xa8\r\xb4<\x05\x83\xc9\xc3A\xca\xed\xe2'
[Relay 2] [Relay] [RETURN] AES-decrypted response: type=<class 'bytes'>, len=50, preview=b'\xc5Z;ra\xfa~\xfd\x00Vfn"\xf3/Y~;\xb2\xab\x12\xdc}\xca_Yp\xc4\x8bZ\xe1$\t\xd5\x99\x7f\xcf\x19\x8a\xe1\xc5\xd7\xdaodc*)[\x06'
[Relay 2] [Relay] [RETURN] AES-decrypted response not UTF-8: 'utf-8' codec can't decode byte 0xc5 in position 0: invalid continuation byte
[Relay 2] [Relay] [RETURN] AES-encrypted response (hex): fcde5474882e06297c84c4f68f9e42a0b0e03558e40e9a664698f978ed7721cc8c9d1869676a711ba9596df86ae90a2b9095b3a17e85990eb8607590
[Relay 2] [Relay] [RETURN] Base64-encoded AES-encrypted response: type=<class 'bytes'>, len=112, preview=b'/N5UdIguBil8hMT2j55CoLDgNVjkDppmRpj5eO13IcyMnRhpZ2pxG6lZbfhq'
[Relay 3] [Relay] [DEBUG] Received response from next relay: type=<class 'bytes'>, len=112, preview=b'/N5UdIguBil8hMT2j55CoLDgNVjkDppmRpj5eO13IcyMnRhpZ2pxG6lZbfhq'
[Relay 2] [Relay] [handle_message END] addr=('10.250.120.196', 59920), thread=6157463552
[Relay 3] [Relay] [RETURN] Base64-decoded response: type=<class 'bytes'>, len=82, preview=b'\xfc\xdeTt\x88.\x06)|\x84\xc4\xf6\x8f\x9eB\xa0\xb0\xe05X\xe4\x0e\x9afF\x98\xf9x\xedw!\xcc\x8c\x9d\x18igjq\x1b\xa9Ym\xf8j\xe9\n+\x90\x95\xb3\xa1~\x85\x99\x0e\xb8`u\x90'
[Relay 3] [Relay] [RETURN] AES-decrypted response: type=<class 'bytes'>, len=66, preview=b'D\xf3o\x0b58\xc7$u\xf7x!o\xa0\xa5\xa4(z\xdb\x16w\xb9\xdf\x01\xb8\xb1\x8fQR\xbc\xa24\x83\xeb\xdd\xc1#4s6)2\xcb\xe1\xe5*_6\xf5\xc9\xe4\xf4\x7f\xa0\x98\x9c9\xa6FS'
[Relay 3] [Relay] [RETURN] AES-decrypted response not UTF-8: 'utf-8' codec can't decode byte 0xf3 in position 1: invalid continuation byte
[Relay 3] [Relay] [RETURN] AES-encrypted response (hex): cdc705870a040b9413d6071716fc30834f5c797486f27b5364f5a5b2062624e02e971532b42ed83dc2884672b7a642484a7bc09fb1ab432b67b57e0f
[Relay 3] [Relay] [RETURN] Base64-encoded AES-encrypted response: type=<class 'bytes'>, len=132, preview=b'zccFhwoEC5QT1gcXFvwwg09ceXSG8ntTZPWlsgYmJOAulxUytC7YPcKIRnK3'
[Relay] ---- Relay process started ----
[Relay 1] [Relay] Loaded persistent RSA keypair from relay1_key.pem
[Relay 1] [Relay] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] [KEY] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] Relay 1 starting on 10.250.120.196:9101 (RELAY PORT 9101)
[Relay 1] Registering with CDS at 127.0.0.1:9000
[Relay 1] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9101, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5MM7/HBECV26fZqjUJkt\nQ4+dx297cL0hf1+rf08Qir5tL/lArfQsiplTqcsIsZiN7vJ8K2XzvK5JAEv8tVE4\nEKU4W1hbEVBd1eLCX+Oc5XauTbWhW8xlc2wdNlNwDhin2Mw84doKJWPyfjtIwnIi\n3nWHqxLyAqkj6qDoByA8D7YVmJxvzwL0mrYE8G8b4Q4Wjnx2SXeTwc9LRzqwrsyb\nlM5B4BSVPBignOMhD2AfuIFw6uULQThbkL9L5AnQA08B4Gqzo731LLJN/Y6qo+VJ\nki2t6m1aJTG0LBjijpH7CtnN1MHIQ5UueS1sJVYZooYxkxEYYZTqIUXxuI5ICKPC\nCQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 1] [Relay] Listening for incoming messages on port 9101 (RELAY PORT 9101)
[Relay] ---- Relay process started ----
[Relay 2] [Relay] Loaded persistent RSA keypair from relay2_key.pem
[Relay 2] [Relay] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] [KEY] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] Relay 2 starting on 10.250.120.196:9102 (RELAY PORT 9102)
[Relay 2] Registering with CDS at 127.0.0.1:9000
[Relay 2] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9102, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA58J3pSrOQd4hYnuzQQ7q\nWrjjo+3BJp+ik23brR2yl0kjtfH+wjD9LYWHS7dBxsDRzSozJ/7EWKKNCaTsgvaF\nN6vpyBPqDM/uQfOWfirteL50RgDZw95Vml4Fuay7bTBEb1J8ydvFqawo8rnLE2I3\nU4BjBT+CD38bY3je8wrrCX9fo1uYaLDlfteGshadZ2gnTxrAzkZZ/CTFdyb8JrmN\nIuxjBVjwSA/uIv+KHWQhXRA5jJPXcNV88LYXyEzpid1Cr9gnrqA88K0HSleiwZjU\nJF3LhBvS2Ga2HHfFsk5D/yz/pTHwDvRA98VMT/90wahwmSJsck4XWDFhmNhy3oDR\nBQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 2] [Relay] Listening for incoming messages on port 9102 (RELAY PORT 9102)
[Relay] ---- Relay process started ----
[Relay 3] [Relay] Loaded persistent RSA keypair from relay3_key.pem
[Relay 3] [Relay] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] [Relay] [KEY] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] Relay 3 starting on 10.250.120.196:9103 (RELAY PORT 9103)
[Relay 3] Registering with CDS at 127.0.0.1:9000
[Relay 3] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9103, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5k9OJ8m3IdjmwR1skM1G\nwrKkwlYLK0Qs+I/BX5ww5wEakOsTy5NVFAwTYrCUnR012u2jCwI8wV1YpPaMa8RJ\ntnqNFy4pFfqBh5tmidHQ3QMRvINPrGtQM5+VgMXoA0y8izql52M1K/3Q6sHVlAXd\nmpQcBO+JSHY7uyVx1txZssyisia7Nn8Frh/XRpl0oUvGkSnbm/KgqDAP0xJ3lUZS\nEGiIWdf0bn7tHD3nYBMrWWi3jSQWf0Q80asIEYWipwkfMPf0ffzu4FX0elfvpyOX\nr50xk7sb8K5IhcilwxKxQpPOcq3f6ph0EERQR7pOdDqkzFdHoGiyssSX4MYM60kd\nmQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 3] [Relay] Listening for incoming messages on port 9103 (RELAY PORT 9103)
[Relay 1] [Relay] [handle_message ENTERED] addr=('10.250.120.196', 60517), thread=6197686272, relay_port=9101
[Relay 1] [Relay] [DEBUG] Raw data received: b'{"next_ip": "10.250.120.196", "next_port": 9101, "session_key": "ssbKqdkxpZ/0oXnfPc9my7OvPB4QFNf+kAKaySdStcFEcj5UDdRlV4YASzu60ObolQFnQKcJRp+qHAypekY8Zg9O0VpL4HbkQD4cisJithm+0XSXt0xeEju2+LUrmF4t4g7hlc5CSgK9yql4QFfmeJRRkdZZvaWhs2SdH0JZsNKKVHjXgTeFhp4KV+qL8G6EQtiWZ6Vsz+a5q6V3DjvxpCN8MqYgXyCaFC1o3FdCABvYSFehi4GWonLgom7+K5WKSgKui/Yyhel72+mjy8MNYzFVvjdmEw5K6f8Fg7c7yluXRFE7IzYowh3q7GqDobFsGNAHEDSFKLHlIk42msvjvA==", "payload": "WwiM0oOWs5jzIzH7DI4OOGKuRklFdPXiC27mbROa/BnSjP5mlCy0BJnYipbL1vzK+P8JJ/nK5eLKMsrBQIf7cj+TUFyGv8SlF5anVnPlAOmbXcm6Kamm6gUq90Ll+3fKSwOnRkDmzgx0iea9Zj2Id8ZFttzn/r3FPahO/1umeM/R4/L5ZiM9Hb4MotAkm5Aj0ALItIxPZIvZDp4UM+A1XuNUBHVwSOoXXq4f82fd+a1W6naPtPGGP5fZAawqvZdKJiB1qUVPcgimiTd0zkwQF36542YI+VTazzCDCftJ/rAJ7fFxqnMuKf+FysHeRDL5lZnPv2uNSdBY8k7B6i5wbqwX6zI3hgfFP8IG4oPMWwzY+5s2pI25k8DMJZH1FqtzAyTChdBq4J+UCR6EhwfdBE/3C1xucscA5VmPogm15TKzZ20sTMYz8SV+rikUyErAgBc1IS+cyR57zOmMXbsCHbxlNHjymCp00z+h7m9oc8N+nwbGK5XTEuXYceSJrmvbMBffIuVg48jMDrL+UnfGCGqXtYDuzwM0WN/BPo6/aBmQsnazyoDNhd1rEw7CJD0n1FoBQXAsfftMTR9ovTmuAyYHj5P1PrSKHptiirSiElGO6zu0qKZLR62VuQ+LfCyxRt42Z30YSHLbQMle2GGOxna14ACtkJ5D9EMOOXKuZSRwfosAOmG7rIaSKtU4Q7sbgeaRjNhMyTtJWE8FGvX/lF1+kvLllz2uKHAVKm1xql9wcYDIRO1jGzeQaeLYXHP7W6LYeCu2aSOs/yLmNPk3jFvjtl/aZAqkYTT6nY2p21kg2fUMdNQhZaYe7peFLuUS2EFmY4b4URuVNKDDqqAFunnfYfNdc6lfAMXXvwlOh/jMbTLIAjkMifQyi4mjzl8pO1t7I+IbTEasVhyVl4G/YXQCYe5qk/OCJvdaqwphLMUTOYWaHG7BcPPVXLkQFrYmxfNZ6VpXkTX/IvpGyoXvLmTfunGz2Scg7ZIUJLp4GQB0aIGPCX0aTg0PhjWScDniQlKqKfIBj5N8xI6kjk//DeTFMtf6eAHrt6BSn98wWuzSdZPEPfC8kW67ac6xl6qGDM5LLj+W21resViewtZviSb61qDEMMjHEI1goT+Xwy1h/7K/6S29XTV4+kicUQeenMujlLez40W7lrtbTEIPFFnjVDx8cUPAD6QUPSwCzUQBQTyiQgoO3q/Lwhi1gXejeDSaOFkIKEtrrLTaH9jYlXmUM/JJlQ3b2QZ7MZ5mH6NdPc5jeMOaZZCW5L3rRUTC+PxaV8noZksS5lwiO4ZEdS6UixRDTnKV8jzZs0u1jcY37+TNRy+IyIJqh9j2y0E2ELB7rqxBajN87SV0dRjf6uqaQ8WIMa771DVK7Qi1XaToz0CHgqP9VBbrjlCXknV+tlk/XPCY6CTAvoF75hqO3QFkzDArhSkBRSTWlf1MU0FVJ62wAFmgzifRPxY5PwLyTrM="}'
[Relay 1] [Relay] [DEBUG] Data after JSON parse: type=<class 'dict'>, keys=['next_ip', 'next_port', 'session_key', 'payload']
[Relay 1] [Relay] Received session_key (base64): ssbKqdkxpZ/0oXnfPc9my7OvPB4QFNf+kAKaySdStcFEcj5UDdRlV4YASzu60ObolQFnQKcJRp+qHAypekY8Zg9O0VpL4HbkQD4cisJithm+0XSXt0xeEju2+LUrmF4t4g7hlc5CSgK9yql4QFfmeJRRkdZZvaWhs2SdH0JZsNKKVHjXgTeFhp4KV+qL8G6EQtiWZ6Vsz+a5q6V3DjvxpCN8MqYgXyCaFC1o3FdCABvYSFehi4GWonLgom7+K5WKSgKui/Yyhel72+mjy8MNYzFVvjdmEw5K6f8Fg7c7yluXRFE7IzYowh3q7GqDobFsGNAHEDSFKLHlIk42msvjvA==
[Relay 1] [Relay] Decoded session_key_enc (hex): b2c6caa9d931a59ff4a179df3dcf66cbb3af3c1e1014d7fe90029ac92752b5c144723e540dd4655786004b3bbad0e6e895016740a709469faa1c0ca97a463c660f4ed15a4be076e4403e1c8ac262b619bed17497b74c5e123bb6f8b52b985e2de20ee195ce424a02bdcaa9784057e678945191d659bda5a1b3649d1f4259b0d28a5478d7813785869e0a57ea8bf06e8442d89667a56ccfe6b9aba5770e3bf1a4237c32a6205f209a142d68dc5742001bd84857a18b8196a272e0a26efe2b958a4a02ae8bf63285e97bdbe9a3cbc30d633155be3766130e4ae9ff0583b73bca5b9744513b233628c21deaec6a83a1b16c18d00710348528b1e5224e369acbe3bc
[Relay 1] [Relay] Decrypting session key with fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] Decrypted session_key (hex): 10c1d262a579d395ef9cb02197bf241e89ad4fdc810c006c7fb6ccc649ef0bc1
[Relay 1] [Relay] [DEBUG] About to AES-decrypt payload (passing base64 string directly)
[Relay 1] [Relay] [DEBUG] Payload base64-decoded: type=<class 'bytes'>, len=1106, preview=b"[\x08\x8c\xd2\x83\x96\xb3\x98\xf3#1\xfb\x0c\x8e\x0e8b\xaeFIEt\xf5\xe2\x0bn\xe6m\x13\x9a\xfc\x19\xd2\x8c\xfef\x94,\xb4\x04\x99\xd8\x8a\x96\xcb\xd6\xfc\xca\xf8\xff\t'\xf9\xca\xe5\xe2\xca2\xca\xc1"
[Relay 1] [Relay] [DEBUG] AES-decrypted payload: type=<class 'bytes'>, len=1090, preview=b'{"next_ip": "10.250.120.196", "next_port": 9102, "session_ke'
[Relay 1] [Relay] [DEBUG] AES-decrypted payload (hex): 7b226e6578745f6970223a202231302e3235302e3132302e313936222c20226e6578745f706f7274223a20393130322c202273657373696f6e5f6b65
[Relay 1] [Relay] [DEBUG] Next hop JSON keys: ['next_ip', 'next_port', 'session_key', 'payload']
[Relay 1] [Relay] [DEBUG] Forwarding to next relay 10.250.120.196:9102
[Relay 2] [Relay] [handle_message ENTERED] addr=('10.250.120.196', 60526), thread=6132690944, relay_port=9102
[Relay 2] [Relay] [DEBUG] Raw data received: b'{"next_ip": "10.250.120.196", "next_port": 9102, "session_key": "cP+QCevhs41QBL+dbmZAxsDX1T4oIP/gZp4l+8qrrfECkVrhV4PGKhPAmh0b/CeIEYxYp0Y0rjhbDySJSCN4ZL/DOpzzU6HynPqsEmrkBixRVWHrKAScFXidZ+tLIGriYPrgs9H717w5btpqp+BKwBbXaSm/77bvns1yfoq8Fe7+D4abuqn/crcqYK0LUqhfr4bq25J4WSYUEPXEfjWE5QqhQTJIJwGqZ4MO8nCPc1MVBg5cinuY84n6bvqFfeMXduFYMFS0NqX6iDtZCZmUIeNrQWDFRv1DP0Ih5ra7wtUP9G6r4e1IWIPyZrpcBWINMzFkpfMAGtLUC6YsX5YWFQ==", "payload": "IYgViqbfcHTc2QLQkuNIhE/P7AH4WiswkjV/1B3/FzZKAV7zxtRWJmCCU0j8T5wgPVI6dKn4JHE0/yzKhef/9nrrUJJpO3MPCwcVfs2jSlaW5ilRo0IAJU7xsgMHUL81bddyEYUixsRwx/R2deWXSgBe77P2bYbM/utUx660ggI7qVO1KhH3kIzq+j4Iy/yP3A/x+h3pA0Cv85zWFQl/TMEkk25pkBGiCn0Y3lDvWG5EoCK4+HMj1Dgzr7IUo0WHEX14T6SiRKscxUDgRrgsk6Mln7tcG/5OpUo9R5C8h/Sd2DxWrnrJUJkEDE21U6BowYttKah5FYUi0Ri/5z9M3KNZkhmIFrpdgx1kmUGerlwkHUxxplbpMBoAlxQU9KjaELJHpRFnuIza8uahP50o9nf20SajRZwcAlHYlHe3bDxpKVrQ5zN9a2lC9zDOpXWjEb22n5wfsPmY75iEugC7nIaGLoYeaP1nbptc+ChR7eFB5xdgpVk4BwxZ5h47m9EKRmKhxhlvEdkm8wjqP1jkWdZ0lw/KEPS+U26SN5Vfk94k4d7CSM7vB9jDeJqnxOg+E43pTKP99VV3eQlUSQV39axJB/uInht2c+V7+nqp/PbfLaD01KY61WB8i4CoswFetsQsu3fEFuIq7ENjplHtY+kC"}'
[Relay 2] [Relay] [DEBUG] Data after JSON parse: type=<class 'dict'>, keys=['next_ip', 'next_port', 'session_key', 'payload']
[Relay 2] [Relay] Received session_key (base64): cP+QCevhs41QBL+dbmZAxsDX1T4oIP/gZp4l+8qrrfECkVrhV4PGKhPAmh0b/CeIEYxYp0Y0rjhbDySJSCN4ZL/DOpzzU6HynPqsEmrkBixRVWHrKAScFXidZ+tLIGriYPrgs9H717w5btpqp+BKwBbXaSm/77bvns1yfoq8Fe7+D4abuqn/crcqYK0LUqhfr4bq25J4WSYUEPXEfjWE5QqhQTJIJwGqZ4MO8nCPc1MVBg5cinuY84n6bvqFfeMXduFYMFS0NqX6iDtZCZmUIeNrQWDFRv1DP0Ih5ra7wtUP9G6r4e1IWIPyZrpcBWINMzFkpfMAGtLUC6YsX5YWFQ==
[Relay 2] [Relay] Decoded session_key_enc (hex): 70ff9009ebe1b38d5004bf9d6e6640c6c0d7d53e2820ffe0669e25fbcaabadf102915ae15783c62a13c09a1d1bfc2788118c58a74634ae385b0f248948237864bfc33a9cf353a1f29cfaac126ae4062c515561eb28049c15789d67eb4b206ae260fae0b3d1fbd7bc396eda6aa7e04ac016d76929bfefb6ef9ecd727e8abc15eefe0f869bbaa9ff72b72a60ad0b52a85faf86eadb927859261410f5c47e3584e50aa14132482701aa67830ef2708f735315060e5c8a7b98f389fa6efa857de31776e1583054b436a5fa883b5909999421e36b4160c546fd433f4221e6b6bbc2d50ff46eabe1ed485883f266ba5c05620d333164a5f3001ad2d40ba62c5f961615
[Relay 2] [Relay] Decrypting session key with fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] Decrypted session_key (hex): 33c929f4483ac6b52aed26b2b77efdbbb3046d7662ba6ba6d8426c656671f713
[Relay 2] [Relay] [DEBUG] About to AES-decrypt payload (passing base64 string directly)
[Relay 2] [Relay] [DEBUG] Payload base64-decoded: type=<class 'bytes'>, len=498, preview=b'!\x88\x15\x8a\xa6\xdfpt\xdc\xd9\x02\xd0\x92\xe3H\x84O\xcf\xec\x01\xf8Z+0\x925\x7f\xd4\x1d\xff\x176J\x01^\xf3\xc6\xd4V&`\x82SH\xfcO\x9c =R:t\xa9\xf8$q4\xff,\xca'
[Relay 2] [Relay] [DEBUG] AES-decrypted payload: type=<class 'bytes'>, len=482, preview=b'{"next_ip": "10.250.120.196", "next_port": 9103, "session_ke'
[Relay 2] [Relay] [DEBUG] AES-decrypted payload (hex): 7b226e6578745f6970223a202231302e3235302e3132302e313936222c20226e6578745f706f7274223a20393130332c202273657373696f6e5f6b65
[Relay 2] [Relay] [DEBUG] Next hop JSON keys: ['next_ip', 'next_port', 'session_key', 'payload']
[Relay 2] [Relay] [DEBUG] Forwarding to next relay 10.250.120.196:9103
[Relay 3] [Relay] [handle_message ENTERED] addr=('10.250.120.196', 60529), thread=6156529664, relay_port=9103
[Relay 3] [Relay] [DEBUG] Raw data received: b'{"next_ip": "10.250.120.196", "next_port": 9103, "session_key": "XFTic0/n0Y6aLSXl5LZO92eNSW+EjlwsDIYsaWr+2s/NVMM7fuXLndpetTzxFepobApIC/LEA40KBuNsL+JHoO1S8uF1h7qAVntAInGkbQPhGVItkjIscpVYiZ+8c+khEBGAcNjL0aUkGtT/ftTHkssOTthXKRi2h8MkfWKJskt2Wos2JKndPN3L42KxiKbNjJHG8KcgMeboUsD41Eby4ziMN8pzt287EfOY+L/hY5+tc1f5sDpfmwlxfnSHBhf/eqsuLjl1XxUiihQg9AcS2+aMqnnxK2rWTx382+WVPsSzLBI+FyjOUhj3BRlWPfSdRILdhT8gahxa7JeVLneS4Q==", "payload": "0PzJ9CmkDE1T5H7QpVppgS+mKPXVI+2K2wG5GddUYvn1Q1pyW0XqGQ=="}'
[Relay 3] [Relay] [DEBUG] Data after JSON parse: type=<class 'dict'>, keys=['next_ip', 'next_port', 'session_key', 'payload']
[Relay 3] [Relay] Received session_key (base64): XFTic0/n0Y6aLSXl5LZO92eNSW+EjlwsDIYsaWr+2s/NVMM7fuXLndpetTzxFepobApIC/LEA40KBuNsL+JHoO1S8uF1h7qAVntAInGkbQPhGVItkjIscpVYiZ+8c+khEBGAcNjL0aUkGtT/ftTHkssOTthXKRi2h8MkfWKJskt2Wos2JKndPN3L42KxiKbNjJHG8KcgMeboUsD41Eby4ziMN8pzt287EfOY+L/hY5+tc1f5sDpfmwlxfnSHBhf/eqsuLjl1XxUiihQg9AcS2+aMqnnxK2rWTx382+WVPsSzLBI+FyjOUhj3BRlWPfSdRILdhT8gahxa7JeVLneS4Q==
[Relay 3] [Relay] Decoded session_key_enc (hex): 5c54e2734fe7d18e9a2d25e5e4b64ef7678d496f848e5c2c0c862c696afedacfcd54c33b7ee5cb9dda5eb53cf115ea686c0a480bf2c4038d0a06e36c2fe247a0ed52f2e17587ba80567b402271a46d03e119522d92322c729558899fbc73e92110118070d8cbd1a5241ad4ff7ed4c792cb0e4ed8572918b687c3247d6289b24b765a8b3624a9dd3cddcbe362b188a6cd8c91c6f0a72031e6e852c0f8d446f2e3388c37ca73b76f3b11f398f8bfe1639fad7357f9b03a5f9b09717e74870617ff7aab2e2e39755f15228a1420f40712dbe68caa79f12b6ad64f1dfcdbe5953ec4b32c123e1728ce5218f70519563df49d4482dd853f206a1c5aec97952e7792e1
[Relay 3] [Relay] Decrypting session key with fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] [Relay] Decrypted session_key (hex): 959d6672cb586aa26cdc6b2bd3eafbc2e7fab13b3211495d9988b555e6189774
[Relay 3] [Relay] [DEBUG] About to AES-decrypt payload (passing base64 string directly)
[Relay 3] [Relay] [DEBUG] Payload base64-decoded: type=<class 'bytes'>, len=40, preview=b'\xd0\xfc\xc9\xf4)\xa4\x0cMS\xe4~\xd0\xa5Zi\x81/\xa6(\xf5\xd5#\xed\x8a\xdb\x01\xb9\x19\xd7Tb\xf9\xf5CZr[E\xea\x19'
[Relay 3] [Relay] [DEBUG] AES-decrypted payload: type=<class 'bytes'>, len=24, preview=b'{"msg": "Hello, world!"}'
[Relay 3] [Relay] [DEBUG] AES-decrypted payload (hex): 7b226d7367223a202248656c6c6f2c20776f726c6421227d
[Relay 3] [Relay] [DEBUG] Next hop JSON keys: ['msg']
[Relay 3] [Relay] [DEBUG] Payload is not JSON, assuming last hop. Error: 'next_ip'
[Relay 3] [Relay] [Last Hop] Forwarding payload to dest 127.0.0.1:9100, len=24, type=<class 'bytes'>
[Relay 3] [Relay] [Last Hop] Sending to dest: type=<class 'bytes'>, len=24, preview=b'{"msg": "Hello, world!"}'
[Relay 3] [Relay] [Last Hop] Received response from dest: type=<class 'bytes'>, len=50, preview=b'{"result": "OK", "echo": {"msg": "Hello, world!"}}'
[Relay 3] [Relay] [Last Hop] Response from dest decoded as UTF-8: '{"result": "OK", "echo": {"msg": "Hello, world!"}}'
[Relay 3] [Relay] [Last Hop] Response from dest (hex): 7b22726573756c74223a20224f4b222c20226563686f223a207b226d7367223a202248656c6c6f2c20776f726c6421227d7d
[Relay 3] [Relay] [Last Hop] About to AES-encrypt response: type=<class 'bytes'>, len=50, preview=b'{"result": "OK", "echo": {"msg": "Hello, world!"}}'
[Relay 3] [Relay] [Last Hop] AES-encrypted response (hex): 976f4e4c1b17e7703367ef8fdf921bebceaa01ed10cb414838d578e2c9be30cd5dede5441a342be49830c2b60d4bca0bae518b83bb2684740e36a093
[Relay 3] [Relay] [Last Hop] Base64-encoded AES-encrypted response: type=<class 'bytes'>, len=88, preview=b'l29OTBsX53AzZ++P35Ib686qAe0Qy0FIONV44sm+MM1d7eVEGjQr5JgwwrYN'
[Relay 3] [Relay] [Last Hop] Sent response to ('10.250.120.196', 60529): b'l29OTBsX53AzZ++P35Ib686qAe0Qy0FIONV44sm+MM1d7eVEGjQr5JgwwrYN'... (len=88)
[Relay 2] [Relay] [DEBUG] Received response from next relay: type=<class 'bytes'>, len=88, preview=b'l29OTBsX53AzZ++P35Ib686qAe0Qy0FIONV44sm+MM1d7eVEGjQr5JgwwrYN'
[Relay 3] [Relay] [handle_message END] addr=('10.250.120.196', 60529), thread=6156529664
[Relay 2] [Relay] [RETURN] Base64-decoded response: type=<class 'bytes'>, len=66, preview=b'\x97oNL\x1b\x17\xe7p3g\xef\x8f\xdf\x92\x1b\xeb\xce\xaa\x01\xed\x10\xcbAH8\xd5x\xe2\xc9\xbe0\xcd]\xed\xe5D\x1a4+\xe4\x980\xc2\xb6\rK\xca\x0b\xaeQ\x8b\x83\xbb&\x84t\x0e6\xa0\x93'
[Relay 2] [Relay] [RETURN] AES-decrypted response: type=<class 'bytes'>, len=50, preview=b"\x94`U\xf7\xf5\xc6\x01\xd8\xb5\xff\xe9\x0e\x13$\xdby\x08s\x95'\x1a\xb2\x98H\xc9\x83-\xd3\xeaS\xd0\x16\xc6\xd6\xe6\xb8\xa9\xfd>67\xf0 \xec\t\x85\xf3:\xec\x1a"
[Relay 2] [Relay] [RETURN] AES-decrypted response not UTF-8: 'utf-8' codec can't decode byte 0x94 in position 0: invalid start byte
[Relay 2] [Relay] [RETURN] AES-encrypted response (hex): 263d9384811d0cc2448a775ed783a557a5da84fcf8db733c0ca9cc87288311ae02d1bc051770ac2dc6eaa5ced088f1f91ef29838f247c4aac465de7e
[Relay 2] [Relay] [RETURN] Base64-encoded AES-encrypted response: type=<class 'bytes'>, len=112, preview=b'Jj2ThIEdDMJEinde14OlV6XahPz423M8DKnMhyiDEa4C0bwFF3CsLcbqpc7Q'
[Relay 1] [Relay] [DEBUG] Received response from next relay: type=<class 'bytes'>, len=112, preview=b'Jj2ThIEdDMJEinde14OlV6XahPz423M8DKnMhyiDEa4C0bwFF3CsLcbqpc7Q'
[Relay 2] [Relay] [handle_message END] addr=('10.250.120.196', 60526), thread=6132690944
[Relay 1] [Relay] [RETURN] Base64-decoded response: type=<class 'bytes'>, len=82, preview=b'&=\x93\x84\x81\x1d\x0c\xc2D\x8aw^\xd7\x83\xa5W\xa5\xda\x84\xfc\xf8\xdbs<\x0c\xa9\xcc\x87(\x83\x11\xae\x02\xd1\xbc\x05\x17p\xac-\xc6\xea\xa5\xce\xd0\x88\xf1\xf9\x1e\xf2\x988\xf2G\xc4\xaa\xc4e\xde~'
[Relay 1] [Relay] [RETURN] AES-decrypted response: type=<class 'bytes'>, len=66, preview=b'\xa6\xce\xbd\x82:\x1a\xe1\x0f\x07\x88f\xc2\x8e\xea\xd4\xe2\x99Y\xb0\xed\x9b\x91\xf0C\xc8\xdd\x8c\xd7\xc6bF\xe9t\x8d=\xe2M\xbf\n\xc6\xe02X\xd8\xdcP9\x03pA\x1di\tU\xba\xf3\nM\x0c%'
[Relay 1] [Relay] [RETURN] AES-decrypted response not UTF-8: 'utf-8' codec can't decode byte 0xa6 in position 0: invalid start byte
[Relay 1] [Relay] [RETURN] AES-encrypted response (hex): b0ed11a3278865f0c1e296b16d9042c8814d412977e3166ae912c385bffc0e395b5cc0ef5b9a851c565d6119bc6bf594a133f127f05c81883ee6823a
[Relay 1] [Relay] [RETURN] Base64-encoded AES-encrypted response: type=<class 'bytes'>, len=132, preview=b'sO0RoyeIZfDB4paxbZBCyIFNQSl34xZq6RLDhb/8DjlbXMDvW5qFHFZdYRm8'
[Relay] ---- Relay process started ----
[Relay 1] [Relay] Loaded persistent RSA keypair from relay1_key.pem
[Relay 1] [Relay] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] [KEY] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] Relay 1 starting on 10.250.120.196:9101 (RELAY PORT 9101)
[Relay 1] Registering with CDS at 127.0.0.1:9000
[Relay 1] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9101, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5MM7/HBECV26fZqjUJkt\nQ4+dx297cL0hf1+rf08Qir5tL/lArfQsiplTqcsIsZiN7vJ8K2XzvK5JAEv8tVE4\nEKU4W1hbEVBd1eLCX+Oc5XauTbWhW8xlc2wdNlNwDhin2Mw84doKJWPyfjtIwnIi\n3nWHqxLyAqkj6qDoByA8D7YVmJxvzwL0mrYE8G8b4Q4Wjnx2SXeTwc9LRzqwrsyb\nlM5B4BSVPBignOMhD2AfuIFw6uULQThbkL9L5AnQA08B4Gqzo731LLJN/Y6qo+VJ\nki2t6m1aJTG0LBjijpH7CtnN1MHIQ5UueS1sJVYZooYxkxEYYZTqIUXxuI5ICKPC\nCQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 1] [Relay] Listening for incoming messages on port 9101 (RELAY PORT 9101)
[Relay] ---- Relay process started ----
[Relay 2] [Relay] Loaded persistent RSA keypair from relay2_key.pem
[Relay 2] [Relay] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] [KEY] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] Relay 2 starting on 10.250.120.196:9102 (RELAY PORT 9102)
[Relay 2] Registering with CDS at 127.0.0.1:9000
[Relay 2] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9102, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA58J3pSrOQd4hYnuzQQ7q\nWrjjo+3BJp+ik23brR2yl0kjtfH+wjD9LYWHS7dBxsDRzSozJ/7EWKKNCaTsgvaF\nN6vpyBPqDM/uQfOWfirteL50RgDZw95Vml4Fuay7bTBEb1J8ydvFqawo8rnLE2I3\nU4BjBT+CD38bY3je8wrrCX9fo1uYaLDlfteGshadZ2gnTxrAzkZZ/CTFdyb8JrmN\nIuxjBVjwSA/uIv+KHWQhXRA5jJPXcNV88LYXyEzpid1Cr9gnrqA88K0HSleiwZjU\nJF3LhBvS2Ga2HHfFsk5D/yz/pTHwDvRA98VMT/90wahwmSJsck4XWDFhmNhy3oDR\nBQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 2] [Relay] Listening for incoming messages on port 9102 (RELAY PORT 9102)
[Relay] ---- Relay process started ----
[Relay 3] [Relay] Loaded persistent RSA keypair from relay3_key.pem
[Relay 3] [Relay] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] [Relay] [KEY] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] Relay 3 starting on 10.250.120.196:9103 (RELAY PORT 9103)
[Relay 3] Registering with CDS at 127.0.0.1:9000
[Relay 3] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9103, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5k9OJ8m3IdjmwR1skM1G\nwrKkwlYLK0Qs+I/BX5ww5wEakOsTy5NVFAwTYrCUnR012u2jCwI8wV1YpPaMa8RJ\ntnqNFy4pFfqBh5tmidHQ3QMRvINPrGtQM5+VgMXoA0y8izql52M1K/3Q6sHVlAXd\nmpQcBO+JSHY7uyVx1txZssyisia7Nn8Frh/XRpl0oUvGkSnbm/KgqDAP0xJ3lUZS\nEGiIWdf0bn7tHD3nYBMrWWi3jSQWf0Q80asIEYWipwkfMPf0ffzu4FX0elfvpyOX\nr50xk7sb8K5IhcilwxKxQpPOcq3f6ph0EERQR7pOdDqkzFdHoGiyssSX4MYM60kd\nmQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 3] [Relay] Listening for incoming messages on port 9103 (RELAY PORT 9103)
[Relay 3] [handle_message START] addr=('10.250.120.196', 63152), thread=6127775744
[Relay 3] [handle_message] Received data: len=1902 from ('10.250.120.196', 63152)
[Relay 3] [handle_message] ERROR parsing outer JSON or decrypting: 'utf-8' codec can't decode byte 0x9d in position 0: invalid start byte
Traceback (most recent call last):
  File "/Users/mohamedzidancassim/Desktop/Junior Year/CS262/Final Project/fp-tor-replica/relay.py", line 141, in handle_message
    self.log(f"[Relay] [DEBUG] Next hop JSON keys: {list(next_msg.keys())}")
              ^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x9d in position 0: invalid start byte

[Relay 3] [handle_message END] addr=('10.250.120.196', 63152), thread=6127775744
[Relay] ---- Relay process started ----
[Relay 1] [Relay] Loaded persistent RSA keypair from relay1_key.pem
[Relay 1] [Relay] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] [KEY] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] Relay 1 starting on 10.250.120.196:9101 (RELAY PORT 9101)
[Relay 1] Registering with CDS at 127.0.0.1:9000
[Relay 1] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9101, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5MM7/HBECV26fZqjUJkt\nQ4+dx297cL0hf1+rf08Qir5tL/lArfQsiplTqcsIsZiN7vJ8K2XzvK5JAEv8tVE4\nEKU4W1hbEVBd1eLCX+Oc5XauTbWhW8xlc2wdNlNwDhin2Mw84doKJWPyfjtIwnIi\n3nWHqxLyAqkj6qDoByA8D7YVmJxvzwL0mrYE8G8b4Q4Wjnx2SXeTwc9LRzqwrsyb\nlM5B4BSVPBignOMhD2AfuIFw6uULQThbkL9L5AnQA08B4Gqzo731LLJN/Y6qo+VJ\nki2t6m1aJTG0LBjijpH7CtnN1MHIQ5UueS1sJVYZooYxkxEYYZTqIUXxuI5ICKPC\nCQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 1] [Relay] Listening for incoming messages on port 9101 (RELAY PORT 9101)
[Relay] ---- Relay process started ----
[Relay 2] [Relay] Loaded persistent RSA keypair from relay2_key.pem
[Relay 2] [Relay] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] [KEY] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] Relay 2 starting on 10.250.120.196:9102 (RELAY PORT 9102)
[Relay 2] Registering with CDS at 127.0.0.1:9000
[Relay 2] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9102, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA58J3pSrOQd4hYnuzQQ7q\nWrjjo+3BJp+ik23brR2yl0kjtfH+wjD9LYWHS7dBxsDRzSozJ/7EWKKNCaTsgvaF\nN6vpyBPqDM/uQfOWfirteL50RgDZw95Vml4Fuay7bTBEb1J8ydvFqawo8rnLE2I3\nU4BjBT+CD38bY3je8wrrCX9fo1uYaLDlfteGshadZ2gnTxrAzkZZ/CTFdyb8JrmN\nIuxjBVjwSA/uIv+KHWQhXRA5jJPXcNV88LYXyEzpid1Cr9gnrqA88K0HSleiwZjU\nJF3LhBvS2Ga2HHfFsk5D/yz/pTHwDvRA98VMT/90wahwmSJsck4XWDFhmNhy3oDR\nBQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 2] [Relay] Listening for incoming messages on port 9102 (RELAY PORT 9102)
[Relay] ---- Relay process started ----
[Relay 3] [Relay] Loaded persistent RSA keypair from relay3_key.pem
[Relay 3] [Relay] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] [Relay] [KEY] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] Relay 3 starting on 10.250.120.196:9103 (RELAY PORT 9103)
[Relay 3] Registering with CDS at 127.0.0.1:9000
[Relay 3] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9103, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5k9OJ8m3IdjmwR1skM1G\nwrKkwlYLK0Qs+I/BX5ww5wEakOsTy5NVFAwTYrCUnR012u2jCwI8wV1YpPaMa8RJ\ntnqNFy4pFfqBh5tmidHQ3QMRvINPrGtQM5+VgMXoA0y8izql52M1K/3Q6sHVlAXd\nmpQcBO+JSHY7uyVx1txZssyisia7Nn8Frh/XRpl0oUvGkSnbm/KgqDAP0xJ3lUZS\nEGiIWdf0bn7tHD3nYBMrWWi3jSQWf0Q80asIEYWipwkfMPf0ffzu4FX0elfvpyOX\nr50xk7sb8K5IhcilwxKxQpPOcq3f6ph0EERQR7pOdDqkzFdHoGiyssSX4MYM60kd\nmQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 3] [Relay] Listening for incoming messages on port 9103 (RELAY PORT 9103)
[Relay 1] [handle_message START] addr=('10.250.120.196', 63289), thread=6136934400
[Relay 1] [handle_message] Received data: len=1902 from ('10.250.120.196', 63289)
[Relay 1] [handle_message] ERROR parsing outer JSON or decrypting: 'utf-8' codec can't decode byte 0x9d in position 0: invalid start byte
Traceback (most recent call last):
  File "/Users/mohamedzidancassim/Desktop/Junior Year/CS262/Final Project/fp-tor-replica/relay.py", line 141, in handle_message
    decrypted = aes_decrypt(session_key, payload_bytes)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x9d in position 0: invalid start byte

[Relay 1] [handle_message END] addr=('10.250.120.196', 63289), thread=6136934400
[Relay] ---- Relay process started ----
[Relay 1] [Relay] Loaded persistent RSA keypair from relay1_key.pem
[Relay 1] [Relay] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] [KEY] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] Relay 1 starting on 10.250.120.196:9101 (RELAY PORT 9101)
[Relay 1] Registering with CDS at 127.0.0.1:9000
[Relay 1] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9101, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5MM7/HBECV26fZqjUJkt\nQ4+dx297cL0hf1+rf08Qir5tL/lArfQsiplTqcsIsZiN7vJ8K2XzvK5JAEv8tVE4\nEKU4W1hbEVBd1eLCX+Oc5XauTbWhW8xlc2wdNlNwDhin2Mw84doKJWPyfjtIwnIi\n3nWHqxLyAqkj6qDoByA8D7YVmJxvzwL0mrYE8G8b4Q4Wjnx2SXeTwc9LRzqwrsyb\nlM5B4BSVPBignOMhD2AfuIFw6uULQThbkL9L5AnQA08B4Gqzo731LLJN/Y6qo+VJ\nki2t6m1aJTG0LBjijpH7CtnN1MHIQ5UueS1sJVYZooYxkxEYYZTqIUXxuI5ICKPC\nCQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 1] [Relay] Listening for incoming messages on port 9101 (RELAY PORT 9101)
[Relay] ---- Relay process started ----
[Relay 2] [Relay] Loaded persistent RSA keypair from relay2_key.pem
[Relay 2] [Relay] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] [KEY] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] Relay 2 starting on 10.250.120.196:9102 (RELAY PORT 9102)
[Relay 2] Registering with CDS at 127.0.0.1:9000
[Relay 2] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9102, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA58J3pSrOQd4hYnuzQQ7q\nWrjjo+3BJp+ik23brR2yl0kjtfH+wjD9LYWHS7dBxsDRzSozJ/7EWKKNCaTsgvaF\nN6vpyBPqDM/uQfOWfirteL50RgDZw95Vml4Fuay7bTBEb1J8ydvFqawo8rnLE2I3\nU4BjBT+CD38bY3je8wrrCX9fo1uYaLDlfteGshadZ2gnTxrAzkZZ/CTFdyb8JrmN\nIuxjBVjwSA/uIv+KHWQhXRA5jJPXcNV88LYXyEzpid1Cr9gnrqA88K0HSleiwZjU\nJF3LhBvS2Ga2HHfFsk5D/yz/pTHwDvRA98VMT/90wahwmSJsck4XWDFhmNhy3oDR\nBQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 2] [Relay] Listening for incoming messages on port 9102 (RELAY PORT 9102)
[Relay] ---- Relay process started ----
[Relay 3] [Relay] Loaded persistent RSA keypair from relay3_key.pem
[Relay 3] [Relay] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] [Relay] [KEY] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] Relay 3 starting on 10.250.120.196:9103 (RELAY PORT 9103)
[Relay 3] Registering with CDS at 127.0.0.1:9000
[Relay 3] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9103, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5k9OJ8m3IdjmwR1skM1G\nwrKkwlYLK0Qs+I/BX5ww5wEakOsTy5NVFAwTYrCUnR012u2jCwI8wV1YpPaMa8RJ\ntnqNFy4pFfqBh5tmidHQ3QMRvINPrGtQM5+VgMXoA0y8izql52M1K/3Q6sHVlAXd\nmpQcBO+JSHY7uyVx1txZssyisia7Nn8Frh/XRpl0oUvGkSnbm/KgqDAP0xJ3lUZS\nEGiIWdf0bn7tHD3nYBMrWWi3jSQWf0Q80asIEYWipwkfMPf0ffzu4FX0elfvpyOX\nr50xk7sb8K5IhcilwxKxQpPOcq3f6ph0EERQR7pOdDqkzFdHoGiyssSX4MYM60kd\nmQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 3] [Relay] Listening for incoming messages on port 9103 (RELAY PORT 9103)
[Relay 2] [handle_message START] addr=('10.250.120.196', 63574), thread=6196326400
[Relay 2] [handle_message] Received data: len=1902 from ('10.250.120.196', 63574)
[Relay 2] [handle_message] ERROR parsing outer JSON or decrypting: 'utf-8' codec can't decode byte 0x9d in position 0: invalid start byte
Traceback (most recent call last):
  File "/Users/mohamedzidancassim/Desktop/Junior Year/CS262/Final Project/fp-tor-replica/relay.py", line 141, in handle_message
    decrypted = aes_decrypt(session_key, payload_bytes)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x9d in position 0: invalid start byte

[Relay 2] [handle_message END] addr=('10.250.120.196', 63574), thread=6196326400
[Relay] ---- Relay process started ----
[Relay 1] [Relay] Loaded persistent RSA keypair from relay1_key.pem
[Relay 1] [Relay] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] [KEY] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] Relay 1 starting on 10.250.120.196:9101 (RELAY PORT 9101)
[Relay 1] Registering with CDS at 127.0.0.1:9000
[Relay 1] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9101, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5MM7/HBECV26fZqjUJkt\nQ4+dx297cL0hf1+rf08Qir5tL/lArfQsiplTqcsIsZiN7vJ8K2XzvK5JAEv8tVE4\nEKU4W1hbEVBd1eLCX+Oc5XauTbWhW8xlc2wdNlNwDhin2Mw84doKJWPyfjtIwnIi\n3nWHqxLyAqkj6qDoByA8D7YVmJxvzwL0mrYE8G8b4Q4Wjnx2SXeTwc9LRzqwrsyb\nlM5B4BSVPBignOMhD2AfuIFw6uULQThbkL9L5AnQA08B4Gqzo731LLJN/Y6qo+VJ\nki2t6m1aJTG0LBjijpH7CtnN1MHIQ5UueS1sJVYZooYxkxEYYZTqIUXxuI5ICKPC\nCQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 1] [Relay] Listening for incoming messages on port 9101 (RELAY PORT 9101)
[Relay] ---- Relay process started ----
[Relay 2] [Relay] Loaded persistent RSA keypair from relay2_key.pem
[Relay 2] [Relay] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] [KEY] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] Relay 2 starting on 10.250.120.196:9102 (RELAY PORT 9102)
[Relay 2] Registering with CDS at 127.0.0.1:9000
[Relay 2] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9102, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA58J3pSrOQd4hYnuzQQ7q\nWrjjo+3BJp+ik23brR2yl0kjtfH+wjD9LYWHS7dBxsDRzSozJ/7EWKKNCaTsgvaF\nN6vpyBPqDM/uQfOWfirteL50RgDZw95Vml4Fuay7bTBEb1J8ydvFqawo8rnLE2I3\nU4BjBT+CD38bY3je8wrrCX9fo1uYaLDlfteGshadZ2gnTxrAzkZZ/CTFdyb8JrmN\nIuxjBVjwSA/uIv+KHWQhXRA5jJPXcNV88LYXyEzpid1Cr9gnrqA88K0HSleiwZjU\nJF3LhBvS2Ga2HHfFsk5D/yz/pTHwDvRA98VMT/90wahwmSJsck4XWDFhmNhy3oDR\nBQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 2] [Relay] Listening for incoming messages on port 9102 (RELAY PORT 9102)
[Relay] ---- Relay process started ----
[Relay 3] [Relay] Loaded persistent RSA keypair from relay3_key.pem
[Relay 3] [Relay] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] [Relay] [KEY] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] Relay 3 starting on 10.250.120.196:9103 (RELAY PORT 9103)
[Relay 3] Registering with CDS at 127.0.0.1:9000
[Relay 3] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9103, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5k9OJ8m3IdjmwR1skM1G\nwrKkwlYLK0Qs+I/BX5ww5wEakOsTy5NVFAwTYrCUnR012u2jCwI8wV1YpPaMa8RJ\ntnqNFy4pFfqBh5tmidHQ3QMRvINPrGtQM5+VgMXoA0y8izql52M1K/3Q6sHVlAXd\nmpQcBO+JSHY7uyVx1txZssyisia7Nn8Frh/XRpl0oUvGkSnbm/KgqDAP0xJ3lUZS\nEGiIWdf0bn7tHD3nYBMrWWi3jSQWf0Q80asIEYWipwkfMPf0ffzu4FX0elfvpyOX\nr50xk7sb8K5IhcilwxKxQpPOcq3f6ph0EERQR7pOdDqkzFdHoGiyssSX4MYM60kd\nmQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 3] [Relay] Listening for incoming messages on port 9103 (RELAY PORT 9103)
[Relay 1] [Relay] [handle_message ENTERED] addr=('10.250.120.196', 64747), thread=6160576512, relay_port=9101
[Relay 1] [Relay] [DEBUG] Raw data received: b'{"next_ip": "10.250.120.196", "next_port": 9101, "session_key": "NL6AfPbHy8R5QQi8S/yTnCytxvk57Y477Wv4l9dqEhOPKdsa0gZ+HiOt50EWKYjvorS/jBymPPeA3LWIe8F1KtcwIPoETjfgZtJ/Pa+RUF36lRYRaZl27ep7GNz0f3UBUBN8I79ugayRD8AoAqk4JSjAhzez9tSNOM8qouerZV5TaHfPlZvKxLGxM3hxABjIxxMCt33i8WkSW8lPNG94d9DutVk1TMihcttcVRoWs7MdJyVlezCzJMpEbh01lO5zdgCaYUZ+gC4UOq88eeuZqFHOhFZ3HTlaQO/FbmISbmRSGUNllG3sZ/sdTV4JQieF6aP0uoOUZmnU1v6/hnOnxg==", "payload": "zfe8AYEin+7+lBfDb6vse//gAZiGSMf85tItEUxwjvPbH0RyCy+2hr4FmUMVcWrcbj204hn1/3VKHbKeCGVIuzPqK6rA9AAu/s757i2ipaRJGD3ieQn0NOqjBwbooxbvkp86lNNaYHtAriEjtuuzBw65PgcIWpsFPbbQga/yO7Z+wpstXsNqyWaBkhPIWdyJpK5L6VscZgrl3lnEWgagtZhmPACwv6e7p4s6e03ftGSq1blSBhK/nQAEkhVqeSxtrGm0F31B7e2dqpz4ufarxrB9Kl29QDWHzfBtw6g4vcEoYXygA+Tnu9oTsVdygHqC0HQCzechlTNTby8Inj+3SN8MXKUzMSvsaq/sMTu32HWQrn5QuZsXbakTNikmECUF60hWhX0jOVBCZoJcIEkmoc7EjviqfZCiT0veTzTHedVCZXKkka1flsdT6VtqNH9X1UEveXPNU22Tkvsr4rCgSGrmiyg9ZLgwNUSa39mzd2w5v0JALLuA41eAnmdsH79SNCzuWXjBYs4ZiZAbVUHUAy5QJ95/ypSuQB1elpe8XhuuiA+7/zollbE5Kir5sRf8sNKaYNIN/KhualP6ATzEfbFwOgSg+4zfy3DPEXWMJaOGwc1p7aI4IqLbJtCIK3VFMe5mzvu599HkrKak6FEFWUIt716a5sDJ6BeDq3MrPxZRpZQ8Ubljz9IpMV9Q0o25w/yGJgmvjg1WFPr6sUcxZFYWZY5P1PjfmFsHsKO2JBLqy55o87AoXEOq7x+O7zd0ECmE6XsHmN8pcQiqdohWQQWFT2etgI6Ys1EuN8+DRBqNRTdBVvHsHuaVjrY4yydY+HDFF9Rp98yOS6cNodunc5voI1fqlpiq5TYodd2i4bn7EFGfJEGwNdZGMW8hT+sOIsv0oNgXKBX3lipAlEgP9wCjzx15dNs5mcO0qyQOQTD1ZWjfO0MnySMjnXH5De1787fEKuto6hwNq3Oo6+8K0hVz8UXd8p5WzT7mZcN3QY3FvbnmXh/k1chuQmCCVAtwPEWtodeFwZk+gibMEVcu/ca8iL58tTPrvMGRhH6hHCRmgFeEGDZ+MW+Oi08z0ZaEWzE4YhhMOCWqG62FdLZEjejW/C+8Jvz9qJChlv/MObAsf3k/4JDowQSB9RXhMl6pUudgXfcyW0JubciLhSINcPFaUb+og91Y/vc5VYCKrnz/KworYYuqES1mPuBqmGeeFYl90V5EVVd2dFnSMEpUri1TFgfXeCfiE0tUEI9FWyH08BXm4lqDmsYw0O5lvrojue0HMIEl3t8dwZsAwb4aJnv/gwFNnuNPLIqV4KhV+4du8f2OlAPNKJKDyZoCWER13cyTa8OyPUr7/aGTqOl5Gy0biFsFIfxQng8U4TGhJ0S2HuSG0LjELAQLyEzbQU9aoduH+ctsjnwGheDoErKkyAfNp8QmwQNpnbKPSOQcj4+K6R11AWJekX+7M+t+otIPPWA="}'
[Relay 1] [Relay] [DEBUG] Data after JSON parse: type=<class 'dict'>, keys=['next_ip', 'next_port', 'session_key', 'payload']
[Relay 1] [Relay] Received session_key (base64): NL6AfPbHy8R5QQi8S/yTnCytxvk57Y477Wv4l9dqEhOPKdsa0gZ+HiOt50EWKYjvorS/jBymPPeA3LWIe8F1KtcwIPoETjfgZtJ/Pa+RUF36lRYRaZl27ep7GNz0f3UBUBN8I79ugayRD8AoAqk4JSjAhzez9tSNOM8qouerZV5TaHfPlZvKxLGxM3hxABjIxxMCt33i8WkSW8lPNG94d9DutVk1TMihcttcVRoWs7MdJyVlezCzJMpEbh01lO5zdgCaYUZ+gC4UOq88eeuZqFHOhFZ3HTlaQO/FbmISbmRSGUNllG3sZ/sdTV4JQieF6aP0uoOUZmnU1v6/hnOnxg==
[Relay 1] [Relay] Decoded session_key_enc (hex): 34be807cf6c7cbc4794108bc4bfc939c2cadc6f939ed8e3bed6bf897d76a12138f29db1ad2067e1e23ade741162988efa2b4bf8c1ca63cf780dcb5887bc1752ad73020fa044e37e066d27f3daf91505dfa951611699976edea7b18dcf47f750150137c23bf6e81ac910fc02802a9382528c08737b3f6d48d38cf2aa2e7ab655e536877cf959bcac4b1b13378710018c8c71302b77de2f169125bc94f346f7877d0eeb559354cc8a172db5c551a16b3b31d2725657b30b324ca446e1d3594ee7376009a61467e802e143aaf3c79eb99a851ce8456771d395a40efc56e62126e6452194365946dec67fb1d4d5e09422785e9a3f4ba83946669d4d6febf8673a7c6
[Relay 1] [Relay] Decrypting session key with fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] Decrypted session_key (hex): ee444420801122b66c84b6bee6d3fdd725894ad163317b1e1541d251e23c6847
[Relay 1] [Relay] [DEBUG] About to AES-decrypt payload (passing base64 string directly)
[Relay 1] [Relay] [DEBUG] Payload base64-decoded: type=<class 'bytes'>, len=1106, preview=b'\xcd\xf7\xbc\x01\x81"\x9f\xee\xfe\x94\x17\xc3o\xab\xec{\xff\xe0\x01\x98\x86H\xc7\xfc\xe6\xd2-\x11Lp\x8e\xf3\xdb\x1fDr\x0b/\xb6\x86\xbe\x05\x99C\x15qj\xdcn=\xb4\xe2\x19\xf5\xffuJ\x1d\xb2\x9e'
[Relay 1] [Relay] [DEBUG] AES-decrypted payload: type=<class 'bytes'>, len=1090, preview=b'{"next_ip": "10.250.120.196", "next_port": 9102, "session_ke'
[Relay 1] [Relay] [DEBUG] AES-decrypted payload (hex): 7b226e6578745f6970223a202231302e3235302e3132302e313936222c20226e6578745f706f7274223a20393130322c202273657373696f6e5f6b65
[Relay 1] [Relay] [DEBUG] Next hop JSON keys: ['next_ip', 'next_port', 'session_key', 'payload']
[Relay 1] [Relay] [DEBUG] Forwarding to next relay 10.250.120.196:9102
[Relay 2] [Relay] [handle_message ENTERED] addr=('10.250.120.196', 64749), thread=6191640576, relay_port=9102
[Relay 2] [Relay] [DEBUG] Raw data received: b'{"next_ip": "10.250.120.196", "next_port": 9102, "session_key": "nFgNTWCkb7w1O9kPQUHdKneotZg8/h2CD3PO6fiZPweufunVDYkvsrH90Vc+p6OM/AcMFSLmzrq7xUIC775FYEOnu7cE7sDmPyosUJabvqPHipUM6Vhak3V3M3zrMt77e+QaiUSBH2TuJFQ+QuAhwwffxMUpGJJvz6Z2TfbsSuw9VhYukptvQbmWWbDakMw2ZPB6/Np+ml3xIeT8JlsIMmJcCG0NLBuLMecerDH1CFuE2O/e5/5ORLL0LgxwpDgENR2zJIYpEFEZS1BreyQ5S/X04/6NTgsDbWKfnihRwTe5NJlrNB3Yd1sjNmFrgwMs17tdg9aAHzxRg2QMZf6agw==", "payload": "7kqnwKgORzYtt5GASGmnAc9V059bP5jwuNT7Y1UNZy8mQMdTJbjFfnZrmsQ6SxOjixhOoqJnftIY5crMiVvNfoJ5TTByHZPqzHVgwzlipTTKGWy/uHLkYQ4woJuntH2xtpEUhsGV2h0BmU4bNO9VJwquKHqoDJdiBDjJaudAOsA6SlWRZnQjV7RKtOtB6gnx3rjH2eIaddldXghe5lNOd/G0WT2xAqIn9g2cCzIzrze63gXsnoZ+Z1S4KplhMbY1G/IC0trsfa8agzEyA+2vWUjAT3B+NRvSQVIFO3uTlBedLhLpq8mnJDsZgh2awueQKB4jHOmAP61QuFLUlFSzFCW9hB/J5mz0xlDUIosKwY2A7oMi2nAZwd3C7QgXMhMXWWS1CWoqozr3g7TlH8CjySuZ9uuVXNG3yemYz263nhYOcK+q/GqNeFwqF2hkou5ElakD5mXX4JClMmH7NVUeJndV5cKffq2axXDCpuVeZ8r08EGA+oRwjpyCyBPZYb8x+3Dfn37mllpRrUVkj5BXvws7BS3Zd/Ku7FIA06HekawZg6ShSJxG+gWRxi1uk9J1tokzre3L6amE/muvENCvhXNjhEcsaz4xVbSlLDxtSlIW5v9pd2SK50w9kM5YONurNppIJiw3QUIV1GKHGEw8EDYD"}'
[Relay 2] [Relay] [DEBUG] Data after JSON parse: type=<class 'dict'>, keys=['next_ip', 'next_port', 'session_key', 'payload']
[Relay 2] [Relay] Received session_key (base64): nFgNTWCkb7w1O9kPQUHdKneotZg8/h2CD3PO6fiZPweufunVDYkvsrH90Vc+p6OM/AcMFSLmzrq7xUIC775FYEOnu7cE7sDmPyosUJabvqPHipUM6Vhak3V3M3zrMt77e+QaiUSBH2TuJFQ+QuAhwwffxMUpGJJvz6Z2TfbsSuw9VhYukptvQbmWWbDakMw2ZPB6/Np+ml3xIeT8JlsIMmJcCG0NLBuLMecerDH1CFuE2O/e5/5ORLL0LgxwpDgENR2zJIYpEFEZS1BreyQ5S/X04/6NTgsDbWKfnihRwTe5NJlrNB3Yd1sjNmFrgwMs17tdg9aAHzxRg2QMZf6agw==
[Relay 2] [Relay] Decoded session_key_enc (hex): 9c580d4d60a46fbc353bd90f4141dd2a77a8b5983cfe1d820f73cee9f8993f07ae7ee9d50d892fb2b1fdd1573ea7a38cfc070c1522e6cebabbc54202efbe456043a7bbb704eec0e63f2a2c50969bbea3c78a950ce9585a937577337ceb32defb7be41a8944811f64ee24543e42e021c307dfc4c52918926fcfa6764df6ec4aec3d56162e929b6f41b99659b0da90cc3664f07afcda7e9a5df121e4fc265b0832625c086d0d2c1b8b31e71eac31f5085b84d8efdee7fe4e44b2f42e0c70a43804351db32486291051194b506b7b24394bf5f4e3fe8d4e0b036d629f9e2851c137b934996b341dd8775b2336616b83032cd7bb5d83d6801f3c5183640c65fe9a83
[Relay 2] [Relay] Decrypting session key with fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] Decrypted session_key (hex): ce8d7ebf85db07e0430602bd8615d7bcf32d060155334cb05dd2ee78ad79bba7
[Relay 2] [Relay] [DEBUG] About to AES-decrypt payload (passing base64 string directly)
[Relay 2] [Relay] [DEBUG] Payload base64-decoded: type=<class 'bytes'>, len=498, preview=b'\xeeJ\xa7\xc0\xa8\x0eG6-\xb7\x91\x80Hi\xa7\x01\xcfU\xd3\x9f[?\x98\xf0\xb8\xd4\xfbcU\rg/&@\xc7S%\xb8\xc5~vk\x9a\xc4:K\x13\xa3\x8b\x18N\xa2\xa2g~\xd2\x18\xe5\xca\xcc'
[Relay 2] [Relay] [DEBUG] AES-decrypted payload: type=<class 'bytes'>, len=482, preview=b'{"next_ip": "10.250.120.196", "next_port": 9103, "session_ke'
[Relay 2] [Relay] [DEBUG] AES-decrypted payload (hex): 7b226e6578745f6970223a202231302e3235302e3132302e313936222c20226e6578745f706f7274223a20393130332c202273657373696f6e5f6b65
[Relay 2] [Relay] [DEBUG] Next hop JSON keys: ['next_ip', 'next_port', 'session_key', 'payload']
[Relay 2] [Relay] [DEBUG] Forwarding to next relay 10.250.120.196:9103
[Relay 3] [Relay] [handle_message ENTERED] addr=('10.250.120.196', 64754), thread=6124482560, relay_port=9103
[Relay 3] [Relay] [DEBUG] Raw data received: b'{"next_ip": "10.250.120.196", "next_port": 9103, "session_key": "BN2M1wYraU7prV1UU+JAW/9b6eDabBvkxlNu6X9Ht6gHj0I3xKX0a3WsqwoM1Ky3RRRKB0DuHmCIw18aUQWtTKcf0MVC6fwIbjuGuAi1NC08dIyaEbheax0ZkDJEUw856XHwA+Sr4PMfGDWOkNR0Pyz0xm5+3M/Y0GaFOLUJFSsdW9JuXSKg1556EK+cw5PWY1XcADgFbu78PGKBiS3jlSq4jOtncd8wCfLg6F9Law9ldeIrSrINGXGa+il6Hllcw0cZw8cCMWCz5cFYoHK4XSWDg9+twyUHeIne6YH3MzF7G/0Elr9uazmP/f7JZRTKVt6fO+v93P3RxLgqbNH1kQ==", "payload": "MEbq+x7261useLOLVpuQB6hJf9OO88RnNcdcXbK3JOaA+iJOCG0Psg=="}'
[Relay 3] [Relay] [DEBUG] Data after JSON parse: type=<class 'dict'>, keys=['next_ip', 'next_port', 'session_key', 'payload']
[Relay 3] [Relay] Received session_key (base64): BN2M1wYraU7prV1UU+JAW/9b6eDabBvkxlNu6X9Ht6gHj0I3xKX0a3WsqwoM1Ky3RRRKB0DuHmCIw18aUQWtTKcf0MVC6fwIbjuGuAi1NC08dIyaEbheax0ZkDJEUw856XHwA+Sr4PMfGDWOkNR0Pyz0xm5+3M/Y0GaFOLUJFSsdW9JuXSKg1556EK+cw5PWY1XcADgFbu78PGKBiS3jlSq4jOtncd8wCfLg6F9Law9ldeIrSrINGXGa+il6Hllcw0cZw8cCMWCz5cFYoHK4XSWDg9+twyUHeIne6YH3MzF7G/0Elr9uazmP/f7JZRTKVt6fO+v93P3RxLgqbNH1kQ==
[Relay 3] [Relay] Decoded session_key_enc (hex): 04dd8cd7062b694ee9ad5d5453e2405bff5be9e0da6c1be4c6536ee97f47b7a8078f4237c4a5f46b75acab0a0cd4acb745144a0740ee1e6088c35f1a5105ad4ca71fd0c542e9fc086e3b86b808b5342d3c748c9a11b85e6b1d19903244530f39e971f003e4abe0f31f18358e90d4743f2cf4c66e7edccfd8d0668538b509152b1d5bd26e5d22a0d79e7a10af9cc393d66355dc0038056eeefc3c6281892de3952ab88ceb6771df3009f2e0e85f4b6b0f6575e22b4ab20d19719afa297a1e595cc34719c3c7023160b3e5c158a072b85d258383dfadc325077889dee981f733317b1bfd0496bf6e6b398ffdfec96514ca56de9f3bebfddcfdd1c4b82a6cd1f591
[Relay 3] [Relay] Decrypting session key with fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] [Relay] Decrypted session_key (hex): e40af59039a8ade64f349c9d9c2aa5f043a0cf19803f95feac8e5d8424e0694b
[Relay 3] [Relay] [DEBUG] About to AES-decrypt payload (passing base64 string directly)
[Relay 3] [Relay] [DEBUG] Payload base64-decoded: type=<class 'bytes'>, len=40, preview=b'0F\xea\xfb\x1e\xf6\xeb[\xacx\xb3\x8bV\x9b\x90\x07\xa8I\x7f\xd3\x8e\xf3\xc4g5\xc7\\]\xb2\xb7$\xe6\x80\xfa"N\x08m\x0f\xb2'
[Relay 3] [Relay] [DEBUG] AES-decrypted payload: type=<class 'bytes'>, len=24, preview=b'{"msg": "Hello, world!"}'
[Relay 3] [Relay] [DEBUG] AES-decrypted payload (hex): 7b226d7367223a202248656c6c6f2c20776f726c6421227d
[Relay 3] [Relay] [DEBUG] Next hop JSON keys: ['msg']
[Relay 3] [Relay] [DEBUG] Payload is not JSON, assuming last hop. Error: 'next_ip'
[Relay 3] [Relay] [Last Hop] Forwarding payload to dest 127.0.0.1:9100, len=24, type=<class 'bytes'>
[Relay 3] [Relay] [Last Hop] Sending to dest: type=<class 'bytes'>, len=24, preview=b'{"msg": "Hello, world!"}'
[Relay 3] [Relay] [Last Hop] Received response from dest: type=<class 'bytes'>, len=50, preview=b'{"result": "OK", "echo": {"msg": "Hello, world!"}}'
[Relay 3] [Relay] [Last Hop] Response from dest decoded as UTF-8: '{"result": "OK", "echo": {"msg": "Hello, world!"}}'
[Relay 3] [Relay] [Last Hop] Response from dest (hex): 7b22726573756c74223a20224f4b222c20226563686f223a207b226d7367223a202248656c6c6f2c20776f726c6421227d7d
[Relay 3] [Relay] [Last Hop] About to AES-encrypt response: type=<class 'bytes'>, len=50, preview=b'{"result": "OK", "echo": {"msg": "Hello, world!"}}'
[Relay 3] [Relay] [Last Hop] AES-encrypted response (hex): 6bf11b6ae560e5fddcc12e882410175180bcd440f3ba8f8ded9e54bac3ac75aabedceff80dbd46dbdf2a8f8828de024e6855a1794a91cc627c869b16
[Relay 3] [Relay] [Last Hop] Base64-encoded AES-encrypted response: type=<class 'bytes'>, len=88, preview=b'a/EbauVg5f3cwS6IJBAXUYC81EDzuo+N7Z5UusOsdaq+3O/4Db1G298qj4go'
[Relay 2] [Relay] [DEBUG] Received response from next relay: type=<class 'bytes'>, len=88, preview=b'a/EbauVg5f3cwS6IJBAXUYC81EDzuo+N7Z5UusOsdaq+3O/4Db1G298qj4go'
[Relay 3] [Relay] [Last Hop] Sent response to ('10.250.120.196', 64754): b'a/EbauVg5f3cwS6IJBAXUYC81EDzuo+N7Z5UusOsdaq+3O/4Db1G298qj4go'... (len=88)
[Relay 2] [Relay] [RETURN] Base64-decoded response: type=<class 'bytes'>, len=66, preview=b'k\xf1\x1bj\xe5`\xe5\xfd\xdc\xc1.\x88$\x10\x17Q\x80\xbc\xd4@\xf3\xba\x8f\x8d\xed\x9eT\xba\xc3\xacu\xaa\xbe\xdc\xef\xf8\r\xbdF\xdb\xdf*\x8f\x88(\xde\x02NhU\xa1yJ\x91\xccb|\x86\x9b\x16'
[Relay 2] [Relay] [RETURN] AES-decrypted response: type=<class 'bytes'>, len=50, preview=b'D\x81<\xa6\x04Y\xba,\xdeeV\x8f\x8e\x91\xce\x80g\xdf\xb4\x05\xdf\xf5\xc0\xb2\xd911ru\xbc}\x8b\x14\x8d\x8e]\xb3\xf2\xb3\xf2\xac\xdb\x026\x87\x94\xc5\xbd\xc4\x1f'
[Relay 3] [Relay] [handle_message END] addr=('10.250.120.196', 64754), thread=6124482560
[Relay 2] [Relay] [RETURN] AES-decrypted response not UTF-8: 'utf-8' codec can't decode byte 0x81 in position 1: invalid start byte
[Relay 2] [Relay] [RETURN] AES-encrypted response (hex): 01f169c65299bc15851bf1305cc5c5500d553895da2bb07f7ad9de6872916ba265b162f0b3cf1accfcccdd49c5386963e8e6c64df1c33da7d7dadb4c
[Relay 2] [Relay] [RETURN] Base64-encoded AES-encrypted response: type=<class 'bytes'>, len=112, preview=b'AfFpxlKZvBWFG/EwXMXFUA1VOJXaK7B/etneaHKRa6JlsWLws88azPzM3UnF'
[Relay 1] [Relay] [DEBUG] Received response from next relay: type=<class 'bytes'>, len=112, preview=b'AfFpxlKZvBWFG/EwXMXFUA1VOJXaK7B/etneaHKRa6JlsWLws88azPzM3UnF'
[Relay 2] [Relay] [handle_message END] addr=('10.250.120.196', 64749), thread=6191640576
[Relay 1] [Relay] [RETURN] Base64-decoded response: type=<class 'bytes'>, len=82, preview=b'\x01\xf1i\xc6R\x99\xbc\x15\x85\x1b\xf10\\\xc5\xc5P\rU8\x95\xda+\xb0\x7fz\xd9\xdehr\x91k\xa2e\xb1b\xf0\xb3\xcf\x1a\xcc\xfc\xcc\xddI\xc58ic\xe8\xe6\xc6M\xf1\xc3=\xa7\xd7\xda\xdbL'
[Relay 1] [Relay] [RETURN] AES-decrypted response: type=<class 'bytes'>, len=66, preview=b"5\xafu\xea*\xc5\xbd\xe4\x01Z\x07\xbez\x92F\x7f_c\x18\xf4\xef\x8a\xc1*x'5]\xf5Z\x8c\x08N\xa03|\xe2\xad\x19|s\xb0\xfd\xaeTcg\\\xa7c\xfd\x16u\xfc*\x0f\xee\xa8\xed\x06"
[Relay 1] [Relay] [RETURN] AES-decrypted response not UTF-8: 'utf-8' codec can't decode byte 0xaf in position 1: invalid start byte
[Relay 1] [Relay] [RETURN] AES-encrypted response (hex): 8a86431793039d68c72feea857ba935400a868cd01ca0ce6830908926c630ce0bbeef099b892bd9688adc4b677140cfb35faf571f8e6ae5c11c2584b
[Relay 1] [Relay] [RETURN] Base64-encoded AES-encrypted response: type=<class 'bytes'>, len=132, preview=b'ioZDF5MDnWjHL+6oV7qTVACoaM0BygzmgwkIkmxjDOC77vCZuJK9loitxLZ3'
[Relay] ---- Relay process started ----
[Relay 1] [Relay] Loaded persistent RSA keypair from relay1_key.pem
[Relay 1] [Relay] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] [KEY] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] Relay 1 starting on 10.250.120.196:9101 (RELAY PORT 9101)
[Relay 1] Registering with CDS at 127.0.0.1:9000
[Relay 1] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9101, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5MM7/HBECV26fZqjUJkt\nQ4+dx297cL0hf1+rf08Qir5tL/lArfQsiplTqcsIsZiN7vJ8K2XzvK5JAEv8tVE4\nEKU4W1hbEVBd1eLCX+Oc5XauTbWhW8xlc2wdNlNwDhin2Mw84doKJWPyfjtIwnIi\n3nWHqxLyAqkj6qDoByA8D7YVmJxvzwL0mrYE8G8b4Q4Wjnx2SXeTwc9LRzqwrsyb\nlM5B4BSVPBignOMhD2AfuIFw6uULQThbkL9L5AnQA08B4Gqzo731LLJN/Y6qo+VJ\nki2t6m1aJTG0LBjijpH7CtnN1MHIQ5UueS1sJVYZooYxkxEYYZTqIUXxuI5ICKPC\nCQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 1] [Relay] Listening for incoming messages on port 9101 (RELAY PORT 9101)
[Relay] ---- Relay process started ----
[Relay 2] [Relay] Loaded persistent RSA keypair from relay2_key.pem
[Relay 2] [Relay] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] [KEY] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] Relay 2 starting on 10.250.120.196:9102 (RELAY PORT 9102)
[Relay 2] Registering with CDS at 127.0.0.1:9000
[Relay 2] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9102, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA58J3pSrOQd4hYnuzQQ7q\nWrjjo+3BJp+ik23brR2yl0kjtfH+wjD9LYWHS7dBxsDRzSozJ/7EWKKNCaTsgvaF\nN6vpyBPqDM/uQfOWfirteL50RgDZw95Vml4Fuay7bTBEb1J8ydvFqawo8rnLE2I3\nU4BjBT+CD38bY3je8wrrCX9fo1uYaLDlfteGshadZ2gnTxrAzkZZ/CTFdyb8JrmN\nIuxjBVjwSA/uIv+KHWQhXRA5jJPXcNV88LYXyEzpid1Cr9gnrqA88K0HSleiwZjU\nJF3LhBvS2Ga2HHfFsk5D/yz/pTHwDvRA98VMT/90wahwmSJsck4XWDFhmNhy3oDR\nBQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 2] [Relay] Listening for incoming messages on port 9102 (RELAY PORT 9102)
[Relay] ---- Relay process started ----
[Relay 3] [Relay] Loaded persistent RSA keypair from relay3_key.pem
[Relay 3] [Relay] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] [Relay] [KEY] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] Relay 3 starting on 10.250.120.196:9103 (RELAY PORT 9103)
[Relay 3] Registering with CDS at 127.0.0.1:9000
[Relay 3] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9103, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5k9OJ8m3IdjmwR1skM1G\nwrKkwlYLK0Qs+I/BX5ww5wEakOsTy5NVFAwTYrCUnR012u2jCwI8wV1YpPaMa8RJ\ntnqNFy4pFfqBh5tmidHQ3QMRvINPrGtQM5+VgMXoA0y8izql52M1K/3Q6sHVlAXd\nmpQcBO+JSHY7uyVx1txZssyisia7Nn8Frh/XRpl0oUvGkSnbm/KgqDAP0xJ3lUZS\nEGiIWdf0bn7tHD3nYBMrWWi3jSQWf0Q80asIEYWipwkfMPf0ffzu4FX0elfvpyOX\nr50xk7sb8K5IhcilwxKxQpPOcq3f6ph0EERQR7pOdDqkzFdHoGiyssSX4MYM60kd\nmQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 3] [Relay] Listening for incoming messages on port 9103 (RELAY PORT 9103)
[Relay 2] [Relay] [handle_message ENTERED] addr=('10.250.120.196', 50334), thread=6125826048, relay_port=9102
[Relay 2] [Relay] [DEBUG] Raw data received: b'{"next_ip": "10.250.120.196", "next_port": 9102, "session_key": "u3ZA1YSZb3rkfTWrKK3KL8irFjVX+2h6EAzDcvUalO6Annlm/kl98LzfsGbg26buQsLSYBdf5dGRklIE02x6QwvH4VJap0w73qu5j/2jX2U8AkZ+A1CvWyBnAYbyZSMlHw++pzVDc8MRVwQbd3RK/ww+ULgIB8K8dB9kYx5W/Ql4yVr9CcSrU5tnPpQyyEmGsOEO99UYvc73iXYCzFo3OxJ20vWNmCLRVhVJnkWu7MZ5sbDssIcXlQvEDjJFJX3EF9y63j0uazA6dzU2iZy5AixN0eT0arzGgzKJhCRFCaq82+v1K8NuGywZgyQKtGocdd6Hw7lGp4AzNs63Rrg51g==", "payload": "UyqW7q6cvbCjpWXpbCBxxxbG/mjra0y54bXA1OKAiLLrf4cODXoOXiIGSOsYk/0I6dU/6ZlCXFZBS3bRevP53WUtAWl/Obz4FQoMz9FmNHUd6gyfDbtI8F/c2qncpalbFy3zSNKL5qbLARmyWDfbi/7JXeUN68yXL1FYmaV+SAAJjD7/V+X9Ay0INWbA7fttKl4/u88vyVndqc24XtKaxdD4c80NPU0HdkYlWEyEXwevQHTNIBDg2qr0GUWY2uTH6ldCXyBaV0xV2SYxraDBNWJ2kI7ueZE4Ah3KcaFcrIuwT4F4mD00N7wueHefEePfqd5gfJAFXStwBujQm641HLnBI20GAaq9D2A168aNEXwsq5Zzla31YOLgSff6GcYz5g4D9o1jPhg3soElt/5lACOZFv3nqYz0rnCv4Ttc9B7pGkE4jegtpFLjFIaSn09KCtQQOWgnmwxqe1LW9L1DhiBX8sFh62ic/7wxFgFu4khGLaHAGMSqJNwL98zHD8W4ipkuNmqwnmGDd8fq1qPymgEkzcT++Jrfn6ctyzCq0zIZTudO2gzKfykR2svcEzrP2CgPJ3N/xQnCKMAdnh3J1mbdJunxaMlqSKLIaD203kw1fWQex82XplaH4DepG1O705df7zsYIbfuhp5L6Ol8ueJtImSPn5oZHgC05ocaJRkyYG6mWOHvaXRiifm3ps+y12AWNzKD+8cp/DKKtKfZkny7aXqkJVPjv1I2iaukLNNfUFegrVMl50xS0p6eZuA6QNglovVV7ZOVJXXXGiosMzNzq6w/w3rEU3BgyddxGgdY7waL+SJt0kFhqYbmVrK4JzUirbc2YEzHDQQViK3UKOA/KS4gkBjeTYeIXAubl1+TyJ2e4y3NPpYJceiQghaVtNykZEtDIYSs1bYmN2me2xqoOqfcN855SKLbsTG96ZPJZizjPQ+bhQnrjGvLMrz+tzXgAzHXGlaRXPInql7az65+BAQU+w8qkBifTDSAPUty0e2m8MKi2L06IYK+UdGP6OnDF9d6h16CDRpeWM8hqn1oDKJ+iOeMgZ9dsEsrzeLV65FySwTEl7Rf9UBg9dbAfsLwXxe6U/IrJ+ojk2MKNqSCGDlfKJ+hN5Suzk+bSxumCAO3YjDeF4QVMNJbqVF0+G48Kyy8eufcCF2MNeeXkaeecffnSshMNTGeY1R4Z8b29b8Mp9bjB0CXY3SQAxu1mZreHdhkEaWveYgqaX2i5VtxhPgNiN7GAAklSDNZo3GR9X7WQDWLKuRm2ie3/aiAwX78kQW7Vl5W58jQg4JVTYnC/nEKKCaCVYZuan+G9t9IHT5h1t/jrvPcLCytAbIMZAIBSy+Mdg/s3nUtOv3QmebKYiUGHiJuiyMrUQSuV9se3diG4nQ8VLeKEbsxEOJS4SJ0qTEqKI52G81HEOhnGn8B"}'
[Relay 2] [Relay] [DEBUG] Data after JSON parse: type=<class 'dict'>, keys=['next_ip', 'next_port', 'session_key', 'payload']
[Relay 2] [Relay] Received session_key (base64): u3ZA1YSZb3rkfTWrKK3KL8irFjVX+2h6EAzDcvUalO6Annlm/kl98LzfsGbg26buQsLSYBdf5dGRklIE02x6QwvH4VJap0w73qu5j/2jX2U8AkZ+A1CvWyBnAYbyZSMlHw++pzVDc8MRVwQbd3RK/ww+ULgIB8K8dB9kYx5W/Ql4yVr9CcSrU5tnPpQyyEmGsOEO99UYvc73iXYCzFo3OxJ20vWNmCLRVhVJnkWu7MZ5sbDssIcXlQvEDjJFJX3EF9y63j0uazA6dzU2iZy5AixN0eT0arzGgzKJhCRFCaq82+v1K8NuGywZgyQKtGocdd6Hw7lGp4AzNs63Rrg51g==
[Relay 2] [Relay] Decoded session_key_enc (hex): bb7640d584996f7ae47d35ab28adca2fc8ab163557fb687a100cc372f51a94ee809e7966fe497df0bcdfb066e0dba6ee42c2d260175fe5d191925204d36c7a430bc7e1525aa74c3bdeabb98ffda35f653c02467e0350af5b20670186f26523251f0fbea7354373c31157041b77744aff0c3e50b80807c2bc741f64631e56fd0978c95afd09c4ab539b673e9432c84986b0e10ef7d518bdcef7897602cc5a373b1276d2f58d9822d15615499e45aeecc679b1b0ecb08717950bc40e3245257dc417dcbade3d2e6b303a773536899cb9022c4dd1e4f46abcc683328984244509aabcdbebf52bc36e1b2c1983240ab46a1c75de87c3b946a7803336ceb746b839d6
[Relay 2] [Relay] Decrypting session key with fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] ERROR in message processing: Decryption failed
Traceback (most recent call last):
  File "/Users/mohamedzidancassim/Desktop/Junior Year/CS262/Final Project/fp-tor-replica/relay.py", line 158, in handle_message
    session_key = rsa_decrypt(self.private_key, session_key_enc)
  File "/Users/mohamedzidancassim/Desktop/Junior Year/CS262/Final Project/fp-tor-replica/crypto_utils.py", line 40, in rsa_decrypt
    return private_key.decrypt(
           ~~~~~~~~~~~~~~~~~~~^
        ciphertext,
        ^^^^^^^^^^^
    ...<4 lines>...
        )
        ^
    )
    ^
ValueError: Decryption failed

[Relay 1] [Relay] Deregistering from CDS and shutting down...
[Relay 2] [Relay] [handle_message END] addr=('10.250.120.196', 50334), thread=6125826048
[Relay 3] [Relay] Deregistering from CDS and shutting down...
[Relay 2] [Relay] Deregistering from CDS and shutting down...
[Relay 3] [Relay] ERROR during deregistration: [Errno 54] Connection reset by peer
[Relay 2] [Relay] ERROR during deregistration: [Errno 32] Broken pipe
[Relay 1] [Relay] ERROR during deregistration: [Errno 32] Broken pipe
[Relay] ---- Relay process started ----
[Relay 1] [Relay] Loaded persistent RSA keypair from relay1_key.pem
[Relay 1] [Relay] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] [KEY] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] Relay 1 starting on 10.250.120.196:9101 (RELAY PORT 9101)
[Relay 1] Registering with CDS at 127.0.0.1:9000
[Relay 1] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9101, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5MM7/HBECV26fZqjUJkt\nQ4+dx297cL0hf1+rf08Qir5tL/lArfQsiplTqcsIsZiN7vJ8K2XzvK5JAEv8tVE4\nEKU4W1hbEVBd1eLCX+Oc5XauTbWhW8xlc2wdNlNwDhin2Mw84doKJWPyfjtIwnIi\n3nWHqxLyAqkj6qDoByA8D7YVmJxvzwL0mrYE8G8b4Q4Wjnx2SXeTwc9LRzqwrsyb\nlM5B4BSVPBignOMhD2AfuIFw6uULQThbkL9L5AnQA08B4Gqzo731LLJN/Y6qo+VJ\nki2t6m1aJTG0LBjijpH7CtnN1MHIQ5UueS1sJVYZooYxkxEYYZTqIUXxuI5ICKPC\nCQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 1] [Relay] Listening for incoming messages on port 9101 (RELAY PORT 9101)
[Relay] ---- Relay process started ----
[Relay 2] [Relay] Loaded persistent RSA keypair from relay2_key.pem
[Relay 2] [Relay] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] [KEY] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] Relay 2 starting on 10.250.120.196:9102 (RELAY PORT 9102)
[Relay 2] Registering with CDS at 127.0.0.1:9000
[Relay 2] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9102, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA58J3pSrOQd4hYnuzQQ7q\nWrjjo+3BJp+ik23brR2yl0kjtfH+wjD9LYWHS7dBxsDRzSozJ/7EWKKNCaTsgvaF\nN6vpyBPqDM/uQfOWfirteL50RgDZw95Vml4Fuay7bTBEb1J8ydvFqawo8rnLE2I3\nU4BjBT+CD38bY3je8wrrCX9fo1uYaLDlfteGshadZ2gnTxrAzkZZ/CTFdyb8JrmN\nIuxjBVjwSA/uIv+KHWQhXRA5jJPXcNV88LYXyEzpid1Cr9gnrqA88K0HSleiwZjU\nJF3LhBvS2Ga2HHfFsk5D/yz/pTHwDvRA98VMT/90wahwmSJsck4XWDFhmNhy3oDR\nBQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 2] [Relay] Listening for incoming messages on port 9102 (RELAY PORT 9102)
[Relay] ---- Relay process started ----
[Relay 3] [Relay] Loaded persistent RSA keypair from relay3_key.pem
[Relay 3] [Relay] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] [Relay] [KEY] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] Relay 3 starting on 10.250.120.196:9103 (RELAY PORT 9103)
[Relay 3] Registering with CDS at 127.0.0.1:9000
[Relay 3] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9103, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5k9OJ8m3IdjmwR1skM1G\nwrKkwlYLK0Qs+I/BX5ww5wEakOsTy5NVFAwTYrCUnR012u2jCwI8wV1YpPaMa8RJ\ntnqNFy4pFfqBh5tmidHQ3QMRvINPrGtQM5+VgMXoA0y8izql52M1K/3Q6sHVlAXd\nmpQcBO+JSHY7uyVx1txZssyisia7Nn8Frh/XRpl0oUvGkSnbm/KgqDAP0xJ3lUZS\nEGiIWdf0bn7tHD3nYBMrWWi3jSQWf0Q80asIEYWipwkfMPf0ffzu4FX0elfvpyOX\nr50xk7sb8K5IhcilwxKxQpPOcq3f6ph0EERQR7pOdDqkzFdHoGiyssSX4MYM60kd\nmQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 3] [Relay] Listening for incoming messages on port 9103 (RELAY PORT 9103)
[Relay 2] [Relay] [handle_message ENTERED] addr=('10.250.120.196', 51460), thread=6135197696, relay_port=9102
[Relay 2] [Relay] [DEBUG] Raw data received: b'{"next_ip": "10.250.120.196", "next_port": 9102, "session_key": "42wdaYsogpPSgiMAJcPsqGDJjCoLNYJGumA8Hbrcxyv4/Um54whFm7C8mWRjE3c3nFv8lD/kl3s7GGsrViAxgj4rs1IZZ/4B3ED7IGu57u0v6+3z1aFNJl0B93Lg/K0WFGdD5rRhEW61cCXwQ8iNyc0Q4+2UAbMOp9747EYFe1eSK0aRg6OKpCVp3TBNKp1sZQBAV73/VjuHv1LAAMD8fph1JOzVphCmDVn//raqzujB+GhQk4bucye3Ye6vvFeAPuA9Mg/VxIqWMbxcCsJ/CPB5ffrBc/MGc5ETjRB0WzuUmDB+4SDfuFMjvA34zNGHRnVr/1FgbNjTY1amV60kiw==", "payload": "f1+3wI4p6mr7IYJfFycMJpAixKEABJdxEBisQkksp8iyD9cZXvDcytVPxAiY81GNQ+c7aJvZGsp0IXUP7BqwpEHYXQTK0qYRNrxOjZq4zxOg/2JV0NpVuJPyPawFIk6hnHB4RK/hBQOLy8onGK6y4WxN5/4QBMAVw2UR4svBJ5Eehr2JLb2AuEb41edhBwX8yueDWFARzvM6vbu4wzJK7Ou80QnLqp27Nn8V7DXsQ0XZjKdg9NzzI6s24etEuHBWZNY5L3fbJNZyIjw4tu4NYba/Pg+tdrMuZY7oycSl/S/5/KfLhNrNB2CVtlBFBRyBLUkHvRvk9lmS4dbft1lcdi+/6hdG1NpGnsr4JWoBwccH2Cdsd6kyOWdHOxwRpV6YhLEJSgXG7imObb4eTypVghIAGDuAf9YjBxjy7aKesIiA5Rq2gSX0iqbdOkEUMSA7sCFhb32PGEG7NveMnFyFWnWxx1bqS8tk2HvH5yg+phWTGt34wPaA6LbiO0sWR2ng0rHvf5P4KdUnMoYpWtOVJrZ7XOR1ykz1QAM/yyyfVj4YQ9s3Qq4sxgH/HG4SqDSJIbcvXFyI0xxjzAepsvu2gTbkTs0NsC/4e5KNI1AL+cRFFRf6t4LIRRiV+jL7EXOCsaOr1jNvOHzR66g8+daJMOROY4f+EOcHaLDwvpDXOwAP/yq8wLfDYeSaGMoCdgzZjSiZ8PhU1jOpe0Z1ThY+jbhI2S3+XbIqlsYDiUir0eJKb0Ih4jvdocLnU32lB6gIKO873NLoXWb+LI0xrUX2d75tuR/L3FpWhq8/Cw0erKTg2SDb0d6bPC9R2XY8yd5B7CmnBWLIJOBnFaOILMFowXeKnHz8iTIkFzlgIZQo4NiKuvQyfnUdpPUQQg8TZaHUYYQ1782FvpxEtSqDLmsWu8pRj3MjraedoMnTIxT+6LpwERcgVtByBRSY5T0uIUCqt/Hp0TSSu3/+IlLnfM4pYfwPxpL31gHhETdr4WFJybPmtVUReERiavOrdqsYOYg5bRnnssnkgk8k/yC776nvbXrFWp5yzoxAasK30emK41j83hlvo0JM81kW9xo7/vVt5hcgUWUxzxJHsW89gVZ6qssFfayHB19PlDVVKMMPeEDiuY9BhrLfPyG800+8WJH0VAiYZl9U874bN33myrfLsBg+oJhf9mNSlaz+L7cqyc0Aq5bEuuUnMNwLeaPUoxyOffK1fVuiqT3APmIavgxyrr/GNMwR3tJtyKj2helWU09oRSvgR8EaNxhtkmA5uoqchV3U45v9btK/CpAfvPMnRagBr9NJ04FDFWwoOTFvEKc2i3PC6BSswDuOZK4ZMuankIzoCJCWJmyJL5jvgS/E0VHUUwWjBsm1ZB1byQKWCpCmGpYBp33NZQWS/FLRplTMhycEa29laZpQa3RvgiGnsvLT"}'
[Relay 2] [Relay] [DEBUG] Data after JSON parse: type=<class 'dict'>, keys=['next_ip', 'next_port', 'session_key', 'payload']
[Relay 2] [Relay] Received session_key (base64): 42wdaYsogpPSgiMAJcPsqGDJjCoLNYJGumA8Hbrcxyv4/Um54whFm7C8mWRjE3c3nFv8lD/kl3s7GGsrViAxgj4rs1IZZ/4B3ED7IGu57u0v6+3z1aFNJl0B93Lg/K0WFGdD5rRhEW61cCXwQ8iNyc0Q4+2UAbMOp9747EYFe1eSK0aRg6OKpCVp3TBNKp1sZQBAV73/VjuHv1LAAMD8fph1JOzVphCmDVn//raqzujB+GhQk4bucye3Ye6vvFeAPuA9Mg/VxIqWMbxcCsJ/CPB5ffrBc/MGc5ETjRB0WzuUmDB+4SDfuFMjvA34zNGHRnVr/1FgbNjTY1amV60kiw==
[Relay 2] [Relay] Decoded session_key_enc (hex): e36c1d698b288293d282230025c3eca860c98c2a0b358246ba603c1dbadcc72bf8fd49b9e308459bb0bc9964631377379c5bfc943fe4977b3b186b2b562031823e2bb3521967fe01dc40fb206bb9eeed2febedf3d5a14d265d01f772e0fcad16146743e6b461116eb57025f043c88dc9cd10e3ed9401b30ea7def8ec46057b57922b469183a38aa42569dd304d2a9d6c65004057bdff563b87bf52c000c0fc7e987524ecd5a610a60d59fffeb6aacee8c1f868509386ee7327b761eeafbc57803ee03d320fd5c48a9631bc5c0ac27f08f0797dfac173f3067391138d10745b3b9498307ee120dfb85323bc0df8ccd18746756bff51606cd8d36356a657ad248b
[Relay 2] [Relay] Decrypting session key with fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] ERROR: RSA decryption failed: Decryption failed
[Relay 2] [Relay] [handle_message END] addr=('10.250.120.196', 51460), thread=6135197696
[Relay 3] [Relay] Deregistering from CDS and shutting down...
[Relay 1] [Relay] Deregistering from CDS and shutting down...
[Relay 2] [Relay] Deregistering from CDS and shutting down...
[Relay 1] [Relay] ERROR during deregistration: [Errno 54] Connection reset by peer
[Relay 2] [Relay] ERROR during deregistration: [Errno 54] Connection reset by peer
[Relay 3] [Relay] ERROR during deregistration: [Errno 54] Connection reset by peer
[Relay] ---- Relay process started ----
[Relay 1] [Relay] Loaded persistent RSA keypair from relay1_key.pem
[Relay 1] [Relay] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] [KEY] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] Relay 1 starting on 10.250.120.196:9101 (RELAY PORT 9101)
[Relay 1] Registering with CDS at 127.0.0.1:9000
[Relay 1] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9101, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5MM7/HBECV26fZqjUJkt\nQ4+dx297cL0hf1+rf08Qir5tL/lArfQsiplTqcsIsZiN7vJ8K2XzvK5JAEv8tVE4\nEKU4W1hbEVBd1eLCX+Oc5XauTbWhW8xlc2wdNlNwDhin2Mw84doKJWPyfjtIwnIi\n3nWHqxLyAqkj6qDoByA8D7YVmJxvzwL0mrYE8G8b4Q4Wjnx2SXeTwc9LRzqwrsyb\nlM5B4BSVPBignOMhD2AfuIFw6uULQThbkL9L5AnQA08B4Gqzo731LLJN/Y6qo+VJ\nki2t6m1aJTG0LBjijpH7CtnN1MHIQ5UueS1sJVYZooYxkxEYYZTqIUXxuI5ICKPC\nCQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 1] [Relay] Listening for incoming messages on port 9101 (RELAY PORT 9101)
[Relay] ---- Relay process started ----
[Relay 2] [Relay] Loaded persistent RSA keypair from relay2_key.pem
[Relay 2] [Relay] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] [KEY] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] Relay 2 starting on 10.250.120.196:9102 (RELAY PORT 9102)
[Relay 2] Registering with CDS at 127.0.0.1:9000
[Relay 2] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9102, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA58J3pSrOQd4hYnuzQQ7q\nWrjjo+3BJp+ik23brR2yl0kjtfH+wjD9LYWHS7dBxsDRzSozJ/7EWKKNCaTsgvaF\nN6vpyBPqDM/uQfOWfirteL50RgDZw95Vml4Fuay7bTBEb1J8ydvFqawo8rnLE2I3\nU4BjBT+CD38bY3je8wrrCX9fo1uYaLDlfteGshadZ2gnTxrAzkZZ/CTFdyb8JrmN\nIuxjBVjwSA/uIv+KHWQhXRA5jJPXcNV88LYXyEzpid1Cr9gnrqA88K0HSleiwZjU\nJF3LhBvS2Ga2HHfFsk5D/yz/pTHwDvRA98VMT/90wahwmSJsck4XWDFhmNhy3oDR\nBQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 2] [Relay] Listening for incoming messages on port 9102 (RELAY PORT 9102)
[Relay] ---- Relay process started ----
[Relay 3] [Relay] Loaded persistent RSA keypair from relay3_key.pem
[Relay 3] [Relay] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] [Relay] [KEY] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] Relay 3 starting on 10.250.120.196:9103 (RELAY PORT 9103)
[Relay 3] Registering with CDS at 127.0.0.1:9000
[Relay 3] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9103, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5k9OJ8m3IdjmwR1skM1G\nwrKkwlYLK0Qs+I/BX5ww5wEakOsTy5NVFAwTYrCUnR012u2jCwI8wV1YpPaMa8RJ\ntnqNFy4pFfqBh5tmidHQ3QMRvINPrGtQM5+VgMXoA0y8izql52M1K/3Q6sHVlAXd\nmpQcBO+JSHY7uyVx1txZssyisia7Nn8Frh/XRpl0oUvGkSnbm/KgqDAP0xJ3lUZS\nEGiIWdf0bn7tHD3nYBMrWWi3jSQWf0Q80asIEYWipwkfMPf0ffzu4FX0elfvpyOX\nr50xk7sb8K5IhcilwxKxQpPOcq3f6ph0EERQR7pOdDqkzFdHoGiyssSX4MYM60kd\nmQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 3] [Relay] Listening for incoming messages on port 9103 (RELAY PORT 9103)
[Relay] ---- Relay process started ----
[Relay 1] [Relay] Loaded persistent RSA keypair from relay1_key.pem
[Relay 1] [Relay] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] [KEY] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] Relay 1 starting on 10.250.120.196:9101 (RELAY PORT 9101)
[Relay 1] Registering with CDS at 127.0.0.1:9000
[Relay 1] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9101, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5MM7/HBECV26fZqjUJkt\nQ4+dx297cL0hf1+rf08Qir5tL/lArfQsiplTqcsIsZiN7vJ8K2XzvK5JAEv8tVE4\nEKU4W1hbEVBd1eLCX+Oc5XauTbWhW8xlc2wdNlNwDhin2Mw84doKJWPyfjtIwnIi\n3nWHqxLyAqkj6qDoByA8D7YVmJxvzwL0mrYE8G8b4Q4Wjnx2SXeTwc9LRzqwrsyb\nlM5B4BSVPBignOMhD2AfuIFw6uULQThbkL9L5AnQA08B4Gqzo731LLJN/Y6qo+VJ\nki2t6m1aJTG0LBjijpH7CtnN1MHIQ5UueS1sJVYZooYxkxEYYZTqIUXxuI5ICKPC\nCQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 1] [Relay] Listening for incoming messages on port 9101 (RELAY PORT 9101)
[Relay] ---- Relay process started ----
[Relay 2] [Relay] Loaded persistent RSA keypair from relay2_key.pem
[Relay 2] [Relay] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] [KEY] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] Relay 2 starting on 10.250.120.196:9102 (RELAY PORT 9102)
[Relay 2] Registering with CDS at 127.0.0.1:9000
[Relay 2] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9102, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA58J3pSrOQd4hYnuzQQ7q\nWrjjo+3BJp+ik23brR2yl0kjtfH+wjD9LYWHS7dBxsDRzSozJ/7EWKKNCaTsgvaF\nN6vpyBPqDM/uQfOWfirteL50RgDZw95Vml4Fuay7bTBEb1J8ydvFqawo8rnLE2I3\nU4BjBT+CD38bY3je8wrrCX9fo1uYaLDlfteGshadZ2gnTxrAzkZZ/CTFdyb8JrmN\nIuxjBVjwSA/uIv+KHWQhXRA5jJPXcNV88LYXyEzpid1Cr9gnrqA88K0HSleiwZjU\nJF3LhBvS2Ga2HHfFsk5D/yz/pTHwDvRA98VMT/90wahwmSJsck4XWDFhmNhy3oDR\nBQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 2] [Relay] Listening for incoming messages on port 9102 (RELAY PORT 9102)
[Relay] ---- Relay process started ----
[Relay 3] [Relay] Loaded persistent RSA keypair from relay3_key.pem
[Relay 3] [Relay] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] [Relay] [KEY] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] Relay 3 starting on 10.250.120.196:9103 (RELAY PORT 9103)
[Relay 3] Registering with CDS at 127.0.0.1:9000
[Relay 3] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9103, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5k9OJ8m3IdjmwR1skM1G\nwrKkwlYLK0Qs+I/BX5ww5wEakOsTy5NVFAwTYrCUnR012u2jCwI8wV1YpPaMa8RJ\ntnqNFy4pFfqBh5tmidHQ3QMRvINPrGtQM5+VgMXoA0y8izql52M1K/3Q6sHVlAXd\nmpQcBO+JSHY7uyVx1txZssyisia7Nn8Frh/XRpl0oUvGkSnbm/KgqDAP0xJ3lUZS\nEGiIWdf0bn7tHD3nYBMrWWi3jSQWf0Q80asIEYWipwkfMPf0ffzu4FX0elfvpyOX\nr50xk7sb8K5IhcilwxKxQpPOcq3f6ph0EERQR7pOdDqkzFdHoGiyssSX4MYM60kd\nmQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 3] [Relay] Listening for incoming messages on port 9103 (RELAY PORT 9103)
[Relay 3] [Relay] [handle_message ENTERED] addr=('10.250.120.196', 51801), thread=6126284800, relay_port=9103
[Relay 3] [Relay] [DEBUG] Raw data received: b'{"next_ip": "10.250.120.196", "next_port": 9103, "session_key": "ZayUbCzfcJgLETVHljulgAaVfpjRRO7BDxvVObSBaVuPhyswUgYjjUTN2C87sonkUAD0VbJ0/YwU5+dLTNHnqUgW8Tzol6H4GC52tFdlEHBHBlGB6Du+e3YuYIXNBjmnR5ChSqSmsXKkFtyGl44S65RFWmzEGX4B9MZVEnIy3xGGrkp6JT57qGJoJKb3oa327RnZfdC4p1yIBW5USRIkLX8uX0MqdxhodOCvGw3MsQOf8urxk3kwV/lOWPB2ZeQ+fTtIm8lDJJft/BPqEYMg5yD2YYjgkHuB4WquHvbBMKownDme3WD6Zw7Y0Il+Mq6rhHSt5EyWUumgHLnHC7rcvw==", "payload": "X80/jxb/tirxOyaUjWXRLFWdaohH+sAtZ6wE4/zZwGxKc2jVYec3C+stweSXvSub1gAYAxfnpWA6sYtpv6IgeeCZm93+TQfATAKNidGfmXqiaFtcng/m+UVYit01tcR3mCE3YPXiZ9M8UtGrMlvW93kK/vhX9mF7RhSM5PYjHd8k+Qfg8wlu5dQ1jJtgbt3gggdvWfRI/6B0Km6OiXP04WYKe01heHSDAnDO6TQ3AcC77UK2v/CRrADyGK18j7S44TkgZuc9wIcexF71YulzF1xvsDOzxZGku825hcSqwK/lDC1RHhNuBy5IHBm5yD6IqeSX5gFgdnJFna3wkqv6SRKhuwvw7ibZYJ1SkDSVD8CJ8Ha0gD4omIKwL9Qj06BA3+pRO0Cn1ELR07a6VztUJT0Mmf5LTUbKiyvCRes5M16phaJ+DKgTcjzQ/sjAup9vqpVH3JweuEuRHk5ncr0OJ+cgiMV0wVBwKdu/s0/ylIgBKV1UXh7QrpnmIccTlN8nmezfvHxg/NxTGZSkTi0lR9umNmres9Mgkq/xcLyuMwA1URVAJmENmRkFCV5PMwrACtI5Cf7VKWFmRnON3C66q0IFCrHRCNZuHtFkJlBhEkHpT9it40XEPXIfcFjqa42jOZx2swAkW2s5K9QRgrT/zxDBLVUt7U5pIUdIDe2Nq6Fu20SVBn6Rn0xvseqAE6qWssY7dOQSdR8ScoRu82ZnfcILNALBb0hFmPIWOs8/+9mcD3yMsphiF/UFYWpqwvhO7hc9rhHogG+tan/hwcIPTNOmGFb1NdIUJ0+WsijtJO2yQq+C+qFplcrXhvfzxLs8k7E7VZENSlpDoRiXnrY2xAuJx2EnJ9cmaCT3tbgUb6Xnel0F+YKH0ULLXFoyYBtn33p3qfVGN4jvMXoPWiC4ynw4/KMrjRNv0WX6QYw7i8AD2alEs5HvxUG9I9f5WDQsJP/RNBuF88ZCKlzS5LesGbjy+ydxjuHYdTnGH9TkgcCR9TWASKpO/ip0dUW9AuDjshxsRZaM6GDEHxJrgZ+nFUHgDEByNQYQjGB3YIoqP3RBmkQbA/AHFlupHijGbSi52RzglVpOU9hV+5Wy4hdiyjnOLHi2+O9FN9PNFchPAC6Ype2SKEdwOeU+7yDbzQYG6/wmFldNfRiV/YjsrNarXKho2azGAPTHKu9V6exFXUEBE+Z/RJgxjjFaDfFMGHmz7dcW+PWVaTK8/WwI6cYvuDIKHk2+VHzTLC4uALjBc5b1KwV9iZ8zs4W7OAxVbLrcKb859YFhs6PRFUdYDrLLiG2Gaoka+dQ8zBaLeH7etCgYMFU6quzm28ZEAWXvlCWS2VGVIYRaDODy+KLxTdybVmAWn5hEvq8SeIzc8PQ09LfHCSzWQ8Uk0DvtRaLt7NN5b17ddHvHP/jyZmGLBzY="}'
[Relay 3] [Relay] [DEBUG] Data after JSON parse: type=<class 'dict'>, keys=['next_ip', 'next_port', 'session_key', 'payload']
[Relay 3] [Relay] Received session_key (base64): ZayUbCzfcJgLETVHljulgAaVfpjRRO7BDxvVObSBaVuPhyswUgYjjUTN2C87sonkUAD0VbJ0/YwU5+dLTNHnqUgW8Tzol6H4GC52tFdlEHBHBlGB6Du+e3YuYIXNBjmnR5ChSqSmsXKkFtyGl44S65RFWmzEGX4B9MZVEnIy3xGGrkp6JT57qGJoJKb3oa327RnZfdC4p1yIBW5USRIkLX8uX0MqdxhodOCvGw3MsQOf8urxk3kwV/lOWPB2ZeQ+fTtIm8lDJJft/BPqEYMg5yD2YYjgkHuB4WquHvbBMKownDme3WD6Zw7Y0Il+Mq6rhHSt5EyWUumgHLnHC7rcvw==
[Relay 3] [Relay] Decoded session_key_enc (hex): 65ac946c2cdf70980b113547963ba58006957e98d144eec10f1bd539b481695b8f872b305206238d44cdd82f3bb289e45000f455b274fd8c14e7e74b4cd1e7a94816f13ce897a1f8182e76b45765107047065181e83bbe7b762e6085cd0639a74790a14aa4a6b172a416dc86978e12eb94455a6cc4197e01f4c655127232df1186ae4a7a253e7ba8626824a6f7a1adf6ed19d97dd0b8a75c88056e544912242d7f2e5f432a77186874e0af1b0dccb1039ff2eaf193793057f94e58f07665e43e7d3b489bc9432497edfc13ea118320e720f66188e0907b81e16aae1ef6c130aa309c399edd60fa670ed8d0897e32aeab8474ade44c9652e9a01cb9c70bbadcbf
[Relay 3] [Relay] Decrypting session key with fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] [Relay] ERROR: RSA decryption failed: Decryption failed
[Relay 3] [Relay] [handle_message END] addr=('10.250.120.196', 51801), thread=6126284800
[Relay 2] [Relay] Deregistering from CDS and shutting down...
[Relay 3] [Relay] Deregistering from CDS and shutting down...
[Relay 1] [Relay] Deregistering from CDS and shutting down...
[Relay 3] [Relay] ERROR during deregistration: [Errno 54] Connection reset by peer
[Relay 1] [Relay] ERROR during deregistration: [Errno 54] Connection reset by peer
[Relay 2] [Relay] ERROR during deregistration: [Errno 54] Connection reset by peer
[Relay] ---- Relay process started ----
[Relay 1] [Relay] Loaded persistent RSA keypair from relay1_key.pem
[Relay 1] [Relay] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] [KEY] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] Relay 1 starting on 10.250.120.196:9101 (RELAY PORT 9101)
[Relay 1] Registering with CDS at 127.0.0.1:9000
[Relay 1] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9101, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5MM7/HBECV26fZqjUJkt\nQ4+dx297cL0hf1+rf08Qir5tL/lArfQsiplTqcsIsZiN7vJ8K2XzvK5JAEv8tVE4\nEKU4W1hbEVBd1eLCX+Oc5XauTbWhW8xlc2wdNlNwDhin2Mw84doKJWPyfjtIwnIi\n3nWHqxLyAqkj6qDoByA8D7YVmJxvzwL0mrYE8G8b4Q4Wjnx2SXeTwc9LRzqwrsyb\nlM5B4BSVPBignOMhD2AfuIFw6uULQThbkL9L5AnQA08B4Gqzo731LLJN/Y6qo+VJ\nki2t6m1aJTG0LBjijpH7CtnN1MHIQ5UueS1sJVYZooYxkxEYYZTqIUXxuI5ICKPC\nCQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 1] [Relay] Listening for incoming messages on port 9101 (RELAY PORT 9101)
[Relay] ---- Relay process started ----
[Relay 2] [Relay] Loaded persistent RSA keypair from relay2_key.pem
[Relay 2] [Relay] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] [KEY] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] Relay 2 starting on 10.250.120.196:9102 (RELAY PORT 9102)
[Relay 2] Registering with CDS at 127.0.0.1:9000
[Relay 2] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9102, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA58J3pSrOQd4hYnuzQQ7q\nWrjjo+3BJp+ik23brR2yl0kjtfH+wjD9LYWHS7dBxsDRzSozJ/7EWKKNCaTsgvaF\nN6vpyBPqDM/uQfOWfirteL50RgDZw95Vml4Fuay7bTBEb1J8ydvFqawo8rnLE2I3\nU4BjBT+CD38bY3je8wrrCX9fo1uYaLDlfteGshadZ2gnTxrAzkZZ/CTFdyb8JrmN\nIuxjBVjwSA/uIv+KHWQhXRA5jJPXcNV88LYXyEzpid1Cr9gnrqA88K0HSleiwZjU\nJF3LhBvS2Ga2HHfFsk5D/yz/pTHwDvRA98VMT/90wahwmSJsck4XWDFhmNhy3oDR\nBQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 2] [Relay] Listening for incoming messages on port 9102 (RELAY PORT 9102)
[Relay] ---- Relay process started ----
[Relay 3] [Relay] Loaded persistent RSA keypair from relay3_key.pem
[Relay 3] [Relay] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] [Relay] [KEY] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] Relay 3 starting on 10.250.120.196:9103 (RELAY PORT 9103)
[Relay 3] Registering with CDS at 127.0.0.1:9000
[Relay 3] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9103, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5k9OJ8m3IdjmwR1skM1G\nwrKkwlYLK0Qs+I/BX5ww5wEakOsTy5NVFAwTYrCUnR012u2jCwI8wV1YpPaMa8RJ\ntnqNFy4pFfqBh5tmidHQ3QMRvINPrGtQM5+VgMXoA0y8izql52M1K/3Q6sHVlAXd\nmpQcBO+JSHY7uyVx1txZssyisia7Nn8Frh/XRpl0oUvGkSnbm/KgqDAP0xJ3lUZS\nEGiIWdf0bn7tHD3nYBMrWWi3jSQWf0Q80asIEYWipwkfMPf0ffzu4FX0elfvpyOX\nr50xk7sb8K5IhcilwxKxQpPOcq3f6ph0EERQR7pOdDqkzFdHoGiyssSX4MYM60kd\nmQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 3] [Relay] Listening for incoming messages on port 9103 (RELAY PORT 9103)
[Relay 3] [Relay] Deregistering from CDS and shutting down...
[Relay 1] [Relay] Deregistering from CDS and shutting down...
[Relay 2] [Relay] Deregistering from CDS and shutting down...
[Relay 3] [Relay] ERROR during deregistration: [Errno 54] Connection reset by peer
[Relay 2] [Relay] ERROR during deregistration: [Errno 54] Connection reset by peer
[Relay 1] [Relay] ERROR during deregistration: [Errno 54] Connection reset by peer
[Relay] ---- Relay process started ----
[Relay 1] [Relay] Loaded persistent RSA keypair from relay1_key.pem
[Relay 1] [Relay] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] [KEY] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] Relay 1 starting on 10.250.120.196:9101 (RELAY PORT 9101)
[Relay 1] Registering with CDS at 127.0.0.1:9000
[Relay 1] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9101, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5MM7/HBECV26fZqjUJkt\nQ4+dx297cL0hf1+rf08Qir5tL/lArfQsiplTqcsIsZiN7vJ8K2XzvK5JAEv8tVE4\nEKU4W1hbEVBd1eLCX+Oc5XauTbWhW8xlc2wdNlNwDhin2Mw84doKJWPyfjtIwnIi\n3nWHqxLyAqkj6qDoByA8D7YVmJxvzwL0mrYE8G8b4Q4Wjnx2SXeTwc9LRzqwrsyb\nlM5B4BSVPBignOMhD2AfuIFw6uULQThbkL9L5AnQA08B4Gqzo731LLJN/Y6qo+VJ\nki2t6m1aJTG0LBjijpH7CtnN1MHIQ5UueS1sJVYZooYxkxEYYZTqIUXxuI5ICKPC\nCQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 1] [Relay] Listening for incoming messages on port 9101 (RELAY PORT 9101)
[Relay] ---- Relay process started ----
[Relay 2] [Relay] Loaded persistent RSA keypair from relay2_key.pem
[Relay 2] [Relay] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] [KEY] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] Relay 2 starting on 10.250.120.196:9102 (RELAY PORT 9102)
[Relay 2] Registering with CDS at 127.0.0.1:9000
[Relay 2] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9102, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA58J3pSrOQd4hYnuzQQ7q\nWrjjo+3BJp+ik23brR2yl0kjtfH+wjD9LYWHS7dBxsDRzSozJ/7EWKKNCaTsgvaF\nN6vpyBPqDM/uQfOWfirteL50RgDZw95Vml4Fuay7bTBEb1J8ydvFqawo8rnLE2I3\nU4BjBT+CD38bY3je8wrrCX9fo1uYaLDlfteGshadZ2gnTxrAzkZZ/CTFdyb8JrmN\nIuxjBVjwSA/uIv+KHWQhXRA5jJPXcNV88LYXyEzpid1Cr9gnrqA88K0HSleiwZjU\nJF3LhBvS2Ga2HHfFsk5D/yz/pTHwDvRA98VMT/90wahwmSJsck4XWDFhmNhy3oDR\nBQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 2] [Relay] Listening for incoming messages on port 9102 (RELAY PORT 9102)
[Relay] ---- Relay process started ----
[Relay 3] [Relay] Loaded persistent RSA keypair from relay3_key.pem
[Relay 3] [Relay] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] [Relay] [KEY] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] Relay 3 starting on 10.250.120.196:9103 (RELAY PORT 9103)
[Relay 3] Registering with CDS at 127.0.0.1:9000
[Relay 3] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9103, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5k9OJ8m3IdjmwR1skM1G\nwrKkwlYLK0Qs+I/BX5ww5wEakOsTy5NVFAwTYrCUnR012u2jCwI8wV1YpPaMa8RJ\ntnqNFy4pFfqBh5tmidHQ3QMRvINPrGtQM5+VgMXoA0y8izql52M1K/3Q6sHVlAXd\nmpQcBO+JSHY7uyVx1txZssyisia7Nn8Frh/XRpl0oUvGkSnbm/KgqDAP0xJ3lUZS\nEGiIWdf0bn7tHD3nYBMrWWi3jSQWf0Q80asIEYWipwkfMPf0ffzu4FX0elfvpyOX\nr50xk7sb8K5IhcilwxKxQpPOcq3f6ph0EERQR7pOdDqkzFdHoGiyssSX4MYM60kd\nmQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 3] [Relay] Listening for incoming messages on port 9103 (RELAY PORT 9103)
[Relay 1] [Relay] [handle_message ENTERED] addr=('10.250.120.196', 52141), thread=6159282176, relay_port=9101
[Relay 1] [Relay] [DEBUG] Raw data received: b'{"next_ip": "10.250.120.196", "next_port": 9101, "session_key": "MoCBjc0VDnfBghH+AjQ9LT7qonzBZG43SGJNxc+BCb6tqEGVgpmcqPBy0ucYvpdJccZWyYdzPeqWE2a+lDLwXEmn6dcnkvWHUQdA3/5hUv1jJ9OtcOghAc2aFK/3n4MSjwqV3O4loqVRhu8Pz2QYRZMEBjH+mWYX6wRwBqhpRNnsPSiny/x5fS1CFz3HsFJWt/7h+5DOqZZa7hv8HcSk7NttnWFpAwgE+TtZQFy3WX+Zxrz8Xls+je/9IH2CTmdCFe7pyURxxR6KCpBxgkrdSwjx5g5+CcdAGYIFTNqbl0cCaJdsEMEFT2gUEjMrwfMqC94s0PFgrR4dD9iuqYMu5A==", "payload": "NrHRF/6fxIl84U12phS9DMr+On6GvZU88lvbSznaXKaweYExiGCFG9x5qgt7bJGfgUQs2lmBF+AwdxiUhZZN0iw7U+mo+z73vkdPUsj7CuXntImjIQJi3Aqq/dspEiLm+WOSjsGZZgvII0/TKNBz7ckj9iq0qUMXsXdb5/qbbS1GYujqQg7R6glJ6LMQ4cmWin7f1oyKG8En/8X+f/140AFuXlXexvcHQMllGGVpa2/3H27V5Icb4DpKWcqLo7PG0tqUZi3KBnj3l8scRLe1gjIiISNfLDJlDsd8eDugTB+0sBEGcl5yVWn/pEdBKAqbilrjRGyoOhS3tgedHxh2yZ7EXD4+BFhY8HEhAtwsSj/K5s8BbQrKTYH9NiqrhXtzZnAef928qHmIBjCzqQTwBDqJK8JzFmJoN5hJBNYWe7JxC14HHEWTZM+OMjtjTabpXV9S+AQzzZVd2bUBwbFqcfYUMRqmOooxeFiZSfvrCTJsxMCKH0eIgRpTVr7UZcJmmzpluYxG3/G8LfqsiIUBZef4h+kzpGla5tZBJUCyF8SzXU+cKtHzOW1IAqyIizjcPbcozI9FHVKbgs4KzG8Lif4lE0eqx2u56ZrEWEWurdQD5yK5qQ=="}'
[Relay 1] [Relay] [DEBUG] Data after JSON parse: type=<class 'dict'>, keys=['next_ip', 'next_port', 'session_key', 'payload']
[Relay 1] [Relay] Received session_key (base64): MoCBjc0VDnfBghH+AjQ9LT7qonzBZG43SGJNxc+BCb6tqEGVgpmcqPBy0ucYvpdJccZWyYdzPeqWE2a+lDLwXEmn6dcnkvWHUQdA3/5hUv1jJ9OtcOghAc2aFK/3n4MSjwqV3O4loqVRhu8Pz2QYRZMEBjH+mWYX6wRwBqhpRNnsPSiny/x5fS1CFz3HsFJWt/7h+5DOqZZa7hv8HcSk7NttnWFpAwgE+TtZQFy3WX+Zxrz8Xls+je/9IH2CTmdCFe7pyURxxR6KCpBxgkrdSwjx5g5+CcdAGYIFTNqbl0cCaJdsEMEFT2gUEjMrwfMqC94s0PFgrR4dD9iuqYMu5A==
[Relay 1] [Relay] Decoded session_key_enc (hex): 3280818dcd150e77c18211fe02343d2d3eeaa27cc1646e3748624dc5cf8109beada8419582999ca8f072d2e718be974971c656c987733dea961366be9432f05c49a7e9d72792f587510740dffe6152fd6327d3ad70e82101cd9a14aff79f83128f0a95dcee25a2a55186ef0fcf64184593040631fe996617eb047006a86944d9ec3d28a7cbfc797d2d42173dc7b05256b7fee1fb90cea9965aee1bfc1dc4a4ecdb6d9d6169030804f93b59405cb7597f99c6bcfc5e5b3e8deffd207d824e674215eee9c94471c51e8a0a9071824add4b08f1e60e7e09c7401982054cda9b97470268976c10c1054f681412332bc1f32a0bde2cd0f160ad1e1d0fd8aea9832ee4
[Relay 1] [Relay] Decrypting session key with fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] ERROR: RSA decryption failed: Decryption failed
[Relay 2] [Relay] Deregistering from CDS and shutting down...
[Relay 1] [Relay] [handle_message END] addr=('10.250.120.196', 52141), thread=6159282176
[Relay 1] [Relay] Deregistering from CDS and shutting down...
[Relay 3] [Relay] Deregistering from CDS and shutting down...
[Relay 1] [Relay] ERROR during deregistration: [Errno 54] Connection reset by peer
[Relay 2] [Relay] ERROR during deregistration: [Errno 54] Connection reset by peer
[Relay 3] [Relay] ERROR during deregistration: [Errno 54] Connection reset by peer
[Relay] ---- Relay process started ----
[Relay 1] [Relay] Loaded persistent RSA keypair from relay1_key.pem
[Relay 1] [Relay] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] [KEY] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] Relay 1 starting on 10.250.120.196:9101 (RELAY PORT 9101)
[Relay 1] Registering with CDS at 127.0.0.1:9000
[Relay 1] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9101, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5MM7/HBECV26fZqjUJkt\nQ4+dx297cL0hf1+rf08Qir5tL/lArfQsiplTqcsIsZiN7vJ8K2XzvK5JAEv8tVE4\nEKU4W1hbEVBd1eLCX+Oc5XauTbWhW8xlc2wdNlNwDhin2Mw84doKJWPyfjtIwnIi\n3nWHqxLyAqkj6qDoByA8D7YVmJxvzwL0mrYE8G8b4Q4Wjnx2SXeTwc9LRzqwrsyb\nlM5B4BSVPBignOMhD2AfuIFw6uULQThbkL9L5AnQA08B4Gqzo731LLJN/Y6qo+VJ\nki2t6m1aJTG0LBjijpH7CtnN1MHIQ5UueS1sJVYZooYxkxEYYZTqIUXxuI5ICKPC\nCQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 1] [Relay] Listening for incoming messages on port 9101 (RELAY PORT 9101)
[Relay] ---- Relay process started ----
[Relay 2] [Relay] Loaded persistent RSA keypair from relay2_key.pem
[Relay 2] [Relay] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] [KEY] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] Relay 2 starting on 10.250.120.196:9102 (RELAY PORT 9102)
[Relay 2] Registering with CDS at 127.0.0.1:9000
[Relay 2] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9102, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA58J3pSrOQd4hYnuzQQ7q\nWrjjo+3BJp+ik23brR2yl0kjtfH+wjD9LYWHS7dBxsDRzSozJ/7EWKKNCaTsgvaF\nN6vpyBPqDM/uQfOWfirteL50RgDZw95Vml4Fuay7bTBEb1J8ydvFqawo8rnLE2I3\nU4BjBT+CD38bY3je8wrrCX9fo1uYaLDlfteGshadZ2gnTxrAzkZZ/CTFdyb8JrmN\nIuxjBVjwSA/uIv+KHWQhXRA5jJPXcNV88LYXyEzpid1Cr9gnrqA88K0HSleiwZjU\nJF3LhBvS2Ga2HHfFsk5D/yz/pTHwDvRA98VMT/90wahwmSJsck4XWDFhmNhy3oDR\nBQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 2] [Relay] Listening for incoming messages on port 9102 (RELAY PORT 9102)
[Relay] ---- Relay process started ----
[Relay 3] [Relay] Loaded persistent RSA keypair from relay3_key.pem
[Relay 3] [Relay] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] [Relay] [KEY] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] Relay 3 starting on 10.250.120.196:9103 (RELAY PORT 9103)
[Relay 3] Registering with CDS at 127.0.0.1:9000
[Relay 3] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9103, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5k9OJ8m3IdjmwR1skM1G\nwrKkwlYLK0Qs+I/BX5ww5wEakOsTy5NVFAwTYrCUnR012u2jCwI8wV1YpPaMa8RJ\ntnqNFy4pFfqBh5tmidHQ3QMRvINPrGtQM5+VgMXoA0y8izql52M1K/3Q6sHVlAXd\nmpQcBO+JSHY7uyVx1txZssyisia7Nn8Frh/XRpl0oUvGkSnbm/KgqDAP0xJ3lUZS\nEGiIWdf0bn7tHD3nYBMrWWi3jSQWf0Q80asIEYWipwkfMPf0ffzu4FX0elfvpyOX\nr50xk7sb8K5IhcilwxKxQpPOcq3f6ph0EERQR7pOdDqkzFdHoGiyssSX4MYM60kd\nmQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 3] [Relay] Listening for incoming messages on port 9103 (RELAY PORT 9103)
[Relay 2] [Relay] [handle_message ENTERED] addr=('10.250.120.196', 52582), thread=6136082432, relay_port=9102
[Relay 2] [Relay] [DEBUG] Raw data received: b'{"next_ip": "10.250.120.196", "next_port": 9101, "session_key": "5rfuM3gSS4mOnCP3Dxfad9Vcqu731nWXXNekY7ftvObJvZe4jyIBQxLh7RZHbGm4NucZwFWfz4s0lLqeVL29veHZdO5YS5wKHvYDfc+XjgJaK9wBIpaG2nRmH7O3xIlK5oQX3DqaNuNfveEX0elwu4iAyMFRqxaOk/sEkhWZT6YnCwoLVyWPXCH7AxCSywAcsFJmyI+y9wHWHE8aSL1u64Y9n6XBiq55qGN0QJHMwRN479OaL2TP46/gIiExeRoRj7k5/m3jk/2AYcrW+BjGzrRSaZ/fCvlowzfz63b+A72GYtNKl09sa19NkfzkEVSchHm4jQ3Jv/UClKyjUbkTwQ==", "payload": "FtMw2psRDDD4isMZG81e+OpqO2lgcl1uDC9GNbGGUKRPWdeAMKsdRh6BG1AalbXSequ2m+PrEMQn8WBPy/7Dlj1gCfae1y3+7+Dm5tENdzX0E0OyrOtn7FaAjmS2mBDUXLLdMBqV1PuuEFakKUBHif/pfGmIWcJeodf13xI7W1MO8CC+Wobk9kPCOSuenz38IPR+vV6frWXvBcca6pV/4eGfboExNwhNmg4CQExGzCj8b6ZIh8FlEAxtfuyqLNAI+kI3oeW2QP1dGv0xlNnMNFNgtxgYKErzL/eK7nzlVQID9aaLTJ5BtTBQsA6+ELiigPRH3toDY5D+zWpfup+alDWLG63V+oY3VC6yRCXdEO9AOPr9mQga5BMXlWl6dStEhjmv0jXTPgmaRFmr56pl1F5RMbHo+2RBRWVtgjvTlaMB2Y8HZ5jBerYcPt/qh30tMp33tqBq+HDSfSbyUGg0CdG1ChqiAhkWQLoo/RN6D2YgUt8TMwYrfwISAQVpuRYIGwmvBDjWa8JtYgMIfgX5fyfdNKjwzKBuYNR0zCD4SQuR1TRPJXrEVxWaEJBfW2jnAVuVl25MRLHDY4SvWfyZEhZR38SJhoodrzHgMSuK+9g/elkfAQ=="}'
[Relay 2] [Relay] [DEBUG] Data after JSON parse: type=<class 'dict'>, keys=['next_ip', 'next_port', 'session_key', 'payload']
[Relay 2] [Relay] Received session_key (base64): 5rfuM3gSS4mOnCP3Dxfad9Vcqu731nWXXNekY7ftvObJvZe4jyIBQxLh7RZHbGm4NucZwFWfz4s0lLqeVL29veHZdO5YS5wKHvYDfc+XjgJaK9wBIpaG2nRmH7O3xIlK5oQX3DqaNuNfveEX0elwu4iAyMFRqxaOk/sEkhWZT6YnCwoLVyWPXCH7AxCSywAcsFJmyI+y9wHWHE8aSL1u64Y9n6XBiq55qGN0QJHMwRN479OaL2TP46/gIiExeRoRj7k5/m3jk/2AYcrW+BjGzrRSaZ/fCvlowzfz63b+A72GYtNKl09sa19NkfzkEVSchHm4jQ3Jv/UClKyjUbkTwQ==
[Relay 2] [Relay] Decoded session_key_enc (hex): e6b7ee3378124b898e9c23f70f17da77d55caaeef7d675975cd7a463b7edbce6c9bd97b88f22014312e1ed16476c69b836e719c0559fcf8b3494ba9e54bdbdbde1d974ee584b9c0a1ef6037dcf978e025a2bdc01229686da74661fb3b7c4894ae68417dc3a9a36e35fbde117d1e970bb8880c8c151ab168e93fb049215994fa6270b0a0b57258f5c21fb031092cb001cb05266c88fb2f701d61c4f1a48bd6eeb863d9fa5c18aae79a863744091ccc11378efd39a2f64cfe3afe0222131791a118fb939fe6de393fd8061cad6f818c6ceb452699fdf0af968c337f3eb76fe03bd8662d34a974f6c6b5f4d91fce411549c8479b88d0dc9bff50294aca351b913c1
[Relay 2] [Relay] Decrypting session key with fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] Decrypted session_key (hex): f37e8299c25d8d463246b8f0f103769e19e2666cef388e1c8b016190c9717c04
[Relay 2] [Relay] [DEBUG] About to AES-decrypt payload (passing base64 string directly)
[Relay 2] [Relay] [DEBUG] Payload base64-decoded: type=<class 'bytes'>, len=469, preview=b"\x16\xd30\xda\x9b\x11\x0c0\xf8\x8a\xc3\x19\x1b\xcd^\xf8\xeaj;i`r]n\x0c/F5\xb1\x86P\xa4OY\xd7\x800\xab\x1dF\x1e\x81\x1bP\x1a\x95\xb5\xd2z\xab\xb6\x9b\xe3\xeb\x10\xc4'\xf1`O"
[Relay 2] [Relay] [DEBUG] AES-decrypted payload: type=<class 'bytes'>, len=453, preview=b'\xa8\xb1\x0c\xb7\xee\x84N\x89\xdbv\xec} D\x9eO\xba\xf7\xb4\xf1\xb00\xcb\x17\xbb\x99\xc2ia\x9a\x0c\xa4\x976\xb6\xbc\xdd\x05\x12\t\x02K\x0e\x04\x80sT\x1cBY\x86-\xb81\xcfX\xaf\xc3E('
[Relay 2] [Relay] [DEBUG] AES-decrypted payload (hex): a8b10cb7ee844e89db76ec7d20449e4fbaf7b4f1b030cb17bb99c269619a0ca49736b6bcdd051209024b0e048073541c4259862db831cf58afc34528
[Relay 2] [Relay] [DEBUG] Payload is not JSON, assuming last hop. Error: 'utf-8' codec can't decode byte 0xa8 in position 0: invalid start byte
[Relay 2] [Relay] [Last Hop] Forwarding payload to dest 127.0.0.1:9100, len=453, type=<class 'bytes'>
[Relay 2] [Relay] [Last Hop] Sending to dest: type=<class 'bytes'>, len=453, preview=b'\xa8\xb1\x0c\xb7\xee\x84N\x89\xdbv\xec} D\x9eO\xba\xf7\xb4\xf1\xb00\xcb\x17\xb
[Relay 2] [Relay] [Last Hop] Received response from dest: type=<class 'bytes'>, len=56, preview=b'RVJST1I6IENvdWxkIG5vdCBkZWNvZGUgcGF5bG9hZCBhcyBKU09OLg=='
[Relay 2] [Relay] [Last Hop] Response from dest decoded as UTF-8: 'RVJST1I6IENvdWxkIG5vdCBkZWNvZGUgcGF5bG9hZCBhcyBKU09OLg=='
[Relay 2] [Relay] [Last Hop] Response from dest (hex): 52564a535431493649454e766457786b494735766443426b5a574e765a47556763474635624739685a4342686379424b5530394f4c673d3d
[Relay 2] [Relay] [Last Hop] About to AES-encrypt response: type=<class 'bytes'>, len=56, preview=b'RVJST1I6IENvdWxkIG5vdCBkZWNvZGUgcGF5bG9hZCBhcyBKU09OLg=='
[Relay 2] [Relay] [Last Hop] AES-encrypted response (hex): 7ef08b5698f046e7c8cb069bb904f4f77e3d7859911a05472d3a702c0849114ade8c1625b4d6e7800124846e3ef7937939de03b17cc07292c7788a87
[Relay 2] [Relay] [Last Hop] Base64-encoded AES-encrypted response: type=<class 'bytes'>, len=96, preview=b'fvCLVpjwRufIywabuQT09349eFmRGgVHLTpwLAhJEUrejBYltNbngAEkhG4+'
[Relay 1] [Relay] Deregistering from CDS and shutting down...
[Relay 3] [Relay] Deregistering from CDS and shutting down...
[Relay 2] [Relay] [Last Hop] Sent response to ('10.250.120.196', 52582): b'fvCLVpjwRufIywabuQT09349eFmRGgVHLTpwLAhJEUrejBYltNbngAEkhG4+'... (len=96)
[Relay 2] [Relay] Deregistering from CDS and shutting down...
[Relay 2] [Relay] [handle_message END] addr=('10.250.120.196', 52582), thread=6136082432
[Relay 1] [Relay] ERROR during deregistration: [Errno 54] Connection reset by peer
[Relay 3] [Relay] ERROR during deregistration: [Errno 54] Connection reset by peer
[Relay 2] [Relay] ERROR during deregistration: [Errno 32] Broken pipe
[Relay] ---- Relay process started ----
[Relay 1] [Relay] Loaded persistent RSA keypair from relay1_key.pem
[Relay 1] [Relay] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] [KEY] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] Relay 1 starting on 10.250.120.196:9101 (RELAY PORT 9101)
[Relay 1] Registering with CDS at 127.0.0.1:9000
[Relay 1] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9101, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5MM7/HBECV26fZqjUJkt\nQ4+dx297cL0hf1+rf08Qir5tL/lArfQsiplTqcsIsZiN7vJ8K2XzvK5JAEv8tVE4\nEKU4W1hbEVBd1eLCX+Oc5XauTbWhW8xlc2wdNlNwDhin2Mw84doKJWPyfjtIwnIi\n3nWHqxLyAqkj6qDoByA8D7YVmJxvzwL0mrYE8G8b4Q4Wjnx2SXeTwc9LRzqwrsyb\nlM5B4BSVPBignOMhD2AfuIFw6uULQThbkL9L5AnQA08B4Gqzo731LLJN/Y6qo+VJ\nki2t6m1aJTG0LBjijpH7CtnN1MHIQ5UueS1sJVYZooYxkxEYYZTqIUXxuI5ICKPC\nCQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 1] [Relay] Listening for incoming messages on port 9101 (RELAY PORT 9101)
[Relay] ---- Relay process started ----
[Relay 2] [Relay] Loaded persistent RSA keypair from relay2_key.pem
[Relay 2] [Relay] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] [KEY] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] Relay 2 starting on 10.250.120.196:9102 (RELAY PORT 9102)
[Relay 2] Registering with CDS at 127.0.0.1:9000
[Relay 2] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9102, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA58J3pSrOQd4hYnuzQQ7q\nWrjjo+3BJp+ik23brR2yl0kjtfH+wjD9LYWHS7dBxsDRzSozJ/7EWKKNCaTsgvaF\nN6vpyBPqDM/uQfOWfirteL50RgDZw95Vml4Fuay7bTBEb1J8ydvFqawo8rnLE2I3\nU4BjBT+CD38bY3je8wrrCX9fo1uYaLDlfteGshadZ2gnTxrAzkZZ/CTFdyb8JrmN\nIuxjBVjwSA/uIv+KHWQhXRA5jJPXcNV88LYXyEzpid1Cr9gnrqA88K0HSleiwZjU\nJF3LhBvS2Ga2HHfFsk5D/yz/pTHwDvRA98VMT/90wahwmSJsck4XWDFhmNhy3oDR\nBQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 2] [Relay] Listening for incoming messages on port 9102 (RELAY PORT 9102)
[Relay] ---- Relay process started ----
[Relay 3] [Relay] Loaded persistent RSA keypair from relay3_key.pem
[Relay 3] [Relay] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] [Relay] [KEY] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] Relay 3 starting on 10.250.120.196:9103 (RELAY PORT 9103)
[Relay 3] Registering with CDS at 127.0.0.1:9000
[Relay 3] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9103, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5k9OJ8m3IdjmwR1skM1G\nwrKkwlYLK0Qs+I/BX5ww5wEakOsTy5NVFAwTYrCUnR012u2jCwI8wV1YpPaMa8RJ\ntnqNFy4pFfqBh5tmidHQ3QMRvINPrGtQM5+VgMXoA0y8izql52M1K/3Q6sHVlAXd\nmpQcBO+JSHY7uyVx1txZssyisia7Nn8Frh/XRpl0oUvGkSnbm/KgqDAP0xJ3lUZS\nEGiIWdf0bn7tHD3nYBMrWWi3jSQWf0Q80asIEYWipwkfMPf0ffzu4FX0elfvpyOX\nr50xk7sb8K5IhcilwxKxQpPOcq3f6ph0EERQR7pOdDqkzFdHoGiyssSX4MYM60kd\nmQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 3] [Relay] Listening for incoming messages on port 9103 (RELAY PORT 9103)
[Relay 1] [Relay] [handle_message ENTERED] addr=('10.250.120.196', 52964), thread=6168637440, relay_port=9101
[Relay 1] [Relay] [DEBUG] Raw data received: b'{"next_ip": "10.250.120.196", "next_port": 9102, "session_key": "Qo2ZYA2TVtLqCcNglNdTqgi9s82SxtqhsxckkwRNCCOuGdQiSVyAKLtwipzW4+5SIb8qlzLrKfSrtfghk+MMWE+4EXiOTKJhQ1bmHwXZVvqvCV8MUKnwCYzWn66RcODKiQS6o7HWKK3G98GQ67hEVxf3YchhmJiSep3o8j09a95Qm3FwtHBqac5MlMl8QJ3VCbk26hWfBXN7A8Y9eP+KckvHtO35+oBeq4haCNddB6o7x8GwSa66ngG7+NKhYGVGaG7P50OzxDgYKgQFis+uTFrJgIvze37gmE5R2m+u5Ecx4VYTTSYpvNJtRcUGdoentByiLI/UU8A+HPU1CcTmHQ==", "payload": "DVoVdxmJEyXdxDNx4rraQ5pJGgaYQfemgGgcrdX8Ye0xMUy+ovQhCo6sllc70gdiepLenaeVPAsBR4fP/mKPlh+HC2IO7OQ08CvAyRp17Sd2RXiMSlpwpCcjp/FfhcV1TSnqR70n1oFCbuzniC3BBCSVLRVjEWi3czVgH1fTia13TmoaB+kHG5e2NzkB7D4+Xt9FDp4wbx1w6oor1QdJyZng8KdxaGMY9hZuNUIDE0EPXqKtpn1FQ82jOX3pmnZuiSbNgpyRMICsIW7VEnPxnJPTmvDtSl5aLxfaOvSRgyMMdD5jKILQbbehCIVLP1MvaKShYidJ2hrPgXryPBE/xVXjmwoR1BB5giNNYyOx0UmufYldYvtIWXQopEAtaiEJ0r+hb1hQHWYYDsbbLkWuEu7UYXJ7a2PChoQhOTEyVfBULYn6coqh79/lVrGCAykCVk5nruImU/u/m2eKGnOydRLJCWxhThR2UINxcFCDFeonu0EzI+pORgnQ75T4p5DniYLD589RY7np5ZTDifuJhOt33D+FQJpiTIALHTy3etAyh1XnGyKj47s+hzlZk/HcL9iscxzlJTtIrH6uyQXvMnuZWxmcdGGutC1HSYMBVrQ1pHD+Yg=="}'
[Relay 1] [Relay] [DEBUG] Data after JSON parse: type=<class 'dict'>, keys=['next_ip', 'next_port', 'session_key', 'payload']
[Relay 1] [Relay] Received session_key (base64): Qo2ZYA2TVtLqCcNglNdTqgi9s82SxtqhsxckkwRNCCOuGdQiSVyAKLtwipzW4+5SIb8qlzLrKfSrtfghk+MMWE+4EXiOTKJhQ1bmHwXZVvqvCV8MUKnwCYzWn66RcODKiQS6o7HWKK3G98GQ67hEVxf3YchhmJiSep3o8j09a95Qm3FwtHBqac5MlMl8QJ3VCbk26hWfBXN7A8Y9eP+KckvHtO35+oBeq4haCNddB6o7x8GwSa66ngG7+NKhYGVGaG7P50OzxDgYKgQFis+uTFrJgIvze37gmE5R2m+u5Ecx4VYTTSYpvNJtRcUGdoentByiLI/UU8A+HPU1CcTmHQ==
[Relay 1] [Relay] Decoded session_key_enc (hex): 428d99600d9356d2ea09c36094d753aa08bdb3cd92c6daa1b3172493044d0823ae19d422495c8028bb708a9cd6e3ee5221bf2a9732eb29f4abb5f82193e30c584fb811788e4ca2614356e61f05d956faaf095f0c50a9f0098cd69fae9170e0ca8904baa3b1d628adc6f7c190ebb8445717f761c8619898927a9de8f23d3d6bde509b7170b4706a69ce4c94c97c409dd509b936ea159f05737b03c63d78ff8a724bc7b4edf9fa805eab885a08d75d07aa3bc7c1b049aeba9e01bbf8d2a1606546686ecfe743b3c438182a04058acfae4c5ac9808bf37b7ee0984e51da6faee44731e156134d2629bcd26d45c5067687a7b41ca22c8fd453c03e1cf53509c4e61d
[Relay 1] [Relay] Decrypting session key with fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] Decrypted session_key (hex): faa515ccfcb956fc266c7c474abd77c7c21ef258046600f9644226616d896445
[Relay 1] [Relay] [DEBUG] About to AES-decrypt payload (passing base64 string directly)
[Relay 1] [Relay] [DEBUG] Payload base64-decoded: type=<class 'bytes'>, len=469, preview=b'\rZ\x15w\x19\x89\x13%\xdd\xc43q\xe2\xba\xdaC\x9aI\x1a\x06\x98A\xf7\xa6\x80h\x1c\xad\xd5\xfca\xed11L\xbe\xa2\xf4!\n\x8e\xac\x96W;\xd2\x07bz\x92\xde\x9d\xa7\x95<\x0b\x01G\x87\xcf'
[Relay 1] [Relay] [DEBUG] AES-decrypted payload: type=<class 'bytes'>, len=453, preview=b'\xbf\t\x97\xb7p\xce\xa5\x0c\xce%G\x15\xbc\x8d\x1f\x81U\xc3\x94Y\xfeT\x1e\xcd\xbf\x96O\xcf\x0f^\x02\x04\xa3\xf8b\x93*6 c\xf9\xd1\xe61h\xd2\x95j\xbb!-\xca\xe1\xc3<\xa8\x9a\xc5\xb7F'
[Relay 1] [Relay] [DEBUG] AES-decrypted payload (hex): bf0997b770cea50cce254715bc8d1f8155c39459fe541ecdbf964fcf0f5e0204a3f862932a362063f9d1e63168d2956abb212dcae1c33ca89ac5b746
[Relay 1] [Relay] [DEBUG] Payload is not JSON, assuming last hop. Error: 'utf-8' codec can't decode byte 0xbf in position 0: invalid start byte
[Relay 1] [Relay] [Last Hop] Forwarding payload to dest 127.0.0.1:9100, len=453, type=<class 'bytes'>
[Relay 1] [Relay] [Last Hop] Sending to dest: type=<class 'bytes'>, len=453, preview=b'\xbf\t\x97\xb7p\xce\xa5\x0c\xce%G\x15\xbc\x8d\x1f\x81U\xc3\x94Y\xfeT\x1e\xcd\x
[Relay 1] [Relay] [Last Hop] Received response from dest: type=<class 'bytes'>, len=56, preview=b'RVJST1I6IENvdWxkIG5vdCBkZWNvZGUgcGF5bG9hZCBhcyBKU09OLg=='
[Relay 1] [Relay] [Last Hop] Response to client (UTF-8 JSON): b'{"result": "OK", "echo": "RVJST1I6IENvdWxkIG5vdCBkZWNvZGUgcGF5bG9hZCBhcyBKU09OLg=="}'
[Relay 1] [Relay] [Last Hop] AES-encrypted response (hex): 93e919fede1059def241004a019787585c8d90f38b08228dc766a42e1f860579da42246a97bb9be06ae19f64eb009405430e6aae3f6f28d128be6fb0
[Relay 1] [Relay] [Last Hop] ERROR forwarding to dest: cannot access local variable 'base64' where it is not associated with a value
[Relay 1] [Relay] [handle_message END] addr=('10.250.120.196', 52964), thread=6168637440
[Relay 2] [Relay] Deregistering from CDS and shutting down...
[Relay 1] [Relay] Deregistering from CDS and shutting down...
[Relay 3] [Relay] Deregistering from CDS and shutting down...
[Relay 1] [Relay] ERROR during deregistration: [Errno 32] Broken pipe
[Relay 3] [Relay] ERROR during deregistration: [Errno 32] Broken pipe
[Relay 2] [Relay] ERROR during deregistration: [Errno 32] Broken pipe
[Relay] ---- Relay process started ----
[Relay 1] [Relay] Loaded persistent RSA keypair from relay1_key.pem
[Relay 1] [Relay] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] [KEY] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] Relay 1 starting on 10.250.120.196:9101 (RELAY PORT 9101)
[Relay 1] Registering with CDS at 127.0.0.1:9000
[Relay 1] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9101, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5MM7/HBECV26fZqjUJkt\nQ4+dx297cL0hf1+rf08Qir5tL/lArfQsiplTqcsIsZiN7vJ8K2XzvK5JAEv8tVE4\nEKU4W1hbEVBd1eLCX+Oc5XauTbWhW8xlc2wdNlNwDhin2Mw84doKJWPyfjtIwnIi\n3nWHqxLyAqkj6qDoByA8D7YVmJxvzwL0mrYE8G8b4Q4Wjnx2SXeTwc9LRzqwrsyb\nlM5B4BSVPBignOMhD2AfuIFw6uULQThbkL9L5AnQA08B4Gqzo731LLJN/Y6qo+VJ\nki2t6m1aJTG0LBjijpH7CtnN1MHIQ5UueS1sJVYZooYxkxEYYZTqIUXxuI5ICKPC\nCQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 1] [Relay] Listening for incoming messages on port 9101 (RELAY PORT 9101)
[Relay] ---- Relay process started ----
[Relay 2] [Relay] Loaded persistent RSA keypair from relay2_key.pem
[Relay 2] [Relay] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] [KEY] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] Relay 2 starting on 10.250.120.196:9102 (RELAY PORT 9102)
[Relay 2] Registering with CDS at 127.0.0.1:9000
[Relay 2] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9102, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA58J3pSrOQd4hYnuzQQ7q\nWrjjo+3BJp+ik23brR2yl0kjtfH+wjD9LYWHS7dBxsDRzSozJ/7EWKKNCaTsgvaF\nN6vpyBPqDM/uQfOWfirteL50RgDZw95Vml4Fuay7bTBEb1J8ydvFqawo8rnLE2I3\nU4BjBT+CD38bY3je8wrrCX9fo1uYaLDlfteGshadZ2gnTxrAzkZZ/CTFdyb8JrmN\nIuxjBVjwSA/uIv+KHWQhXRA5jJPXcNV88LYXyEzpid1Cr9gnrqA88K0HSleiwZjU\nJF3LhBvS2Ga2HHfFsk5D/yz/pTHwDvRA98VMT/90wahwmSJsck4XWDFhmNhy3oDR\nBQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 2] [Relay] Listening for incoming messages on port 9102 (RELAY PORT 9102)
[Relay] ---- Relay process started ----
[Relay 3] [Relay] Loaded persistent RSA keypair from relay3_key.pem
[Relay 3] [Relay] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] [Relay] [KEY] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] Relay 3 starting on 10.250.120.196:9103 (RELAY PORT 9103)
[Relay 3] Registering with CDS at 127.0.0.1:9000
[Relay 3] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9103, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5k9OJ8m3IdjmwR1skM1G\nwrKkwlYLK0Qs+I/BX5ww5wEakOsTy5NVFAwTYrCUnR012u2jCwI8wV1YpPaMa8RJ\ntnqNFy4pFfqBh5tmidHQ3QMRvINPrGtQM5+VgMXoA0y8izql52M1K/3Q6sHVlAXd\nmpQcBO+JSHY7uyVx1txZssyisia7Nn8Frh/XRpl0oUvGkSnbm/KgqDAP0xJ3lUZS\nEGiIWdf0bn7tHD3nYBMrWWi3jSQWf0Q80asIEYWipwkfMPf0ffzu4FX0elfvpyOX\nr50xk7sb8K5IhcilwxKxQpPOcq3f6ph0EERQR7pOdDqkzFdHoGiyssSX4MYM60kd\nmQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 3] [Relay] Listening for incoming messages on port 9103 (RELAY PORT 9103)
[Relay 1] [Relay] [handle_message ENTERED] addr=('10.250.120.196', 53367), thread=6133608448, relay_port=9101
[Relay 1] [Relay] [DEBUG] Raw data received: b'{"next_ip": "10.250.120.196", "next_port": 9103, "session_key": "OVO2Hz2Fo1/an+mi3ch2MntT8xZU0Xw/Z+9sDm+GJrQA66IwHTxm1u9nkQoU+sS+j74KTisHONamBmElZ/NF0LAgiDuG894mHebk7oAZV8dAnTnpB2/z0CLfB4+RNG8o2HoVaz+ZQUVKBDvl21MKBxOJxMumnQHE+x6fb4zRUJ2+b4Y+iheqiNA9mknoP1K98waefZ1ugWZ/w5BHNvkVZRaJGTfcWr05sDPcPu50o7cjlEDRQBsbjZ/dKIDpcu7rnnI7S466vKN1IPVOI+7wgm1+JzwRjsqlpPkzbnayCViA2m/CHo0536YsJ/av5ErlitunJ8ZIJSn8kOOWsQUiCQ==", "payload": "rbWW3ZDtGCrrr7arrfXahByselG3Of8T24ziRpBb2Q1D9eYPn4HPF1/m22BU6cfO5yVqTTq6YqMgPmytzLvML6FsZdSfKXLG9qhyXJYh8WZAR4Zi8+zj3xE588TVJDg7bxyO86Z3RfOr1uWjtrPTBZbAQ1kaKmV8j30sQqmgWPqj9LAxr/oUiQu4QEX4sTBr1YPpAjkQCDflBQXbAzQisIpEX68aI3CjrPEVC+k4yMxAZ/+08azE/lneWUav1OxppAaWU3NCxpb0zjWf23h+pb0NtUUd0xXsBI2RfTGEBDzRUGW7zePu1KCKzYUUnB6+XK+GX14rdtXcMqDHFROFm1lpKQgAHmvW4vO2W2dTOuX1LyVzc7J9UKsh43aRmajbyqBuskAwNFsIqHDOBQZyipc7FRfExdQEwa3GX92gl+VXS66gEWjyBcTXdOYBRXFDYdXahEJQLU8jeHak9F7nMzg7Y1Tj3U88uZOzbW0/qIaKQne4eILYmA72odOZHSqilWJZOn6NdFvYgbML8efDgCg+hB1Z0Rsq3fUhENHa1Qne2DlwkXkUm75TTuL7MC1BvhhLwoa2jEfD6ytilQAOQW5KR/I4XEoZlQubhGRXrnHXyitIWA=="}'
[Relay 1] [Relay] [DEBUG] Data after JSON parse: type=<class 'dict'>, keys=['next_ip', 'next_port', 'session_key', 'payload']
[Relay 1] [Relay] Received session_key (base64): OVO2Hz2Fo1/an+mi3ch2MntT8xZU0Xw/Z+9sDm+GJrQA66IwHTxm1u9nkQoU+sS+j74KTisHONamBmElZ/NF0LAgiDuG894mHebk7oAZV8dAnTnpB2/z0CLfB4+RNG8o2HoVaz+ZQUVKBDvl21MKBxOJxMumnQHE+x6fb4zRUJ2+b4Y+iheqiNA9mknoP1K98waefZ1ugWZ/w5BHNvkVZRaJGTfcWr05sDPcPu50o7cjlEDRQBsbjZ/dKIDpcu7rnnI7S466vKN1IPVOI+7wgm1+JzwRjsqlpPkzbnayCViA2m/CHo0536YsJ/av5ErlitunJ8ZIJSn8kOOWsQUiCQ==
[Relay 1] [Relay] Decoded session_key_enc (hex): 3953b61f3d85a35fda9fe9a2ddc876327b53f31654d17c3f67ef6c0e6f8626b400eba2301d3c66d6ef67910a14fac4be8fbe0a4e2b0738d6a606612567f345d0b020883b86f3de261de6e4ee801957c7409d39e9076ff3d022df078f91346f28d87a156b3f9941454a043be5db530a071389c4cba69d01c4fb1e9f6f8cd1509dbe6f863e8a17aa88d03d9a49e83f52bdf3069e7d9d6e81667fc3904736f9156516891937dc5abd39b033dc3eee74a3b7239440d1401b1b8d9fdd2880e972eeeb9e723b4b8ebabca37520f54e23eef0826d7e273c118ecaa5a4f9336e76b2095880da6fc21e8d39dfa62c27f6afe44ae58adba727c6482529fc90e396b1052209
[Relay 1] [Relay] Decrypting session key with fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] Decrypted session_key (hex): eef14ce568faefe95c289ed36a039aee816bc9a568eeab0f8113803c309d28ac
[Relay 1] [Relay] [DEBUG] About to AES-decrypt payload (passing base64 string directly)
[Relay 1] [Relay] [DEBUG] Payload base64-decoded: type=<class 'bytes'>, len=469, preview=b'\xad\xb5\x96\xdd\x90\xed\x18*\xeb\xaf\xb6\xab\xad\xf5\xda\x84\x1c\xaczQ\xb79\xff\x13\xdb\x8c\xe2F\x90[\xd9\rC\xf5\xe6\x0f\x9f\x81\xcf\x17_\xe6\xdb`T\xe9\xc7\xce\xe7%jM:\xbab\xa3 >l\xad'
[Relay 1] [Relay] [DEBUG] AES-decrypted payload: type=<class 'bytes'>, len=453, preview=b'\x90\xed!\x14Dk\xf1\xa8\xa49\xd0\xde\xf6T\xb1"\xec\x03\x17\ni\xef\x08\xab\xf2\xbc\x92y\xe1"\xa5F\x94jeh\xb8\xdd\r0\xb5\x16\x9b\xf2)K\xce^\xa8\xe48\xdf\x9a\x95\xd4#\xc9\x9c\'\xf1'
[Relay 1] [Relay] [DEBUG] AES-decrypted payload (hex): 90ed2114446bf1a8a439d0def654b122ec03170a69ef08abf2bc9279e122a546946a6568b8dd0d30b5169bf2294bce5ea8e438df9a95d423c99c27f1
[Relay 1] [Relay] [DEBUG] Payload is not JSON, assuming last hop. Error: 'utf-8' codec can't decode byte 0x90 in position 0: invalid start byte
[Relay 1] [Relay] [Last Hop] Forwarding payload to dest 127.0.0.1:9100, len=453, type=<class 'bytes'>
[Relay 1] [Relay] [Last Hop] Sending to dest: type=<class 'bytes'>, len=453, preview=b'\x90\xed!\x14Dk\xf1\xa8\xa49\xd0\xde\xf6T\xb1"\xec\x03\x17\ni\xef\x08\xab\xf2\
[Relay 1] [Relay] [Last Hop] Received response from dest: type=<class 'bytes'>, len=56, preview=b'RVJST1I6IENvdWxkIG5vdCBkZWNvZGUgcGF5bG9hZCBhcyBKU09OLg=='
[Relay 1] [Relay] [Last Hop] Response to client (UTF-8 JSON): b'{"result": "OK", "echo": "RVJST1I6IENvdWxkIG5vdCBkZWNvZGUgcGF5bG9hZCBhcyBKU09OLg=="}'
[Relay 1] [Relay] [Last Hop] AES-encrypted response (hex): 714d5ab7b387c8cebb8dfa117e5553af3f1be09b2d8555bbe0a0d9230cabaf12ee79bb0f1b574affa22ad7f93da70d1b67bad74da630b2caf53332f2
[Relay 1] [Relay] [Last Hop] Base64-encoded AES-encrypted response: type=<class 'bytes'>, len=136, preview=b'cU1at7OHyM67jfoRflVTrz8b4JsthVW74KDZIwyrrxLuebsPG1dK/6Iq1/k9'
[Relay 1] [Relay] [Last Hop] Sent response to ('10.250.120.196', 53367): b'cU1at7OHyM67jfoRflVTrz8b4JsthVW74KDZIwyrrxLuebsPG1dK/6Iq1/k9'... (len=136)
[Relay 2] [Relay] Deregistering from CDS and shutting down...
[Relay 3] [Relay] Deregistering from CDS and shutting down...
[Relay 1] [Relay] Deregistering from CDS and shutting down...
[Relay 1] [Relay] [handle_message END] addr=('10.250.120.196', 53367), thread=6133608448
[Relay 1] [Relay] ERROR during deregistration: [Errno 54] Connection reset by peer
[Relay 3] [Relay] ERROR during deregistration: [Errno 54] Connection reset by peer
[Relay 2] [Relay] ERROR during deregistration: [Errno 54] Connection reset by peer
[Relay] ---- Relay process started ----
[Relay 1] [Relay] Loaded persistent RSA keypair from relay1_key.pem
[Relay 1] [Relay] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] [KEY] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] Relay 1 starting on 10.250.120.196:9101 (RELAY PORT 9101)
[Relay 1] Registering with CDS at 127.0.0.1:9000
[Relay 1] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9101, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5MM7/HBECV26fZqjUJkt\nQ4+dx297cL0hf1+rf08Qir5tL/lArfQsiplTqcsIsZiN7vJ8K2XzvK5JAEv8tVE4\nEKU4W1hbEVBd1eLCX+Oc5XauTbWhW8xlc2wdNlNwDhin2Mw84doKJWPyfjtIwnIi\n3nWHqxLyAqkj6qDoByA8D7YVmJxvzwL0mrYE8G8b4Q4Wjnx2SXeTwc9LRzqwrsyb\nlM5B4BSVPBignOMhD2AfuIFw6uULQThbkL9L5AnQA08B4Gqzo731LLJN/Y6qo+VJ\nki2t6m1aJTG0LBjijpH7CtnN1MHIQ5UueS1sJVYZooYxkxEYYZTqIUXxuI5ICKPC\nCQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 1] [Relay] Listening for incoming messages on port 9101 (RELAY PORT 9101)
[Relay] ---- Relay process started ----
[Relay 2] [Relay] Loaded persistent RSA keypair from relay2_key.pem
[Relay 2] [Relay] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] [KEY] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] Relay 2 starting on 10.250.120.196:9102 (RELAY PORT 9102)
[Relay 2] Registering with CDS at 127.0.0.1:9000
[Relay 2] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9102, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA58J3pSrOQd4hYnuzQQ7q\nWrjjo+3BJp+ik23brR2yl0kjtfH+wjD9LYWHS7dBxsDRzSozJ/7EWKKNCaTsgvaF\nN6vpyBPqDM/uQfOWfirteL50RgDZw95Vml4Fuay7bTBEb1J8ydvFqawo8rnLE2I3\nU4BjBT+CD38bY3je8wrrCX9fo1uYaLDlfteGshadZ2gnTxrAzkZZ/CTFdyb8JrmN\nIuxjBVjwSA/uIv+KHWQhXRA5jJPXcNV88LYXyEzpid1Cr9gnrqA88K0HSleiwZjU\nJF3LhBvS2Ga2HHfFsk5D/yz/pTHwDvRA98VMT/90wahwmSJsck4XWDFhmNhy3oDR\nBQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 2] [Relay] Listening for incoming messages on port 9102 (RELAY PORT 9102)
[Relay] ---- Relay process started ----
[Relay 3] [Relay] Loaded persistent RSA keypair from relay3_key.pem
[Relay 3] [Relay] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] [Relay] [KEY] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] Relay 3 starting on 10.250.120.196:9103 (RELAY PORT 9103)
[Relay 3] Registering with CDS at 127.0.0.1:9000
[Relay 3] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9103, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5k9OJ8m3IdjmwR1skM1G\nwrKkwlYLK0Qs+I/BX5ww5wEakOsTy5NVFAwTYrCUnR012u2jCwI8wV1YpPaMa8RJ\ntnqNFy4pFfqBh5tmidHQ3QMRvINPrGtQM5+VgMXoA0y8izql52M1K/3Q6sHVlAXd\nmpQcBO+JSHY7uyVx1txZssyisia7Nn8Frh/XRpl0oUvGkSnbm/KgqDAP0xJ3lUZS\nEGiIWdf0bn7tHD3nYBMrWWi3jSQWf0Q80asIEYWipwkfMPf0ffzu4FX0elfvpyOX\nr50xk7sb8K5IhcilwxKxQpPOcq3f6ph0EERQR7pOdDqkzFdHoGiyssSX4MYM60kd\nmQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 3] [Relay] Listening for incoming messages on port 9103 (RELAY PORT 9103)
[Relay 3] [Relay] [handle_message ENTERED] addr=('10.250.120.196', 53638), thread=6127546368, relay_port=9103
[Relay 3] [Relay] [DEBUG] Raw data received: b'{"next_ip": "10.250.120.196", "next_port": 9102, "session_key": "E2MW92/UjaYV7YIDpNxEaLRAaoQsgg7FM6OKUljlFNkSv7er6MU07JjIXm9zNLWg8gCMQ9eax5j/fllGjYlg5jQ2HYV/0J7zJZTHV4dNT91HtFpKu0rb1+Yxv6Me76Mc/RIPwKItEZydXWcD1QKIuYwrSIdm/9xMBCnyU75G44GBDYIk++e1RMnnpYVm+NyyzoPmGqePlFdG8um1Y8ydfc1kraWQeH3wjEZM1Ut2Vja8kWcEW/I425yYZqhaUq4T1EmsW31pY+y6bXNVRMXhh444vNRs/vZG0OCj1jZs95MrJ+0riobrnFcjrXVtcoNq/Bl+3yjyXKAQzbFcBbEYWQ==", "payload": "CUFkc4DjFq2wH1eS/P2gSMRApyX00PuNo5pOdJ/Ndy6MGXNSLxCRKgt1jeIld8wYpSJ/vvgOh9xkTz8hkhbx+1vZpVCYvFdNIoHbV+iGSenMrCAutKjLbT0SxQBL4iqEZ5TNXQV6tV7XTCKMfNftoxyNLrwXWf+KkgNVWhwli3dyX73vu7NKpqHT9jOdz3weIb3ZqrJl6Te2JBmZVIOly/xRWK97eeYJa3rtY0MlF/eGASTSeyrShpLg3x4SiICj0k9TpkXpSQw25yZaXLx+T7tKNJgzpdJ+CmkfX4n6iEqsz99QIsjlUL7pa/wVdloZE9Fn4Aekpz0PPq7z/YRkur8/yeq4ptBNSqLEN/km9EU5AYDz/drpS2Vn45C2U4R56AwFTTADSc/eo9lUr9nliNl0xs62OCHWe4iB0a6bQJ0BCHH0XMlEt1SJY7p0FP61XIjnAyXafiGBGuK+TWR3Y9NEMQbpO9HDpvpyXa3tALBjd6hAZwXyO7O2OREEINZHU/v8LdKKNfb5pI25gsWadgVQCoo0zXtPJF4tGZ2dYzm/q1P35bOu9+SxJG0YAZm72h0L24ATHb+OX4SM7Y6ZIyn9ydCnamVqd1uwTMDjJdQNH989Cw=="}'
[Relay 3] [Relay] [DEBUG] Data after JSON parse: type=<class 'dict'>, keys=['next_ip', 'next_port', 'session_key', 'payload']
[Relay 3] [Relay] Received session_key (base64): E2MW92/UjaYV7YIDpNxEaLRAaoQsgg7FM6OKUljlFNkSv7er6MU07JjIXm9zNLWg8gCMQ9eax5j/fllGjYlg5jQ2HYV/0J7zJZTHV4dNT91HtFpKu0rb1+Yxv6Me76Mc/RIPwKItEZydXWcD1QKIuYwrSIdm/9xMBCnyU75G44GBDYIk++e1RMnnpYVm+NyyzoPmGqePlFdG8um1Y8ydfc1kraWQeH3wjEZM1Ut2Vja8kWcEW/I425yYZqhaUq4T1EmsW31pY+y6bXNVRMXhh444vNRs/vZG0OCj1jZs95MrJ+0riobrnFcjrXVtcoNq/Bl+3yjyXKAQzbFcBbEYWQ==
[Relay 3] [Relay] Decoded session_key_enc (hex): 136316f76fd48da615ed8203a4dc4468b4406a842c820ec533a38a5258e514d912bfb7abe8c534ec98c85e6f7334b5a0f2008c43d79ac798ff7e59468d8960e634361d857fd09ef32594c757874d4fdd47b45a4abb4adbd7e631bfa31eefa31cfd120fc0a22d119c9d5d6703d50288b98c2b488766ffdc4c0429f253be46e381810d8224fbe7b544c9e7a58566f8dcb2ce83e61aa78f945746f2e9b563cc9d7dcd64ada590787df08c464cd54b765636bc9167045bf238db9c9866a85a52ae13d449ac5b7d6963ecba6d735544c5e1878e38bcd46cfef646d0e0a3d6366cf7932b27ed2b8a86eb9c5723ad756d72836afc197edf28f25ca010cdb15c05b11859
[Relay 3] [Relay] Decrypting session key with fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] [Relay] Decrypted session_key (hex): 7329d018b358af3c26766b3a0b50a4a84d169653385d2ec1fbb39f7dab1a65c8
[Relay 3] [Relay] [DEBUG] About to AES-decrypt payload (passing base64 string directly)
[Relay 3] [Relay] [DEBUG] Payload base64-decoded: type=<class 'bytes'>, len=469, preview=b'\tAds\x80\xe3\x16\xad\xb0\x1fW\x92\xfc\xfd\xa0H\xc4@\xa7%\xf4\xd0\xfb\x8d\xa3\x9aNt\x9f\xcdw.\x8c\x19sR/\x10\x91*\x0bu\x8d\xe2%w\xcc\x18\xa5"\x7f\xbe\xf8\x0e\x87\xdcdO?!'
[Relay 3] [Relay] [DEBUG] AES-decrypted payload: type=<class 'bytes'>, len=453, preview=b'\x08\xfe\x9a_\x95\xa8\xa8\xc2\xec\x9f\x86\xf91V\xca\x8f&\x83\xea\xfbU6\x19\xa1\xb7\xd7[\xc1h\xce\x9b\xae*4\xe2\xce\x07\x16(\xb7\x82\xcb\xaa8\x03\x12\x15\xb7\x05\x85X1\xa7\xd0\xe1\x7f\x82=\xed\xec'
[Relay 3] [Relay] [DEBUG] AES-decrypted payload (hex): 08fe9a5f95a8a8c2ec9f86f93156ca8f2683eafb553619a1b7d75bc168ce9bae2a34e2ce071628b782cbaa38031215b705855831a7d0e17f823dedec
[Relay 3] [Relay] [DEBUG] Payload is not JSON, assuming last hop. Error: 'utf-8' codec can't decode byte 0xfe in position 1: invalid start byte
[Relay 3] [Relay] [Last Hop] Forwarding payload to dest 127.0.0.1:9100, len=453, type=<class 'bytes'>
[Relay 3] [Relay] [Last Hop] Sending to dest: type=<class 'bytes'>, len=453, preview=b'\x08\xfe\x9a_\x95\xa8\xa8\xc2\xec\x9f\x86\xf91V\xca\x8f&\x83\xea\xfbU6\x19\xa1
[Relay 3] [Relay] [Last Hop] Received response from dest: type=<class 'bytes'>, len=56, preview=b'RVJST1I6IENvdWxkIG5vdCBkZWNvZGUgcGF5bG9hZCBhcyBKU09OLg=='
[Relay 3] [Relay] [Last Hop] Response to client (UTF-8 JSON): b'{"result": "OK", "echo": "RVJST1I6IENvdWxkIG5vdCBkZWNvZGUgcGF5bG9hZCBhcyBKU09OLg=="}'
[Relay 3] [Relay] [Last Hop] AES-encrypted response (hex): d53127379b33ad709c21d2ee2ee1b15f6724e22ee13a8ee35834960e7e76152088d33df759ab512f68960baeb6c700e62666ae58b5a463fddd42f2c0
[Relay 3] [Relay] [Last Hop] Base64-encoded AES-encrypted response: type=<class 'bytes'>, len=136, preview=b'1TEnN5szrXCcIdLuLuGxX2ck4i7hOo7jWDSWDn52FSCI0z33WatRL2iWC662'
[Relay 3] [Relay] [Last Hop] Sent response to ('10.250.120.196', 53638): b'1TEnN5szrXCcIdLuLuGxX2ck4i7hOo7jWDSWDn52FSCI0z33WatRL2iWC662'... (len=136)
[Relay 1] [Relay] Deregistering from CDS and shutting down...
[Relay 2] [Relay] Deregistering from CDS and shutting down...
[Relay 3] [Relay] Deregistering from CDS and shutting down...
[Relay 3] [Relay] [handle_message END] addr=('10.250.120.196', 53638), thread=6127546368
[Relay 3] [Relay] ERROR during deregistration: [Errno 54] Connection reset by peer
[Relay 2] [Relay] ERROR during deregistration: [Errno 54] Connection reset by peer
[Relay 1] [Relay] ERROR during deregistration: [Errno 54] Connection reset by peer
[Relay] ---- Relay process started ----
[Relay 1] [Relay] Loaded persistent RSA keypair from relay1_key.pem
[Relay 1] [Relay] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] [KEY] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] Relay 1 starting on 10.250.120.196:9101 (RELAY PORT 9101)
[Relay 1] Registering with CDS at 127.0.0.1:9000
[Relay 1] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9101, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5MM7/HBECV26fZqjUJkt\nQ4+dx297cL0hf1+rf08Qir5tL/lArfQsiplTqcsIsZiN7vJ8K2XzvK5JAEv8tVE4\nEKU4W1hbEVBd1eLCX+Oc5XauTbWhW8xlc2wdNlNwDhin2Mw84doKJWPyfjtIwnIi\n3nWHqxLyAqkj6qDoByA8D7YVmJxvzwL0mrYE8G8b4Q4Wjnx2SXeTwc9LRzqwrsyb\nlM5B4BSVPBignOMhD2AfuIFw6uULQThbkL9L5AnQA08B4Gqzo731LLJN/Y6qo+VJ\nki2t6m1aJTG0LBjijpH7CtnN1MHIQ5UueS1sJVYZooYxkxEYYZTqIUXxuI5ICKPC\nCQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 1] [Relay] Listening for incoming messages on port 9101 (RELAY PORT 9101)
[Relay] ---- Relay process started ----
[Relay 2] [Relay] Loaded persistent RSA keypair from relay2_key.pem
[Relay 2] [Relay] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] [KEY] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] Relay 2 starting on 10.250.120.196:9102 (RELAY PORT 9102)
[Relay 2] Registering with CDS at 127.0.0.1:9000
[Relay 2] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9102, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA58J3pSrOQd4hYnuzQQ7q\nWrjjo+3BJp+ik23brR2yl0kjtfH+wjD9LYWHS7dBxsDRzSozJ/7EWKKNCaTsgvaF\nN6vpyBPqDM/uQfOWfirteL50RgDZw95Vml4Fuay7bTBEb1J8ydvFqawo8rnLE2I3\nU4BjBT+CD38bY3je8wrrCX9fo1uYaLDlfteGshadZ2gnTxrAzkZZ/CTFdyb8JrmN\nIuxjBVjwSA/uIv+KHWQhXRA5jJPXcNV88LYXyEzpid1Cr9gnrqA88K0HSleiwZjU\nJF3LhBvS2Ga2HHfFsk5D/yz/pTHwDvRA98VMT/90wahwmSJsck4XWDFhmNhy3oDR\nBQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 2] [Relay] Listening for incoming messages on port 9102 (RELAY PORT 9102)
[Relay] ---- Relay process started ----
[Relay 3] [Relay] Loaded persistent RSA keypair from relay3_key.pem
[Relay 3] [Relay] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] [Relay] [KEY] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] Relay 3 starting on 10.250.120.196:9103 (RELAY PORT 9103)
[Relay 3] Registering with CDS at 127.0.0.1:9000
[Relay 3] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9103, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5k9OJ8m3IdjmwR1skM1G\nwrKkwlYLK0Qs+I/BX5ww5wEakOsTy5NVFAwTYrCUnR012u2jCwI8wV1YpPaMa8RJ\ntnqNFy4pFfqBh5tmidHQ3QMRvINPrGtQM5+VgMXoA0y8izql52M1K/3Q6sHVlAXd\nmpQcBO+JSHY7uyVx1txZssyisia7Nn8Frh/XRpl0oUvGkSnbm/KgqDAP0xJ3lUZS\nEGiIWdf0bn7tHD3nYBMrWWi3jSQWf0Q80asIEYWipwkfMPf0ffzu4FX0elfvpyOX\nr50xk7sb8K5IhcilwxKxQpPOcq3f6ph0EERQR7pOdDqkzFdHoGiyssSX4MYM60kd\nmQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 3] [Relay] Listening for incoming messages on port 9103 (RELAY PORT 9103)
[Relay 2] [Relay] [handle_message ENTERED] addr=('10.250.120.196', 54047), thread=6197374976, relay_port=9102
[Relay 2] [Relay] [DEBUG] Raw data received: b'{"next_ip": "10.250.120.196", "next_port": 9103, "session_key": "XBwPfTQFmoX9/sGnuSuMfzW++vEkr7KGVGlm0TdVIWe9L1tf0J1S4763KZ5qlnsEMjtSTNV+3JJW04SIoydyG+4nWfR50ZpmDUGQA6ljxwU0d7bb6GTLpiAUmxiqFgoJ6MsXmoT2VAhXitebVxECmf7VGW52W5LNZbcG5HDdrWns6Kiv8xdalYnIQFRHAx1y9S/+V06DqUjKSzBTQn2x8IrN1l8tqFbCD8fiT7bMInWDq06AJnn4BfNX45otyVnwIpHyV0eKemWBaL4ZSsYFmfXBJQor43d0tov+IMEnXjzn2Ea9SW43RGtPVdkt9liwLjvVJtzZ0QVHpRY+GZ39Xg==", "payload": "0X6lFn4cuey+wxXmvC9DtJyHbwZy+L3/nr/qjUrN3oj+ESY18oMug/KCVBPMBsneHrap0udeBk5IFiNNtCVbTm3lspx8AidoOgpAEwNdtHEzSEPX/krM83fABgjXMzbJB1D/WqulCwshKTCI3U3RjnRP9G+litpmTNRNm1Jdx+SdIYopVfiU8yH31Yj8PLkaYmyf/WeLZQUMx9AHbfIlU4u1SCcIzG9fwCPlJ+49nvFsiCdxuGa6gqvwgZoXySLJk9949wyRoe5e8R3bOpIbiytgrXfB4orFEZFI+Uq0RVH4X7snxFl6saD1higYzbrvzlhMpxAB6hMR72i7X8T79DIOuRh7VdL1amJnOYZe6RFt/Je91Qv3VVetC4T/I9ohO397ckpF1Dd9tSy+lT9dcJyT9DUnjrB+GB+wh6oQRfp3niD88BBtCncbBiiBE/x02H9Rzqydt5uOrErPOfM5zOtaltoF+IpzuQ+Wvn7oRxFByMCevU+x4wuCFGh9cDlZ4eXTCeP27YvbfDRoMNr5pop3/rBEwr9XXC4mGDD4YHMt2JwtNVkB1dhcER0aOzavNBPl1U4BVUPxvgkGiblwWOIsxkXONBLNfjcgY8s7N+aDmhkA5Q=="}'
[Relay 2] [Relay] [DEBUG] Data after JSON parse: type=<class 'dict'>, keys=['next_ip', 'next_port', 'session_key', 'payload']
[Relay 2] [Relay] Received session_key (base64): XBwPfTQFmoX9/sGnuSuMfzW++vEkr7KGVGlm0TdVIWe9L1tf0J1S4763KZ5qlnsEMjtSTNV+3JJW04SIoydyG+4nWfR50ZpmDUGQA6ljxwU0d7bb6GTLpiAUmxiqFgoJ6MsXmoT2VAhXitebVxECmf7VGW52W5LNZbcG5HDdrWns6Kiv8xdalYnIQFRHAx1y9S/+V06DqUjKSzBTQn2x8IrN1l8tqFbCD8fiT7bMInWDq06AJnn4BfNX45otyVnwIpHyV0eKemWBaL4ZSsYFmfXBJQor43d0tov+IMEnXjzn2Ea9SW43RGtPVdkt9liwLjvVJtzZ0QVHpRY+GZ39Xg==
[Relay 2] [Relay] Decoded session_key_enc (hex): 5c1c0f7d34059a85fdfec1a7b92b8c7f35befaf124afb286546966d137552167bd2f5b5fd09d52e3beb7299e6a967b04323b524cd57edc9256d38488a327721bee2759f479d19a660d419003a963c7053477b6dbe864cba620149b18aa160a09e8cb179a84f65408578ad79b57110299fed5196e765b92cd65b706e470ddad69ece8a8aff3175a9589c8405447031d72f52ffe574e83a948ca4b3053427db1f08acdd65f2da856c20fc7e24fb6cc227583ab4e802679f805f357e39a2dc959f02291f257478a7a658168be194ac60599f5c1250a2be37774b68bfe20c1275e3ce7d846bd496e37446b4f55d92df658b02e3bd526dcd9d10547a5163e199dfd5e
[Relay 2] [Relay] Decrypting session key with fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] Decrypted session_key (hex): 3c969ba13aa8af63a99059618fae63c15bb2932092b32b54e96fe79655aa3da9
[Relay 2] [Relay] [DEBUG] About to AES-decrypt payload (passing base64 string directly)
[Relay 2] [Relay] [DEBUG] Payload base64-decoded: type=<class 'bytes'>, len=469, preview=b'\xd1~\xa5\x16~\x1c\xb9\xec\xbe\xc3\x15\xe6\xbc/C\xb4\x9c\x87o\x06r\xf8\xbd\xff\x9e\xbf\xea\x8dJ\xcd\xde\x88\xfe\x11&5\xf2\x83.\x83\xf2\x82T\x13\xcc\x06\xc9\xde\x1e\xb6\xa9\xd2\xe7^\x06NH\x16#M'
[Relay 2] [Relay] [DEBUG] AES-decrypted payload: type=<class 'bytes'>, len=453, preview=b"\xd2\xb77\x80\xa89,\xba\xcd2J\x93'[\x9c\x81\xb0\x95\x1a\xb2\xeaAai\xa7,\x8c\xf5\xd2\xf8\xc5\xc1\xf7\xd1\xdf2\x9dI\xa72\x9a\x85^h\xad\x13b4\xb4q\x9e\x85tA\n\xcf\xb0}\x99\x06"
[Relay 2] [Relay] [DEBUG] AES-decrypted payload (hex): d2b73780a8392cbacd324a93275b9c81b0951ab2ea416169a72c8cf5d2f8c5c1f7d1df329d49a7329a855e68ad136234b4719e8574410acfb07d9906
[Relay 2] [Relay] [DEBUG] Payload is not JSON, assuming last hop. Error: 'utf-8' codec can't decode byte 0x80 in position 3: invalid start byte
[Relay 2] [Relay] [Last Hop] Forwarding payload to dest 127.0.0.1:9100, len=453, type=<class 'bytes'>
[Relay 2] [Relay] [Last Hop] Sending to dest: type=<class 'bytes'>, len=453, preview=b'\xd2\xb77\x80\xa89,\xba\xcd2J\x93\'[\x9c\x81\xb0\x95\x1a\xb2\xeaAai\xa7,\x8c\x
[Relay 2] [Relay] [Last Hop] Received response from dest: type=<class 'bytes'>, len=56, preview=b'RVJST1I6IENvdWxkIG5vdCBkZWNvZGUgcGF5bG9hZCBhcyBKU09OLg=='
[Relay 2] [Relay] [Last Hop] Response to client (UTF-8 JSON): b'{"result": "OK", "echo": "RVJST1I6IENvdWxkIG5vdCBkZWNvZGUgcGF5bG9hZCBhcyBKU09OLg=="}'
[Relay 2] [Relay] [Last Hop] AES-encrypted response (hex): aab29c6e8327c17d3c36bb95cd9e45304b3f401e0080cef63aa15b5397a79d38c879b49771684337843955637b2c543d7ae745cd5234cd66ec45bd69
[Relay 2] [Relay] [Last Hop] Base64-encoded AES-encrypted response: type=<class 'bytes'>, len=136, preview=b'qrKcboMnwX08NruVzZ5FMEs/QB4AgM72OqFbU5ennTjIebSXcWhDN4Q5VWN7'
[Relay 1] [Relay] Deregistering from CDS and shutting down...
[Relay 3] [Relay] Deregistering from CDS and shutting down...
[Relay 2] [Relay] [Last Hop] Sent response to ('10.250.120.196', 54047): b'qrKcboMnwX08NruVzZ5FMEs/QB4AgM72OqFbU5ennTjIebSXcWhDN4Q5VWN7'... (len=136)
[Relay 2] [Relay] Deregistering from CDS and shutting down...
[Relay 2] [Relay] [handle_message END] addr=('10.250.120.196', 54047), thread=6197374976
[Relay 1] [Relay] ERROR during deregistration: [Errno 54] Connection reset by peer
[Relay 3] [Relay] ERROR during deregistration: [Errno 54] Connection reset by peer
[Relay 2] [Relay] ERROR during deregistration: [Errno 54] Connection reset by peer
[Relay] ---- Relay process started ----
[Relay 1] [Relay] Loaded persistent RSA keypair from relay1_key.pem
[Relay 1] [Relay] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] [KEY] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] Relay 1 starting on 10.250.120.196:9101 (RELAY PORT 9101)
[Relay 1] Registering with CDS at 127.0.0.1:9000
[Relay 1] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9101, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5MM7/HBECV26fZqjUJkt\nQ4+dx297cL0hf1+rf08Qir5tL/lArfQsiplTqcsIsZiN7vJ8K2XzvK5JAEv8tVE4\nEKU4W1hbEVBd1eLCX+Oc5XauTbWhW8xlc2wdNlNwDhin2Mw84doKJWPyfjtIwnIi\n3nWHqxLyAqkj6qDoByA8D7YVmJxvzwL0mrYE8G8b4Q4Wjnx2SXeTwc9LRzqwrsyb\nlM5B4BSVPBignOMhD2AfuIFw6uULQThbkL9L5AnQA08B4Gqzo731LLJN/Y6qo+VJ\nki2t6m1aJTG0LBjijpH7CtnN1MHIQ5UueS1sJVYZooYxkxEYYZTqIUXxuI5ICKPC\nCQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 1] [Relay] Listening for incoming messages on port 9101 (RELAY PORT 9101)
[Relay] ---- Relay process started ----
[Relay 2] [Relay] Loaded persistent RSA keypair from relay2_key.pem
[Relay 2] [Relay] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] [KEY] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] Relay 2 starting on 10.250.120.196:9102 (RELAY PORT 9102)
[Relay 2] Registering with CDS at 127.0.0.1:9000
[Relay 2] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9102, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA58J3pSrOQd4hYnuzQQ7q\nWrjjo+3BJp+ik23brR2yl0kjtfH+wjD9LYWHS7dBxsDRzSozJ/7EWKKNCaTsgvaF\nN6vpyBPqDM/uQfOWfirteL50RgDZw95Vml4Fuay7bTBEb1J8ydvFqawo8rnLE2I3\nU4BjBT+CD38bY3je8wrrCX9fo1uYaLDlfteGshadZ2gnTxrAzkZZ/CTFdyb8JrmN\nIuxjBVjwSA/uIv+KHWQhXRA5jJPXcNV88LYXyEzpid1Cr9gnrqA88K0HSleiwZjU\nJF3LhBvS2Ga2HHfFsk5D/yz/pTHwDvRA98VMT/90wahwmSJsck4XWDFhmNhy3oDR\nBQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 2] [Relay] Listening for incoming messages on port 9102 (RELAY PORT 9102)
[Relay] ---- Relay process started ----
[Relay 3] [Relay] Loaded persistent RSA keypair from relay3_key.pem
[Relay 3] [Relay] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] [Relay] [KEY] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] Relay 3 starting on 10.250.120.196:9103 (RELAY PORT 9103)
[Relay 3] Registering with CDS at 127.0.0.1:9000
[Relay 3] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9103, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5k9OJ8m3IdjmwR1skM1G\nwrKkwlYLK0Qs+I/BX5ww5wEakOsTy5NVFAwTYrCUnR012u2jCwI8wV1YpPaMa8RJ\ntnqNFy4pFfqBh5tmidHQ3QMRvINPrGtQM5+VgMXoA0y8izql52M1K/3Q6sHVlAXd\nmpQcBO+JSHY7uyVx1txZssyisia7Nn8Frh/XRpl0oUvGkSnbm/KgqDAP0xJ3lUZS\nEGiIWdf0bn7tHD3nYBMrWWi3jSQWf0Q80asIEYWipwkfMPf0ffzu4FX0elfvpyOX\nr50xk7sb8K5IhcilwxKxQpPOcq3f6ph0EERQR7pOdDqkzFdHoGiyssSX4MYM60kd\nmQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 3] [Relay] Listening for incoming messages on port 9103 (RELAY PORT 9103)
[Relay 3] [Relay] [handle_message ENTERED] addr=('10.250.120.196', 54270), thread=6163443712, relay_port=9103
[Relay 3] [Relay] [DEBUG] Raw data received: b'{"next_ip": "10.250.120.196", "next_port": 9102, "session_key": "OlxbpqGrA2Em+DG/tzoY5bhoFSGHKQEYXHqD5CCkSa8NYhjItKS76Gict9IaJ1ZdBWA23VvZQ4QMNr6fFkctzeZSsTGnQwVVuYmsVeGMEK9acJ7eBUGt/jmUTb5xfjbZ+V4wbK+V/0WfprxuSysQJaF25cxrn7Ht2U1E3O0kOQ1P9dH++D05bofoJNVmCMgAsHRB/eTX/tP0vfy6vt6kk2MfLrpCJ9cJjs9Az8V+/nue2EF5wX8+aH3ZPTRdsEDGPr1cJsCym4TzcdATtFHIPHDe+5oZwNmSwnzZ1m3gquFUjnzDiQljcnXlRel/n0cUbAyAtKmWOSWw5LPRW90w+Q==", "payload": "AbE8flDUBxGs/a2BSj0BDwLxacJ+CULkqEd6/kaZPjYlsTWKDBty5HfkzWwrdZGUjW4RkGFKdX5jDwV5H/2PSIwJ2NXzx9P2pEdPEXzNHGmjPmXCQWdDl2X3lN5sn3xHJydZJ+19XS1VltnmmPev+aKgPfJg/Xe8b5upZLmn0aLLASa9m5rU/rNLtcuBKc+BahpjjX/AwAaGoxbcH56Uns15wBbrRg7BRI+NN7UvUJsDjmB5LYoX1I9w6dx305domGzwpFR2G3qpQCvzk0IQ3fLaW0CpwDt47/kFAHTgMCB3C8gjrXFyEtcqXyF4XbhTtVNO9nTpzIVB0LbGB1PaZhYZJAYTWwjfjf2xb+dZ4txdYXuJ2kYLwumHCUXFoTSULjAyUKvQJa1lxUt6NVm7wOsColkL+rxN1jvjzi33UiHPrkbYvkmDkCLKGxTl/QxMrkFopkblrrO+bfF0JbcrB4JkVhb42uXpbgox3mOaPlXyMmWmaEaaFuRHzrhxdeRFrmYImd0MPbzWi6Xa8kvwXd2UzCKUqdLYygoqPnEWQYDZwbPEYm01jEggFv8IBgnaOT7Tbcnx9b7kPhNKpJTN+oFE2GRHiHubcEy4Em8QI5VM1oi77A=="}'
[Relay 3] [Relay] [DEBUG] Data after JSON parse: type=<class 'dict'>, keys=['next_ip', 'next_port', 'session_key', 'payload']
[Relay 3] [Relay] Received session_key (base64): OlxbpqGrA2Em+DG/tzoY5bhoFSGHKQEYXHqD5CCkSa8NYhjItKS76Gict9IaJ1ZdBWA23VvZQ4QMNr6fFkctzeZSsTGnQwVVuYmsVeGMEK9acJ7eBUGt/jmUTb5xfjbZ+V4wbK+V/0WfprxuSysQJaF25cxrn7Ht2U1E3O0kOQ1P9dH++D05bofoJNVmCMgAsHRB/eTX/tP0vfy6vt6kk2MfLrpCJ9cJjs9Az8V+/nue2EF5wX8+aH3ZPTRdsEDGPr1cJsCym4TzcdATtFHIPHDe+5oZwNmSwnzZ1m3gquFUjnzDiQljcnXlRel/n0cUbAyAtKmWOSWw5LPRW90w+Q==
[Relay 3] [Relay] Decoded session_key_enc (hex): 3a5c5ba6a1ab036126f831bfb73a18e5b8681521872901185c7a83e420a449af0d6218c8b4a4bbe8689cb7d21a27565d056036dd5bd943840c36be9f16472dcde652b131a7430555b989ac55e18c10af5a709ede0541adfe39944dbe717e36d9f95e306caf95ff459fa6bc6e4b2b1025a176e5cc6b9fb1edd94d44dced24390d4ff5d1fef83d396e87e824d56608c800b07441fde4d7fed3f4bdfcbabedea493631f2eba4227d7098ecf40cfc57efe7b9ed84179c17f3e687dd93d345db040c63ebd5c26c0b29b84f371d013b451c83c70defb9a19c0d992c27cd9d66de0aae1548e7cc38909637275e545e97f9f47146c0c80b4a9963925b0e4b3d15bdd30f9
[Relay 3] [Relay] Decrypting session key with fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] [Relay] Decrypted session_key (hex): 1ae1147892a7d02433afdce7864f81c5d5ef338b3117dc1519eba6d770fc8a50
[Relay 3] [Relay] [DEBUG] About to AES-decrypt payload (passing base64 string directly)
[Relay 3] [Relay] [DEBUG] Payload base64-decoded: type=<class 'bytes'>, len=469, preview=b'\x01\xb1<~P\xd4\x07\x11\xac\xfd\xad\x81J=\x01\x0f\x02\xf1i\xc2~\tB\xe4\xa8Gz\xfeF\x99>6%\xb15\x8a\x0c\x1br\xe4w\xe4\xcdl+u\x91\x94\x8dn\x11\x90aJu~c\x0f\x05y'
[Relay 3] [Relay] [DEBUG] AES-decrypted payload: type=<class 'bytes'>, len=453, preview=b'\xcc\xa5}B=\xf2U\xc8J:gv\xb0\xfc\xa8\xfe\x8c\xb8d\xca\xe8c\xe4\xb1t\xfc\x1d;v~!\xbf)\xd7\x08\xb5\x1f\xfd0\xe7\x86\xd1EHLu\x11\x0e\xae>\xc8z)\x02\x96T\x8c\xcd\x15\xf7'
[Relay 3] [Relay] [DEBUG] AES-decrypted payload (hex): cca57d423df255c84a3a6776b0fca8fe8cb864cae863e4b174fc1d3b767e21bf29d708b51ffd30e786d145484c75110eae3ec87a290296548ccd15f7
[Relay 3] [Relay] [DEBUG] Payload is not JSON, assuming last hop. Error: 'utf-8' codec can't decode byte 0xf2 in position 5: invalid continuation byte
[Relay 3] [Relay] [Last Hop] Forwarding payload to dest 127.0.0.1:9100, len=453, type=<class 'bytes'>
[Relay 3] [Relay] [Last Hop] Sending to dest: type=<class 'bytes'>, len=453, preview=b'\xcc\xa5}B=\xf2U\xc8J:gv\xb0\xfc\xa8\xfe\x8c\xb8d\xca\xe8c\xe4\xb1t\xfc\x1d;v~
[Relay 3] [Relay] [Last Hop] Received response from dest: type=<class 'bytes'>, len=72, preview=b'{"result": "ERROR", "error": "ERROR: Could not decode payloa'
[Relay 3] [Relay] [Last Hop] Response to client (UTF-8 JSON): b'{"result": "ERROR", "error": "ERROR: Could not decode payload as JSON."}'
[Relay 3] [Relay] [Last Hop] AES-encrypted response (hex): 849c2b37abf2711343b6700d2e7f84ccb1c3f4608603822bc439036811862d128bd0f307325e0aa6f750f6904aa12823c76437b2371dc89061a1a09a
[Relay 3] [Relay] [Last Hop] Base64-encoded AES-encrypted response: type=<class 'bytes'>, len=120, preview=b'hJwrN6vycRNDtnANLn+EzLHD9GCGA4IrxDkDaBGGLRKL0PMHMl4KpvdQ9pBK'
[Relay 3] [Relay] [Last Hop] Sent response to ('10.250.120.196', 54270): b'hJwrN6vycRNDtnANLn+EzLHD9GCGA4IrxDkDaBGGLRKL0PMHMl4KpvdQ9pBK'... (len=120)
[Relay 1] [Relay] Deregistering from CDS and shutting down...
[Relay 2] [Relay] Deregistering from CDS and shutting down...
[Relay 3] [Relay] Deregistering from CDS and shutting down...
[Relay 3] [Relay] [handle_message END] addr=('10.250.120.196', 54270), thread=6163443712
[Relay 3] [Relay] ERROR during deregistration: [Errno 54] Connection reset by peer
[Relay 2] [Relay] ERROR during deregistration: [Errno 54] Connection reset by peer
[Relay 1] [Relay] ERROR during deregistration: [Errno 54] Connection reset by peer
[Relay] ---- Relay process started ----
[Relay 1] [Relay] Loaded persistent RSA keypair from relay1_key.pem
[Relay 1] [Relay] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] [KEY] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] Relay 1 starting on 10.250.120.196:9101 (RELAY PORT 9101)
[Relay 1] Registering with CDS at 127.0.0.1:9000
[Relay 1] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9101, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5MM7/HBECV26fZqjUJkt\nQ4+dx297cL0hf1+rf08Qir5tL/lArfQsiplTqcsIsZiN7vJ8K2XzvK5JAEv8tVE4\nEKU4W1hbEVBd1eLCX+Oc5XauTbWhW8xlc2wdNlNwDhin2Mw84doKJWPyfjtIwnIi\n3nWHqxLyAqkj6qDoByA8D7YVmJxvzwL0mrYE8G8b4Q4Wjnx2SXeTwc9LRzqwrsyb\nlM5B4BSVPBignOMhD2AfuIFw6uULQThbkL9L5AnQA08B4Gqzo731LLJN/Y6qo+VJ\nki2t6m1aJTG0LBjijpH7CtnN1MHIQ5UueS1sJVYZooYxkxEYYZTqIUXxuI5ICKPC\nCQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 1] [Relay] Listening for incoming messages on port 9101 (RELAY PORT 9101)
[Relay] ---- Relay process started ----
[Relay 2] [Relay] Loaded persistent RSA keypair from relay2_key.pem
[Relay 2] [Relay] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] [KEY] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] Relay 2 starting on 10.250.120.196:9102 (RELAY PORT 9102)
[Relay 2] Registering with CDS at 127.0.0.1:9000
[Relay 2] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9102, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA58J3pSrOQd4hYnuzQQ7q\nWrjjo+3BJp+ik23brR2yl0kjtfH+wjD9LYWHS7dBxsDRzSozJ/7EWKKNCaTsgvaF\nN6vpyBPqDM/uQfOWfirteL50RgDZw95Vml4Fuay7bTBEb1J8ydvFqawo8rnLE2I3\nU4BjBT+CD38bY3je8wrrCX9fo1uYaLDlfteGshadZ2gnTxrAzkZZ/CTFdyb8JrmN\nIuxjBVjwSA/uIv+KHWQhXRA5jJPXcNV88LYXyEzpid1Cr9gnrqA88K0HSleiwZjU\nJF3LhBvS2Ga2HHfFsk5D/yz/pTHwDvRA98VMT/90wahwmSJsck4XWDFhmNhy3oDR\nBQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 2] [Relay] Listening for incoming messages on port 9102 (RELAY PORT 9102)
[Relay] ---- Relay process started ----
[Relay 3] [Relay] Loaded persistent RSA keypair from relay3_key.pem
[Relay 3] [Relay] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] [Relay] [KEY] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] Relay 3 starting on 10.250.120.196:9103 (RELAY PORT 9103)
[Relay 3] Registering with CDS at 127.0.0.1:9000
[Relay 3] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9103, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5k9OJ8m3IdjmwR1skM1G\nwrKkwlYLK0Qs+I/BX5ww5wEakOsTy5NVFAwTYrCUnR012u2jCwI8wV1YpPaMa8RJ\ntnqNFy4pFfqBh5tmidHQ3QMRvINPrGtQM5+VgMXoA0y8izql52M1K/3Q6sHVlAXd\nmpQcBO+JSHY7uyVx1txZssyisia7Nn8Frh/XRpl0oUvGkSnbm/KgqDAP0xJ3lUZS\nEGiIWdf0bn7tHD3nYBMrWWi3jSQWf0Q80asIEYWipwkfMPf0ffzu4FX0elfvpyOX\nr50xk7sb8K5IhcilwxKxQpPOcq3f6ph0EERQR7pOdDqkzFdHoGiyssSX4MYM60kd\nmQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 3] [Relay] Listening for incoming messages on port 9103 (RELAY PORT 9103)
[Relay 3] [Relay] [handle_message ENTERED] addr=('10.250.120.196', 54462), thread=6202404864, relay_port=9103
[Relay 3] [Relay] [DEBUG] Raw data received: b'{"next_ip": "10.250.120.196", "next_port": 9101, "session_key": "k2SQInFPASrtdrGY11hi0ymKSiIY+ZFLt0Q3O31x0b4BQh6R5qzFXOWaDgUyZQhPDQ/m1RH6E/+gXTkfrOv+DjczwkTRoU4AdhScZaGDqZOMmNTybzXj7rj7JcaIm79urKomF+er/RxNxPj2ssLPxzOZDAI3JMdGYvyWTpbEzBZe0DoRVd5LXMi0MhrONS/Jd9nC6Re7XYxRjNUqK6n3ZWixkR52BLY0Aa7VD7vQFYvJbXvGsTxgqbLbunFzAjcCy4t/nAo5WH8bMfWXtjHPhUJsi9RoVKOdKxBiAnXyp3NhWN+qKu25su1LVRwJElStIOXAD2OXChe+ieQI0n6Bqg==", "payload": "m91gVyuseRZ/zpYzS/hmbk02yAS16rCeaHsCskj1IQ9rGj3emDnUSvxyXJEenTBfdInCQNgpxXK0bO9zbsgFVQvfDCI7VCPCPd2vx9z8PRCb4mQ6AeRPnzgLOIn3XGd/qcNktTkWOdjbsFyh7mksF7YJgcS7/KKebFqeByVz6RIKDoLuJDDe/wa2EAqa+2dZ7tzkDm7CEwGWA2TGm2R1KSYHq3tE4WTP0WEjun2SXxEwJqHLzpNxMzdYQCTA3QZ4Xt6QTG3xECAqa2gn39gTEhkiH/uX+klLaI3UpmgZVVzl/Tc1fQJUL7w1wmXfB9vo2gZ6s5majfHtp78GH43HPGggPTgFx85qo9/kJn4UVDOKUPhDQ7yhhYTjEFst9yCBSi/SusHGIGciPzNiFSnMQBjKv/xrmL3WDEeOoxy+FSbAI5rALLApB/Qjm3oAmv78nWoR+mv0Fhq/hPmGp+VrASM0bhGrVuieXhnp4HhdAIe/v7coAIIXSiy8TeLrpri6V0RQhRT1LrBvg3aU2mhVj5VnkbDa97uzIVzgQiaev55y525zIoeN4e8YHwDc924Ho2cy/cRrhLpEIIqTtirXJ8ORAgWTSgAXDTgSewwoJGKFe6Pjag=="}'
[Relay 3] [Relay] [DEBUG] Data after JSON parse: type=<class 'dict'>, keys=['next_ip', 'next_port', 'session_key', 'payload']
[Relay 3] [Relay] Received session_key (base64): k2SQInFPASrtdrGY11hi0ymKSiIY+ZFLt0Q3O31x0b4BQh6R5qzFXOWaDgUyZQhPDQ/m1RH6E/+gXTkfrOv+DjczwkTRoU4AdhScZaGDqZOMmNTybzXj7rj7JcaIm79urKomF+er/RxNxPj2ssLPxzOZDAI3JMdGYvyWTpbEzBZe0DoRVd5LXMi0MhrONS/Jd9nC6Re7XYxRjNUqK6n3ZWixkR52BLY0Aa7VD7vQFYvJbXvGsTxgqbLbunFzAjcCy4t/nAo5WH8bMfWXtjHPhUJsi9RoVKOdKxBiAnXyp3NhWN+qKu25su1LVRwJElStIOXAD2OXChe+ieQI0n6Bqg==
[Relay 3] [Relay] Decoded session_key_enc (hex): 93649022714f012aed76b198d75862d3298a4a2218f9914bb744373b7d71d1be01421e91e6acc55ce59a0e053265084f0d0fe6d511fa13ffa05d391facebfe0e3733c244d1a14e0076149c65a183a9938c98d4f26f35e3eeb8fb25c6889bbf6eacaa2617e7abfd1c4dc4f8f6b2c2cfc733990c023724c74662fc964e96c4cc165ed03a1155de4b5cc8b4321ace352fc977d9c2e917bb5d8c518cd52a2ba9f76568b1911e7604b63401aed50fbbd0158bc96d7bc6b13c60a9b2dbba7173023702cb8b7f9c0a39587f1b31f597b631cf85426c8bd46854a39d2b10620275f2a7736158dfaa2aedb9b2ed4b551c091254ad20e5c00f63970a17be89e408d27e81aa
[Relay 3] [Relay] Decrypting session key with fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] [Relay] Decrypted session_key (hex): 0b4f490ba5df15188647be823b33bd0540386ff5aae084493a30600028eed242
[Relay 3] [Relay] [DEBUG] About to AES-decrypt payload (passing base64 string directly)
[Relay 3] [Relay] [DEBUG] Payload base64-decoded: type=<class 'bytes'>, len=469, preview=b'\x9b\xdd`W+\xacy\x16\x7f\xce\x963K\xf8fnM6\xc8\x04\xb5\xea\xb0\x9eh{\x02\xb2H\xf5!\x0fk\x1a=\xde\x989\xd4J\xfcr\\\x91\x1e\x9d0_t\x89\xc2@\xd8)\xc5r\xb4l\xefs'
[Relay 3] [Relay] [DEBUG] AES-decrypted payload: type=<class 'bytes'>, len=453, preview=b'\x8cC\x16R\xf7\x85\xd3N\x9876]\xb6y-\x84T\xec\xdd\xaf\xf3\xff\xc4~\xb4\xdc\xc9\xd1Il\xd4L\x83=\x9f\\g\x1cz\xf5\x7f\xed\xb6\x1b\xe5\x17\xc0\x18\xd9Ry\xc4Y\xdb\x9ahC\x94\x15\xa6'
[Relay 3] [Relay] [DEBUG] AES-decrypted payload (hex): 8c431652f785d34e9837365db6792d8454ecddaff3ffc47eb4dcc9d1496cd44c833d9f5c671c7af57fedb61be517c018d95279c459db9a68439415a6
[Relay 3] [Relay] [DEBUG] Payload is not JSON, assuming last hop. Error: 'utf-8' codec can't decode byte 0x8c in position 0: invalid start byte
[Relay 3] [Relay] [Last Hop] Forwarding payload to dest 127.0.0.1:9100, len=453, type=<class 'bytes'>
[Relay 3] [Relay] [Last Hop] Sending to dest: type=<class 'bytes'>, len=453, preview=b'\x8cC\x16R\xf7\x85\xd3N\x9876]\xb6y-\x84T\xec\xdd\xaf\xf3\xff\xc4~\xb4\xdc\xc9
[Relay 3] [Relay] [Last Hop] Received response from dest: type=<class 'bytes'>, len=72, preview=b'{"result": "ERROR", "error": "ERROR: Could not decode payloa'
[Relay 3] [Relay] [Last Hop] Response to client (UTF-8 JSON): b'{"result": "ERROR", "error": "ERROR: Could not decode payload as JSON."}'
[Relay 3] [Relay] [Last Hop] AES-encrypted response (hex): 0998ca02911e6a4040a8ad67212361484eea46cdd0bcc11336629b322e46d6ea50b4c61550b161194eeb8044ac9a82c05d614565c3da5c621932a964
[Relay 3] [Relay] [Last Hop] Base64-encoded AES-encrypted response: type=<class 'bytes'>, len=120, preview=b'CZjKApEeakBAqK1nISNhSE7qRs3QvMETNmKbMi5G1upQtMYVULFhGU7rgESs'
[Relay 3] [Relay] [Last Hop] Sent response to ('10.250.120.196', 54462): b'CZjKApEeakBAqK1nISNhSE7qRs3QvMETNmKbMi5G1upQtMYVULFhGU7rgESs'... (len=120)
[Relay 1] [Relay] Deregistering from CDS and shutting down...
[Relay 3] [Relay] Deregistering from CDS and shutting down...
[Relay 2] [Relay] Deregistering from CDS and shutting down...
[Relay 3] [Relay] [handle_message END] addr=('10.250.120.196', 54462), thread=6202404864
[Relay 3] [Relay] ERROR during deregistration: [Errno 54] Connection reset by peer
[Relay 2] [Relay] ERROR during deregistration: [Errno 54] Connection reset by peer
[Relay 1] [Relay] ERROR during deregistration: [Errno 54] Connection reset by peer
[Relay] ---- Relay process started ----
[Relay 1] [Relay] Loaded persistent RSA keypair from relay1_key.pem
[Relay 1] [Relay] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] [KEY] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] Relay 1 starting on 10.250.120.196:9101 (RELAY PORT 9101)
[Relay 1] Registering with CDS at 127.0.0.1:9000
[Relay 1] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9101, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5MM7/HBECV26fZqjUJkt\nQ4+dx297cL0hf1+rf08Qir5tL/lArfQsiplTqcsIsZiN7vJ8K2XzvK5JAEv8tVE4\nEKU4W1hbEVBd1eLCX+Oc5XauTbWhW8xlc2wdNlNwDhin2Mw84doKJWPyfjtIwnIi\n3nWHqxLyAqkj6qDoByA8D7YVmJxvzwL0mrYE8G8b4Q4Wjnx2SXeTwc9LRzqwrsyb\nlM5B4BSVPBignOMhD2AfuIFw6uULQThbkL9L5AnQA08B4Gqzo731LLJN/Y6qo+VJ\nki2t6m1aJTG0LBjijpH7CtnN1MHIQ5UueS1sJVYZooYxkxEYYZTqIUXxuI5ICKPC\nCQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 1] [Relay] Listening for incoming messages on port 9101 (RELAY PORT 9101)
[Relay] ---- Relay process started ----
[Relay 2] [Relay] Loaded persistent RSA keypair from relay2_key.pem
[Relay 2] [Relay] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] [KEY] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] Relay 2 starting on 10.250.120.196:9102 (RELAY PORT 9102)
[Relay 2] Registering with CDS at 127.0.0.1:9000
[Relay 2] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9102, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA58J3pSrOQd4hYnuzQQ7q\nWrjjo+3BJp+ik23brR2yl0kjtfH+wjD9LYWHS7dBxsDRzSozJ/7EWKKNCaTsgvaF\nN6vpyBPqDM/uQfOWfirteL50RgDZw95Vml4Fuay7bTBEb1J8ydvFqawo8rnLE2I3\nU4BjBT+CD38bY3je8wrrCX9fo1uYaLDlfteGshadZ2gnTxrAzkZZ/CTFdyb8JrmN\nIuxjBVjwSA/uIv+KHWQhXRA5jJPXcNV88LYXyEzpid1Cr9gnrqA88K0HSleiwZjU\nJF3LhBvS2Ga2HHfFsk5D/yz/pTHwDvRA98VMT/90wahwmSJsck4XWDFhmNhy3oDR\nBQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 2] [Relay] Listening for incoming messages on port 9102 (RELAY PORT 9102)
[Relay] ---- Relay process started ----
[Relay 3] [Relay] Loaded persistent RSA keypair from relay3_key.pem
[Relay 3] [Relay] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] [Relay] [KEY] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] Relay 3 starting on 10.250.120.196:9103 (RELAY PORT 9103)
[Relay 3] Registering with CDS at 127.0.0.1:9000
[Relay 3] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9103, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5k9OJ8m3IdjmwR1skM1G\nwrKkwlYLK0Qs+I/BX5ww5wEakOsTy5NVFAwTYrCUnR012u2jCwI8wV1YpPaMa8RJ\ntnqNFy4pFfqBh5tmidHQ3QMRvINPrGtQM5+VgMXoA0y8izql52M1K/3Q6sHVlAXd\nmpQcBO+JSHY7uyVx1txZssyisia7Nn8Frh/XRpl0oUvGkSnbm/KgqDAP0xJ3lUZS\nEGiIWdf0bn7tHD3nYBMrWWi3jSQWf0Q80asIEYWipwkfMPf0ffzu4FX0elfvpyOX\nr50xk7sb8K5IhcilwxKxQpPOcq3f6ph0EERQR7pOdDqkzFdHoGiyssSX4MYM60kd\nmQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 3] [Relay] Listening for incoming messages on port 9103 (RELAY PORT 9103)
[Relay 3] [Relay] [handle_message ENTERED] addr=('10.250.120.196', 54869), thread=6196244480, relay_port=9103
[Relay 3] [Relay] [DEBUG] Raw data received: b'{"next_ip": "10.250.120.196", "next_port": 9102, "session_key": "GtvFrZTF/sZRQYwIXea2A0ayhuXoGk5eR6YgnA4HqteaYvXjLiqk7zxDspuFfd4GI4/8Xe8pLSXf6wKzydKH6SBn5MKW1WIxffi0C+CeKXsVlwHR60SQgkCpKsRa/1F5IN7gI+9vVMnJI1ZcVYE2XJsacuUw7G1qcfN5ghYSrSqMWxR9JrP72/avQUpxFy1CkJqtBKlxI+IMRUVcDsnReWg7GVkWEzVG7t7OKsittzmgmlvl9/R9uQp+HzLztZxu7YbVDmeDUIN8KMOEe+f9VgGU+gtqf46K99J1e8IlyToMtpZ+yOQyme0TVguHUkYc78hCLwWdripjNT6ZwiKEDw==", "payload": "UEoX4P4a8GZ0TrRgS/Eomsd6T1mofq7qB4MJKqY0GrOo+LbbEC8qbwilZjqY4yrUCvRd60UvpvV/xUc1I4lfVf8AmMQ+ZlW6CQbChoPGmmAPFcpErGnlZ3lH8/Bcfa6TBjXUdimDydbhGw8JC6pBOalez2VZ5PUXV0jZJchN/cMLlXd2BQahNcoH1L5pCBHGcBTY2ajs59FtmyxYuMKN4OWG0GGqW2n06fH9U9atUPQvWUz167dp/owPreyWhiJSb7FBDLpLnCN1Lh5OmKqqlQ/Sv8Nx6MTVSN92ExawkS2RRWYxPmJMaOfcSnFAU1niiA9cjWC0zzZZgA5OOAo26xmuv7ckoXvLOTYeVeYUTGWWCdKAkXAji+GOf8VM8YzxB/v0FzOXG/nKDgEwekDbHvNTRoInK1X4Dx/wiv5UaoXwvB4qn1Q2wnLWdgRITun2FECNsVSXSL0iFbgwk/i+dsW1Pl7ojSj1bqKKJ+Z599bw2JMugycxJZGrmrZ9pJyyN0jLj4EL5KQ/yiwCKaKeFCkBnyIbCyXTbkZR+oZMozTjmN4z7JiQRLLTopUGwxFXShDECySA7djWAmwcJH97Q0A3pPxmFEerZE0DH48xTpTC4ZE3qA=="}'
[Relay 3] [Relay] [DEBUG] Data after JSON parse: type=<class 'dict'>, keys=['next_ip', 'next_port', 'session_key', 'payload']
[Relay 3] [Relay] Received session_key (base64): GtvFrZTF/sZRQYwIXea2A0ayhuXoGk5eR6YgnA4HqteaYvXjLiqk7zxDspuFfd4GI4/8Xe8pLSXf6wKzydKH6SBn5MKW1WIxffi0C+CeKXsVlwHR60SQgkCpKsRa/1F5IN7gI+9vVMnJI1ZcVYE2XJsacuUw7G1qcfN5ghYSrSqMWxR9JrP72/avQUpxFy1CkJqtBKlxI+IMRUVcDsnReWg7GVkWEzVG7t7OKsittzmgmlvl9/R9uQp+HzLztZxu7YbVDmeDUIN8KMOEe+f9VgGU+gtqf46K99J1e8IlyToMtpZ+yOQyme0TVguHUkYc78hCLwWdripjNT6ZwiKEDw==
[Relay 3] [Relay] Decoded session_key_enc (hex): 1adbc5ad94c5fec651418c085de6b60346b286e5e81a4e5e47a6209c0e07aad79a62f5e32e2aa4ef3c43b29b857dde06238ffc5def292d25dfeb02b3c9d287e92067e4c296d562317df8b40be09e297b159701d1eb44908240a92ac45aff517920dee023ef6f54c9c923565c5581365c9b1a72e530ec6d6a71f379821612ad2a8c5b147d26b3fbdbf6af414a71172d42909aad04a97123e20c45455c0ec9d179683b195916133546eedece2ac8adb739a09a5be5f7f47db90a7e1f32f3b59c6eed86d50e678350837c28c3847be7fd560194fa0b6a7f8e8af7d2757bc225c93a0cb6967ec8e43299ed13560b8752461cefc8422f059dae2a63353e99c222840f
[Relay 3] [Relay] Decrypting session key with fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] [Relay] Decrypted session_key (hex): d8b542edc3b6006ea8a278416f227e3d270c979424b70f3665ef66b8a829cb90
[Relay 3] [Relay] [DEBUG] About to AES-decrypt payload (passing base64 string directly)
[Relay 3] [Relay] [DEBUG] Payload base64-decoded: type=<class 'bytes'>, len=469, preview=b'PJ\x17\xe0\xfe\x1a\xf0ftN\xb4`K\xf1(\x9a\xc7zOY\xa8~\xae\xea\x07\x83\t*\xa64\x1a\xb3\xa8\xf8\xb6\xdb\x10/*o\x08\xa5f:\x98\xe3*\xd4\n\xf4]\xebE/\xa6\xf5\x7f\xc5G5'
[Relay 3] [Relay] [DEBUG] AES-decrypted payload: type=<class 'bytes'>, len=453, preview=b'\x11\x11*\xd3J\xd4.\xfe\xff\xddLx\xda"G\x05S-\x16A\xca\xe5\xf0E\xdc\xf0i/\x0b\xbbf^q:-\xf4\x88mF\xfd\xb1\x0f\xdf\xa2\xb0S\x8e\xb9\x8e\xcdG\x89\x0b\x02\x8b\x08\xa7\xf9\xb4\xd1'
[Relay 3] [Relay] [DEBUG] AES-decrypted payload (hex): 11112ad34ad42efeffdd4c78da224705532d1641cae5f045dcf0692f0bbb665e713a2df4886d46fdb10fdfa2b0538eb98ecd47890b028b08a7f9b4d1
[Relay 3] [Relay] [DEBUG] AES-decrypted payload not UTF-8: 'utf-8' codec can't decode byte 0xd3 in position 3: invalid continuation byte
[Relay 3] [Relay] [DEBUG] Payload is not JSON, assuming last hop. Error: 'utf-8' codec can't decode byte 0xd3 in position 3: invalid continuation byte
[Relay 3] [Relay] [Last Hop] Forwarding payload to dest 127.0.0.1:9100, len=453, type=<class 'bytes'>
[Relay 3] [Relay] [Last Hop] Sending to dest: type=<class 'bytes'>, len=453, preview=b'\x11\x11*\xd3J\xd4.\xfe\xff\xddLx\xda"G\x05S-\x16A\xca\xe5\xf0E\xdc\xf0i/\x0b\
[Relay 3] [Relay] [Last Hop] Received response from dest: type=<class 'bytes'>, len=72, preview=b'{"result": "ERROR", "error": "ERROR: Could not decode payloa'
[Relay 3] [Relay] [Last Hop] Response to client (UTF-8 JSON): b'{"result": "ERROR", "error": "ERROR: Could not decode payload as JSON."}'
[Relay 3] [Relay] [Last Hop] AES-encrypted response (hex): 229f4ac9d73da686eb8ce5a8e83678e71bf284cb74037e91991bcc4daa32c2f5a3d416dbcbf62029c316012dbcf9ab9b6a16d3919006a2cf531e446a
[Relay 3] [Relay] [Last Hop] Base64-encoded AES-encrypted response: type=<class 'bytes'>, len=120, preview=b'Ip9Kydc9pobrjOWo6DZ45xvyhMt0A36RmRvMTaoywvWj1Bbby/YgKcMWAS28'
[Relay 3] [Relay] [Last Hop] Sent response to ('10.250.120.196', 54869): b'Ip9Kydc9pobrjOWo6DZ45xvyhMt0A36RmRvMTaoywvWj1Bbby/YgKcMWAS28'... (len=120)
[Relay 1] [Relay] Deregistering from CDS and shutting down...
[Relay 3] [Relay] Deregistering from CDS and shutting down...
[Relay 2] [Relay] Deregistering from CDS and shutting down...
[Relay 3] [Relay] [handle_message END] addr=('10.250.120.196', 54869), thread=6196244480
[Relay 1] [Relay] ERROR during deregistration: [Errno 54] Connection reset by peer
[Relay 2] [Relay] ERROR during deregistration: [Errno 54] Connection reset by peer
[Relay 3] [Relay] ERROR during deregistration: [Errno 32] Broken pipe
[Relay] ---- Relay process started ----
[Relay 1] [Relay] Loaded persistent RSA keypair from relay1_key.pem
[Relay 1] [Relay] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] [KEY] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] Relay 1 starting on 10.250.120.196:9101 (RELAY PORT 9101)
[Relay 1] Registering with CDS at 127.0.0.1:9000
[Relay 1] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9101, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5MM7/HBECV26fZqjUJkt\nQ4+dx297cL0hf1+rf08Qir5tL/lArfQsiplTqcsIsZiN7vJ8K2XzvK5JAEv8tVE4\nEKU4W1hbEVBd1eLCX+Oc5XauTbWhW8xlc2wdNlNwDhin2Mw84doKJWPyfjtIwnIi\n3nWHqxLyAqkj6qDoByA8D7YVmJxvzwL0mrYE8G8b4Q4Wjnx2SXeTwc9LRzqwrsyb\nlM5B4BSVPBignOMhD2AfuIFw6uULQThbkL9L5AnQA08B4Gqzo731LLJN/Y6qo+VJ\nki2t6m1aJTG0LBjijpH7CtnN1MHIQ5UueS1sJVYZooYxkxEYYZTqIUXxuI5ICKPC\nCQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 1] [Relay] Listening for incoming messages on port 9101 (RELAY PORT 9101)
[Relay] ---- Relay process started ----
[Relay 2] [Relay] Loaded persistent RSA keypair from relay2_key.pem
[Relay 2] [Relay] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] [KEY] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] Relay 2 starting on 10.250.120.196:9102 (RELAY PORT 9102)
[Relay 2] Registering with CDS at 127.0.0.1:9000
[Relay 2] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9102, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA58J3pSrOQd4hYnuzQQ7q\nWrjjo+3BJp+ik23brR2yl0kjtfH+wjD9LYWHS7dBxsDRzSozJ/7EWKKNCaTsgvaF\nN6vpyBPqDM/uQfOWfirteL50RgDZw95Vml4Fuay7bTBEb1J8ydvFqawo8rnLE2I3\nU4BjBT+CD38bY3je8wrrCX9fo1uYaLDlfteGshadZ2gnTxrAzkZZ/CTFdyb8JrmN\nIuxjBVjwSA/uIv+KHWQhXRA5jJPXcNV88LYXyEzpid1Cr9gnrqA88K0HSleiwZjU\nJF3LhBvS2Ga2HHfFsk5D/yz/pTHwDvRA98VMT/90wahwmSJsck4XWDFhmNhy3oDR\nBQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 2] [Relay] Listening for incoming messages on port 9102 (RELAY PORT 9102)
[Relay] ---- Relay process started ----
[Relay 3] [Relay] Loaded persistent RSA keypair from relay3_key.pem
[Relay 3] [Relay] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] [Relay] [KEY] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] Relay 3 starting on 10.250.120.196:9103 (RELAY PORT 9103)
[Relay 3] Registering with CDS at 127.0.0.1:9000
[Relay 3] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9103, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5k9OJ8m3IdjmwR1skM1G\nwrKkwlYLK0Qs+I/BX5ww5wEakOsTy5NVFAwTYrCUnR012u2jCwI8wV1YpPaMa8RJ\ntnqNFy4pFfqBh5tmidHQ3QMRvINPrGtQM5+VgMXoA0y8izql52M1K/3Q6sHVlAXd\nmpQcBO+JSHY7uyVx1txZssyisia7Nn8Frh/XRpl0oUvGkSnbm/KgqDAP0xJ3lUZS\nEGiIWdf0bn7tHD3nYBMrWWi3jSQWf0Q80asIEYWipwkfMPf0ffzu4FX0elfvpyOX\nr50xk7sb8K5IhcilwxKxQpPOcq3f6ph0EERQR7pOdDqkzFdHoGiyssSX4MYM60kd\nmQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 3] [Relay] Listening for incoming messages on port 9103 (RELAY PORT 9103)
[Relay 1] [Relay] Deregistering from CDS and shutting down...
[Relay 2] [Relay] Deregistering from CDS and shutting down...
[Relay 3] [Relay] Deregistering from CDS and shutting down...
[Relay 1] [Relay] ERROR during deregistration: [Errno 54] Connection reset by peer
[Relay 2] [Relay] ERROR during deregistration: [Errno 54] Connection reset by peer
[Relay 3] [Relay] ERROR during deregistration: [Errno 54] Connection reset by peer
[Relay] ---- Relay process started ----
[Relay 1] [Relay] Loaded persistent RSA keypair from relay1_key.pem
[Relay 1] [Relay] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] [KEY] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] Relay 1 starting on 10.250.120.196:9101 (RELAY PORT 9101)
[Relay 1] Registering with CDS at 127.0.0.1:9000
[Relay 1] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9101, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5MM7/HBECV26fZqjUJkt\nQ4+dx297cL0hf1+rf08Qir5tL/lArfQsiplTqcsIsZiN7vJ8K2XzvK5JAEv8tVE4\nEKU4W1hbEVBd1eLCX+Oc5XauTbWhW8xlc2wdNlNwDhin2Mw84doKJWPyfjtIwnIi\n3nWHqxLyAqkj6qDoByA8D7YVmJxvzwL0mrYE8G8b4Q4Wjnx2SXeTwc9LRzqwrsyb\nlM5B4BSVPBignOMhD2AfuIFw6uULQThbkL9L5AnQA08B4Gqzo731LLJN/Y6qo+VJ\nki2t6m1aJTG0LBjijpH7CtnN1MHIQ5UueS1sJVYZooYxkxEYYZTqIUXxuI5ICKPC\nCQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 1] [Relay] Listening for incoming messages on port 9101 (RELAY PORT 9101)
[Relay] ---- Relay process started ----
[Relay 2] [Relay] Loaded persistent RSA keypair from relay2_key.pem
[Relay 2] [Relay] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] [KEY] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] Relay 2 starting on 10.250.120.196:9102 (RELAY PORT 9102)
[Relay 2] Registering with CDS at 127.0.0.1:9000
[Relay 2] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9102, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA58J3pSrOQd4hYnuzQQ7q\nWrjjo+3BJp+ik23brR2yl0kjtfH+wjD9LYWHS7dBxsDRzSozJ/7EWKKNCaTsgvaF\nN6vpyBPqDM/uQfOWfirteL50RgDZw95Vml4Fuay7bTBEb1J8ydvFqawo8rnLE2I3\nU4BjBT+CD38bY3je8wrrCX9fo1uYaLDlfteGshadZ2gnTxrAzkZZ/CTFdyb8JrmN\nIuxjBVjwSA/uIv+KHWQhXRA5jJPXcNV88LYXyEzpid1Cr9gnrqA88K0HSleiwZjU\nJF3LhBvS2Ga2HHfFsk5D/yz/pTHwDvRA98VMT/90wahwmSJsck4XWDFhmNhy3oDR\nBQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 2] [Relay] Listening for incoming messages on port 9102 (RELAY PORT 9102)
[Relay] ---- Relay process started ----
[Relay 3] [Relay] Loaded persistent RSA keypair from relay3_key.pem
[Relay 3] [Relay] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] [Relay] [KEY] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] Relay 3 starting on 10.250.120.196:9103 (RELAY PORT 9103)
[Relay 3] Registering with CDS at 127.0.0.1:9000
[Relay 3] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9103, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5k9OJ8m3IdjmwR1skM1G\nwrKkwlYLK0Qs+I/BX5ww5wEakOsTy5NVFAwTYrCUnR012u2jCwI8wV1YpPaMa8RJ\ntnqNFy4pFfqBh5tmidHQ3QMRvINPrGtQM5+VgMXoA0y8izql52M1K/3Q6sHVlAXd\nmpQcBO+JSHY7uyVx1txZssyisia7Nn8Frh/XRpl0oUvGkSnbm/KgqDAP0xJ3lUZS\nEGiIWdf0bn7tHD3nYBMrWWi3jSQWf0Q80asIEYWipwkfMPf0ffzu4FX0elfvpyOX\nr50xk7sb8K5IhcilwxKxQpPOcq3f6ph0EERQR7pOdDqkzFdHoGiyssSX4MYM60kd\nmQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 3] [Relay] Listening for incoming messages on port 9103 (RELAY PORT 9103)
[Relay 3] [Relay] [handle_message ENTERED] addr=('10.250.120.196', 55723), thread=6130315264, relay_port=9103
[Relay 3] [Relay] [DEBUG] Raw data received: b'rP\xf5b@\x92\x96Yz\xe1\xc9l\xea\xd7\xa0e\x7f)\x97&\xab\xdavc\xc4\x8f\xda\xe5\t\xf4(N\x93\xab5;L\xb8R\xd4\x8a\x0b\x18\x98\xcf\xb7\xa1\x10\xd1v\xdfX\xff\xad\xbb@\xe6\xfc\xe7\x882\xe6#\xdff\x82\x94\xfa\xd5\xcdW|\xf4a$\x84\xfa\xe6Aw/\x93u6\xf5\xd0\x06C\xcd\xfd\x8c\xd9\x91\xba\xdf\xfe\tL\x94-\xc2\xa12\x8dq\xdd\xb8\x97\x84_\xae5\xa9\x15;\xd4\xe5\r%\xe5B\x0fo(\xa0lY\x86\x82\x81\xf6\xb1u\x88\x1a(\xac\xech+_?\x1e\x1f\x19\xcf6|w\xdc\xca\x9f\x7f8S+0\xda\xbe\xd0\x1c\xd5\xb1\xad\x01l\x12\x8e\xf3\xb5\x8a\xbeKr\xe1\xe6\xebGS\x90\x16\xc2\x889\xac\xe9\xb0\r\xa4\x0b\x9ek\x93x\\S\xb7\'\n\xb2S\xac \xb4\xdf\xd9\xea*\x11E\x81\xbd\xcf\xf6\x05I\x8e\xf5\xdb#Gmz\r\xb7\xc5\xd3_|\x91\x88\xdfz\xca\x90\'\xb7H\x07\x0c\x12\x8f\x1e\x95\x03\x9d2rSw2.)1\x10\r7E\x1d\xc3\x10%\xeeT\x9e\xc5\x9b\x85\xb5^\xcd^D\\\xa1\xef\xa0d\xdb\x7f\x16\xe8\xeaN\xb3\xd9\x90\x0eL\x9f\xd2k\xd6H\xca\xb0\xc1\x926\xb3<k\xb5\x8e\x96"\t\xbe\x0cp\xa1z\xaa\xb8\x05\xc0:>jb\x87\rUy\x19S\x94\x88\x9e\xec;\xeeDw*8\x81\xa1\xc9YuV\x00\x8d\x81\x18-\n>\xf8\x98\xfb\xabF\xb6\xb6S\xe5\xf1\xce\\\xfc\x1e)\x9d\x9c\x90\x18\x12:\xebf:R\'H\x0f\x8c\x86\x7fm\x8e\xd8\xf4\xcf\xca+\x0eW\xa5\xdc\x94\xff\x01(\x82S\x88\xf2:\xbb\xe5\xb0\x9c3q%\x1e\x05Q\x90\xeb\xb4\xe2Zd\x7f8\xd28\x06v&\xb9\x90\xcdL\xed5,\x11\x08pZ\x0c\x92\xbe\xe2\xe2\x13\x98s7\x01r\xaa6\xddcC\xc7@\xc9\xf66\xdd\x83b.\xdfB\xe8u\x08\\ax\xbed\xfcw\x9d\xbbN\xe6\x8d\xea\xfb\x96\xae\x1b-\x84f\xf8\xe5\xe7\xb4\xfe\xc2C0\xfcZ0\x0cX\x9d\xe0f\xc0x\x0b\x0f\x08\xa2\xe2\xe8\x9b\xe3s\xbaI\x08\xd9\x9f7\x18Q| \xda\x9e\xea\x8bOf\xeb( \xd0LS\x8e\x8e\xd9\xbdX{fl\x8b6\x89z\x14\xbd\xf7\x9c\x10\xb5\x9b\x02\xd9h\x00Sn\x11\xa4#\x8c\xbbt*cS;\x1cd\xa0\xed\x9c\x0e\xd1\x8b\x9b\xf7\x02\xe4\n\x14\x980A(5\xbfRG\xfb\'\t\xcb\xdc\x98\xb9\x7f\x9e1\xb3\xb9\xccV\x98m\x86\xb7\x06\xb2\x9a\xac\xf3\xeb\xcfedm\x86\x04\x92H\x9c\x7f\x83\xff2@\xba8\xffZf\xb8\xc6\x88\x96\xce*\x8d\x1e\'\x06l\xdcx\xca>\xc0\xc5e\xc8\x12R\xd5\xec\xae\xbd\xa432\xe4]\xfa\xb1i\x1e-W\x8c\x948\xadB,\xe8O\x1b5\xd8b\x9f\xa3\xa0\xe8\xae\xf1@\xbf?\xdau\x97\x0b\xafy>\x95\xe1\xa4\x94\x10!\xca{\x88\xe3\x80\x96t\xe0i\x04\xf7\x92l7\xc4!\x86\x0cu<\xc4\xc4\xf7A\x85\x18\x93\x9e\x7fG\xd4\xb6\xb8\xcd\xc6\x95\xafHF\xf4\xbe\xd7\x9d\xaa\x97 \xfd\xf9\xaa\xa7"\xd5\xafb\xf0\x87\x9a\x9b\x97%\x00w\x86\x91\xc1\xa1\xdf\xbe\xb2\xb1\xeco\xc5\xfe\xb7\x84g1\xf6#\xab\x93\x98Ao\xab\xd2\xe1\xa1\xe8\xb7\x9d\x19n\xc4\x84^\xa6D/\x95\x0802k\x1a|\x96\x8a\xacK\x8f\xdfC6\xd8#<\xf4\xa3\x072\xacK\xc8\xa7\x07\xdf\xcdr\x1c\x97\x03\xaf\'\x97\x00\xc6W\x8d\xad\xbf\xff\xe9\x13g\x02]a\x94\xcb\x18\x01h/\xd6\x80\xefy\xbapF\x0b\xfb\xc1"\x85 ]_\xe4\xab\xa1L\x07\xac?m\x19\x87\xde\xc0\x10\x1c\\\x10\xd7(t\xa1\xcf\x9a\xcfB7\x92\xa4(\xc8\x1f\rR\xc9\x87{\x9f\xab`\x84\xaa\x81R*\xf1\xe5k\xe3\xd4BD,\xac*\xa0\x9a\xcd\xb65\x90\xa3\xc8\xcf\x14^\xba\x81H\x98\xbf\xdc)\xc4\x0cr\xdcd\xcd\x04\xb9\xa4rT\x8b\xd3\x19D\x95\xf9\xc3\xe3j$,\x01\x17\x0b{\x83\x97B\xf7\xf4u\xeb\x9fv\x856O!\xfb\x8b_\xac\xf4\x1e\x85\xb0TK\x1b\x95\x99T3\x02\\f\x08V\xa5\x9f\xb4\x96\x1d\xc0\xa6\xf8\xf4PI\x1cR\xc4\xe2\xdb \xc4\xd8.:\xeb\x7f\xdeI\xe5\xf3M@\x97:\x8f\x07\xb38\x8b\xfb\xeb\xa7 \xb9\xa9\xc5T[!\x9d:\xb4B_\x07\xbew\xddQ\x96\x16rh~J\xc5K\xc4\xa1G'
[Relay 3] [Relay] [handle_message END] addr=('10.250.120.196', 55723), thread=6130315264
[Relay 1] [Relay] Deregistering from CDS and shutting down...
[Relay 2] [Relay] Deregistering from CDS and shutting down...
[Relay 3] [Relay] Deregistering from CDS and shutting down...
[Relay 2] [Relay] ERROR during deregistration: [Errno 54] Connection reset by peer
[Relay 1] [Relay] ERROR during deregistration: [Errno 54] Connection reset by peer
[Relay 3] [Relay] ERROR during deregistration: [Errno 61] Connection refused
[Relay] ---- Relay process started ----
[Relay 1] [Relay] Loaded persistent RSA keypair from relay1_key.pem
[Relay 1] [Relay] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] [KEY] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] Relay 1 starting on 10.250.120.196:9101 (RELAY PORT 9101)
[Relay 1] Registering with CDS at 127.0.0.1:9000
[Relay 1] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9101, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5MM7/HBECV26fZqjUJkt\nQ4+dx297cL0hf1+rf08Qir5tL/lArfQsiplTqcsIsZiN7vJ8K2XzvK5JAEv8tVE4\nEKU4W1hbEVBd1eLCX+Oc5XauTbWhW8xlc2wdNlNwDhin2Mw84doKJWPyfjtIwnIi\n3nWHqxLyAqkj6qDoByA8D7YVmJxvzwL0mrYE8G8b4Q4Wjnx2SXeTwc9LRzqwrsyb\nlM5B4BSVPBignOMhD2AfuIFw6uULQThbkL9L5AnQA08B4Gqzo731LLJN/Y6qo+VJ\nki2t6m1aJTG0LBjijpH7CtnN1MHIQ5UueS1sJVYZooYxkxEYYZTqIUXxuI5ICKPC\nCQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 1] [Relay] Listening for incoming messages on port 9101 (RELAY PORT 9101)
[Relay] ---- Relay process started ----
[Relay 2] [Relay] Loaded persistent RSA keypair from relay2_key.pem
[Relay 2] [Relay] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] [KEY] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] Relay 2 starting on 10.250.120.196:9102 (RELAY PORT 9102)
[Relay 2] Registering with CDS at 127.0.0.1:9000
[Relay 2] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9102, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA58J3pSrOQd4hYnuzQQ7q\nWrjjo+3BJp+ik23brR2yl0kjtfH+wjD9LYWHS7dBxsDRzSozJ/7EWKKNCaTsgvaF\nN6vpyBPqDM/uQfOWfirteL50RgDZw95Vml4Fuay7bTBEb1J8ydvFqawo8rnLE2I3\nU4BjBT+CD38bY3je8wrrCX9fo1uYaLDlfteGshadZ2gnTxrAzkZZ/CTFdyb8JrmN\nIuxjBVjwSA/uIv+KHWQhXRA5jJPXcNV88LYXyEzpid1Cr9gnrqA88K0HSleiwZjU\nJF3LhBvS2Ga2HHfFsk5D/yz/pTHwDvRA98VMT/90wahwmSJsck4XWDFhmNhy3oDR\nBQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 2] [Relay] Listening for incoming messages on port 9102 (RELAY PORT 9102)
[Relay] ---- Relay process started ----
[Relay 3] [Relay] Loaded persistent RSA keypair from relay3_key.pem
[Relay 3] [Relay] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] [Relay] [KEY] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] Relay 3 starting on 10.250.120.196:9103 (RELAY PORT 9103)
[Relay 3] Registering with CDS at 127.0.0.1:9000
[Relay 3] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9103, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5k9OJ8m3IdjmwR1skM1G\nwrKkwlYLK0Qs+I/BX5ww5wEakOsTy5NVFAwTYrCUnR012u2jCwI8wV1YpPaMa8RJ\ntnqNFy4pFfqBh5tmidHQ3QMRvINPrGtQM5+VgMXoA0y8izql52M1K/3Q6sHVlAXd\nmpQcBO+JSHY7uyVx1txZssyisia7Nn8Frh/XRpl0oUvGkSnbm/KgqDAP0xJ3lUZS\nEGiIWdf0bn7tHD3nYBMrWWi3jSQWf0Q80asIEYWipwkfMPf0ffzu4FX0elfvpyOX\nr50xk7sb8K5IhcilwxKxQpPOcq3f6ph0EERQR7pOdDqkzFdHoGiyssSX4MYM60kd\nmQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 3] [Relay] Listening for incoming messages on port 9103 (RELAY PORT 9103)
[Relay 3] [Relay] [handle_message ENTERED] addr=('10.250.120.196', 55924), thread=6131380224, relay_port=9103
[Relay 3] [Relay] [DEBUG] Raw data received: b'\x8c]2\xbc\xd9\xdd\xbe\xfdH.{\xd6\xe5\xf6t\xf7\xb0\xd9\x9e\xa9\x8dQ\xa63e\x9e+\xddG\xb1F\x96vU\x87F2\xb7\xe3\x9a\x14\t\xa9+-\x97\xeaL\xba\tU3\xbe\x98}\xc9(\x17\xed\xf7Z\xf4\xad\xfb\x90\xeb!\x8f\xdcF\n\x86\x94\x17\xdb\xb5\xcf\x19@|\xe0b1\xdcc\xa9K{\x9eC\x9c\xabV\xdb\x14\xdd\xc8s\x1b<\x08\x90a\x9c\xa8l\x16\x86\xa9iP\xa5h\xd54G\xc6u\xe0E)\xda4W\x12\xd99z\xaa\xdb=\xf5\xbd\x16\xaa1\xbb6\x85h\xd0\x81\xf6:\x80(\xe278y\xbf\xcc\xceLu\xd8\xd69\x07W\x95O\xf1\xb6\x8e&[\xba\xe7\xe7\x19B\xa5\x86\x17\xd4\xc7<\x82\xdf-J\xd4\x1c_\x8fv\xfa\x8a<\xe8\xb0\x82\x7f\xaf\x1e\xad\x7f\xc3\xbd~\xd9(8\x90\xf8|w\x1e\xa4z9\xff;q\x9f\xd1\xf4\x18\xa6\x82~\x1b\tn-\x85\xec[)\xe0\x95\xc8p\xd20\x03\xb2\x93\xa9\xae\xcae\xee\x8b\xa0\xfd\xf6 \xc7\xa5\x16\x97\xb8\xfbS\xfe\xc2G\x8b\xde\xdf\x9d\xd8\x06\xa9\xc3\xb9\xa1>tCN7\xa9`>\xa4\x93?\x9a\x15\xb9\x92\x00\xa5\x18\xec\t\x96\x1c\xa2\x01\x07\xee\xc5\r\nB\xcb\t\xb1 )\xc1jk\x1a\xfb\x8a\x1e\x05\x826\xd1\x01\xd4hi\x1f\xdc\xb4\xe5;ce]5N\x80\xfe\xff4\x8f3B\xba}\x12E\x0e\xe0\xff\xb7\xdb\xb6\xe7T`J\xc4D\x18F\xb7\xe2)\xdc\xcbZ&y\x8aL 98r\x86\x13\xe0\xff\x93._\xd7\xd7y\r:\xff\xbeo)H!\x10{u\x8fl\xdcS\xda8I\xca\xb3\xa4\xe8e\xa0\xdaL\x85J\x1b\xd9\xd8\x93p\xa9\xfd\xa9;D\x1f?#\xae;\x81X\xbe\x15\xa6\xd3\xec\x84\x9b\x0bC\x94J1 \xea\x13jmy\xe3Fd\x0f,\xc4\xf6\xfa\xba\xb1N\xf9\x03y6Tn\x02\xbd\xc3!\x7f\xb0X3\x12\xec eH\x19YE\xbe\x8b\t\xb5\xe9\x18\xc0\xbbwf\xe5g\xe9n\xebI3\xc6\xeex\xea\x8dS\xe9$\x03y\x99i\xbe \xd4\xd1\xe1\x1f\x10R\xcb$Zt\xc7\xc0t\x1d\xb5\xb4\x94=\xdf\xdcM4\xceYv\x9b\x8a\x1f\xc2\xcb7\xd6\xe0\x8at:\x1641Za\x02\x7fzR;\r\xff\x98\xf15z\xf6c\xbaW\x8d\xa8h\xb3\xc7\xe8\x9e\rCFb\xad\x02VH\t\x1f\xe4D\xc7\x84\\|\x15Or\xd7@\x8a\r9H\xbe\xeb+\x11~2\xb5\xc8m:\x97\xf0g\xba\x98\x88\xcd\xd3\xa1\xdbL\x96>i\x194\'\\8\xd7\xdfFX\xecsz\xa0\xca\xbd\x1b\x0f5\x8c\xc6\xf6\xc8\x86`\x91\xf1\x9e\x18\x93,U\x93\x89\\x\x89q\x19\xb4\t\x04r9\x8d\xee\x81,O\x18\xfe(|\x10P\xe4\xf8^\xee\xd3\x94\xe3(\xfa\xb2"\x923"=~\x03\'\xd0\xb3\x9b\xeee2\x18\xae\xe4\x96tT\x0f]\x83\xa3W\x1alJ\x0er\x88\x1c\xa4\xe2\x17\x81\xb9\xa3\xa5\xcbW%\xae\x1ff\nQ\xfbt\xb01\xf8\xa0;\x86\xa6\x0b\x02x;\xcf\x14Cj\x7f\xfb#s\x90\xb8Y\xa8/\x11\x0e\x11m|[\x85\xc7\xfb\x97\xe1\\\x84\x94=\x0c\x11\xca\xe5\xe0\x9f\xf9:a\xabf\xa7q\x88&F\x868\xf2\xf4\x1b\xc6\xb6\xb3\x80\xcd\xeb\xdfE\x1c6\x01\xb6\xaf\xe0.\xba\xb4\xe4\xd8\xdf\x94\xe96\'\xda\xa7\x14\xbeoj\xb5\x99\xd0n\xa7\xe6\xdaX\x8f\xc1\xec\x04\x03\xcf\xdf\xc9{\xfc\x91\x1b\xa1\xd7V\xb6\xb8\'\x00QE\xb2\xea%7\xac\x84\xf7lT\xe2\x8dYRz\xffP`\xb6OL\x02\x8d#\xd9\xcb`$7\x90.\xe8=\x8d\x93zP\xf3\xde\xe5\xff\xb65\x0e\x8e\x07\xa1v\xfaCQD\xfaqS\xb6q\xf3:\xf6p\x9c\xe3\x9e\xd0\x08iE\xc2?\xc2\x1c\xccY\x0b\x9a$\x18\xe5\x93\x1e\x13\xc6[\x16Y_\x94\xd8R\xdfc\x7f\\\xa0\'\xfc\xe9\x8a\x7f\xafGi\x18\xea\x9c\xcc\x9d\xees\xe1\xbc6\x87\x10}\xa3\xfb\xb6\x99\x88Ee\x02\xcb\xa6\xfa74\x0e\xeb\x86\xae\xa2\x14\xf1\xa0u\xc8]\xdce\xc2"\xec\x11\x98\x0f\x964\x10n\xe9\xc6\xf9\xbb]\xd5\xca\xe9zvO(KhI\xd98\xd0mc\xfb\xf7\x19\x02\xf4\xa1\xe2\xb2HB\n]v\x07,\xee\x07\xcey\xb7\x7f\x1bv\x06\xbc$a\x86\xda\xf9\n;\x97\x18\xb5;\xba\xf1hC\xff\xac\xf5\x05\x00\x13\x18\xd3C\x97'
[Relay 3] [Relay] [DEBUG] Data is not JSON, treating as last hop (forwarding to dest)
[Relay 3] [Relay] [Last Hop] Forwarding payload to dest 127.0.0.1:9100, len=1070, type=<class 'bytes'>
[Relay 3] [Relay] [Last Hop] Sending to dest: type=<class 'bytes'>, len=1070, preview=b'\x8c]2\xbc\xd9\xdd\xbe\xfdH.{\xd6\xe5\xf6t\xf7\xb0\xd9\x9e\xa9\x8dQ\xa63e\x9e+
[Relay 3] [Relay] [Last Hop] Received response from dest: type=<class 'bytes'>, len=72, preview=b'{"result": "ERROR", "error": "ERROR: Could not decode payloa'
[Relay 3] [Relay] [Last Hop] Response to client (UTF-8 JSON): b'{"result": "ERROR", "error": "ERROR: Could not decode payload as JSON."}'
[Relay 3] [Relay] [Last Hop] ERROR forwarding to dest: key must be bytes-like
[Relay 3] [Relay] [handle_message END] addr=('10.250.120.196', 55924), thread=6131380224
[Relay 1] [Relay] Deregistering from CDS and shutting down...
[Relay 2] [Relay] Deregistering from CDS and shutting down...
[Relay 3] [Relay] [handle_message END] addr=('10.250.120.196', 55924), thread=6131380224
[Relay 3] [Relay] Deregistering from CDS and shutting down...
[Relay 2] [Relay] ERROR during deregistration: [Errno 54] Connection reset by peer
[Relay 1] [Relay] ERROR during deregistration: [Errno 54] Connection reset by peer
[Relay 3] [Relay] ERROR during deregistration: [Errno 61] Connection refused
[Relay] ---- Relay process started ----
[Relay 1] [Relay] Loaded persistent RSA keypair from relay1_key.pem
[Relay 1] [Relay] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] [KEY] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] Relay 1 starting on 10.250.120.196:9101 (RELAY PORT 9101)
[Relay 1] Registering with CDS at 127.0.0.1:9000
[Relay 1] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9101, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5MM7/HBECV26fZqjUJkt\nQ4+dx297cL0hf1+rf08Qir5tL/lArfQsiplTqcsIsZiN7vJ8K2XzvK5JAEv8tVE4\nEKU4W1hbEVBd1eLCX+Oc5XauTbWhW8xlc2wdNlNwDhin2Mw84doKJWPyfjtIwnIi\n3nWHqxLyAqkj6qDoByA8D7YVmJxvzwL0mrYE8G8b4Q4Wjnx2SXeTwc9LRzqwrsyb\nlM5B4BSVPBignOMhD2AfuIFw6uULQThbkL9L5AnQA08B4Gqzo731LLJN/Y6qo+VJ\nki2t6m1aJTG0LBjijpH7CtnN1MHIQ5UueS1sJVYZooYxkxEYYZTqIUXxuI5ICKPC\nCQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 1] [Relay] Listening for incoming messages on port 9101 (RELAY PORT 9101)
[Relay] ---- Relay process started ----
[Relay 2] [Relay] Loaded persistent RSA keypair from relay2_key.pem
[Relay 2] [Relay] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] [KEY] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] Relay 2 starting on 10.250.120.196:9102 (RELAY PORT 9102)
[Relay 2] Registering with CDS at 127.0.0.1:9000
[Relay 2] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9102, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA58J3pSrOQd4hYnuzQQ7q\nWrjjo+3BJp+ik23brR2yl0kjtfH+wjD9LYWHS7dBxsDRzSozJ/7EWKKNCaTsgvaF\nN6vpyBPqDM/uQfOWfirteL50RgDZw95Vml4Fuay7bTBEb1J8ydvFqawo8rnLE2I3\nU4BjBT+CD38bY3je8wrrCX9fo1uYaLDlfteGshadZ2gnTxrAzkZZ/CTFdyb8JrmN\nIuxjBVjwSA/uIv+KHWQhXRA5jJPXcNV88LYXyEzpid1Cr9gnrqA88K0HSleiwZjU\nJF3LhBvS2Ga2HHfFsk5D/yz/pTHwDvRA98VMT/90wahwmSJsck4XWDFhmNhy3oDR\nBQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 2] [Relay] Listening for incoming messages on port 9102 (RELAY PORT 9102)
[Relay] ---- Relay process started ----
[Relay 3] [Relay] Loaded persistent RSA keypair from relay3_key.pem
[Relay 3] [Relay] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] [Relay] [KEY] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] Relay 3 starting on 10.250.120.196:9103 (RELAY PORT 9103)
[Relay 3] Registering with CDS at 127.0.0.1:9000
[Relay 3] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9103, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5k9OJ8m3IdjmwR1skM1G\nwrKkwlYLK0Qs+I/BX5ww5wEakOsTy5NVFAwTYrCUnR012u2jCwI8wV1YpPaMa8RJ\ntnqNFy4pFfqBh5tmidHQ3QMRvINPrGtQM5+VgMXoA0y8izql52M1K/3Q6sHVlAXd\nmpQcBO+JSHY7uyVx1txZssyisia7Nn8Frh/XRpl0oUvGkSnbm/KgqDAP0xJ3lUZS\nEGiIWdf0bn7tHD3nYBMrWWi3jSQWf0Q80asIEYWipwkfMPf0ffzu4FX0elfvpyOX\nr50xk7sb8K5IhcilwxKxQpPOcq3f6ph0EERQR7pOdDqkzFdHoGiyssSX4MYM60kd\nmQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 3] [Relay] Listening for incoming messages on port 9103 (RELAY PORT 9103)
[Relay 3] [Relay] [handle_message ENTERED] addr=('10.250.120.196', 56288), thread=6133280768, relay_port=9103
[Relay 3] [Relay] [DEBUG] Raw data received: b'\xbe\xdaLKE\xd7\x11F\xbf!\x9co\x96\x00\xa9\xea\x15u\xbf\xc9\xb1\x9a\x95t)Z\t\xe2I9\x15\xb3\xf8i\xc9\x97\xf1\t\x01E\\\xf5%1\xfe\xe2+\x8b\x98\x8b\xf2\xeb\x96E\x9c\xad\xc9\xd5\xf5\x1b\x0c\x12\x07HSs\xa1[\xdd\x9e\x18:Ud\xd6\x0b\'\x9d\xb3\x99\x0bh\xbe\x12x\xcfC\x05\xf3\xb2F\x17\x9e\xf5T\xa23ZNE1W\x85\x17x}\xcc`\x8e\xcc\x84~\xc6\x8f\x90\xcc\xf5o\xba~\xb1\xe8g0?\xce(\x1abSe\xfd\x05\x7f\xe4\x7f\xe1\x02\x00m\xe6\xc1\x06\x07L:\xef\xe2\xb6\xf0\x9f\x8e\xbe\xa4lB\xd8\xfc0\xbf\xdd\xaeF\xc4\xfc;\xa5rGa\x9e7^\x02%\xa8\xd6\x95t\xad\xd0s\xa0\xf0mR\x0b\xdc\xeft\xbcg\xa4`O0\xe3\xc3Pi\xa9\x19\xfd\x0c\x06;\xa6\xc0\x1c\x17\x84<\x18\xec^!\x14\xd3\xc5]\x0f]Ey\xa5\xee\x0fj\x0bA2~\x986\x14\xff\xdef\xb0\xad\xf0(\xb4sGb~f\x82\x7f)\x82\xef\xc1}E\xceZ\xb2\xeb\xfeK\xa1L7$\x90\xff}{\xd8\x13u@\xd8K\x83\x05\xccr\x82\xf0BB\xec\xea$\xdf\xbe\xbde\xbe\x13qi\xcb\xb0\x96<\xb8)yt\xe6\xbd\xeb\x06u,\xf8\xa9\\\xd4T\x17\xfb\xd6\x96Q\xae~\xd5\xc2%~\xc6\xaeg\xa4d\xc5\x97&\x7f\xe5\x8a6\xa7a\xa99=\xbdN&\x90%\x1b[mJ\xb6\xd1\xd7H\xc3N\xab\x19\xa6\x98G\xcd\xab\x17\xcaaS0\xe4\xdf\xd7L\xb4\x07\xb3\xf9HB\xe4\x97\xd4\x10\xb8\xa4-\xd9\x9b\x88d\x07\x14$l\x1c\xa4O\xc7J\x94:\xeb3\xe7\xe2\xdb2W\x07\xd7*\x00\xfcF\x98\x0fc\x0c\x86\x13\x86\x92.iRB\xac\x82\xf84\x89\xee\xca\x02\x0b\xb9-\x90Zv\xc3"\xe12\xae\x9fe\xa8\x13nd\x81\xef\x92\x87a\xdfij\xb3\xd5\x06\xe5!th\xe2\xcd\xc9>\xf1\xdc\x9d\x00<\xc1g\x13\xc6\x04\xb3\xb2i\x10\xc7\x86s\x0f\xc3Z\xc0\xe5\xe0\xfe\xa8\x92Z\x82\x9e\x99\xe3\x1ab\xef\xf9I\x9cq,O\xa2ZL\xd0\x02\xe2\xb2\x93\xbf\xcf\xe0\x16\x98\xc8\x06\xf4\xaeV\xe6\x97\x03d\xb4\x05\x1f\x81U\xc9B*\xe5\xd3:\xd5\xe8E\x15r\xa0\xae\xf8\x8c\xb2\x95\xb1b\x93\x8a\xb9\xd2P\x00\xe7\xe4W\x82\x92\xb8D\xfe\x1c\x07\x93\xfc\xe2l\n\x89M\x9c\xbd\x06>K\xb4\x9a\xd8Qc\x84I\xb3\x15@\xd4\xe9\xcd\xf6\x8f\x8a-^}\xfa"\x84\x8b\x91\x0b\xec\xe9N\xcb\x87\x03I"B\x95\xeb\x16Q\xa4\xa0!7\xc0\xe9\x83\xe5k"z\x0c\x81~\xfdd]\xa7\xea\x99\x98i\x04\xed\xa5\xe6\x020P\xe4\xb6\\\xb9\x03\xf1\xd2\xb8\xa4G\xc7\x00\xa9\xdd\xe1\xc7\x14m\xfex\x08"U\xef4l~-\x980\xecv\xcb\xcf9\xeb{\xb7\xc2\x96`*\x81\xe6>\xa4\xf2\xaf)b\x95E\x91Y"\r\xe2\xe5\xa5\xdb\x13\xb4:R;V\x91\x12]p\x86\x84\xc8~\xc1|\xd2\xd1\x1e\xf4J4\x92\x9d\x0c\rT*\xef\xab\x83\x82\xfe\xd9\xf9\xd7z\x9e\xbf\xe5\xa8N4|Y0\xd3\x14h\xd3\x8c\x1d\xa2\n\x89\xcc\x85\xe9{\x9ef\xc58\xb40v\x88j"\x89\xd3P\xa8>\xacE{!\xa1\xed\x81{.\xd1\x0fK\x8c\xee\xb2}\xddV\x026p\x85\xd4,L\xec\xfdU\xbaW\xeb\x14\xba\xab\xc8\x1e\xa7\x9c\xade\xe4w"v\xc5\xf7EO\xb4\xf3"%\x14,\x845\x1e \xd0m\xb92\xa9\xe1T\x8f\x1f\x1f\x17E\xf3h\xfbJ\xaa\xe4t\xe7\x99\xbf\xc9F\x98\'\xbcC\xe8\xe6:\x9c\x8a\xa6N\r\x11\x1ch\xc0\xa0\x05\xeaq\xef\xe5R\xaa!\xed\xee\x8dsLM\x8b\x9e_\x8c\xb4\x0eS\x97cR:\x9bmd]\xb0fz4\x93\xc1I\xa1\x9dMa\xdaWu\x0f\xde\x04\xb2\xca\t\xd9\xfc\xc7\x12Q\xe9F\xd7\x85\xdb~\xfc\x96\x08nb$S\xb6\x1f-"t)\xb0\xfd\xc1"\xa5\xebo*\xd9SL[\x0f\xcf\xec\xaf\xa1\xcc(\xc0\x91\x99\xefv\x84\xadUnG\xdb\xd7\x97l\xd5%\xc1KVBc\x19\xdf>~\xa2\xea\x9ag\x04\xf5\x80nY\x9aj\xb0G\xa6u~\x8f/;\xa9\xba\x81/\xa1\x91$Af\xca\xc1\xfc%j\xc0\x98!\x15\x00\x84\xd4F\'\xf9\x8d\x81\x07B>8\x90\x1dC\xfdL\x1cs\x8f\xcd\xd3\xf9\x85\xbe\x8e\xb8\xca21\xb1\xf3'
[Relay 3] [Relay] [DEBUG] Data is not JSON, treating as last hop (will try to decrypt and forward to dest)
[Relay 3] [Relay] [DEBUG] Attempting to parse envelope for session_key
[Relay 3] [Relay] [ERROR] Could not parse envelope as JSON for last hop: Expecting value: line 1 column 1 (char 0)
[Relay 3] [Relay] [ERROR] Could not decrypt last hop payload, forwarding raw to dest (no encryption on return)
[Relay 3] [Relay] [Last Hop] Forwarding payload to dest 127.0.0.1:9100, len=1070, type=<class 'bytes'>
[Relay 3] [Relay] [Last Hop] Sending to dest: type=<class 'bytes'>, len=1070, preview=b'\xbe\xdaLKE\xd7\x11F\xbf!\x9co\x96\x00\xa9\xea\x15u\xbf\xc9\xb1\x9a\x95t)Z\t\x
[Relay 3] [Relay] [Last Hop] Received response from dest: type=<class 'bytes'>, len=72, preview=b'{"result": "ERROR", "error": "ERROR: Could not decode payloa'
[Relay 3] [Relay] [Last Hop] Response to client (UTF-8 JSON): b'{"result": "ERROR", "error": "ERROR: Could not decode payload as JSON."}'
[Relay 3] [Relay] [Last Hop] ERROR forwarding to dest: key must be bytes-like
[Relay 3] [Relay] [handle_message END] addr=('10.250.120.196', 56288), thread=6133280768
[Relay 3] [Relay] [handle_message END] addr=('10.250.120.196', 56288), thread=6133280768
[Relay 1] [Relay] Deregistering from CDS and shutting down...
[Relay 2] [Relay] Deregistering from CDS and shutting down...
[Relay 3] [Relay] Deregistering from CDS and shutting down...
[Relay 1] [Relay] ERROR during deregistration: [Errno 54] Connection reset by peer
[Relay 2] [Relay] ERROR during deregistration: [Errno 54] Connection reset by peer
[Relay 3] [Relay] ERROR during deregistration: [Errno 54] Connection reset by peer
[Relay] ---- Relay process started ----
[Relay 1] [Relay] Loaded persistent RSA keypair from relay1_key.pem
[Relay 1] [Relay] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] [KEY] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] Relay 1 starting on 10.250.120.196:9101 (RELAY PORT 9101)
[Relay 1] Registering with CDS at 127.0.0.1:9000
[Relay 1] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9101, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5MM7/HBECV26fZqjUJkt\nQ4+dx297cL0hf1+rf08Qir5tL/lArfQsiplTqcsIsZiN7vJ8K2XzvK5JAEv8tVE4\nEKU4W1hbEVBd1eLCX+Oc5XauTbWhW8xlc2wdNlNwDhin2Mw84doKJWPyfjtIwnIi\n3nWHqxLyAqkj6qDoByA8D7YVmJxvzwL0mrYE8G8b4Q4Wjnx2SXeTwc9LRzqwrsyb\nlM5B4BSVPBignOMhD2AfuIFw6uULQThbkL9L5AnQA08B4Gqzo731LLJN/Y6qo+VJ\nki2t6m1aJTG0LBjijpH7CtnN1MHIQ5UueS1sJVYZooYxkxEYYZTqIUXxuI5ICKPC\nCQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 1] [Relay] Listening for incoming messages on port 9101 (RELAY PORT 9101)
[Relay] ---- Relay process started ----
[Relay 2] [Relay] Loaded persistent RSA keypair from relay2_key.pem
[Relay 2] [Relay] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] [KEY] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] Relay 2 starting on 10.250.120.196:9102 (RELAY PORT 9102)
[Relay 2] Registering with CDS at 127.0.0.1:9000
[Relay 2] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9102, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA58J3pSrOQd4hYnuzQQ7q\nWrjjo+3BJp+ik23brR2yl0kjtfH+wjD9LYWHS7dBxsDRzSozJ/7EWKKNCaTsgvaF\nN6vpyBPqDM/uQfOWfirteL50RgDZw95Vml4Fuay7bTBEb1J8ydvFqawo8rnLE2I3\nU4BjBT+CD38bY3je8wrrCX9fo1uYaLDlfteGshadZ2gnTxrAzkZZ/CTFdyb8JrmN\nIuxjBVjwSA/uIv+KHWQhXRA5jJPXcNV88LYXyEzpid1Cr9gnrqA88K0HSleiwZjU\nJF3LhBvS2Ga2HHfFsk5D/yz/pTHwDvRA98VMT/90wahwmSJsck4XWDFhmNhy3oDR\nBQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 2] [Relay] Listening for incoming messages on port 9102 (RELAY PORT 9102)
[Relay] ---- Relay process started ----
[Relay 3] [Relay] Loaded persistent RSA keypair from relay3_key.pem
[Relay 3] [Relay] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] [Relay] [KEY] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] Relay 3 starting on 10.250.120.196:9103 (RELAY PORT 9103)
[Relay 3] Registering with CDS at 127.0.0.1:9000
[Relay 3] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9103, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5k9OJ8m3IdjmwR1skM1G\nwrKkwlYLK0Qs+I/BX5ww5wEakOsTy5NVFAwTYrCUnR012u2jCwI8wV1YpPaMa8RJ\ntnqNFy4pFfqBh5tmidHQ3QMRvINPrGtQM5+VgMXoA0y8izql52M1K/3Q6sHVlAXd\nmpQcBO+JSHY7uyVx1txZssyisia7Nn8Frh/XRpl0oUvGkSnbm/KgqDAP0xJ3lUZS\nEGiIWdf0bn7tHD3nYBMrWWi3jSQWf0Q80asIEYWipwkfMPf0ffzu4FX0elfvpyOX\nr50xk7sb8K5IhcilwxKxQpPOcq3f6ph0EERQR7pOdDqkzFdHoGiyssSX4MYM60kd\nmQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 3] [Relay] Listening for incoming messages on port 9103 (RELAY PORT 9103)
[Relay 2] [Relay] [handle_message ENTERED] addr=('10.250.120.196', 56975), thread=6137556992, relay_port=9102
[Relay 2] [Relay] [DEBUG] Raw data received: b'\xd7\xab\xb5{\x8a\xd2\xa0\x01KB\xda\xe3\xd0\xb6\xe4\xdf?* \x7f`\x0f\x98d\xa5\xe2d\x1d\x19WW\xfd\x0c\xf9\xa9<i\xcc\xd00\x13f\x0c\xba\xb6\xc8\xc2Hwa\xbbl!\\Lw\xc0\xccU\xa5\x18\xed`\xc3\xd6C9\xf4\x04\x84\xa1\x11\xea\x8f\xf6\xf2h\xc0\xb2\x9c\xc2w\xd0J9\x91\xdf\x1a@\xa9r\x81\x95\x02\x9e\xb7\xe4\xe4\x86\x9a\xbd?@\xef\xec\x87&xS\xb0\xd3\xe4\x08_U3\xb7\\\xc2\xb5\xc5W\xd6\x9e\xc8\x0e\x9d\xb4\x99\x15\xd1\rB\x13\xfe\x98\xaf\x8e\xf8\x8a\x9b\xe7\x86\x80\x14\x8f\xad8\xd8H;\xcc\xb9\x1fk\x033\xc1\x93\xae\xd5Pa\xe6y`\ryV\xe5\xec[e\x857\xceRq\x00\xa4nH\xef\x17Mt\x80%\xfb\xab\xfe\xdf\x85Q\x05J\x16\x8f\xd7\x1a\xb0\rQ\x1d0\x00Sfb\'\x8b\xef\xb9\x13\x8c\xf6\xf5\xa6\xb1\xb1\x99\x11\xd2\x0f\x81G\xc6\x92\x156\xda\x18\x1f\xfb\xcb\xc7\xef=\xe1\x07\x9b\xa4&\r\xb4U\x10N]\xdb\x80\xc6\x01\xcf\x06P\xdd\xe3\x9cq\xac7\x94\xdaf\xd6\x936"\xc1\xc2\xe9\x0f\xb6\xb5\xe6\x13W)\xdc,\xb3\x1c=\xed\x13c\xddu5\xd2\xf4\xbf|F\x07\xd6j~A\xe1K:\xc1h\r\xf9VL\xd5u\xc8^V\xec\x8df\x1a\x1b-DD\tyj\xb9\xda\x0c\xaey\xe4\xa2\xb1\xdc\\lb\xecE\x01=\x18\x955@\x8f\xber.\x89\x08\xacR\xf6\xe8\x19\xfbaD\xd3U\x00\xcez\xa9\xa7\x18COaxP\xe7\x1f\xc4\xbfb\x8d]\x12b\x81\x87\x1e\xb5\xc9\x03\x97\x0e\x87n)\xe1\xe0\xaa\xc3\xff\xf7\x7f)A\x1b\xb1V\x04\x1a\x17\xc7\xc7\x1a\xe2\x99*^ED-\x9a\x81;y}\xe0\xffK\xb2A\x95\xb3Eg\xd5T\xc4\x0bs\x94\xb3|\xaa\x16\xf6\xab?\xec\x9e\xa3\xc8\x18\xdb\xf1\x88\xd3d\xcc<\xed\xc6\x82\x12\x15\xdf&\xf1\x0b\xfd\x7f&pJ\xe5\x936z\xf3\xe2\xf5\xb3/$\x1c\xaa\xab\xd3\x1a\x01\xc0kc\x83\xbe\xc8E=\x80%w\xa4\x9f\x953\xa3X\xcd\xa7\x0eE\xf6Y\x13\xee\xb7CH@Dg\xc6\xa5\xeb\xa1m\xebu\xe1\xc7\x8b\xe4\x0e\xdcj\x86S`Z\x92\xd0\xa0V\x8c\xb5\xa1m\xffW>_^\xdb\xd7=\xbbp\xf5L\x0f\x03\x8c\xee7^\x95\x12yr\n\x02\x89n\xd0_\xd2&\xd5\n\xcat\xe4\n\n\xdd\x18\x13\x90H5d\x8a.]\xac\x04\x1f\x99vp\x1b\r\xeb\xfb\x90\x9bL\xa8\xfe\xb0v\x10\xe5\xb4|\xb48\xc0]O\x0f\xab\xeb\x05\x86\xd4S\xc6k\xe1\x87\xca?\xba\x14m\xec"TW\xd2\xaa\xed\xd5\x1f}f\xbe\xf2\x01\xde\xe8\x93\x89\xfdt\xbd\xb6A\xeaA6K<Mf\x9b\xcc\x98^\xa2\xdb]\x01En2\x81\x1a\x11\x10\xe6\x87q\xbb\x0f\xf61<\x88m\x12\xcc}\xca\x9dD\xa8\x90d\xad\x06D\xc3\xe7\x05s\x1d\xcb\x06.\xb2\xfeT/\x8b\\{\xdf\xe98J\xa2$:Q\xdeB)\xc885C\xce\x9a\xc9\x8eB\xea\x0ee\xa0\xf2\xd5\xf9\xfc\xd4\x03\x8e\x05;\x95\x803\xe0\x8f^O\xad\xd6\x14\xcd0j\xe8\xe6\xc7_-wq\x94JE\x96$c\x13\r\x80>\xe3\xff&\xd9\xcf\x8c\x1d\xf2\xa3\xc0Qa;\x89`\xc4\xdcC%q\xfa@\x07\xe2\xa2\xe2\xf1\x18\xfe\xd5$\xb5\r\x13\xed\x1e\xd5\xd2\x9f|I\'\xae\xcd=F\xdc\xeb\x96\x0b\xf6\x07\x14\x01\xee\xb6d\xb5cb\x94\x00\x15\xa3\xcb\xe2\xa0\r^\'\xe3\x9b[3\x9c\xc1\xac\xae!\x0f\x84!\xcbq|\'\x94o\xb0\xf8\x18r\xe4v\xb1\xa1\xea\x93\xb9\xb9?\x8f\xa5[\xec&\xab\xe4\x1d3\xe4\x18\xe0b\x9c\x0b0;Z5\xa7B8f\xe6\x1b\xd1\x8c\xea\xc3U<\xf8\x18\xf3X\x8e\xb4\xa8\t\x1b\xc2s\x19\xe7\xe1\xfc`\xe0?\xe2C\xd7\xda$\x8a\'\x98\xda\xe1I(Z\xae\xe5\x82`\x1cZ\xc5\xbcd\xec\x95\xc4l\xc6\x06A\xaa\xc3\xc9GW\xd2\xd2\x0c^\x92\xae\x0b\xc3]\x8b\xd2;\x8f\xdbW\x19\x92\x12\xe6\x03\xa9\xdf\xa3\xbf\x9bd\xef"1!\xd7\xe2e\xf8\xe1\x82\xc7\xab\xd9\xa9\x99\xab\x8b\x1a\xe6\xdf$\xebq\x0bwW\xc7S:\x86Qa\x1bjvXn\xdf=&\xf0\xe7\xd6\xda\xf7\x13v\xb3\xbfob\xf0\x10\x06\xe1&\xbc&R\xe6u\xff\x03P\x87\xf0>F?\x92V \xbcv\xc3\xbc \x1f\xd5\xff\x05C\r'
[Relay 2] [Relay] [DEBUG] Data is not JSON, treating as last hop (will try to decrypt and forward to dest)
[Relay 2] [Relay] [ERROR] Could not parse envelope as JSON for last hop or decrypt: Expecting value: line 1 column 1 (char 0)
[Relay 2] [Relay] [ERROR] Could not decrypt last hop payload, forwarding raw to dest (no encryption on return)
[Relay 2] [Relay] [Last Hop] Forwarding payload to dest 127.0.0.1:9100, len=1070, type=<class 'bytes'>
[Relay 2] [Relay] [Last Hop] Sending to dest: type=<class 'bytes'>, len=1070, preview=b'\xd7\xab\xb5{\x8a\xd2\xa0\x01KB\xda\xe3\xd0\xb6\xe4\xdf?* \x7f`\x0f\x98d\xa5\x
[Relay 2] [Relay] [Last Hop] Received response from dest: type=<class 'bytes'>, len=72, preview=b'{"result": "ERROR", "error": "ERROR: Could not decode payloa'
[Relay 2] [Relay] [Last Hop] Response to client (UTF-8 JSON): b'{"result": "ERROR", "error": "ERROR: Could not decode payload as JSON."}'
[Relay 2] [Relay] [Last Hop] ERROR forwarding to dest: key must be bytes-like
[Relay 2] [Relay] [handle_message END] addr=('10.250.120.196', 56975), thread=6137556992
[Relay 2] [Relay] [handle_message END] addr=('10.250.120.196', 56975), thread=6137556992
[Relay 3] [Relay] Deregistering from CDS and shutting down...
[Relay 1] [Relay] Deregistering from CDS and shutting down...
[Relay 2] [Relay] Deregistering from CDS and shutting down...
[Relay 3] [Relay] ERROR during deregistration: [Errno 54] Connection reset by peer
[Relay 1] [Relay] ERROR during deregistration: [Errno 54] Connection reset by peer
[Relay 2] [Relay] ERROR during deregistration: [Errno 54] Connection reset by peer
[Relay] ---- Relay process started ----
[Relay 1] [Relay] Loaded persistent RSA keypair from relay1_key.pem
[Relay 1] [Relay] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] [KEY] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] Relay 1 starting on 10.250.120.196:9101 (RELAY PORT 9101)
[Relay 1] Registering with CDS at 127.0.0.1:9000
[Relay 1] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9101, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5MM7/HBECV26fZqjUJkt\nQ4+dx297cL0hf1+rf08Qir5tL/lArfQsiplTqcsIsZiN7vJ8K2XzvK5JAEv8tVE4\nEKU4W1hbEVBd1eLCX+Oc5XauTbWhW8xlc2wdNlNwDhin2Mw84doKJWPyfjtIwnIi\n3nWHqxLyAqkj6qDoByA8D7YVmJxvzwL0mrYE8G8b4Q4Wjnx2SXeTwc9LRzqwrsyb\nlM5B4BSVPBignOMhD2AfuIFw6uULQThbkL9L5AnQA08B4Gqzo731LLJN/Y6qo+VJ\nki2t6m1aJTG0LBjijpH7CtnN1MHIQ5UueS1sJVYZooYxkxEYYZTqIUXxuI5ICKPC\nCQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 1] [Relay] Listening for incoming messages on port 9101 (RELAY PORT 9101)
[Relay] ---- Relay process started ----
[Relay 2] [Relay] Loaded persistent RSA keypair from relay2_key.pem
[Relay 2] [Relay] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] [KEY] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] Relay 2 starting on 10.250.120.196:9102 (RELAY PORT 9102)
[Relay 2] Registering with CDS at 127.0.0.1:9000
[Relay 2] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9102, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA58J3pSrOQd4hYnuzQQ7q\nWrjjo+3BJp+ik23brR2yl0kjtfH+wjD9LYWHS7dBxsDRzSozJ/7EWKKNCaTsgvaF\nN6vpyBPqDM/uQfOWfirteL50RgDZw95Vml4Fuay7bTBEb1J8ydvFqawo8rnLE2I3\nU4BjBT+CD38bY3je8wrrCX9fo1uYaLDlfteGshadZ2gnTxrAzkZZ/CTFdyb8JrmN\nIuxjBVjwSA/uIv+KHWQhXRA5jJPXcNV88LYXyEzpid1Cr9gnrqA88K0HSleiwZjU\nJF3LhBvS2Ga2HHfFsk5D/yz/pTHwDvRA98VMT/90wahwmSJsck4XWDFhmNhy3oDR\nBQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 2] [Relay] Listening for incoming messages on port 9102 (RELAY PORT 9102)
[Relay] ---- Relay process started ----
[Relay 3] [Relay] Loaded persistent RSA keypair from relay3_key.pem
[Relay 3] [Relay] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] [Relay] [KEY] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] Relay 3 starting on 10.250.120.196:9103 (RELAY PORT 9103)
[Relay 3] Registering with CDS at 127.0.0.1:9000
[Relay 3] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9103, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5k9OJ8m3IdjmwR1skM1G\nwrKkwlYLK0Qs+I/BX5ww5wEakOsTy5NVFAwTYrCUnR012u2jCwI8wV1YpPaMa8RJ\ntnqNFy4pFfqBh5tmidHQ3QMRvINPrGtQM5+VgMXoA0y8izql52M1K/3Q6sHVlAXd\nmpQcBO+JSHY7uyVx1txZssyisia7Nn8Frh/XRpl0oUvGkSnbm/KgqDAP0xJ3lUZS\nEGiIWdf0bn7tHD3nYBMrWWi3jSQWf0Q80asIEYWipwkfMPf0ffzu4FX0elfvpyOX\nr50xk7sb8K5IhcilwxKxQpPOcq3f6ph0EERQR7pOdDqkzFdHoGiyssSX4MYM60kd\nmQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 3] [Relay] Listening for incoming messages on port 9103 (RELAY PORT 9103)
[Relay 3] [Relay] [handle_message ENTERED] addr=('10.250.120.196', 57177), thread=6132330496, relay_port=9103
[Relay 3] [Relay] [DEBUG] Raw data received: b'\xdf\xc8\rz\x1cU\xc1\xd2S\x17(\x02r.\xd4>\xfe\xc0\xa2f\'f"\xf48B_\x9d\x8aJ\xbc\xfc )h\xd5\x92\x92\xb2q$\xd7\xce\xee&;\xba\xa8P\r\xd9\xab\xa67w\x93\xb4\xf5N\x1br\x15\xfer2\x85y\xc0`\xb1c\xa8\xa8\xb6\x9f\x88\x11hf\xf3d]&+\xb8\x93\xb7\xa7}7\x8e\xec\xd9\xb7\x95X\xe1\xc03+)\xb3\xc9\x16 \xafR\x15\xe6\xf8\xd2J$\x16\x83\x11x\x91\xc3i\xfe\xf4\'\x15a\x10O\xcbM\xff\xe4\xbc\xacz\x9ba\xc1X\xd3\x85\x9e[\'\xeb\xb5sK9\x9f\x00\xd4Le\x8e\xc0\x16a\x1aP\xfd\x0e\x1e\xeb\xb9t\xf5\xa5\x10\x02\xcc\xc8K|\x97\xd3\xd6\x95\xcaZ\x06/\x19E\x18\x03ki\xddJ\xa3\x01\x0e]\x12\xc8\xb5=\xb4\xfeV\x85\xeb`\x93\x14<\x9d\x9f%\x890\x9f\x91\x05\x19\x07\x9a\xd8?\x84\nk\xd2\x94\x14\n\xf1\x13\x00XB\xa9\xf1\x15\xd6\x95\xc7G\x85\xfc\x94l\x1aa\x88\'r\xdep\xd4/\xe8\xdd\xa6U\xb5\xa2D\x987Rx\x8d\x86\xbcN\xf2"mh/I\x94\x1d \x18\xc6\xc1\xc1&\x039q\xc3\x9fB\xd9Q\xf2wB\x01L\x1a\x7f\xfd\x85\xf8v\xfa\xa0I\xeb\xe1+h\xac\x0cj\x83\xfc\x98\x03U5\x8fm\x1f\x88\x9d\xcb\x823k\x98\xe9\xa9\x14\xff\x80\x81G\xcc\x93\x87(\xad\xee\xeb\xf3jrM\x95xg\x050[\xa1\x96\xc7\xf9\x92!\xd4q\xc8\x97ik\xf1\xcb\xa4 \xb1\x16S\x07\x04\xb5\xbb\xf9>\xe1g\xa6C\xd2\x1b\x9f4\xd54$\xf20\xe9>\xe5\xdc]\xef\x98\xba^\rf\xd4\x0f\xd0}\xab\x1d\xb9\x8c\x97\xac8\x8c\x91x\xf6\xfd/LX\x9b\x05\x01\x87\x15+2\xcb()\x9a\x82\x04\x02\x9dL1@m,s3K\xc4W\xbe\xa7O!\x97\xd0W\xf7\xea\xc5`\x00u\xe33Fng\xc7,\xa7\xee\xdc\x87\xd1(%(g\xb5\x85^\x85\xaa\x14op\x81\xc3\xae3\x02AA\x83\x81|~n\xac\xe3\x8a\x17\xf1\xf9\x85B\xd2^\x97D\x92\xce\xf2\x9b\xa4\x89;\x88s|\x13\x878&\xdaQ\x82F\xbe\x17\'LzK\xbb^CNX\xe5^\xf9\xc4f\xa3;,aL\xf6\x18\x90\xae\x9c\x9c\t|7\xc3\x87\xc7w\xd4wG\xc8\xda\x84\xbc`\x83]k0\xd7\xd7[\x8c4Xq\xd6\xb4e\xbb\xfcV\x93\xd1\x7f\xd5\xc9\xfb1y\xa3\x1e\xcbP\r\xb8\x1e\x90\xe7\x8b7\xd9\r\xf5\xcbO\x9f\x17_6%\xa5\xea\'aUQ\xcb\x92\x1a\xba\x05s\xf6\t\xbcc\xdc\xf8\xca\x03\xf9A\xfa\xf1\x8d\x11\xa6^\xc15\xf1\x9aS\xda\xb6\xe4\xed\x7f7\x02.\xe4\xb0\xff#[\x14\xc8\xa5h\xc7,\xa8\x8eN\xac\xe9\x88\xb2X\xff\xfdo\xd8\xd6\xc0\xd7\xfb\x83k\x13\xff\xc9\x17{\xa1\xe3\x96\xce+]\xaf\x11\xb7\xa5\xa2/!\x9c\xb6`\xe9\x86(\xcf\xd1a\xfc#%\x93\xfa4\xb5\xed\x9c\xcd\x01\xc3)u\xa7\x81\xb9\xd2Xzl+\xfc\xc3\x11\xfcJ\xf5\x84\x9dt\x871\xe7\x9d\x8a\x88\xb1X^\x7fq\xcd\xa7.\xfb\x16\\0K\xd5\xe1\xf9b\xa2\x039mpe\x92(\x97N\xcd\x94\xc8,\xb1\x16\xa3\x99\xfa\xad\x7f\xde]\xee\x07\x9f\x82\x06\x82\x94\xfex\x03\x93\xcf(\xd5(\x83sw\xa5_\xfa\x9d\x99\xe9\x87\xc3\x90\x11\x1fZ\x89\xcdB\xf0\xacZF\xbc\xdd\x0f\xfb\x1e\xe5x\xf7\xc3n\xd3*\xa4nV\x04(/\x16M\xa0\xd1\xd3\x06\xb2,\xdcpBs\x90\x83p55YN6\x00\xd8\x1f\x03\x89\xd6\x0c\x91\x8am\x99Bf\xc0\x08\xd8\xa0\xaevP\xbb\xb2t7G\xbaW\xaa\'l\xec<\x0e!\xa64}~\xed\xe0\xff\x1b\x08\xb5\x15>$\x9f\xba\x07\xb8W0\xef\xf5\x80\x98\xf0%\x0cw[\xebb\t\xf7P\xc8\xc1\xbe\x8c\xc4\xd2\xd3\xbf\r\x8ed\x04\x039\x84<%I,U\x14\xe2:V\xb1\xfe\xbc\x96\xa3\xcb\x8ex\x86#\x97\x9b\x1c\xc1\x8e\x19\x97\xf3B-\x1c)\xe1eI\x92\xac7a\\\xb8N\x0e\xca\x885\x85\x95\x96Z\x05\xa5+\x0e\xc4+\xcd\x01\x87J\xdbD\x84B\x08Fx\xd3\xca\x9bR\xc8jbJ\xb9Vx\xa2\xf0x\xb3\x01p\x06\x11\xee\xd4\x7f\xeb\xa4\x19L0-\xe6\x04\xd4\xb9\x03\x11\x19o\xab\xea@\x82\xe7\x04#\xde\xc3\x97\xf5\xfe\x05\x93\x99\xf8b\xc6\x86\x9c\xc8\xea\xf1\xae\xb99\x02f'
[Relay 3] [Relay] [DEBUG] Data is not JSON, treating as last hop (will try to decrypt and forward to dest)
[Relay 3] [Relay] [ERROR] Could not parse envelope as JSON for last hop or decrypt: Expecting value: line 1 column 2 (char 1)
[Relay 3] [Relay] [ERROR] Could not decrypt last hop payload, forwarding raw to dest (no encryption on return)
[Relay 3] [Relay] [Last Hop] Forwarding payload to dest 127.0.0.1:9100, len=1070, type=<class 'bytes'>
[Relay 3] [Relay] [Last Hop] Sending to dest: type=<class 'bytes'>, len=1070, preview=b'\xdf\xc8\rz\x1cU\xc1\xd2S\x17(\x02r.\xd4>\xfe\xc0\xa2f\'f"\xf48B_\x9d\x8aJ\xbc
[Relay 3] [Relay] [Last Hop] Received response from dest: type=<class 'bytes'>, len=72, preview=b'{"result": "ERROR", "error": "ERROR: Could not decode payloa'
[Relay 3] [Relay] [Last Hop] Response to client (UTF-8 JSON): b'{"result": "ERROR", "error": "ERROR: Could not decode payload as JSON."}'
[Relay 3] [Relay] [Last Hop] ERROR forwarding to dest: key must be bytes-like
[Relay 3] [Relay] [handle_message END] addr=('10.250.120.196', 57177), thread=6132330496
[Relay 1] [Relay] Deregistering from CDS and shutting down...
[Relay 2] [Relay] Deregistering from CDS and shutting down...
[Relay 3] [Relay] Deregistering from CDS and shutting down...
[Relay 3] [Relay] [handle_message END] addr=('10.250.120.196', 57177), thread=6132330496
[Relay 2] [Relay] ERROR during deregistration: [Errno 54] Connection reset by peer
[Relay 1] [Relay] ERROR during deregistration: [Errno 54] Connection reset by peer
[Relay 3] [Relay] ERROR during deregistration: [Errno 54] Connection reset by peer
[Relay] ---- Relay process started ----
[Relay 1] [Relay] Loaded persistent RSA keypair from relay1_key.pem
[Relay 1] [Relay] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] [KEY] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] Relay 1 starting on 10.250.120.196:9101 (RELAY PORT 9101)
[Relay 1] Registering with CDS at 127.0.0.1:9000
[Relay 1] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9101, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5MM7/HBECV26fZqjUJkt\nQ4+dx297cL0hf1+rf08Qir5tL/lArfQsiplTqcsIsZiN7vJ8K2XzvK5JAEv8tVE4\nEKU4W1hbEVBd1eLCX+Oc5XauTbWhW8xlc2wdNlNwDhin2Mw84doKJWPyfjtIwnIi\n3nWHqxLyAqkj6qDoByA8D7YVmJxvzwL0mrYE8G8b4Q4Wjnx2SXeTwc9LRzqwrsyb\nlM5B4BSVPBignOMhD2AfuIFw6uULQThbkL9L5AnQA08B4Gqzo731LLJN/Y6qo+VJ\nki2t6m1aJTG0LBjijpH7CtnN1MHIQ5UueS1sJVYZooYxkxEYYZTqIUXxuI5ICKPC\nCQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 1] [Relay] Listening for incoming messages on port 9101 (RELAY PORT 9101)
[Relay] ---- Relay process started ----
[Relay 2] [Relay] Loaded persistent RSA keypair from relay2_key.pem
[Relay 2] [Relay] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] [KEY] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] Relay 2 starting on 10.250.120.196:9102 (RELAY PORT 9102)
[Relay 2] Registering with CDS at 127.0.0.1:9000
[Relay 2] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9102, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA58J3pSrOQd4hYnuzQQ7q\nWrjjo+3BJp+ik23brR2yl0kjtfH+wjD9LYWHS7dBxsDRzSozJ/7EWKKNCaTsgvaF\nN6vpyBPqDM/uQfOWfirteL50RgDZw95Vml4Fuay7bTBEb1J8ydvFqawo8rnLE2I3\nU4BjBT+CD38bY3je8wrrCX9fo1uYaLDlfteGshadZ2gnTxrAzkZZ/CTFdyb8JrmN\nIuxjBVjwSA/uIv+KHWQhXRA5jJPXcNV88LYXyEzpid1Cr9gnrqA88K0HSleiwZjU\nJF3LhBvS2Ga2HHfFsk5D/yz/pTHwDvRA98VMT/90wahwmSJsck4XWDFhmNhy3oDR\nBQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 2] [Relay] Listening for incoming messages on port 9102 (RELAY PORT 9102)
[Relay] ---- Relay process started ----
[Relay 3] [Relay] Loaded persistent RSA keypair from relay3_key.pem
[Relay 3] [Relay] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] [Relay] [KEY] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] Relay 3 starting on 10.250.120.196:9103 (RELAY PORT 9103)
[Relay 3] Registering with CDS at 127.0.0.1:9000
[Relay 3] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9103, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5k9OJ8m3IdjmwR1skM1G\nwrKkwlYLK0Qs+I/BX5ww5wEakOsTy5NVFAwTYrCUnR012u2jCwI8wV1YpPaMa8RJ\ntnqNFy4pFfqBh5tmidHQ3QMRvINPrGtQM5+VgMXoA0y8izql52M1K/3Q6sHVlAXd\nmpQcBO+JSHY7uyVx1txZssyisia7Nn8Frh/XRpl0oUvGkSnbm/KgqDAP0xJ3lUZS\nEGiIWdf0bn7tHD3nYBMrWWi3jSQWf0Q80asIEYWipwkfMPf0ffzu4FX0elfvpyOX\nr50xk7sb8K5IhcilwxKxQpPOcq3f6ph0EERQR7pOdDqkzFdHoGiyssSX4MYM60kd\nmQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 3] [Relay] Listening for incoming messages on port 9103 (RELAY PORT 9103)
[Relay 2] [Relay] [handle_message ENTERED] addr=('10.250.120.196', 57356), thread=6164262912, relay_port=9102
[Relay 2] [Relay] [DEBUG] Raw data received: b'\xc8\xc4\xa2:\xfeP\x19>\x8eG\xffRu\xdd#\xc1&\xe4\xfb\xbe\xb2\\\xe9\xd5\xadO\x84Wh\xd2\xf0\x9c$\x18:V,N\xd4\xcd\xa1\x0b\xb3\x1e\xf3\xbb\xf6\x08\xd4Q\xa5\x96c-!sT\x82 y\x9cn\x80\xfe\t\xf2p\x07P\xb3\xdd\x906e{\xc0l\xdf\x93A88\xec\xebr\x88\x91A\x1a]\x86\xfe\x9c\x17\xd7tzY\xd830\x03\n\xb4\xf8\xd2u\xed\x89\x05xR\xfd\xdb\x8f\x1d \x01\xc5\xfa\xf0\x8d>\xda\xf9=\xbc\xa0T\x0f^z13\xddIF\x05\xc5D3\xb7i\xec6\xbf-\tz\xf1\xae\xa7\xbc\x95\xbaOq\x85\x9a}\xf8\x8e\xe0"\xaf\xb8`\xcd\xaf|\xa7\xe3`\xd6h\xfa\xe0o\x97ke\xe69\x043\\f\xd1J\x91.\xbfI\n\x18yt\xe0v\xf4\xfe\xe5\xe8Yp\xb9\xb2\x80>9ae#\x08\x8f\xdc\xe7\x87%\xcd\x10\x1f\xe5\x9bz\x938\xf8\x7f>\x03\x16\xb5Y\xd3\xf6\x13\x8d\xfb~\x82\x18\x89\xaa\x9f\xff\x0e}\xb3\xafTJ.\xb8g\x0cEvy],\xcb\xf3\x13I\xe2\xac\x86\xf0p\xfd3O\x94H\xfe9\x02;hM\xaf\x02\xb1\xcaL\x00L\xa2Y\x7f\xc9\xa9\xd9\x03TH\xc2\x1e\x19\xcb\xd4\x913^!\xc6\xcc\xcaz.\xc5\xb2\xd3K\xe9\x10\xf4\xcb\xdf\x8b\xf3\xdd\xca_\x14\xff(mj\ra\xb6{"\xe5i\xa5\xbe\xe20_)\xa8\xbb\xa3R\xf5-+s\xd4\xc0\xe3\x8b\x82&\xc3\xa6\x91$\xcc\xa8\xfe\x00\x9827\xffv\x06\x812+\xf84\x8e\x9ft\xef\xbb@?\x1d\xe1\xb9\xdf\xce\x93S\xaf\xe5\x8c?\xbf\xa1\xfc\xb8\x90n\x14\x18\xfa\xfb7D5\x8f\x01l~\x87h\xe3\x93\x98\xd88wJ\x80\xe4pG\xc7\x92\xbfb\xb0\x87\xd9\x1adN\x87\x1e\xc4\x97\x03\xeb\xd6\x8b\x85\xf8\x023\xdb\x86\xc9:@\x8cd\xc5\r\xf1[>K\xf0\xfa+}\x19e\x91\xde\xfbs\xba\xc3[\x17\xdd\xe3\x9d\xd9h\x8dO]\x92\xa10k5\xb2$\xe09z\xa1\x15l\x958\x91\xdb\x02oWwzL@\xa6\xe4&Q\xad\x9a]\xa8\\\\\xd2A\xcd;\xfa9\xbc\x11\x8b\xa3\n@\r\xd5\x9f\xdaK\x1dz:\xef\xc7\xd4\xbb\x88\xea}nE\xd8\x97R_\xf1R\xdc\x0br4\xe8\xa1sN\x8a\xba4\xd4U\xcc^Wx\x0b\xe2\xa2\xc8\xebB\xc7\xceZa\xe8=02uL\x8d VqQ\xb3\x15\x04\xf0\xa8&\xca\xfa\xbd\xf5\x10\xderx\x9d\xc8\xb3\xff\x9f\xff?\xaf\xdb&qbSAt\xad~ F\xd3&\'j\x17p\xe6\xa9\x85\xe0\xc7Z\\\x1d\xb2\xc6i\x13$\xad\'\x7fu\xc8\x04x\x9cP%+\x0c9\x11\xaa\x89\xe2\xa2\x89|\xbf\x97\x12w\x17B\xb3H\x04)\xdd\xa4\x11\x87\xc1\xed\x9a\t\x9a\xc7cD\x1e\xf7*x\xfd+[\xae0\xbd\xcd\xd0Ag\xaf$p\xcf\x99\x80\x85x\x8c\xe9\xf4\xfe\xd3\x17\xcb\xec\x84LBK=\xea~2\xe0\xfa\x1e\xd6h\xbf4Xm\x1fsS\xc7\xc9Q\xe5(\x02r4\xcf\x9a$\x05=\xb1D\t\x00\xf3A\xf8E\x021\xa5z\xab\x87#d/l0*"*C\xf6\xd9\xc6\xd7\x0b=\xee\x01\xe7\x82F\xc7;\xfd\xc7|\x1b)9\xf0\x96\x84\xdf\xa0[\xe70\x88Z\xd2G\x9f\x90\x89\xc8D\x90\xf1\x14\xc9,\x8e\xbbxX\x1a\xc5\xf3S\xcc\xe2Ip&j\x07\xe5\xd6\xe9c\x959\xc3\x8b\xcd\x16;\x14\x931\x191(4\xba*\xb1b\x1b\x91\xfao*\x83JKl\xe1\x1a\xb7\xd31\xc8w\xbb\xb2>\x8f\xf1\xbc\xd0\xf5\xcc6-\xe1\xfeAP\xfc\x91\xa1\xb2\xbe\xa6}V\x1ce\xd1\'\x9b\xb4\xccY\xf8\xfa{\x13\x1dAF\x94\x8a\xefKm\xd6\xa0\xf8\xe3\xeea\xdbA\xe0\xb8\xea\xf3\xdf.+\x82\xf3\x01*\x9dw8\x88F%\xb0\x98Q\xad\x14\xb0\x89C1,\x96\xcd?F\x95/\xe8\x14\x1b\xdfxG\xa1&\xedM\x9e\x9c\xd08N\xc7T\xea\xc5\xbb\xcb\xdd\xf2>\x98O\x80\xc4\xa4h%:\xc6j\xe3\x96E\xc9\'\xca\x00\xcaAB\x92\xa8<\x9b\x8f\x1bp\xd2\n\xae-\xbc\xbb\x17%\xdf\x93~\xac<\x8cP{?\xa1Y\xfca\xe4\xba51\xc7Q\xbdX~\xc2\xd9\xd1\x19\xbf\xedu\x8eH\xaay\xe1\x0b\xa1\xb6gK?_8\x186I\x87\xd1\xfavJ\xa0;\xdc\xe3\xd9\xf8p+%b\xd6\x07\xbe\t7'
[Relay 2] [Relay] [DEBUG] Data is not JSON, treating as last hop (will try to decrypt and forward to dest)
[Relay 2] [Relay] [ERROR] Could not parse envelope as JSON for last hop or decrypt: Expecting value: line 1 column 1 (char 0)
[Relay 2] [Relay] [ERROR] Could not decrypt last hop payload, forwarding raw to dest (no encryption on return)
[Relay 2] [Relay] [Last Hop] Forwarding payload to dest 127.0.0.1:9100, len=1070, type=<class 'bytes'>
[Relay 2] [Relay] [Last Hop] Sending to dest: type=<class 'bytes'>, len=1070, preview=b'\xc8\xc4\xa2:\xfeP\x19>\x8eG\xffRu\xdd#\xc1&\xe4\xfb\xbe\xb2\\\xe9\xd5\xadO\x84Wh\xd2\xf0\x9c$\x18:V,N\xd4\xcd\xa1\x0b\xb3\x1e\xf3\xbb\xf6\x08\xd4Q\xa5\x96c-!sT\x82 y'
[Relay 2] [Relay] [Last Hop] Received response from dest: type=<class 'bytes'>, len=72, preview=b'{"result": "ERROR", "error": "ERROR: Could not decode payloa'
[Relay 2] [Relay] [Last Hop] Response to client (UTF-8 JSON): b'{"result": "OK", "echo": "{\\"result\\": \\"ERROR\\", \\"error\\": \\"ERROR: Could not decode payload as JSON.\\"}"}'
[Relay 2] [Relay] [Last Hop] Sent plaintext response to ('10.250.120.196', 57356): b'{"result": "OK", "echo": "{\\"result\\": \\"ERROR\\", \\"error\\":'... (len=108)
[Relay 1] [Relay] Deregistering from CDS and shutting down...
[Relay 2] [Relay] [handle_message END] addr=('10.250.120.196', 57356), thread=6164262912
[Relay 3] [Relay] Deregistering from CDS and shutting down...
[Relay 2] [Relay] Deregistering from CDS and shutting down...
[Relay 2] [Relay] [handle_message END] addr=('10.250.120.196', 57356), thread=6164262912
[Relay 3] [Relay] ERROR during deregistration: [Errno 54] Connection reset by peer
[Relay 1] [Relay] ERROR during deregistration: [Errno 54] Connection reset by peer
[Relay 2] [Relay] ERROR during deregistration: [Errno 54] Connection reset by peer
[Relay] ---- Relay process started ----
[Relay 1] [Relay] Loaded persistent RSA keypair from relay1_key.pem
[Relay 1] [Relay] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] [KEY] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] Relay 1 starting on 10.250.120.196:9101 (RELAY PORT 9101)
[Relay 1] Registering with CDS at 127.0.0.1:9000
[Relay 1] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9101, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5MM7/HBECV26fZqjUJkt\nQ4+dx297cL0hf1+rf08Qir5tL/lArfQsiplTqcsIsZiN7vJ8K2XzvK5JAEv8tVE4\nEKU4W1hbEVBd1eLCX+Oc5XauTbWhW8xlc2wdNlNwDhin2Mw84doKJWPyfjtIwnIi\n3nWHqxLyAqkj6qDoByA8D7YVmJxvzwL0mrYE8G8b4Q4Wjnx2SXeTwc9LRzqwrsyb\nlM5B4BSVPBignOMhD2AfuIFw6uULQThbkL9L5AnQA08B4Gqzo731LLJN/Y6qo+VJ\nki2t6m1aJTG0LBjijpH7CtnN1MHIQ5UueS1sJVYZooYxkxEYYZTqIUXxuI5ICKPC\nCQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 1] [Relay] Listening for incoming messages on port 9101 (RELAY PORT 9101)
[Relay] ---- Relay process started ----
[Relay 2] [Relay] Loaded persistent RSA keypair from relay2_key.pem
[Relay 2] [Relay] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] [KEY] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] Relay 2 starting on 10.250.120.196:9102 (RELAY PORT 9102)
[Relay 2] Registering with CDS at 127.0.0.1:9000
[Relay 2] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9102, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA58J3pSrOQd4hYnuzQQ7q\nWrjjo+3BJp+ik23brR2yl0kjtfH+wjD9LYWHS7dBxsDRzSozJ/7EWKKNCaTsgvaF\nN6vpyBPqDM/uQfOWfirteL50RgDZw95Vml4Fuay7bTBEb1J8ydvFqawo8rnLE2I3\nU4BjBT+CD38bY3je8wrrCX9fo1uYaLDlfteGshadZ2gnTxrAzkZZ/CTFdyb8JrmN\nIuxjBVjwSA/uIv+KHWQhXRA5jJPXcNV88LYXyEzpid1Cr9gnrqA88K0HSleiwZjU\nJF3LhBvS2Ga2HHfFsk5D/yz/pTHwDvRA98VMT/90wahwmSJsck4XWDFhmNhy3oDR\nBQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 2] [Relay] Listening for incoming messages on port 9102 (RELAY PORT 9102)
[Relay] ---- Relay process started ----
[Relay 3] [Relay] Loaded persistent RSA keypair from relay3_key.pem
[Relay 3] [Relay] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] [Relay] [KEY] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] Relay 3 starting on 10.250.120.196:9103 (RELAY PORT 9103)
[Relay 3] Registering with CDS at 127.0.0.1:9000
[Relay 3] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9103, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5k9OJ8m3IdjmwR1skM1G\nwrKkwlYLK0Qs+I/BX5ww5wEakOsTy5NVFAwTYrCUnR012u2jCwI8wV1YpPaMa8RJ\ntnqNFy4pFfqBh5tmidHQ3QMRvINPrGtQM5+VgMXoA0y8izql52M1K/3Q6sHVlAXd\nmpQcBO+JSHY7uyVx1txZssyisia7Nn8Frh/XRpl0oUvGkSnbm/KgqDAP0xJ3lUZS\nEGiIWdf0bn7tHD3nYBMrWWi3jSQWf0Q80asIEYWipwkfMPf0ffzu4FX0elfvpyOX\nr50xk7sb8K5IhcilwxKxQpPOcq3f6ph0EERQR7pOdDqkzFdHoGiyssSX4MYM60kd\nmQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 3] [Relay] Listening for incoming messages on port 9103 (RELAY PORT 9103)
[Relay 3] [Relay] [handle_message ENTERED] addr=('10.250.120.196', 57740), thread=6133968896, relay_port=9103
[Relay 3] [Relay] [DEBUG] Raw data received: b'\xba\x8c\xd2L\xa9\x18\xdak\xd9\x7fKOn\xd0\n\xc9\xc8\xb6\xbd\x9b\x1e\xfds\xd5\x86\xd3+\x04\xac\xfb\xbfn&O\xc0\xb3u\x17\xd7\x95b5\xa9M\xf3\x12\xf9\xd5J\xf0\xd6\xdb\x97%\xf7\x8b\x0c\x97&\x9d\xaf\xac\x02\xcb\xfdG\xb8\xe6\x8c\xba\xc7\x0f^\xd2\xc8\xd7\xd1\xc5)\x832+\x08\xe3\xfbk]7@f\x9aU\xfe\xbe\xf6\xda\xee\xae\x83\xdb\xc7Y\xab\x96\x04\xaa3\xa2M\xd0\xaa\xbe\x0c\xb7e\x96X\xa4\x81\x7f\xe4\xd3\xde[$/;\xd3\x19l\x82\x89\xc9\x00\xd3(V\x1b\xf5\x00\xcaf[2\x8d\x10\xd0\xfe\xc6h\xcf\xa1Y\xb1\xdd\xc2\xd7|*\xdb\xb3\x12\x83\x95yB\x99U\xbbo+{X\x04{\xb2\xecN\xa0sM\t\xb4AGd8F\xa6Z\xf1\xb5T~8\x9d\x002*\x9f\xf1\xdb\xdf\xfd^\x1c\xc6=Q\xb40\x9b\x1c\xca!\xb4D"\xbboU\x8b]\xb5\xb8z\xc2;\x1c\xeexB\xeb\xb6\xa5\x1f\xc0j\xb9\x8b\xf1lIu\x85\x7f\xf2\xbeg_9\x1aX\x93\xde\x89\x0e\xb9\xa8\x81\xf2\xac\xffr\x90y\x11CL\xce.\xef\xae\xadC+\x15`\xdc\xa2"\x14\x81\xb9>\xef\xd4%\xdao\xe2C\x99\xeeC}57\x05\xf0P\x95\xe7-"\x0cI\x10\x88z\x13<Z\xe6\x8c\xbe\x05\\\xc5\xba\xf1\x9bB\x9a\xe8\xde\xdfd\x17\x95\x7fyh\x98"[\xc4m\xb9\xd4\x0c\xc7\xd4R\x87\x12E\x14\x07{\xb4\x98\x99\xea\x16\xf7\x9f\xb5\x00?\x86)\x05\x07\x00(\xaa\x0c\xb8\xeb5p\xad\'\x0ci\x08UA\xe8X\xd1o\x12\xf5!Ma\x9b\xd2|\xff!\xbe\xf6\xa8\x1eY~\xd4\xc7\xd8D8\xf9\x05i\x86AE8\xa6\x19\xf2-\xa2\xec\x81\xb1\x1b\\\x1bfE\xfe9o\xe1n\x89\xc56\xbc\xba^`\xc5\xd2N9\xe0Q1\x18\x1e2U\xc5|)\x98\xf4\xf2\x93g\x16\xf0\xb3)\x84u\x15\xc1(\xb5\xc4\xda\xa3iuL\xd2\x18\xbd\xcc\x11\xb8E\xd8\xd8Y\xf1\xea\xdd\xb3\xb0\xc0\xce\x7fF6\x0e+\r\xf5!\x08=K:\xa5\xf2\xc1\x930\x8aRr\xfao\xa1\x9d\x18k\xc4?/6\x0b\x16\x7f\x98~\x9d\nY\x80\xb0\xe6\x16\xf1F\xd9:\xd6\x87~i6A\xee\xd1\xde\x91L\xfb\xc8\t\xd1\xe2\x88x2`\x89\xbe\xa08H\x0c\xe7r*\xe3\xac\xff\xf3>\xd7B\xccZ\xc1Y\x13\x91\x92\x03\xd1\x948j\xe6\xf2\xd5\x99\xdc\x8c+\x9eHw\x1e\xcf\xd3\x96\xb3I\xee\x07\xd1D\xde\xb3g~\x9bY\xc7\x12q\x87\xc5\xd3\xf7\x8b\x9c\xec\x18\xb7\xbf\x18\x8f\x12+\xde\ti\xb6\x06I\x1d0\x8d\x92Q\xee>\xbbs}hw\xa5NR\x98\xd33\xf0\x19P\x07\xc9\xe1\xe0\x95S\x84\xf07~\xff\x17\xdfX\xd4\x90<5O\x01\xf7\xfb\xa1\x1f&F\xd6\xbe\x9d\xb9\x19M\xac\x0e\x87uw\xae\xfb\x89\xdc\x19\xc0\x08\x95\xdeiAEB\xbb7!5p\xb2\xfb \xa1\xe9\x83\xa0L*!\x99V\xe9rr\xcb\x1d\xf4\xb4\x1fk\x88Mz\xcb\xfaJ\xac\xdb>\xd6B^\xfd\xd5\xb0M\x9e\xdaf\x1b4\xc7\xfe\xa0\xfc\xae\xc6\xb4\x88y\xbf\xfe\x85\xe8B\t4\x1c`Hk\xd4\x90\'\x99\x87/\xed\x0c\xee`a]\xa6\xaa\xa1\'\xc18\xba\xb5\xad\r!\x9c\x1a\x00k\xfaA\xb93,\x98\xfd\x92\xd0\x17\xe7\xf7\xb0\x85\x05R.>I:&\x89j\x96\x13\x16b\xc1>\x9a\xee`(f\xb0E"\xfcq\xf3RM\x9c\x9a\xfa\x90\x11\xbf\x8a\xc5\xc3\xbdP\x08\x86u\xd6F\xbc\x8c\x91\x1f\x07\xed\x19\xc0CQ\x1cP+\xa0$\x17J\xcd\xf6\xd7\xdd\xe5\xb6)pV\x12\xd7\x02*\x9f\x8f\xae\x9b\x95\x04\xf2_\x92\xef}\xab\x8b\x18"\xe3<A\x8b\xe8\xd4\x94\xc1\x1c1b\xa6r\xf1\xd4!\xa9\x86\xe4i^\xc3\x13\x96kW\xe2\xf7O\x81\xaa\x8a\xd4kq\xc3\xd4\x12\x05n\xd5\xfb\xfd\xe9\x10,\x01\\\xadg\x8a;\x00J\xd7\x82!\xf3d\xd5\x9a|\x1b\xbb\xc3\xd38\r\xbf\xa6e\x1b\xa8\nE\x00\xff\xd2\x01\x84~2\xd1\xb1\t\xe2\xf8\'@B\x9f\x0e\xf4*\xd5L\xceL\xb0\xbc\xbc\xdar\xb3\x89*\xbd\xe7\x00\xaeUl\xea\xf8\x1f\xa5\x1e\x04<o9Q\\$\xbd\xf8\x8fb\xddV_\xee\xf8\x9d\x8fk\x1e\xf5\xc6\x82{r+\x19FS\x9e\x002\xa2\xc3\x9ar\x1a\xe5\xbe\'\xd2\xfc\xc3\xdb8\x992\xe4\xb8\xc7\xb0\xc6\x8d\xe9'
[Relay 3] [Relay] [DEBUG] Data is not JSON, treating as last hop (will try to decrypt and forward to dest)
[Relay 3] [Relay] [ERROR] Could not parse envelope as JSON for last hop or decrypt: Expecting value: line 1 column 1 (char 0)
[Relay 3] [Relay] [ERROR] Could not decrypt last hop payload, forwarding raw to dest (no encryption on return)
[Relay 3] [Relay] [Last Hop] Forwarding payload to dest 127.0.0.1:9100, len=1070, type=<class 'bytes'>
[Relay 3] [Relay] [Last Hop] Sending to dest: type=<class 'bytes'>, len=1070, preview=b'\xba\x8c\xd2L\xa9\x18\xdak\xd9\x7fKOn\xd0\n\xc9\xc8\xb6\xbd\x9b\x1e\xfds\xd5\x86\xd3+\x04\xac\xfb\xbfn&O\xc0\xb3u\x17\xd7\x95b5\xa9M\xf3\x12\xf9\xd5J\xf0\xd6\xdb\x97%\xf7\x8b\x0c\x97&\x9d'
[Relay 3] [Relay] [Last Hop] Received response from dest: type=<class 'bytes'>, len=72, preview=b'{"result": "ERROR", "error": "ERROR: Could not decode payloa'
[Relay 3] [Relay] [Last Hop] Response to client (UTF-8 JSON): b'{"result": "OK", "echo": "{\\"result\\": \\"ERROR\\", \\"error\\": \\"ERROR: Could not decode payload as JSON.\\"}"}'
[Relay 1] [Relay] Deregistering from CDS and shutting down...
[Relay 3] [Relay] Deregistering from CDS and shutting down...
[Relay 2] [Relay] Deregistering from CDS and shutting down...
[Relay 3] [Relay] [Last Hop] Sent plaintext response to ('10.250.120.196', 57740): b'{"result": "OK", "echo": "{\\"result\\": \\"ERROR\\", \\"error\\":'... (len=108)
[Relay 3] [Relay] [handle_message END] addr=('10.250.120.196', 57740), thread=6133968896
[Relay 3] [Relay] [handle_message END] addr=('10.250.120.196', 57740), thread=6133968896
[Relay 3] [Relay] ERROR during deregistration: [Errno 54] Connection reset by peer
[Relay 2] [Relay] ERROR during deregistration: [Errno 54] Connection reset by peer
[Relay 1] [Relay] ERROR during deregistration: [Errno 54] Connection reset by peer
[Relay] ---- Relay process started ----
[Relay 1] [Relay] Loaded persistent RSA keypair from relay1_key.pem
[Relay 1] [Relay] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] [KEY] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] Relay 1 starting on 10.250.120.196:9101 (RELAY PORT 9101)
[Relay 1] Registering with CDS at 127.0.0.1:9000
[Relay 1] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9101, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5MM7/HBECV26fZqjUJkt\nQ4+dx297cL0hf1+rf08Qir5tL/lArfQsiplTqcsIsZiN7vJ8K2XzvK5JAEv8tVE4\nEKU4W1hbEVBd1eLCX+Oc5XauTbWhW8xlc2wdNlNwDhin2Mw84doKJWPyfjtIwnIi\n3nWHqxLyAqkj6qDoByA8D7YVmJxvzwL0mrYE8G8b4Q4Wjnx2SXeTwc9LRzqwrsyb\nlM5B4BSVPBignOMhD2AfuIFw6uULQThbkL9L5AnQA08B4Gqzo731LLJN/Y6qo+VJ\nki2t6m1aJTG0LBjijpH7CtnN1MHIQ5UueS1sJVYZooYxkxEYYZTqIUXxuI5ICKPC\nCQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 1] [Relay] Listening for incoming messages on port 9101 (RELAY PORT 9101)
[Relay] ---- Relay process started ----
[Relay 2] [Relay] Loaded persistent RSA keypair from relay2_key.pem
[Relay 2] [Relay] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] [KEY] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] Relay 2 starting on 10.250.120.196:9102 (RELAY PORT 9102)
[Relay 2] Registering with CDS at 127.0.0.1:9000
[Relay 2] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9102, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA58J3pSrOQd4hYnuzQQ7q\nWrjjo+3BJp+ik23brR2yl0kjtfH+wjD9LYWHS7dBxsDRzSozJ/7EWKKNCaTsgvaF\nN6vpyBPqDM/uQfOWfirteL50RgDZw95Vml4Fuay7bTBEb1J8ydvFqawo8rnLE2I3\nU4BjBT+CD38bY3je8wrrCX9fo1uYaLDlfteGshadZ2gnTxrAzkZZ/CTFdyb8JrmN\nIuxjBVjwSA/uIv+KHWQhXRA5jJPXcNV88LYXyEzpid1Cr9gnrqA88K0HSleiwZjU\nJF3LhBvS2Ga2HHfFsk5D/yz/pTHwDvRA98VMT/90wahwmSJsck4XWDFhmNhy3oDR\nBQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 2] [Relay] Listening for incoming messages on port 9102 (RELAY PORT 9102)
[Relay] ---- Relay process started ----
[Relay 3] [Relay] Loaded persistent RSA keypair from relay3_key.pem
[Relay 3] [Relay] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] [Relay] [KEY] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] Relay 3 starting on 10.250.120.196:9103 (RELAY PORT 9103)
[Relay 3] Registering with CDS at 127.0.0.1:9000
[Relay 3] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9103, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5k9OJ8m3IdjmwR1skM1G\nwrKkwlYLK0Qs+I/BX5ww5wEakOsTy5NVFAwTYrCUnR012u2jCwI8wV1YpPaMa8RJ\ntnqNFy4pFfqBh5tmidHQ3QMRvINPrGtQM5+VgMXoA0y8izql52M1K/3Q6sHVlAXd\nmpQcBO+JSHY7uyVx1txZssyisia7Nn8Frh/XRpl0oUvGkSnbm/KgqDAP0xJ3lUZS\nEGiIWdf0bn7tHD3nYBMrWWi3jSQWf0Q80asIEYWipwkfMPf0ffzu4FX0elfvpyOX\nr50xk7sb8K5IhcilwxKxQpPOcq3f6ph0EERQR7pOdDqkzFdHoGiyssSX4MYM60kd\nmQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 3] [Relay] Listening for incoming messages on port 9103 (RELAY PORT 9103)
[Relay 2] [Relay] [handle_message ENTERED] addr=('10.250.120.196', 59041), thread=6135689216, relay_port=9102
[Relay 2] [Relay] [DEBUG] Raw data received: b'\xd7\xa3\xd1\xf3\xbbO\xeco\xfb\x16\x9f\x08\xed\x18|\xe9\xbe\xc4\xbd?\x82\x1c\xd8-\xad\xc9\xd6\t\xd8\xc0Y\xa3F\xcfXE\xa26\xf2\xbe\xcd\xa6\xd2\x8b\xa3\x08\xff\xe6;\x9b\xeb\xeb\x06w^D\x97\xac.\xe2\xd6\xbe\x1b\xa4W\xb3\xf5>\x10\xed\xf8)V\x8d\xf2\xdf`9T\xba\xf7\x11\xde\x16D\x97\xe5\xf9\xebS2b\xe4K \xd1\xd3\x8cQ\x1c\x9d\xb7\x05H\x1f\xfep\xca+\xc3\xfd(H\x8c?QeY\xacj\xd5\\\xc8j3\']\xd8\x92\xa6\x8dW\xcc\xbf\x1d\x01y\xe0\xba\x98\xe8G\x108A\x05 *X\xb4P\xc1C\x1e%p>v\xdd\xa1\xf2wvL\xc0\xef\x0c \x8e\x1b\xfeG\x97\x03N!\xe9r\x17\x83\x12\xc7)/\x98iB \xba\xf5`u\xf8\xed\xa4=\xe5[\xea(L\xa8\xd6\x84\xcc\xb8\n\xa2\xb6!\xbe\x8b\xeeh\x15\x1aE\xbckg!\x1e\xd4e%\xca\x85h\xee\x84\xeaQ\xb7\x10\xddY\xb5\xaa\xac\xe4\xce\x8d\xf8s5\x07\xf3\xc0\\\xf6\xcaRq\x10\xaa\xbcX\xa1\x86\x14\xfa\x15\xc39H\xe1\xf4D\xf8\xe51`\xb95\xb1\xc6\xbb,\xe3\xb8\x11\x99\x07\x944\x9f\xa1\x1c\x1d\xbeVx\xee\xd1\xae\xf1\x04\xec\xdd5K\x9f}\x10\x97\x80u)\xfa\xabx\xd3w8\xd5k?\x03i&F\x0c\xe6\xa4\xfdU^l\xac\x8c\xc8>\xfcP\xa6\xa1R\x0eu\x05\x85N\xcc\x0f\xc9\x83\xe9c\x8e\xfbU\x90\xe8\xee6\xcd\x93$\xa0hKL\x1fU\xb8\xe0\xb7\x1ej\xc2\xf0\xfe1\xc2(\xd5\xd7;h\r`\xc3\xf7\x11\xb8#U\xe8\x84,\xbbh\xc0P\xb6\xa9\xdf\x9d\xbf{\\\x92\xe3\x8eu\xa6\xc6\xd1\x8d\x9e\x04\x111\x8e^\x95\xab;^\xc1\xe0\xba\x9a\xd8/\xf0L\x87$ AJn)\x15\x1b\x0eO\xf8\x91\xf6\xd8\xf3W9\xea%\x9a\xc8\xdf\xfcK\xa5Q\xafS\x1b\xa9\xf3;\xaf\xa4\x08\x11Y\r\xa1\nW\xec\xd6f\xd5k[\xe0\x93\xbb\x88\xce\x96M\xb6\xc1\xc3\x19\xba;\xa5\xe4\x9dM\xa6\xb7W\x07\xd3\x1f1\x94\xe9e?\xefq\xed\x99\xdd~\x7f\xf5{a\xefJ&/)\x1dP\xa3\x9c\x7f\xfd\x00\xd2\xee\x93<\xae@F\xf5\n\x15\x8aP\xe2\xebn\xa7\xa4_\xf0\x82\x19w\x81\x0bQ\xf7\xd9r)5P\xa1_z\xce\xd9M\xf87,Wd\xa6A\x93`g\xa9\xa0yhz\x16C/\xbcVB\xe222\xebL_\x9c3\xf2\xa1\xd1\xdc\xe8\xc2\x7f\xae\x8f\x9dl\xde\xd0\xf5\xd5+\xba\xb4\xdf\xc6\xdb?\x02\xdb\xd6x_\xa3\x94\xbc2s\xf1\x058!&Q#W\xdd\x16a&\x81r\xe5\xd5\xa0u48\x9d\xf3Q\xbc\xf2\xb7>g\xf8\xd2\x9f3y1\x91k\xad\xc5\x0b\xe4\x17\xf4\x11\xc8\x89\x12\x85{0\xd8\x9a\x06\xcd\xd5\\\x88SB\x90m\xc2\xfc\xfdJ\xa2\xa0!\xef\xef\x9b\xa9\xaaY3\xd8\x80\x0fY\xaf\xab\x1df\x9d\xc5\xf6<\xd9\xb2j\x0c\xa8\x86\xdba\x05\xc4\x05N\xc1\x9d\x96\xf9,\xc9\x1fT\xab5[}\xb6\x13\xf6s\x99A\xd3\x92\x94\x06\x15\xf4\xd6\xa8\xf7\n\xa2%z\x93 )4\x91\xb3\xa6\x9d\x83\xb0\x8a"/t\xb5c\xf8n\x86\xd9\xbc\x14f\xa6Z\x05\xf8\xf4Em\x0f\xed\xacqOI#\x1e\x15\xc6\xee\xde\xa2\x11T<o\xef\xb5\x17\xe2kc\xb2\xc5\x8b\x1d$P\x8apl/\x01\xb5^\x1a"{\xcc\xea\x7f\xaa+5\x99k\xca\xaff\x96@\\(H\x0e\x00++\x84)\xd9+\xd0g\x00r_aS\xf8p+@\x1c^\xbf\x8c\xcf6i\xfb\xf2e\x040dV<\xde#J/\x03q5.2X\xa2y)UAX=\xae\xb60\xe3\xf9\x8c\xe3\xf2\xd6jW>:\xd6GD[\x85\xb3\xff\x9b\xb8\xb2Rr\xff\xc0<\xde\xa3_j\x101\xeb\xf6\xb6\xbe\x15\xb6&\xb5%\xbe*\n\xc3 \xb7\x13M\xab\x05\x8c\xf9\xeb\xb7L\x17\xd7\x88\xac\xa8w\xed\x92\x00\xdbZ\x80\xa2$\x80)\x88)\xf1\xc5\n;\xe9\xea\t\xf1\x08a!\x0b\xaf\xa8\x0e-V\x15\x8eN1\x8e\x16\x93\xbf\xe0a\x05\xeaC\x8e$\xc5\xb0/gZ\x1e\xd2S\xcd3]\xed0\x1c\xf1y\t\x132\x02\xea\x1f\xeb\xf8{\x10\xef.\xf6\xf3\xbf+x\xae\x1a\x91fb\xb2\xdc\xd0\xbcg\xef\x89\xe8\xde\xc2\x8f\xe8R\xa0\x98<\x19\xf2\x9a#\xb4\xac2\xb0\x18(\xcc\x8c<\x16\xea\xb2\xa1\x93A'
[Relay 2] [Relay] [DEBUG] Data is not JSON, treating as last hop (will try to decrypt and forward to dest)
[Relay 2] [Relay] [ERROR] Could not parse envelope as JSON for last hop or decrypt: Expecting value: line 1 column 1 (char 0)
[Relay 2] [Relay] [ERROR] Could not decrypt last hop payload, forwarding raw to dest (no encryption on return)
[Relay 2] [Relay] [Last Hop] Forwarding payload to dest 127.0.0.1:9100, len=1069, type=<class 'bytes'>
[Relay 2] [Relay] [Last Hop] Sending to dest: type=<class 'bytes'>, len=1069, preview=b'\xd7\xa3\xd1\xf3\xbbO\xeco\xfb\x16\x9f\x08\xed\x18|\xe9\xbe\xc4\xbd?\x82\x1c\xd8-\xad\xc9\xd6\t\xd8\xc0Y\xa3F\xcfXE\xa26\xf2\xbe\xcd\xa6\xd2\x8b\xa3\x08\xff\xe6;\x9b\xeb\xeb\x06w^D\x97\xac.\xe2'
[Relay 2] [Relay] [Last Hop] Received response from dest: type=<class 'bytes'>, len=72, preview=b'{"result": "ERROR", "error": "ERROR: Could not decode payloa'
[Relay 2] [Relay] [Last Hop] Response to client (UTF-8 JSON): b'{"result": "OK", "echo": "{\\"result\\": \\"ERROR\\", \\"error\\": \\"ERROR: Could not decode payload as JSON.\\"}"}'
[Relay 1] [Relay] Deregistering from CDS and shutting down...
[Relay 3] [Relay] Deregistering from CDS and shutting down...
[Relay 2] [Relay] Deregistering from CDS and shutting down...
[Relay 2] [Relay] [Last Hop] Sent plaintext response to ('10.250.120.196', 59041): b'{"result": "OK", "echo": "{\\"result\\": \\"ERROR\\", \\"error\\":'... (len=108)
[Relay 2] [Relay] [handle_message END] addr=('10.250.120.196', 59041), thread=6135689216
[Relay 2] [Relay] [handle_message END] addr=('10.250.120.196', 59041), thread=6135689216
[Relay 3] [Relay] ERROR during deregistration: [Errno 54] Connection reset by peer
[Relay 2] [Relay] ERROR during deregistration: [Errno 54] Connection reset by peer
[Relay 1] [Relay] ERROR during deregistration: [Errno 54] Connection reset by peer
[Relay] ---- Relay process started ----
[Relay 1] [Relay] Loaded persistent RSA keypair from relay1_key.pem
[Relay 1] [Relay] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] [KEY] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] Relay 1 starting on 10.250.120.196:9101 (RELAY PORT 9101)
[Relay 1] Registering with CDS at 127.0.0.1:9000
[Relay 1] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9101, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5MM7/HBECV26fZqjUJkt\nQ4+dx297cL0hf1+rf08Qir5tL/lArfQsiplTqcsIsZiN7vJ8K2XzvK5JAEv8tVE4\nEKU4W1hbEVBd1eLCX+Oc5XauTbWhW8xlc2wdNlNwDhin2Mw84doKJWPyfjtIwnIi\n3nWHqxLyAqkj6qDoByA8D7YVmJxvzwL0mrYE8G8b4Q4Wjnx2SXeTwc9LRzqwrsyb\nlM5B4BSVPBignOMhD2AfuIFw6uULQThbkL9L5AnQA08B4Gqzo731LLJN/Y6qo+VJ\nki2t6m1aJTG0LBjijpH7CtnN1MHIQ5UueS1sJVYZooYxkxEYYZTqIUXxuI5ICKPC\nCQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 1] [Relay] Listening for incoming messages on port 9101 (RELAY PORT 9101)
[Relay] ---- Relay process started ----
[Relay 2] [Relay] Loaded persistent RSA keypair from relay2_key.pem
[Relay 2] [Relay] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] [KEY] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] Relay 2 starting on 10.250.120.196:9102 (RELAY PORT 9102)
[Relay 2] Registering with CDS at 127.0.0.1:9000
[Relay 2] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9102, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA58J3pSrOQd4hYnuzQQ7q\nWrjjo+3BJp+ik23brR2yl0kjtfH+wjD9LYWHS7dBxsDRzSozJ/7EWKKNCaTsgvaF\nN6vpyBPqDM/uQfOWfirteL50RgDZw95Vml4Fuay7bTBEb1J8ydvFqawo8rnLE2I3\nU4BjBT+CD38bY3je8wrrCX9fo1uYaLDlfteGshadZ2gnTxrAzkZZ/CTFdyb8JrmN\nIuxjBVjwSA/uIv+KHWQhXRA5jJPXcNV88LYXyEzpid1Cr9gnrqA88K0HSleiwZjU\nJF3LhBvS2Ga2HHfFsk5D/yz/pTHwDvRA98VMT/90wahwmSJsck4XWDFhmNhy3oDR\nBQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 2] [Relay] Listening for incoming messages on port 9102 (RELAY PORT 9102)
[Relay] ---- Relay process started ----
[Relay 3] [Relay] Loaded persistent RSA keypair from relay3_key.pem
[Relay 3] [Relay] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] [Relay] [KEY] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] Relay 3 starting on 10.250.120.196:9103 (RELAY PORT 9103)
[Relay 3] Registering with CDS at 127.0.0.1:9000
[Relay 3] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9103, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5k9OJ8m3IdjmwR1skM1G\nwrKkwlYLK0Qs+I/BX5ww5wEakOsTy5NVFAwTYrCUnR012u2jCwI8wV1YpPaMa8RJ\ntnqNFy4pFfqBh5tmidHQ3QMRvINPrGtQM5+VgMXoA0y8izql52M1K/3Q6sHVlAXd\nmpQcBO+JSHY7uyVx1txZssyisia7Nn8Frh/XRpl0oUvGkSnbm/KgqDAP0xJ3lUZS\nEGiIWdf0bn7tHD3nYBMrWWi3jSQWf0Q80asIEYWipwkfMPf0ffzu4FX0elfvpyOX\nr50xk7sb8K5IhcilwxKxQpPOcq3f6ph0EERQR7pOdDqkzFdHoGiyssSX4MYM60kd\nmQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 3] [Relay] Listening for incoming messages on port 9103 (RELAY PORT 9103)
[Relay 3] [Relay] [handle_message ENTERED] addr=('10.250.120.196', 59380), thread=6122237952, relay_port=9103
[Relay 3] [Relay] [DEBUG] Raw data received: b'{"next_ip": "10.250.120.196", "next_port": 9103, "session_key": "K1r9n+tuvhNUDqH/TvPjtt+nzhpdxCUej+cfjggdHkG5Fj+Fs2IR8uWm+cm8Fqyi0SF2Cf6Nfb5c/3faIwEQmmdD0gMky6QK7jWzz5MFL0PzknwVjln4VhCNhrDJ2dd5mNp2a5TRkBhQAE7kJMcSSTvyMVyNQA7VwxywwdS63lU2ttaXppICf7wDQlUIKZRMBPL7ZuqX/J+rYZNixq7RH6m7OidM+giBo42SRUkjWAoOKtQofI97uZebM61cQprEXexJSE435fCG7hB8UsZRDPVP8tJS5s7wBt0vLu/hNSfmNnH9eV207x06KuCjhMH2Tw8KdTebU7cqZDBmDZi6LA==", "payload": "6TmjmXQyY+CR7BWsndBgfU/dficsDRUefa8huPjBJqoxLMMevxbnakg+ImUtPORSB4MMkB7aIn+Ny1aCGT7zA45dKePQtTSoBg2uk+ulZQgzPdFyQt7F3wmh3E5cU0Ocxt3oB0IeuhASIIScjGB3XZ/xKg53czLYO2HRzJDYHXKQ4K5Swepkd652iQDYf9N9ucf4eCDcOmDIXoQRoA0UuOMCv3rOBDUixohbMUpdEykYPRct3aVCPWkLdO814YHtf8fvm3ySdkmk59kZ+8wwTcybb/2aIl+OpUANvZejtBwRQy+gfuIKGpALpvmn/9wDe0n1tB15X5LZS3S8RcTfQ8br99BzUQhSmlM4lOn7ePncvP+Fft7bT7eDJnjQmVm88KuHyEgsoHDIezurOUUEEp1wunI+LhpzcO+DfvdE7hNJE0jsiGiS2MIoccBnLwnyzaj8K7+apadgF3hu8SAFmh5LsptQrcj5Quf/ZimugkdD7z63CQMb9nccOYCCSwicrJConK5qsQTa2q4m6YLIeE+E3ZNX98ueKX9FmcFbOAh7BGS0kVo3Jul8ZhvNGJ9+p5vw3MIxeF0wr1is6+IBbispVgWlPBhG8jFbZ5huWzK/M6MGHsc8S+IOGPz2eR8TtwepCzenNpl0WZr0tg=="}'
[Relay 3] [Relay] [DEBUG] Data after JSON parse: type=<class 'dict'>, keys=['next_ip', 'next_port', 'session_key', 'payload']
[Relay 3] [Relay] Received session_key (base64): K1r9n+tuvhNUDqH/TvPjtt+nzhpdxCUej+cfjggdHkG5Fj+Fs2IR8uWm+cm8Fqyi0SF2Cf6Nfb5c/3faIwEQmmdD0gMky6QK7jWzz5MFL0PzknwVjln4VhCNhrDJ2dd5mNp2a5TRkBhQAE7kJMcSSTvyMVyNQA7VwxywwdS63lU2ttaXppICf7wDQlUIKZRMBPL7ZuqX/J+rYZNixq7RH6m7OidM+giBo42SRUkjWAoOKtQofI97uZebM61cQprEXexJSE435fCG7hB8UsZRDPVP8tJS5s7wBt0vLu/hNSfmNnH9eV207x06KuCjhMH2Tw8KdTebU7cqZDBmDZi6LA==
[Relay 3] [Relay] Decoded session_key_enc (hex): 2b5afd9feb6ebe13540ea1ff4ef3e3b6dfa7ce1a5dc4251e8fe71f8e081d1e41b9163f85b36211f2e5a6f9c9bc16aca2d1217609fe8d7dbe5cff77da2301109a6743d20324cba40aee35b3cf93052f43f3927c158e59f856108d86b0c9d9d77998da766b94d1901850004ee424c712493bf2315c8d400ed5c31cb0c1d4bade5536b6d697a692027fbc0342550829944c04f2fb66ea97fc9fab619362c6aed11fa9bb3a274cfa0881a38d92454923580a0e2ad4287c8f7bb9979b33ad5c429ac45dec49484e37e5f086ee107c52c6510cf54ff2d252e6cef006dd2f2eefe13527e63671fd795db4ef1d3a2ae0a384c1f64f0f0a75379b53b72a6430660d98ba2c
[Relay 3] [Relay] Decrypting session key with fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] [Relay] Decrypted session_key (hex): e26d3491fb6a306a6428f663a3e7f156789c32eb99ff10b6ffa8e7dc173a9ed7
[Relay 3] [Relay] [DEBUG] About to AES-decrypt payload (passing base64 string directly)
[Relay 3] [Relay] [DEBUG] Payload base64-decoded: type=<class 'bytes'>, len=493, preview=b'\xe99\xa3\x99t2c\xe0\x91\xec\x15\xac\x9d\xd0`}O\xdd~\',\r\x15\x1e}\xaf!\xb8\xf8\xc1&\xaa1,\xc3\x1e\xbf\x16\xe7jH>"e-<\xe4R\x07\x83\x0c\x90\x1e\xda"\x7f\x8d\xcbV\x82'
[Relay 3] [Relay] [DEBUG] AES-decrypted payload: type=<class 'bytes'>, len=477, preview=b'{"next_ip": "127.0.0.1", "next_port": 9100, "session_key": "'
[Relay 3] [Relay] [DEBUG] AES-decrypted payload (hex): 7b226e6578745f6970223a20223132372e302e302e31222c20226e6578745f706f7274223a20393130302c202273657373696f6e5f6b6579223a2022
[Relay 3] [Relay] [DEBUG] AES-decrypted payload as UTF-8: '{"next_ip": "127.0.0.1", "next_port": 9100, "session_key": "fkoaOh69LCVpxS5qTAnOdskpNROZJy//JNAo3VMH0anDJLlFIrbQdaMAfR7I'
[Relay 3] [Relay] [DEBUG] Inner payload is JSON, forwarding to next relay.
[Relay 3] [Relay] [DEBUG] Forwarding to next relay 127.0.0.1:9100
[Relay 3] [Relay] [DEBUG] Received response from next relay: type=<class 'bytes'>, len=460, preview=b'{"result": "OK", "echo": {"session_key": "fkoaOh69LCVpxS5qTA'
[Relay 3] [Relay] [RETURN] AES-encrypted response (hex): 418e5ef00724e86145a1870f27337b020383251cade97cd1cc1d24ade95edc979945abd16dbffe22b38c77cf6a9a63ac97a69f7fd66ef94328320d5c
[Relay 3] [Relay] [RETURN] Base64-encoded AES-encrypted response: type=<class 'bytes'>, len=636, preview=b'QY5e8Ack6GFFoYcPJzN7AgODJRyt6XzRzB0krele3JeZRavRbb/+IrOMd89q'
[Relay 3] [Relay] [handle_message END] addr=('10.250.120.196', 59380), thread=6122237952
[Relay 1] [Relay] Deregistering from CDS and shutting down...
[Relay 3] [Relay] Deregistering from CDS and shutting down...
[Relay 2] [Relay] Deregistering from CDS and shutting down...
[Relay 3] [Relay] ERROR during deregistration: [Errno 54] Connection reset by peer
[Relay 1] [Relay] ERROR during deregistration: [Errno 54] Connection reset by peer
[Relay 2] [Relay] ERROR during deregistration: [Errno 54] Connection reset by peer
[Relay] ---- Relay process started ----
[Relay 1] [Relay] Loaded persistent RSA keypair from relay1_key.pem
[Relay 1] [Relay] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] [KEY] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] Relay 1 starting on 10.250.120.196:9101 (RELAY PORT 9101)
[Relay 1] Registering with CDS at 127.0.0.1:9000
[Relay 1] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9101, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5MM7/HBECV26fZqjUJkt\nQ4+dx297cL0hf1+rf08Qir5tL/lArfQsiplTqcsIsZiN7vJ8K2XzvK5JAEv8tVE4\nEKU4W1hbEVBd1eLCX+Oc5XauTbWhW8xlc2wdNlNwDhin2Mw84doKJWPyfjtIwnIi\n3nWHqxLyAqkj6qDoByA8D7YVmJxvzwL0mrYE8G8b4Q4Wjnx2SXeTwc9LRzqwrsyb\nlM5B4BSVPBignOMhD2AfuIFw6uULQThbkL9L5AnQA08B4Gqzo731LLJN/Y6qo+VJ\nki2t6m1aJTG0LBjijpH7CtnN1MHIQ5UueS1sJVYZooYxkxEYYZTqIUXxuI5ICKPC\nCQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 1] [Relay] Listening for incoming messages on port 9101 (RELAY PORT 9101)
[Relay] ---- Relay process started ----
[Relay 2] [Relay] Loaded persistent RSA keypair from relay2_key.pem
[Relay 2] [Relay] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] [KEY] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] Relay 2 starting on 10.250.120.196:9102 (RELAY PORT 9102)
[Relay 2] Registering with CDS at 127.0.0.1:9000
[Relay 2] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9102, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA58J3pSrOQd4hYnuzQQ7q\nWrjjo+3BJp+ik23brR2yl0kjtfH+wjD9LYWHS7dBxsDRzSozJ/7EWKKNCaTsgvaF\nN6vpyBPqDM/uQfOWfirteL50RgDZw95Vml4Fuay7bTBEb1J8ydvFqawo8rnLE2I3\nU4BjBT+CD38bY3je8wrrCX9fo1uYaLDlfteGshadZ2gnTxrAzkZZ/CTFdyb8JrmN\nIuxjBVjwSA/uIv+KHWQhXRA5jJPXcNV88LYXyEzpid1Cr9gnrqA88K0HSleiwZjU\nJF3LhBvS2Ga2HHfFsk5D/yz/pTHwDvRA98VMT/90wahwmSJsck4XWDFhmNhy3oDR\nBQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 2] [Relay] Listening for incoming messages on port 9102 (RELAY PORT 9102)
[Relay] ---- Relay process started ----
[Relay 3] [Relay] Loaded persistent RSA keypair from relay3_key.pem
[Relay 3] [Relay] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] [Relay] [KEY] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] Relay 3 starting on 10.250.120.196:9103 (RELAY PORT 9103)
[Relay 3] Registering with CDS at 127.0.0.1:9000
[Relay 3] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9103, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5k9OJ8m3IdjmwR1skM1G\nwrKkwlYLK0Qs+I/BX5ww5wEakOsTy5NVFAwTYrCUnR012u2jCwI8wV1YpPaMa8RJ\ntnqNFy4pFfqBh5tmidHQ3QMRvINPrGtQM5+VgMXoA0y8izql52M1K/3Q6sHVlAXd\nmpQcBO+JSHY7uyVx1txZssyisia7Nn8Frh/XRpl0oUvGkSnbm/KgqDAP0xJ3lUZS\nEGiIWdf0bn7tHD3nYBMrWWi3jSQWf0Q80asIEYWipwkfMPf0ffzu4FX0elfvpyOX\nr50xk7sb8K5IhcilwxKxQpPOcq3f6ph0EERQR7pOdDqkzFdHoGiyssSX4MYM60kd\nmQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 3] [Relay] Listening for incoming messages on port 9103 (RELAY PORT 9103)
[Relay 3] [Relay] Deregistering from CDS and shutting down...
[Relay 1] [Relay] Deregistering from CDS and shutting down...
[Relay 2] [Relay] Deregistering from CDS and shutting down...
[Relay 1] [Relay] ERROR during deregistration: [Errno 54] Connection reset by peer
[Relay 2] [Relay] ERROR during deregistration: [Errno 54] Connection reset by peer
[Relay 3] [Relay] ERROR during deregistration: [Errno 54] Connection reset by peer
[Relay] ---- Relay process started ----
[Relay 1] [Relay] Loaded persistent RSA keypair from relay1_key.pem
[Relay 1] [Relay] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] [KEY] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] Relay 1 starting on 10.250.120.196:9101 (RELAY PORT 9101)
[Relay 1] Registering with CDS at 127.0.0.1:9000
[Relay 1] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9101, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5MM7/HBECV26fZqjUJkt\nQ4+dx297cL0hf1+rf08Qir5tL/lArfQsiplTqcsIsZiN7vJ8K2XzvK5JAEv8tVE4\nEKU4W1hbEVBd1eLCX+Oc5XauTbWhW8xlc2wdNlNwDhin2Mw84doKJWPyfjtIwnIi\n3nWHqxLyAqkj6qDoByA8D7YVmJxvzwL0mrYE8G8b4Q4Wjnx2SXeTwc9LRzqwrsyb\nlM5B4BSVPBignOMhD2AfuIFw6uULQThbkL9L5AnQA08B4Gqzo731LLJN/Y6qo+VJ\nki2t6m1aJTG0LBjijpH7CtnN1MHIQ5UueS1sJVYZooYxkxEYYZTqIUXxuI5ICKPC\nCQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 1] [Relay] Listening for incoming messages on port 9101 (RELAY PORT 9101)
[Relay] ---- Relay process started ----
[Relay 2] [Relay] Loaded persistent RSA keypair from relay2_key.pem
[Relay 2] [Relay] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] [KEY] Public key fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] Relay 2 starting on 10.250.120.196:9102 (RELAY PORT 9102)
[Relay 2] Registering with CDS at 127.0.0.1:9000
[Relay 2] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9102, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA58J3pSrOQd4hYnuzQQ7q\nWrjjo+3BJp+ik23brR2yl0kjtfH+wjD9LYWHS7dBxsDRzSozJ/7EWKKNCaTsgvaF\nN6vpyBPqDM/uQfOWfirteL50RgDZw95Vml4Fuay7bTBEb1J8ydvFqawo8rnLE2I3\nU4BjBT+CD38bY3je8wrrCX9fo1uYaLDlfteGshadZ2gnTxrAzkZZ/CTFdyb8JrmN\nIuxjBVjwSA/uIv+KHWQhXRA5jJPXcNV88LYXyEzpid1Cr9gnrqA88K0HSleiwZjU\nJF3LhBvS2Ga2HHfFsk5D/yz/pTHwDvRA98VMT/90wahwmSJsck4XWDFhmNhy3oDR\nBQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 2] [Relay] Listening for incoming messages on port 9102 (RELAY PORT 9102)
[Relay] ---- Relay process started ----
[Relay 3] [Relay] Loaded persistent RSA keypair from relay3_key.pem
[Relay 3] [Relay] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] [Relay] [KEY] Public key fingerprint: 7a46893f440bcfb43ce49eb8d8156323dab3b8a3de869d2faebb649692ef6c1c
[Relay 3] Relay 3 starting on 10.250.120.196:9103 (RELAY PORT 9103)
[Relay 3] Registering with CDS at 127.0.0.1:9000
[Relay 3] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9103, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5k9OJ8m3IdjmwR1skM1G\nwrKkwlYLK0Qs+I/BX5ww5wEakOsTy5NVFAwTYrCUnR012u2jCwI8wV1YpPaMa8RJ\ntnqNFy4pFfqBh5tmidHQ3QMRvINPrGtQM5+VgMXoA0y8izql52M1K/3Q6sHVlAXd\nmpQcBO+JSHY7uyVx1txZssyisia7Nn8Frh/XRpl0oUvGkSnbm/KgqDAP0xJ3lUZS\nEGiIWdf0bn7tHD3nYBMrWWi3jSQWf0Q80asIEYWipwkfMPf0ffzu4FX0elfvpyOX\nr50xk7sb8K5IhcilwxKxQpPOcq3f6ph0EERQR7pOdDqkzFdHoGiyssSX4MYM60kd\nmQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 3] [Relay] Listening for incoming messages on port 9103 (RELAY PORT 9103)
[Relay 2] [Relay] [handle_message ENTERED] addr=('10.250.120.196', 59681), thread=6164672512, relay_port=9102
[Relay 2] [Relay] [DEBUG] Raw data received: b'{"next_ip": "10.250.120.196", "next_port": 9102, "session_key": "PztxxF8uEcY/QcmnfJ0o+i19boVU4ktyBGvSsVkjNGC8TkRGPYdEtGXfCl/2GUC7RuGpjBym/qbs2YRQwp0aVpL8GIreHUoK77K5Gu+LBMNGJg9EyagpMZ5OkvQXAH8l3hrkjQLNH62NsQ9jOwqtqzFQkPEjjmjPYXtcdX7OvOey6etaoCurjPbGyjDfaq0lRgKxFvSe7jfHcrQqgROXV7woKlRDeMmtKtrAlr3SXOOPvQwj45k1sdgMoMCPWgUaR/JsZbzu3+Olvympyr77UPZK/WIVOT9dxiCvb2I1Ly3A29qr0DLR0HUOm9KEkAOJ4lDTMzMnvkTHsdOfGCuUjA==", "payload": "2M8Xp+c7O3k/GQM+nQqfXJjO4W7uls+gBjioPLJ1WTtg/JI4qwR7Q4tPAZbRJ/1IQ6m/R5q/x9Sz2gyPaUgaXOZMBagi9lqLinSWik7sqQ8ufHjzNOtAutI2kY3l37RAIVYS7+Y5TIb5LjPtEOkSgAX4v+QcCR2FLZbcRZp7hAw4hZaeFqUXw377rampM5X4IX7b7SiFDfHJlARmxy/KRTLnBYGBF2Qqyrq3H478JZ0p4F2bUyEIWckjY+OVGKmQUvlqK7AIjcxRCM4kfjpW1yplqT8IxcQGlkfDtL+n8kCKx8tTHMbYa/EihZm5iHfL1hBeCWDTpXg+G6XtP1mAPs+RgLoGYo81j5wvzL6/jdsAEu+zxwG3iwEVjbcMMxbSikeg6ZmdiTNdEJdqd+qLpe3Pe15hEfD4ANGCXsMX4P03MqWSdPdu5DHvxV6EejoHu1jxF2+aP1aP67bOG1Ph77ilHEAwXe37AXgzljX9grc+kceu7HklXUyKlCRv7V/x/8Vh16CP0pblWeVvyG6u3vnqJj/WU+f8O8VQGu0FFtMNEKV98Q1Bo1zG0rSSOQ2xFRJUPIql2P8ODHhD+XACp7L3R/fun0stTlhpIXbCRgcXxKxLaQCIYkVqiAmqYG+s9tuVvDHIec9SrzJQTZLIMXC2KwHv4fTjSsIukiWWw91pUTFF/Ymudiuth5pP2BDxnlPfDsX5qkBTEuc4iY2yGh1liaiRalr7duc4zY3XnNfkP5Q35DM7XZHH6mLH6IrMgc+PbrjmjfPJ82PuIPXqHwxMn4Ip11LQAkH/msVYQnSFAZOCe8FxM6FY0WcFV+CToZRzzmYDAxVlOkRRxOFUhVaWphKcZKcF+XyRtsIivuLQEaBmKZJ/OA2r0xNZ25dk8m83tyF9AMqBo+YQ3CkIBbtU/B1zzevsWHsmr9vt59WgJlWx+eB0L5I6T9QC5WkhztaXuxX//smdOZX0bAlO3sGZsN4WebrzI6+o6hOxjQ137QxXIM8dCkYKXGXEA3EAWDG8OmQgK7KplEq5S5pRoknc9zwNe4jiKWrO8eYfvZPKtAWpRGntiSzpJO+k0mIU1xUX5sVu4ikUl2pUBfXukf1S2VJRn+aeeARM9pzgTLDodKS/p6N4gmSgjyVFNeBf05qR9yjw++bSko3eD6BADHyLhS1RQPsrCEFdK3aoLeKRrl1dWQ/al7jALq5RjFx8XyswALNtKWWb3OBs1fs9aGTUIbU5NzVhJNNPND2PY515ssSn5JQUEnAB/U+CVA4CJO+49SMqLvWD3U1reKlZ3xZeV/lowxM7csbXEf2+EcrnFBZUl0rM8LeDHm0/6wxAVWMCdLPHRyMyS1mu2z82j7m9SPK14xdzuS6lqe74StVQQeap0DP0erIfBXt8vGploS9yOTGXyxBcxa7nu+zKUUZHoakbkKa3qhh1/ZhVhINT+USp12GdcgTRTU1kNQ=="}'
[Relay 2] [Relay] [DEBUG] Data after JSON parse: type=<class 'dict'>, keys=['next_ip', 'next_port', 'session_key', 'payload']
[Relay 2] [Relay] Received session_key (base64): PztxxF8uEcY/QcmnfJ0o+i19boVU4ktyBGvSsVkjNGC8TkRGPYdEtGXfCl/2GUC7RuGpjBym/qbs2YRQwp0aVpL8GIreHUoK77K5Gu+LBMNGJg9EyagpMZ5OkvQXAH8l3hrkjQLNH62NsQ9jOwqtqzFQkPEjjmjPYXtcdX7OvOey6etaoCurjPbGyjDfaq0lRgKxFvSe7jfHcrQqgROXV7woKlRDeMmtKtrAlr3SXOOPvQwj45k1sdgMoMCPWgUaR/JsZbzu3+Olvympyr77UPZK/WIVOT9dxiCvb2I1Ly3A29qr0DLR0HUOm9KEkAOJ4lDTMzMnvkTHsdOfGCuUjA==
[Relay 2] [Relay] Decoded session_key_enc (hex): 3f3b71c45f2e11c63f41c9a77c9d28fa2d7d6e8554e24b72046bd2b159233460bc4e44463d8744b465df0a5ff61940bb46e1a98c1ca6fea6ecd98450c29d1a5692fc188ade1d4a0aefb2b91aef8b04c346260f44c9a829319e4e92f417007f25de1ae48d02cd1fad8db10f633b0aadab315090f1238e68cf617b5c757ecebce7b2e9eb5aa02bab8cf6c6ca30df6aad254602b116f49eee37c772b42a81139757bc282a544378c9ad2adac096bdd25ce38fbd0c23e39935b1d80ca0c08f5a051a47f26c65bceedfe3a5bf29a9cabefb50f64afd6215393f5dc620af6f62352f2dc0dbdaabd032d1d0750e9bd284900389e250d3333327be44c7b1d39f182b948c
[Relay 2] [Relay] Decrypting session key with fingerprint: 30c6ba45aeff3f8543ce1edb4f46f412e6bcb0300acbf2a008df3bf75d6a137d
[Relay 2] [Relay] Decrypted session_key (hex): d0093cf7318da51566ea2deba7a21a85ac698a02782ab9da19ddf3369772bc04
[Relay 2] [Relay] [DEBUG] About to AES-decrypt payload (passing base64 string directly)
[Relay 2] [Relay] [DEBUG] Payload base64-decoded: type=<class 'bytes'>, len=1102, preview=b"\xd8\xcf\x17\xa7\xe7;;y?\x19\x03>\x9d\n\x9f\\\x98\xce\xe1n\xee\x96\xcf\xa0\x068\xa8<\xb2uY;`\xfc\x928\xab\x04{C\x8bO\x01\x96\xd1'\xfdHC\xa9\xbfG\x9a\xbf\xc7\xd4\xb3\xda\x0c\x8f"
[Relay 2] [Relay] [DEBUG] AES-decrypted payload: type=<class 'bytes'>, len=1086, preview=b'{"next_ip": "10.250.120.196", "next_port": 9101, "session_ke'
[Relay 2] [Relay] [DEBUG] AES-decrypted payload (hex): 7b226e6578745f6970223a202231302e3235302e3132302e313936222c20226e6578745f706f7274223a20393130312c202273657373696f6e5f6b65
[Relay 2] [Relay] [DEBUG] AES-decrypted payload as UTF-8: '{"next_ip": "10.250.120.196", "next_port": 9101, "session_key": "F2h+dQT6g+s7X0stg70kPZZri6cdRl4emlrzJW0M77r3XAfyLaIKvWa'
[Relay 2] [Relay] [DEBUG] Inner payload is JSON, forwarding to next relay.
[Relay 2] [Relay] [DEBUG] Forwarding to next relay 10.250.120.196:9101
[Relay 1] [Relay] [handle_message ENTERED] addr=('10.250.120.196', 59684), thread=6193524736, relay_port=9101
[Relay 1] [Relay] [DEBUG] Raw data received: b'{"session_key": "F2h+dQT6g+s7X0stg70kPZZri6cdRl4emlrzJW0M77r3XAfyLaIKvWaL8XI7N8CXsB6VWHx4/dz4yYks09sAMkpSyhaa+FTwi/2FUfO+Crmv79KwC1Sda2hQsDUWLqvcs0PCsEI5msVke7M3Qp7t8YEjPLHGS7rl+QMbIqnPXmHAFpMBi+Fyid3ITBMf6Eu4+NnJmosGoFmNaenw6thFQaIIuHEKPECHFmtoAKYRngCySePd8gXLHJer9v5kP2Ml2oS4zjtJAsrgykrxVMRQcmYIsg8rWQFoAc3purrw8xcoXEDz0cPcxDVnblP4TlHiTjZB3ZNkk2KDjSt2yMUdEQ==", "payload": "azY0/M2+74nX747073d56wacOMy99DDWSsNeqh0Ct7z4EdoONI7vrFnlha+Zb54AThTYYzDQ3oC6unvBue9MdDpzYo9kx5xaGNgHUey+gI+/LG0sVog+uc5OMYENyyQ844BAOuVnyb3f6y5PJkN9v1d7NRgWNkwWTg5uSOCXe1+xCXGk0IMufyXThY/iM28xkGlGgbTq9+srlJhWq8KdO04MP3dZZego0lSdxursWfVQcLnSQvraG5uHuA+N8x8+tAQaKysNIEUPC67EflQKxnCJR9TSsPrZNOTXCCBTGNJFapq+nql5lqijmjoso/crS4oL4m9PipCPjPCHxC+1/Sy9CP66LcRkevLZbaEliWwwOXXHBgpFfUot4bqJOSU6Fr8yKpD+Gh/P+cBPsSkWdzsAFN/UAiKXSJrcTw0izuhOGjlEFLURSkvVSmd/e2aXKN60df6H0OaOjOaic94mf8O3G7/wZZM5tTUj89RQ36pLrtScyb1jsctyTqCRg5XdimsXNAAAHetS8ariG159Xb/nt7wy9w/W00c9/kWdZpVnbgU5gxvmicYFok7LhAUdRyNnn+MurKxlGconW86pmOJLkF9iUB+BgMcsyig/ILYU3nN33r1EwigfFnvgtZ0G4fHt+q3LKiNzvfQODQ=="}'
[Relay 1] [Relay] [DEBUG] Data after JSON parse: type=<class 'dict'>, keys=['session_key', 'payload']
[Relay 1] [Relay] Received session_key (base64): F2h+dQT6g+s7X0stg70kPZZri6cdRl4emlrzJW0M77r3XAfyLaIKvWaL8XI7N8CXsB6VWHx4/dz4yYks09sAMkpSyhaa+FTwi/2FUfO+Crmv79KwC1Sda2hQsDUWLqvcs0PCsEI5msVke7M3Qp7t8YEjPLHGS7rl+QMbIqnPXmHAFpMBi+Fyid3ITBMf6Eu4+NnJmosGoFmNaenw6thFQaIIuHEKPECHFmtoAKYRngCySePd8gXLHJer9v5kP2Ml2oS4zjtJAsrgykrxVMRQcmYIsg8rWQFoAc3purrw8xcoXEDz0cPcxDVnblP4TlHiTjZB3ZNkk2KDjSt2yMUdEQ==
[Relay 1] [Relay] Decoded session_key_enc (hex): 17687e7504fa83eb3b5f4b2d83bd243d966b8ba71d465e1e9a5af3256d0cefbaf75c07f22da20abd668bf1723b37c097b01e95587c78fddcf8c9892cd3db00324a52ca169af854f08bfd8551f3be0ab9afefd2b00b549d6b6850b035162eabdcb343c2b042399ac5647bb337429eedf181233cb1c64bbae5f9031b22a9cf5e61c01693018be17289ddc84c131fe84bb8f8d9c99a8b06a0598d69e9f0ead84541a208b8710a3c4087166b6800a6119e00b249e3ddf205cb1c97abf6fe643f6325da84b8ce3b4902cae0ca4af154c450726608b20f2b59016801cde9babaf0f317285c40f3d1c3dcc435676e53f84e51e24e3641dd93649362838d2b76c8c51d11
[Relay 1] [Relay] Decrypting session key with fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] Decrypted session_key (hex): e34181c90891222fffe2aefee418dfd9a45b825ac754e2b57579cc453ca87c38
[Relay 1] [Relay] [DEBUG] About to AES-decrypt payload (passing base64 string directly)
[Relay 1] [Relay] [DEBUG] Payload base64-decoded: type=<class 'bytes'>, len=493, preview=b'k64\xfc\xcd\xbe\xef\x89\xd7\xef\x8e\xf4\xefwy\xeb\x06\x9c8\xcc\xbd\xf40\xd6J\xc3^\xaa\x1d\x02\xb7\xbc\xf8\x11\xda\x0e4\x8e\xef\xacY\xe5\x85\xaf\x99o\x9e\x00N\x14\xd8c0\xd0\xde\x80\xba\xba{\xc1'
[Relay 1] [Relay] [DEBUG] AES-decrypted payload: type=<class 'bytes'>, len=477, preview=b'{"next_ip": "127.0.0.1", "next_port": 9100, "session_key": "'
[Relay 1] [Relay] [DEBUG] AES-decrypted payload (hex): 7b226e6578745f6970223a20223132372e302e302e31222c20226e6578745f706f7274223a20393130302c202273657373696f6e5f6b6579223a2022
[Relay 1] [Relay] [DEBUG] AES-decrypted payload as UTF-8: '{"next_ip": "127.0.0.1", "next_port": 9100, "session_key": "PYXCOWvYqdMn9mB/aakmBELXNJIT0nJpPgJtBRRwDVgodDpqdK+KJMtR3ELO'
[Relay 1] [Relay] [DEBUG] Inner payload is JSON, forwarding to next relay.
[Relay 1] [Relay] [DEBUG] Forwarding to next relay 127.0.0.1:9100
[Relay 1] [Relay] [DEBUG] Received response from next relay: type=<class 'bytes'>, len=460, preview=b'{"result": "OK", "echo": {"session_key": "PYXCOWvYqdMn9mB/aa'
[Relay 1] [Relay] [RETURN] AES-encrypted response (hex): a4b99e6c8c9e5952ad33daa4acfe3795d5df4a7ef048540d62feef8015e9a2c40e993540366374b26ab2a298f19b46f9a854f428ad1f5a84b1027c00
[Relay 1] [Relay] [RETURN] Base64-encoded AES-encrypted response: type=<class 'bytes'>, len=636, preview=b'pLmebIyeWVKtM9qkrP43ldXfSn7wSFQNYv7vgBXposQOmTVANmN0smqyopjx'
[Relay 2] [Relay] [DEBUG] Received response from next relay: type=<class 'bytes'>, len=636, preview=b'pLmebIyeWVKtM9qkrP43ldXfSn7wSFQNYv7vgBXposQOmTVANmN0smqyopjx'
[Relay 1] [Relay] [handle_message END] addr=('10.250.120.196', 59684), thread=6193524736
[Relay 2] [Relay] [RETURN] AES-encrypted response (hex): 4fe2f6f69925130cd79464f6f2fc9b3ef0ad8d6215365469a96af863ca73806ebfeb67cf6f9237b15356d922e1142b8f4abe6a6e568b9ec168bc52fd
[Relay 2] [Relay] [RETURN] Base64-encoded AES-encrypted response: type=<class 'bytes'>, len=872, preview=b'T+L29pklEwzXlGT28vybPvCtjWIVNlRpqWr4Y8pzgG6/62fPb5I3sVNW2SLh'
[Relay 1] [Relay] Deregistering from CDS and shutting down...
[Relay 2] [Relay] [handle_message END] addr=('10.250.120.196', 59681), thread=6164672512
[Relay 3] [Relay] Deregistering from CDS and shutting down...
[Relay 2] [Relay] Deregistering from CDS and shutting down...
[Relay 3] [Relay] ERROR during deregistration: [Errno 54] Connection reset by peer
[Relay 1] [Relay] ERROR during deregistration: [Errno 54] Connection reset by peer
[Relay 2] [Relay] ERROR during deregistration: [Errno 54] Connection reset by peer
