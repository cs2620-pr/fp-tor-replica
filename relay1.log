[Relay] ---- Relay process started ----
[Relay 1] [Relay] Loaded persistent RSA keypair from relay1_key.pem
[Relay 1] [Relay] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] [KEY] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] Relay 1 starting on 10.250.153.213:9101 (RELAY PORT 9101)
[Relay 1] Registering with CDS at 127.0.0.1:9000
[Relay 1] [Relay] Registered with CDS: {'ip': '10.250.153.213', 'port': 9101, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5MM7/HBECV26fZqjUJkt\nQ4+dx297cL0hf1+rf08Qir5tL/lArfQsiplTqcsIsZiN7vJ8K2XzvK5JAEv8tVE4\nEKU4W1hbEVBd1eLCX+Oc5XauTbWhW8xlc2wdNlNwDhin2Mw84doKJWPyfjtIwnIi\n3nWHqxLyAqkj6qDoByA8D7YVmJxvzwL0mrYE8G8b4Q4Wjnx2SXeTwc9LRzqwrsyb\nlM5B4BSVPBignOMhD2AfuIFw6uULQThbkL9L5AnQA08B4Gqzo731LLJN/Y6qo+VJ\nki2t6m1aJTG0LBjijpH7CtnN1MHIQ5UueS1sJVYZooYxkxEYYZTqIUXxuI5ICKPC\nCQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 1] [Relay] Listening for incoming messages on port 9101 (RELAY PORT 9101)
[Relay 1] [Relay] [handle_message ENTERED] addr=('10.250.153.213', 56624), thread=6167408640, relay_port=9101
[Relay 1] [Relay] [DEBUG] Raw data received: b'{"next_ip": "10.250.153.213", "next_port": 9101, "session_key": "VZbzBmUokIYtCKBKsY83EiyVarE0M/40K56BWASCdt1b1RIEh2l9999ap8Wx66G5AGLQlWw/hGDlPtzp0F/q5HcqAEH561xqWz94DlClw9Yu3/wKtNXNhn3l8fdLqiJnRUCAo/xgFSIeecTGRi+O+Dy01F96D9AdLhcpq/3+6dt8Cp1w/AqQbAuvXuf/anyONUwJn+iXJImNYwOZyoPMDaFYhn/Ux53/LZvTVHIV0S37XrfmUfWV+8aWKnNAtCCDsewjTXkNPOqV44+x58lzUAF+t6gY8fxBNCFaHFmj1iGPBe5D9yBz8DFOsuBOD8pOxV9KugTtoodpXlfRBI4F+g==", "payload": "lWIBs4xOXv8QRw5c+EMnautdbF2Mkjd+Dsn8BFA3ivhGb0lCCHXlHqkatXI1Iq/HuqxopSqx6XJCUQkXWyia+FY2LGl8VcYwEN/1isg1vycSbVxIk4krqNcvLkeCDumKeGwRMEEtR/jFTlDWbTQXy4qHB3x9lOhnNWqP7AOWpjrAudAUGMonkFFemb9ZxjdTGBPtSukxhKkPqpW4MsBky/+5kc7iRgphmns/hXQiZv+nHbT8wHlbSyoZIccjVRTAvEopNod2qRqENLHcYk7H/KZUYBnjRTJgPHpFNi5WzyNSda3Nw7rf25K4w/sakfaqNCUm6GVZldywfw/eogDDaFB+uOYla7rff+46wlOeWzhkYBkapJGmm1dG3WjI195SRF0B6zMWh7f8m7k+5hriu6j7On+DHqucPE0fGLQjRrJrTxAI5/lWjnN+vYhpbouMGu/h2SBq5CkCeNg4xVu9LH5/ibAGRMe1vKaFBV57w3/5c++4OyPeKdGPElHfebMjjkKDa8e5lPEuOliXwlBcMipnnWHvRRcGmjZ1RztyO7D+LCg/zH7h2YmcKw5d5XqeweowQmHP5L11s6WQHBH2C5rTeaWmnC1VvTvoDSbQxBVPG6mZyivtGThqqagjufDpZ4XymEHyq3PO93l4qgt41QF+"}'
[Relay 1] [Relay] [DEBUG] Data after JSON parse: type=<class 'dict'>, keys=['next_ip', 'next_port', 'session_key', 'payload']
[Relay 1] [Relay] Received session_key (base64): VZbzBmUokIYtCKBKsY83EiyVarE0M/40K56BWASCdt1b1RIEh2l9999ap8Wx66G5AGLQlWw/hGDlPtzp0F/q5HcqAEH561xqWz94DlClw9Yu3/wKtNXNhn3l8fdLqiJnRUCAo/xgFSIeecTGRi+O+Dy01F96D9AdLhcpq/3+6dt8Cp1w/AqQbAuvXuf/anyONUwJn+iXJImNYwOZyoPMDaFYhn/Ux53/LZvTVHIV0S37XrfmUfWV+8aWKnNAtCCDsewjTXkNPOqV44+x58lzUAF+t6gY8fxBNCFaHFmj1iGPBe5D9yBz8DFOsuBOD8pOxV9KugTtoodpXlfRBI4F+g==
[Relay 1] [Relay] Decoded session_key_enc (hex): 5596f306652890862d08a04ab18f37122c956ab13433fe342b9e8158048276dd5bd5120487697df7df5aa7c5b1eba1b90062d0956c3f8460e53edce9d05feae4772a0041f9eb5c6a5b3f780e50a5c3d62edffc0ab4d5cd867de5f1f74baa2267454080a3fc6015221e79c4c6462f8ef83cb4d45f7a0fd01d2e1729abfdfee9db7c0a9d70fc0a906c0baf5ee7ff6a7c8e354c099fe89724898d630399ca83cc0da158867fd4c79dff2d9bd3547215d12dfb5eb7e651f595fbc6962a7340b42083b1ec234d790d3cea95e38fb1e7c97350017eb7a818f1fc4134215a1c59a3d6218f05ee43f72073f0314eb2e04e0fca4ec55f4aba04eda287695e57d1048e05fa
[Relay 1] [Relay] Decrypting session key with fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] Decrypted session_key (hex): fe9e44f9dc5482ef8ae8c2bd359f9f20dc0ee1a30c8f61385c86e095f709ea27
[Relay 1] [Relay] [DEBUG] About to AES-decrypt payload (passing base64 string directly)
[Relay 1] [Relay] [DEBUG] Payload base64-decoded: type=<class 'bytes'>, len=498, preview=b'\x95b\x01\xb3\x8cN^\xff\x10G\x0e\\\xf8C\'j\xeb]l]\x8c\x927~\x0e\xc9\xfc\x04P7\x8a\xf8FoIB\x08u\xe5\x1e\xa9\x1a\xb5r5"\xaf\xc7\xba\xach\xa5*\xb1\xe9rBQ\t\x17'
[Relay 1] [Relay] [DEBUG] AES-decrypted payload: type=<class 'bytes'>, len=482, preview=b'{"next_ip": "10.250.153.213", "next_port": 9103, "session_ke'
[Relay 1] [Relay] [DEBUG] AES-decrypted payload (hex): 7b226e6578745f6970223a202231302e3235302e3135332e323133222c20226e6578745f706f7274223a20393130332c202273657373696f6e5f6b65
[Relay 1] [Relay] [DEBUG] Next hop JSON keys: ['next_ip', 'next_port', 'session_key', 'payload']
[Relay 1] [Relay] [DEBUG] Forwarding to next relay 10.250.153.213:9103
[Relay 1] [Relay] [DEBUG] Received response from next relay: type=<class 'bytes'>, len=24, preview=b'UMz7t9xBeZrgvnEzenAYzw=='
[Relay 1] [Relay] [RETURN] Base64-decoded response: type=<class 'bytes'>, len=16, preview=b'P\xcc\xfb\xb7\xdcAy\x9a\xe0\xbeq3zp\x18\xcf'
[Relay 1] [Relay] [RETURN] AES-decrypted response: type=<class 'bytes'>, len=0, preview=b''
[Relay 1] [Relay] [RETURN] AES-decrypted response as UTF-8: 
[Relay 1] [Relay] [RETURN] AES-encrypted response (hex): 9f6a587879e8faeb4d6463881102aa2436f445ad151829e8e723ac16db306f96
[Relay 1] [Relay] [RETURN] Base64-encoded AES-encrypted response: type=<class 'bytes'>, len=44, preview=b'n2pYeHno+utNZGOIEQKqJDb0Ra0VGCno5yOsFtswb5Y='
[Relay 1] [Relay] [handle_message END] addr=('10.250.153.213', 56624), thread=6167408640
