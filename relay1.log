[Relay] ---- Relay process started ----
[Relay 1] [Relay] Loaded persistent RSA keypair from relay1_key.pem
[Relay 1] [Relay] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] [KEY] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] Relay 1 starting on 10.250.120.196:9101 (RELAY PORT 9101)
[Relay 1] Registering with CDS at 127.0.0.1:9000
[Relay 1] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9101, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5MM7/HBECV26fZqjUJkt\nQ4+dx297cL0hf1+rf08Qir5tL/lArfQsiplTqcsIsZiN7vJ8K2XzvK5JAEv8tVE4\nEKU4W1hbEVBd1eLCX+Oc5XauTbWhW8xlc2wdNlNwDhin2Mw84doKJWPyfjtIwnIi\n3nWHqxLyAqkj6qDoByA8D7YVmJxvzwL0mrYE8G8b4Q4Wjnx2SXeTwc9LRzqwrsyb\nlM5B4BSVPBignOMhD2AfuIFw6uULQThbkL9L5AnQA08B4Gqzo731LLJN/Y6qo+VJ\nki2t6m1aJTG0LBjijpH7CtnN1MHIQ5UueS1sJVYZooYxkxEYYZTqIUXxuI5ICKPC\nCQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 1] [Relay] Listening for incoming messages on port 9101 (RELAY PORT 9101)
[Relay 1] [Relay] [handle_message ENTERED] addr=('10.250.120.196', 59684), thread=6193524736, relay_port=9101
[Relay 1] [Relay] [DEBUG] Raw data received: b'{"session_key": "F2h+dQT6g+s7X0stg70kPZZri6cdRl4emlrzJW0M77r3XAfyLaIKvWaL8XI7N8CXsB6VWHx4/dz4yYks09sAMkpSyhaa+FTwi/2FUfO+Crmv79KwC1Sda2hQsDUWLqvcs0PCsEI5msVke7M3Qp7t8YEjPLHGS7rl+QMbIqnPXmHAFpMBi+Fyid3ITBMf6Eu4+NnJmosGoFmNaenw6thFQaIIuHEKPECHFmtoAKYRngCySePd8gXLHJer9v5kP2Ml2oS4zjtJAsrgykrxVMRQcmYIsg8rWQFoAc3purrw8xcoXEDz0cPcxDVnblP4TlHiTjZB3ZNkk2KDjSt2yMUdEQ==", "payload": "azY0/M2+74nX747073d56wacOMy99DDWSsNeqh0Ct7z4EdoONI7vrFnlha+Zb54AThTYYzDQ3oC6unvBue9MdDpzYo9kx5xaGNgHUey+gI+/LG0sVog+uc5OMYENyyQ844BAOuVnyb3f6y5PJkN9v1d7NRgWNkwWTg5uSOCXe1+xCXGk0IMufyXThY/iM28xkGlGgbTq9+srlJhWq8KdO04MP3dZZego0lSdxursWfVQcLnSQvraG5uHuA+N8x8+tAQaKysNIEUPC67EflQKxnCJR9TSsPrZNOTXCCBTGNJFapq+nql5lqijmjoso/crS4oL4m9PipCPjPCHxC+1/Sy9CP66LcRkevLZbaEliWwwOXXHBgpFfUot4bqJOSU6Fr8yKpD+Gh/P+cBPsSkWdzsAFN/UAiKXSJrcTw0izuhOGjlEFLURSkvVSmd/e2aXKN60df6H0OaOjOaic94mf8O3G7/wZZM5tTUj89RQ36pLrtScyb1jsctyTqCRg5XdimsXNAAAHetS8ariG159Xb/nt7wy9w/W00c9/kWdZpVnbgU5gxvmicYFok7LhAUdRyNnn+MurKxlGconW86pmOJLkF9iUB+BgMcsyig/ILYU3nN33r1EwigfFnvgtZ0G4fHt+q3LKiNzvfQODQ=="}'
[Relay 1] [Relay] [DEBUG] Data after JSON parse: type=<class 'dict'>, keys=['session_key', 'payload']
[Relay 1] [Relay] Received session_key (base64): F2h+dQT6g+s7X0stg70kPZZri6cdRl4emlrzJW0M77r3XAfyLaIKvWaL8XI7N8CXsB6VWHx4/dz4yYks09sAMkpSyhaa+FTwi/2FUfO+Crmv79KwC1Sda2hQsDUWLqvcs0PCsEI5msVke7M3Qp7t8YEjPLHGS7rl+QMbIqnPXmHAFpMBi+Fyid3ITBMf6Eu4+NnJmosGoFmNaenw6thFQaIIuHEKPECHFmtoAKYRngCySePd8gXLHJer9v5kP2Ml2oS4zjtJAsrgykrxVMRQcmYIsg8rWQFoAc3purrw8xcoXEDz0cPcxDVnblP4TlHiTjZB3ZNkk2KDjSt2yMUdEQ==
[Relay 1] [Relay] Decoded session_key_enc (hex): 17687e7504fa83eb3b5f4b2d83bd243d966b8ba71d465e1e9a5af3256d0cefbaf75c07f22da20abd668bf1723b37c097b01e95587c78fddcf8c9892cd3db00324a52ca169af854f08bfd8551f3be0ab9afefd2b00b549d6b6850b035162eabdcb343c2b042399ac5647bb337429eedf181233cb1c64bbae5f9031b22a9cf5e61c01693018be17289ddc84c131fe84bb8f8d9c99a8b06a0598d69e9f0ead84541a208b8710a3c4087166b6800a6119e00b249e3ddf205cb1c97abf6fe643f6325da84b8ce3b4902cae0ca4af154c450726608b20f2b59016801cde9babaf0f317285c40f3d1c3dcc435676e53f84e51e24e3641dd93649362838d2b76c8c51d11
[Relay 1] [Relay] Decrypting session key with fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] Decrypted session_key (hex): e34181c90891222fffe2aefee418dfd9a45b825ac754e2b57579cc453ca87c38
[Relay 1] [Relay] [DEBUG] About to AES-decrypt payload (passing base64 string directly)
[Relay 1] [Relay] [DEBUG] Payload base64-decoded: type=<class 'bytes'>, len=493, preview=b'k64\xfc\xcd\xbe\xef\x89\xd7\xef\x8e\xf4\xefwy\xeb\x06\x9c8\xcc\xbd\xf40\xd6J\xc3^\xaa\x1d\x02\xb7\xbc\xf8\x11\xda\x0e4\x8e\xef\xacY\xe5\x85\xaf\x99o\x9e\x00N\x14\xd8c0\xd0\xde\x80\xba\xba{\xc1'
[Relay 1] [Relay] [DEBUG] AES-decrypted payload: type=<class 'bytes'>, len=477, preview=b'{"next_ip": "127.0.0.1", "next_port": 9100, "session_key": "'
[Relay 1] [Relay] [DEBUG] AES-decrypted payload (hex): 7b226e6578745f6970223a20223132372e302e302e31222c20226e6578745f706f7274223a20393130302c202273657373696f6e5f6b6579223a2022
[Relay 1] [Relay] [DEBUG] AES-decrypted payload as UTF-8: '{"next_ip": "127.0.0.1", "next_port": 9100, "session_key": "PYXCOWvYqdMn9mB/aakmBELXNJIT0nJpPgJtBRRwDVgodDpqdK+KJMtR3ELO'
[Relay 1] [Relay] [DEBUG] Inner payload is JSON, forwarding to next relay.
[Relay 1] [Relay] [DEBUG] Forwarding to next relay 127.0.0.1:9100
[Relay 1] [Relay] [DEBUG] Received response from next relay: type=<class 'bytes'>, len=460, preview=b'{"result": "OK", "echo": {"session_key": "PYXCOWvYqdMn9mB/aa'
[Relay 1] [Relay] [RETURN] AES-encrypted response (hex): a4b99e6c8c9e5952ad33daa4acfe3795d5df4a7ef048540d62feef8015e9a2c40e993540366374b26ab2a298f19b46f9a854f428ad1f5a84b1027c00
[Relay 1] [Relay] [RETURN] Base64-encoded AES-encrypted response: type=<class 'bytes'>, len=636, preview=b'pLmebIyeWVKtM9qkrP43ldXfSn7wSFQNYv7vgBXposQOmTVANmN0smqyopjx'
[Relay 1] [Relay] [handle_message END] addr=('10.250.120.196', 59684), thread=6193524736
[Relay 1] [Relay] Deregistering from CDS and shutting down...
[Relay 1] [Relay] ERROR during deregistration: [Errno 54] Connection reset by peer
