[Relay] ---- Relay process started ----
[Relay 1] [Relay] Loaded persistent RSA keypair from relay1_key.pem
[Relay 1] [Relay] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] [KEY] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] Relay 1 starting on 10.250.120.196:9101 (RELAY PORT 9101)
[Relay 1] Registering with CDS at 127.0.0.1:9000
[Relay 1] [Relay] Registered with CDS: {'ip': '10.250.120.196', 'port': 9101, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5MM7/HBECV26fZqjUJkt\nQ4+dx297cL0hf1+rf08Qir5tL/lArfQsiplTqcsIsZiN7vJ8K2XzvK5JAEv8tVE4\nEKU4W1hbEVBd1eLCX+Oc5XauTbWhW8xlc2wdNlNwDhin2Mw84doKJWPyfjtIwnIi\n3nWHqxLyAqkj6qDoByA8D7YVmJxvzwL0mrYE8G8b4Q4Wjnx2SXeTwc9LRzqwrsyb\nlM5B4BSVPBignOMhD2AfuIFw6uULQThbkL9L5AnQA08B4Gqzo731LLJN/Y6qo+VJ\nki2t6m1aJTG0LBjijpH7CtnN1MHIQ5UueS1sJVYZooYxkxEYYZTqIUXxuI5ICKPC\nCQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 1] [Relay] Listening for incoming messages on port 9101 (RELAY PORT 9101)
[Relay 1] [Relay] [handle_message ENTERED] addr=('10.250.120.196', 60517), thread=6197686272, relay_port=9101
[Relay 1] [Relay] [DEBUG] Raw data received: b'{"next_ip": "10.250.120.196", "next_port": 9101, "session_key": "ssbKqdkxpZ/0oXnfPc9my7OvPB4QFNf+kAKaySdStcFEcj5UDdRlV4YASzu60ObolQFnQKcJRp+qHAypekY8Zg9O0VpL4HbkQD4cisJithm+0XSXt0xeEju2+LUrmF4t4g7hlc5CSgK9yql4QFfmeJRRkdZZvaWhs2SdH0JZsNKKVHjXgTeFhp4KV+qL8G6EQtiWZ6Vsz+a5q6V3DjvxpCN8MqYgXyCaFC1o3FdCABvYSFehi4GWonLgom7+K5WKSgKui/Yyhel72+mjy8MNYzFVvjdmEw5K6f8Fg7c7yluXRFE7IzYowh3q7GqDobFsGNAHEDSFKLHlIk42msvjvA==", "payload": "WwiM0oOWs5jzIzH7DI4OOGKuRklFdPXiC27mbROa/BnSjP5mlCy0BJnYipbL1vzK+P8JJ/nK5eLKMsrBQIf7cj+TUFyGv8SlF5anVnPlAOmbXcm6Kamm6gUq90Ll+3fKSwOnRkDmzgx0iea9Zj2Id8ZFttzn/r3FPahO/1umeM/R4/L5ZiM9Hb4MotAkm5Aj0ALItIxPZIvZDp4UM+A1XuNUBHVwSOoXXq4f82fd+a1W6naPtPGGP5fZAawqvZdKJiB1qUVPcgimiTd0zkwQF36542YI+VTazzCDCftJ/rAJ7fFxqnMuKf+FysHeRDL5lZnPv2uNSdBY8k7B6i5wbqwX6zI3hgfFP8IG4oPMWwzY+5s2pI25k8DMJZH1FqtzAyTChdBq4J+UCR6EhwfdBE/3C1xucscA5VmPogm15TKzZ20sTMYz8SV+rikUyErAgBc1IS+cyR57zOmMXbsCHbxlNHjymCp00z+h7m9oc8N+nwbGK5XTEuXYceSJrmvbMBffIuVg48jMDrL+UnfGCGqXtYDuzwM0WN/BPo6/aBmQsnazyoDNhd1rEw7CJD0n1FoBQXAsfftMTR9ovTmuAyYHj5P1PrSKHptiirSiElGO6zu0qKZLR62VuQ+LfCyxRt42Z30YSHLbQMle2GGOxna14ACtkJ5D9EMOOXKuZSRwfosAOmG7rIaSKtU4Q7sbgeaRjNhMyTtJWE8FGvX/lF1+kvLllz2uKHAVKm1xql9wcYDIRO1jGzeQaeLYXHP7W6LYeCu2aSOs/yLmNPk3jFvjtl/aZAqkYTT6nY2p21kg2fUMdNQhZaYe7peFLuUS2EFmY4b4URuVNKDDqqAFunnfYfNdc6lfAMXXvwlOh/jMbTLIAjkMifQyi4mjzl8pO1t7I+IbTEasVhyVl4G/YXQCYe5qk/OCJvdaqwphLMUTOYWaHG7BcPPVXLkQFrYmxfNZ6VpXkTX/IvpGyoXvLmTfunGz2Scg7ZIUJLp4GQB0aIGPCX0aTg0PhjWScDniQlKqKfIBj5N8xI6kjk//DeTFMtf6eAHrt6BSn98wWuzSdZPEPfC8kW67ac6xl6qGDM5LLj+W21resViewtZviSb61qDEMMjHEI1goT+Xwy1h/7K/6S29XTV4+kicUQeenMujlLez40W7lrtbTEIPFFnjVDx8cUPAD6QUPSwCzUQBQTyiQgoO3q/Lwhi1gXejeDSaOFkIKEtrrLTaH9jYlXmUM/JJlQ3b2QZ7MZ5mH6NdPc5jeMOaZZCW5L3rRUTC+PxaV8noZksS5lwiO4ZEdS6UixRDTnKV8jzZs0u1jcY37+TNRy+IyIJqh9j2y0E2ELB7rqxBajN87SV0dRjf6uqaQ8WIMa771DVK7Qi1XaToz0CHgqP9VBbrjlCXknV+tlk/XPCY6CTAvoF75hqO3QFkzDArhSkBRSTWlf1MU0FVJ62wAFmgzifRPxY5PwLyTrM="}'
[Relay 1] [Relay] [DEBUG] Data after JSON parse: type=<class 'dict'>, keys=['next_ip', 'next_port', 'session_key', 'payload']
[Relay 1] [Relay] Received session_key (base64): ssbKqdkxpZ/0oXnfPc9my7OvPB4QFNf+kAKaySdStcFEcj5UDdRlV4YASzu60ObolQFnQKcJRp+qHAypekY8Zg9O0VpL4HbkQD4cisJithm+0XSXt0xeEju2+LUrmF4t4g7hlc5CSgK9yql4QFfmeJRRkdZZvaWhs2SdH0JZsNKKVHjXgTeFhp4KV+qL8G6EQtiWZ6Vsz+a5q6V3DjvxpCN8MqYgXyCaFC1o3FdCABvYSFehi4GWonLgom7+K5WKSgKui/Yyhel72+mjy8MNYzFVvjdmEw5K6f8Fg7c7yluXRFE7IzYowh3q7GqDobFsGNAHEDSFKLHlIk42msvjvA==
[Relay 1] [Relay] Decoded session_key_enc (hex): b2c6caa9d931a59ff4a179df3dcf66cbb3af3c1e1014d7fe90029ac92752b5c144723e540dd4655786004b3bbad0e6e895016740a709469faa1c0ca97a463c660f4ed15a4be076e4403e1c8ac262b619bed17497b74c5e123bb6f8b52b985e2de20ee195ce424a02bdcaa9784057e678945191d659bda5a1b3649d1f4259b0d28a5478d7813785869e0a57ea8bf06e8442d89667a56ccfe6b9aba5770e3bf1a4237c32a6205f209a142d68dc5742001bd84857a18b8196a272e0a26efe2b958a4a02ae8bf63285e97bdbe9a3cbc30d633155be3766130e4ae9ff0583b73bca5b9744513b233628c21deaec6a83a1b16c18d00710348528b1e5224e369acbe3bc
[Relay 1] [Relay] Decrypting session key with fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] Decrypted session_key (hex): 10c1d262a579d395ef9cb02197bf241e89ad4fdc810c006c7fb6ccc649ef0bc1
[Relay 1] [Relay] [DEBUG] About to AES-decrypt payload (passing base64 string directly)
[Relay 1] [Relay] [DEBUG] Payload base64-decoded: type=<class 'bytes'>, len=1106, preview=b"[\x08\x8c\xd2\x83\x96\xb3\x98\xf3#1\xfb\x0c\x8e\x0e8b\xaeFIEt\xf5\xe2\x0bn\xe6m\x13\x9a\xfc\x19\xd2\x8c\xfef\x94,\xb4\x04\x99\xd8\x8a\x96\xcb\xd6\xfc\xca\xf8\xff\t'\xf9\xca\xe5\xe2\xca2\xca\xc1"
[Relay 1] [Relay] [DEBUG] AES-decrypted payload: type=<class 'bytes'>, len=1090, preview=b'{"next_ip": "10.250.120.196", "next_port": 9102, "session_ke'
[Relay 1] [Relay] [DEBUG] AES-decrypted payload (hex): 7b226e6578745f6970223a202231302e3235302e3132302e313936222c20226e6578745f706f7274223a20393130322c202273657373696f6e5f6b65
[Relay 1] [Relay] [DEBUG] Next hop JSON keys: ['next_ip', 'next_port', 'session_key', 'payload']
[Relay 1] [Relay] [DEBUG] Forwarding to next relay 10.250.120.196:9102
[Relay 1] [Relay] [DEBUG] Received response from next relay: type=<class 'bytes'>, len=112, preview=b'Jj2ThIEdDMJEinde14OlV6XahPz423M8DKnMhyiDEa4C0bwFF3CsLcbqpc7Q'
[Relay 1] [Relay] [RETURN] Base64-decoded response: type=<class 'bytes'>, len=82, preview=b'&=\x93\x84\x81\x1d\x0c\xc2D\x8aw^\xd7\x83\xa5W\xa5\xda\x84\xfc\xf8\xdbs<\x0c\xa9\xcc\x87(\x83\x11\xae\x02\xd1\xbc\x05\x17p\xac-\xc6\xea\xa5\xce\xd0\x88\xf1\xf9\x1e\xf2\x988\xf2G\xc4\xaa\xc4e\xde~'
[Relay 1] [Relay] [RETURN] AES-decrypted response: type=<class 'bytes'>, len=66, preview=b'\xa6\xce\xbd\x82:\x1a\xe1\x0f\x07\x88f\xc2\x8e\xea\xd4\xe2\x99Y\xb0\xed\x9b\x91\xf0C\xc8\xdd\x8c\xd7\xc6bF\xe9t\x8d=\xe2M\xbf\n\xc6\xe02X\xd8\xdcP9\x03pA\x1di\tU\xba\xf3\nM\x0c%'
[Relay 1] [Relay] [RETURN] AES-decrypted response not UTF-8: 'utf-8' codec can't decode byte 0xa6 in position 0: invalid start byte
[Relay 1] [Relay] [RETURN] AES-encrypted response (hex): b0ed11a3278865f0c1e296b16d9042c8814d412977e3166ae912c385bffc0e395b5cc0ef5b9a851c565d6119bc6bf594a133f127f05c81883ee6823a
[Relay 1] [Relay] [RETURN] Base64-encoded AES-encrypted response: type=<class 'bytes'>, len=132, preview=b'sO0RoyeIZfDB4paxbZBCyIFNQSl34xZq6RLDhb/8DjlbXMDvW5qFHFZdYRm8'
[Relay 1] [Relay] [handle_message END] addr=('10.250.120.196', 60517), thread=6197686272
