[Relay] ---- Relay process started ----
[Relay 1] [Relay] Loaded persistent RSA keypair from relay1_key.pem
[Relay 1] [Relay] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] [KEY] Public key fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] Relay 1 starting on 10.250.61.236:9101 (RELAY PORT 9101)
[Relay 1] Registering with CDS at 127.0.0.1:9000
[Relay 1] [Relay] Registered with CDS: {'ip': '10.250.61.236', 'port': 9101, 'public_key': '-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5MM7/HBECV26fZqjUJkt\nQ4+dx297cL0hf1+rf08Qir5tL/lArfQsiplTqcsIsZiN7vJ8K2XzvK5JAEv8tVE4\nEKU4W1hbEVBd1eLCX+Oc5XauTbWhW8xlc2wdNlNwDhin2Mw84doKJWPyfjtIwnIi\n3nWHqxLyAqkj6qDoByA8D7YVmJxvzwL0mrYE8G8b4Q4Wjnx2SXeTwc9LRzqwrsyb\nlM5B4BSVPBignOMhD2AfuIFw6uULQThbkL9L5AnQA08B4Gqzo731LLJN/Y6qo+VJ\nki2t6m1aJTG0LBjijpH7CtnN1MHIQ5UueS1sJVYZooYxkxEYYZTqIUXxuI5ICKPC\nCQIDAQAB\n-----END PUBLIC KEY-----\n'}
[Relay 1] [Relay] Listening for incoming messages on port 9101 (RELAY PORT 9101)
[Relay 1] [Relay] [handle_message ENTERED] addr=('10.250.61.236', 54932), thread=6123532288, relay_port=9101
[Relay 1] [Relay] [DEBUG] Raw data received: b'{"next_ip": "10.250.61.236", "next_port": 9101, "session_key": "fgwOjkHfrgseVDDFiSZTQd161ux3eQP96IibHjiuuC/kT0QBoTW/aAHWVTOZQ+x368AVsXrS4mf5IkQJIp2dQTDel0QBumKEhH/5t3KoRkSEEx1l/afUTQtuMiRP0hpMh1If47lYjOKCychBy17AHyx1HKe4fPYAtLt48yviKcNsMxAKrSgXxiElkv84vDwAPp2a185TU1WGVKqh3MqUJ1+WuMtKe0lcBq5VNxE9AMWNutv0FJn0WaFRxgveNW5GDn+oBCaGFf7jMzeBI5xVeB/UUO7cA/7GRV7dtRknSF8YZ6XwZE7qmTJ9WGG7YDur1refJKq8OFQyphC/4nfsrg==", "payload": "LQWGY0zeZeV/jVwnEHVqwP1v8QdUlIcW2++bj6qJY6uJKM4oR83DAiK3J2mlTRHTLq4hy8obM47h9Ydhx70Oyw4AWOkWbzZj0VObSqHzm06NI8aIMMAA/RH9XjH7RG+7qwXZ2Q+Cp/Ubk+2lP1T7OoLkk+9zoa7LL83uKg+HsnPJ1KePIyrcbFl8RkOMkat+8rYRIx5zNjjqaR5JK+MR8w6p8/nGd2Qu8LhSztUpJ4W8dLI8BefvsAIRNRhywB8b5ihsyHV3neCbHgkRwiqZkZ7VGuYnS4TW0a/HDytroesbkMAQNd/wnS/ztOILzaHAFosAoi8huE+LI7WJBgSQH8X8+PaAGOTMSCBBdU0tdvFpk45SB1KzV7to79gs2J2b/TMFFw0A0NQvBB0jx6cEzdA2VKS4nZgIj+58Tr4mDaC/g17PJRLg1LwOPdxdajI6Dg7YPN/hHIBMRTAMTyxqJdOyScCNqddsalRTmpL2WcUlfXSKgmF9GyKRMiHktDtuF4oeJ+ULG3JHU+ZYb+Klx4OCVkFv3UWUjRD+5rqrl5uv7Do8mrMqtZqfMqQs3dnQpm+ZSo8ZlLv+qFX3Ztn8nWMxSTRFTjQBatbVUlRebsNpY0Ccz9Rn1V2kncWGn0PnGs1yGt8NYDaaIWrFkW2j2Ch1ItQvtpKWWyEJaJfEY5peZvoNjlzmCYII3bL/8TrO0poo2x0WR1c4oh2w9TGaoWiC42iiFH0JcGxQw2XVat2HaOLr0q656NYlfaNvIKsY7W7szMWjkdoZ1ySANZzs9HmJPpc1ftGBOY0Jt7oSverMZ7JMsl4gVyog5H86oo2v/GooSAAzYRTjByW0qPd6iaL29bbyEVP+VlLBh7EJ/nZk5r8Zad8YR834Gs433ApiszaJ2T2/2cq3WZW3r7eqDXb6ZLPtwl7LtETwjC5HyT6VrmmGeh1hwASWwlDlF1xkeHMTncjOo6y2n2C+lk2hXDn4BI4g3kh7xKtxK8SRdcP8M9ulz7eYFG2H7SuOMHqZPQNEsBIkHexMeOiCJWhwwRXEK+bJFO5XksGVfjlnEpMntudAl47MOgkLS5XD7BTE+ajLTogiit/nIgubNNiuFJscLEenuntQvT/R2aImRjoHga6FlJBBZRSNc8J3VsEicM+Ja95+4DjIyPLYr4/UM5GmpxglGgYnm/j30mlbqPtaWfHoq7PQwjQcJWyva+X3Qs9WjipCVfu63/IY1go8AjwNs1RjpcleJMPQSo6qQgMIPQ/ZL5b7E9W1MYv86FlKmT2NDD0Odjz31Bvbo8ME1fS4TT+YGvtF5Cvzssi5rnwCKEVI2fYiNqf3QRddY0Mkt6p4FdfoY3sovlcGMf+8pNjRXHuxOIyXCkXfjDOps+boti8lLmlgxp/ut115rsoaD46NtIrflxzjy3yyxMGrjyfsLnipCFtXO1pehwxumzcyWxPTLRLqaLr2W2mh5nxzHw=="}'
[Relay 1] [Relay] [DEBUG] Data after JSON parse: type=<class 'dict'>, keys=['next_ip', 'next_port', 'session_key', 'payload']
[Relay 1] [Relay] Received session_key (base64): fgwOjkHfrgseVDDFiSZTQd161ux3eQP96IibHjiuuC/kT0QBoTW/aAHWVTOZQ+x368AVsXrS4mf5IkQJIp2dQTDel0QBumKEhH/5t3KoRkSEEx1l/afUTQtuMiRP0hpMh1If47lYjOKCychBy17AHyx1HKe4fPYAtLt48yviKcNsMxAKrSgXxiElkv84vDwAPp2a185TU1WGVKqh3MqUJ1+WuMtKe0lcBq5VNxE9AMWNutv0FJn0WaFRxgveNW5GDn+oBCaGFf7jMzeBI5xVeB/UUO7cA/7GRV7dtRknSF8YZ6XwZE7qmTJ9WGG7YDur1refJKq8OFQyphC/4nfsrg==
[Relay 1] [Relay] Decoded session_key_enc (hex): 7e0c0e8e41dfae0b1e5430c589265341dd7ad6ec777903fde8889b1e38aeb82fe44f4401a135bf6801d655339943ec77ebc015b17ad2e267f9224409229d9d4130de974401ba6284847ff9b772a8464484131d65fda7d44d0b6e32244fd21a4c87521fe3b9588ce282c9c841cb5ec01f2c751ca7b87cf600b4bb78f32be229c36c33100aad2817c6212592ff38bc3c003e9d9ad7ce5353558654aaa1dcca94275f96b8cb4a7b495c06ae5537113d00c58dbadbf41499f459a151c60bde356e460e7fa804268615fee3333781239c55781fd450eedc03fec6455eddb51927485f1867a5f0644eea99327d5861bb603babd6b79f24aabc385432a610bfe277ecae
[Relay 1] [Relay] Decrypting session key with fingerprint: 74019246e4745ea09badde25326501d85571359b8b49ebb8349bb13a86da1d92
[Relay 1] [Relay] Decrypted session_key (hex): 92e6c529edc7faf148a72d59e041803f1b695571dc84f46da6daa46e053d7bec
[Relay 1] [Relay] [DEBUG] About to AES-decrypt payload (passing base64 string directly)
[Relay 1] [Relay] [DEBUG] Payload base64-decoded: type=<class 'bytes'>, len=1105, preview=b'-\x05\x86cL\xdee\xe5\x7f\x8d\\\'\x10uj\xc0\xfdo\xf1\x07T\x94\x87\x16\xdb\xef\x9b\x8f\xaa\x89c\xab\x89(\xce(G\xcd\xc3\x02"\xb7\'i\xa5M\x11\xd3.\xae!\xcb\xca\x1b3\x8e\xe1\xf5\x87a'
[Relay 1] [Relay] [DEBUG] AES-decrypted payload: type=<class 'bytes'>, len=1089, preview=b'{"next_ip": "10.250.61.236", "next_port": 9103, "session_key'
[Relay 1] [Relay] [DEBUG] AES-decrypted payload (hex): 7b226e6578745f6970223a202231302e3235302e36312e323336222c20226e6578745f706f7274223a20393130332c202273657373696f6e5f6b6579
[Relay 1] [Relay] [DEBUG] Next hop JSON keys: ['next_ip', 'next_port', 'session_key', 'payload']
[Relay 1] [Relay] [DEBUG] Forwarding to next relay 10.250.61.236:9103
[Relay 1] [Relay] [DEBUG] Received response from next relay: type=<class 'bytes'>, len=112, preview=b'XI97u625zcj0ypL9H86ugiGeVXTxLjk7VSc+/3qlNU4aJw2oyedj7mi2uXFy'
[Relay 1] [Relay] [RETURN] Base64-decoded response: type=<class 'bytes'>, len=82, preview=b"\\\x8f{\xbb\xad\xb9\xcd\xc8\xf4\xca\x92\xfd\x1f\xce\xae\x82!\x9eUt\xf1.9;U'>\xffz\xa55N\x1a'\r\xa8\xc9\xe7c\xeeh\xb6\xb9qru\x9a\x0f\x840!1\x92_\x91\\\xcc\x7fk\xb2"
[Relay 1] [Relay] [RETURN] AES-decrypted response: type=<class 'bytes'>, len=66, preview=b'\x17&\xae\x87\x03Y\x9b\x8e\x81,\x11x\x83qa\x17\xe8n\xf2\x02\xc5\xb3\x1d\x1a!\xaa\x0e\x99,5\x9f\x88E\x0c2\xc5x\xc7%\x0br\xfc\x1cu\xd65\xb6\xda\xbb2]r\x84\xc8x\x84p\x94\xe4X'
[Relay 1] [Relay] [RETURN] AES-decrypted response not UTF-8: 'utf-8' codec can't decode byte 0xae in position 2: invalid start byte
[Relay 1] [Relay] [RETURN] AES-encrypted response (hex): 69e8a1a41dce4d1b1d2db21468a3bf14c118071196e0510c3a3f585659e2fab1770d9b9a9f4bda988cb668f7f43385995952729bd28bf311ccad7766
[Relay 1] [Relay] [RETURN] Base64-encoded AES-encrypted response: type=<class 'bytes'>, len=132, preview=b'aeihpB3OTRsdLbIUaKO/FMEYBxGW4FEMOj9YVlni+rF3DZuan0vamIy2aPf0'
